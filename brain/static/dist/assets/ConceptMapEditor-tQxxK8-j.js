import{c as _t,Q as ay,T as sy,n as Yp,k as uy,r as T,j as R,U as Tt,e as cy,b as Lt}from"./index-BVqBUaUZ.js";import{c as dy,i as ku,a as Ou,b as ly,d as Du,s as zt,p as Kp,z as Zp,e as fy,f as Xp,g as gr,t as hy}from"./zoom-DwwqPMg_.js";import{t as py,A as gy,D as vy,M as my,a as yy}from"./brain-Bnx4rxRe.js";import{p as by,t as _y,B as pe,m as xy,s as wy}from"./layout-BKsO2JfQ.js";import{P as Lu}from"./plus-BN5qIo2G.js";import{F as Ey}from"./file-text-BTC0_hpX.js";import"./badge-BkuFmKJb.js";import"./circle-check-DssJqdq7.js";import"./circle-DgqYU0W9.js";import"./star-Bu8SsvsT.js";import"./index-B-5vpBbe.js";import"./search-Bh6kJEel.js";import"./select-YdSdKwW-.js";import"./index-DpsEiTZH.js";import"./checkbox-Dm_ePY6N.js";import"./tabs-DoA7ZF7r.js";import"./message-square-Br1IbiIu.js";import"./loader-circle-oc_4DvbM.js";import"./send-BRgcVuPD.js";import"./external-link-qmGTJy6j.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cy=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],Sy=_t("arrow-left-right",Cy);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],Ry=_t("arrow-up-down",qy);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ny=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m8 11 4 4 4-4",key:"1dohi6"}],["path",{d:"M8 5H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-4",key:"1ywtjm"}]],ju=_t("import",Ny);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iy=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Ay=_t("layout-grid",Iy);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const My=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Ty=_t("palette",My);function ue(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=ue(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}function Py(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(o){for(i=0;i<r;++i)n[i]=e[i]*(1-o)+t[i]*o;return n}}function ky(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Oy(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),o=new Array(r),a;for(a=0;a<n;++a)i[a]=ht(e[a],t[a]);for(;a<r;++a)o[a]=t[a];return function(s){for(a=0;a<n;++a)o[a]=i[a](s);return o}}function Dy(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Ly(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=ht(e[i],t[i]):n[i]=t[i];return function(o){for(i in r)n[i]=r[i](o);return n}}function ht(e,t){var r=typeof t,n;return t==null||r==="boolean"?dy(t):(r==="number"?ku:r==="string"?(n=Du(t))?(t=n,Ou):ly:t instanceof Du?Ou:t instanceof Date?Dy:ky(t)?Py:Array.isArray(t)?Oy:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Ly:ku)(e,t)}const Ee={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:r,targetHandle:n})=>`Couldn't create edge for ${e} handle id: "${e==="source"?r:n}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},gt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Qp=["Enter"," ","Escape"],Jp={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:r})=>`Moved selected node ${e}. New position, x: ${t}, y: ${r}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Je;(function(e){e.Strict="strict",e.Loose="loose"})(Je||(Je={}));var ze;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ze||(ze={}));var vt;(function(e){e.Partial="partial",e.Full="full"})(vt||(vt={}));const eg={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Le;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Le||(Le={}));var et;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(et||(et={}));var K;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(K||(K={}));const Bu={[K.Left]:K.Right,[K.Right]:K.Left,[K.Top]:K.Bottom,[K.Bottom]:K.Top};function tg(e){return e===null?null:e?"valid":"invalid"}const rg=e=>"id"in e&&"source"in e&&"target"in e,jy=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Xs=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),xt=(e,t=[0,0])=>{const{width:r,height:n}=Ie(e),i=e.origin??t,o=r*i[0],a=n*i[1];return{x:e.position.x-o,y:e.position.y-a}},By=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,i)=>{const o=typeof i=="string";let a=!t.nodeLookup&&!o?i:void 0;t.nodeLookup&&(a=o?t.nodeLookup.get(i):Xs(i)?i:t.nodeLookup.get(i.id));const s=a?jt(a,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return $t(n,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Vt(r)},wt=(e,t={})=>{let r={x:1/0,y:1/0,x2:-1/0,y2:-1/0},n=!1;return e.forEach(i=>{(t.filter===void 0||t.filter(i))&&(r=$t(r,jt(i)),n=!0)}),n?Vt(r):{x:0,y:0,width:0,height:0}},Qs=(e,t,[r,n,i]=[0,0,1],o=!1,a=!1)=>{const s={...Ct(t,[r,n,i]),width:t.width/i,height:t.height/i},c=[];for(const u of e.values()){const{measured:d,selectable:l=!0,hidden:f=!1}=u;if(a&&!l||f)continue;const p=d.width??u.width??u.initialWidth??null,m=d.height??u.height??u.initialHeight??null,v=mt(s,rt(u)),g=(p??0)*(m??0),y=o&&v>0;(!u.internals.handleBounds||y||v>=g||u.dragging)&&c.push(u)}return c},Fy=(e,t)=>{const r=new Set;return e.forEach(n=>{r.add(n.id)}),t.filter(n=>r.has(n.source)||r.has(n.target))};function Hy(e,t){const r=new Map,n=t?.nodes?new Set(t.nodes.map(i=>i.id)):null;return e.forEach(i=>{i.measured.width&&i.measured.height&&(t?.includeHiddenNodes||!i.hidden)&&(!n||n.has(i.id))&&r.set(i.id,i)}),r}async function zy({nodes:e,width:t,height:r,panZoom:n,minZoom:i,maxZoom:o},a){if(e.size===0)return Promise.resolve(!0);const s=Hy(e,a),c=wt(s),u=Js(c,t,r,a?.minZoom??i,a?.maxZoom??o,a?.padding??.1);return await n.setViewport(u,{duration:a?.duration,ease:a?.ease,interpolate:a?.interpolate}),Promise.resolve(!0)}function ng({nodeId:e,nextPosition:t,nodeLookup:r,nodeOrigin:n=[0,0],nodeExtent:i,onError:o}){const a=r.get(e),s=a.parentId?r.get(a.parentId):void 0,{x:c,y:u}=s?s.internals.positionAbsolute:{x:0,y:0},d=a.origin??n;let l=a.extent||i;if(a.extent==="parent"&&!a.expandParent)if(!s)o?.("005",Ee.error005());else{const p=s.measured.width,m=s.measured.height;p&&m&&(l=[[c,u],[c+p,u+m]])}else s&&nt(a.extent)&&(l=[[a.extent[0][0]+c,a.extent[0][1]+u],[a.extent[1][0]+c,a.extent[1][1]+u]]);const f=nt(l)?$e(t,l,a.measured):t;return(a.measured.width===void 0||a.measured.height===void 0)&&o?.("015",Ee.error015()),{position:{x:f.x-c+(a.measured.width??0)*d[0],y:f.y-u+(a.measured.height??0)*d[1]},positionAbsolute:f}}async function $y({nodesToRemove:e=[],edgesToRemove:t=[],nodes:r,edges:n,onBeforeDelete:i}){const o=new Set(e.map(f=>f.id)),a=[];for(const f of r){if(f.deletable===!1)continue;const p=o.has(f.id),m=!p&&f.parentId&&a.find(v=>v.id===f.parentId);(p||m)&&a.push(f)}const s=new Set(t.map(f=>f.id)),c=n.filter(f=>f.deletable!==!1),d=Fy(a,c);for(const f of c)s.has(f.id)&&!d.find(m=>m.id===f.id)&&d.push(f);if(!i)return{edges:d,nodes:a};const l=await i({nodes:a,edges:d});return typeof l=="boolean"?l?{edges:d,nodes:a}:{edges:[],nodes:[]}:l}const tt=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),$e=(e={x:0,y:0},t,r)=>({x:tt(e.x,t[0][0],t[1][0]-(r?.width??0)),y:tt(e.y,t[0][1],t[1][1]-(r?.height??0))});function ig(e,t,r){const{width:n,height:i}=Ie(r),{x:o,y:a}=r.internals.positionAbsolute;return $e(e,[[o,a],[o+n,a+i]],t)}const Fu=(e,t,r)=>e<t?tt(Math.abs(e-t),1,t)/t:e>r?-tt(Math.abs(e-r),1,t)/t:0,og=(e,t,r=15,n=40)=>{const i=Fu(e.x,n,t.width-n)*r,o=Fu(e.y,n,t.height-n)*r;return[i,o]},$t=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Vs=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),Vt=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),rt=(e,t=[0,0])=>{const{x:r,y:n}=Xs(e)?e.internals.positionAbsolute:xt(e,t);return{x:r,y:n,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},jt=(e,t=[0,0])=>{const{x:r,y:n}=Xs(e)?e.internals.positionAbsolute:xt(e,t);return{x:r,y:n,x2:r+(e.measured?.width??e.width??e.initialWidth??0),y2:n+(e.measured?.height??e.height??e.initialHeight??0)}},ag=(e,t)=>Vt($t(Vs(e),Vs(t))),mt=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},Hu=e=>me(e.width)&&me(e.height)&&me(e.x)&&me(e.y),me=e=>!isNaN(e)&&isFinite(e),Vy=(e,t)=>{},Et=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Ct=({x:e,y:t},[r,n,i],o=!1,a=[1,1])=>{const s={x:(e-r)/i,y:(t-n)/i};return o?Et(s,a):s},Bt=({x:e,y:t},[r,n,i])=>({x:e*i+r,y:t*i+n});function Ze(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(r)}if(typeof e=="string"&&e.endsWith("%")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(t*r*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Gy(e,t,r){if(typeof e=="string"||typeof e=="number"){const n=Ze(e,r),i=Ze(e,t);return{top:n,right:i,bottom:n,left:i,x:i*2,y:n*2}}if(typeof e=="object"){const n=Ze(e.top??e.y??0,r),i=Ze(e.bottom??e.y??0,r),o=Ze(e.left??e.x??0,t),a=Ze(e.right??e.x??0,t);return{top:n,right:a,bottom:i,left:o,x:o+a,y:n+i}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Uy(e,t,r,n,i,o){const{x:a,y:s}=Bt(e,[t,r,n]),{x:c,y:u}=Bt({x:e.x+e.width,y:e.y+e.height},[t,r,n]),d=i-c,l=o-u;return{left:Math.floor(a),top:Math.floor(s),right:Math.floor(d),bottom:Math.floor(l)}}const Js=(e,t,r,n,i,o)=>{const a=Gy(o,t,r),s=(t-a.x)/e.width,c=(r-a.y)/e.height,u=Math.min(s,c),d=tt(u,n,i),l=e.x+e.width/2,f=e.y+e.height/2,p=t/2-l*d,m=r/2-f*d,v=Uy(e,p,m,d,t,r),g={left:Math.min(v.left-a.left,0),top:Math.min(v.top-a.top,0),right:Math.min(v.right-a.right,0),bottom:Math.min(v.bottom-a.bottom,0)};return{x:p-g.left+g.right,y:m-g.top+g.bottom,zoom:d}},yt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function nt(e){return e!=null&&e!=="parent"}function Ie(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function sg(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function ug(e,t={width:0,height:0},r,n,i){const o={...e},a=n.get(r);if(a){const s=a.origin||i;o.x+=a.internals.positionAbsolute.x-(t.width??0)*s[0],o.y+=a.internals.positionAbsolute.y-(t.height??0)*s[1]}return o}function zu(e,t){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}function Wy(){let e,t;return{promise:new Promise((n,i)=>{e=n,t=i}),resolve:e,reject:t}}function Yy(e){return{...Jp,...e||{}}}function pt(e,{snapGrid:t=[0,0],snapToGrid:r=!1,transform:n,containerBounds:i}){const{x:o,y:a}=ye(e),s=Ct({x:o-(i?.left??0),y:a-(i?.top??0)},n),{x:c,y:u}=r?Et(s,t):s;return{xSnapped:c,ySnapped:u,...s}}const eu=e=>({width:e.offsetWidth,height:e.offsetHeight}),cg=e=>e?.getRootNode?.()||window?.document,Ky=["INPUT","SELECT","TEXTAREA"];function dg(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:Ky.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const lg=e=>"clientX"in e,ye=(e,t)=>{const r=lg(e),n=r?e.clientX:e.touches?.[0].clientX,i=r?e.clientY:e.touches?.[0].clientY;return{x:n-(t?.left??0),y:i-(t?.top??0)}},$u=(e,t,r,n,i)=>{const o=t.querySelectorAll(`.${e}`);return!o||!o.length?null:Array.from(o).map(a=>{const s=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:e,nodeId:i,position:a.getAttribute("data-handlepos"),x:(s.left-r.left)/n,y:(s.top-r.top)/n,...eu(a)}})};function fg({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:i,sourceControlY:o,targetControlX:a,targetControlY:s}){const c=e*.125+i*.375+a*.375+r*.125,u=t*.125+o*.375+s*.375+n*.125,d=Math.abs(c-e),l=Math.abs(u-t);return[c,u,d,l]}function Pt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Vu({pos:e,x1:t,y1:r,x2:n,y2:i,c:o}){switch(e){case K.Left:return[t-Pt(t-n,o),r];case K.Right:return[t+Pt(n-t,o),r];case K.Top:return[t,r-Pt(r-i,o)];case K.Bottom:return[t,r+Pt(i-r,o)]}}function hg({sourceX:e,sourceY:t,sourcePosition:r=K.Bottom,targetX:n,targetY:i,targetPosition:o=K.Top,curvature:a=.25}){const[s,c]=Vu({pos:r,x1:e,y1:t,x2:n,y2:i,c:a}),[u,d]=Vu({pos:o,x1:n,y1:i,x2:e,y2:t,c:a}),[l,f,p,m]=fg({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:s,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${s},${c} ${u},${d} ${n},${i}`,l,f,p,m]}function pg({sourceX:e,sourceY:t,targetX:r,targetY:n}){const i=Math.abs(r-e)/2,o=r<e?r+i:r-i,a=Math.abs(n-t)/2,s=n<t?n+a:n-a;return[o,s,i,a]}function Zy({sourceNode:e,targetNode:t,selected:r=!1,zIndex:n=0,elevateOnSelect:i=!1,zIndexMode:o="basic"}){if(o==="manual")return n;const a=i&&r?n+1e3:n,s=Math.max(e.parentId||i&&e.selected?e.internals.z:0,t.parentId||i&&t.selected?t.internals.z:0);return a+s}function Xy({sourceNode:e,targetNode:t,width:r,height:n,transform:i}){const o=$t(jt(e),jt(t));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const a={x:-i[0]/i[2],y:-i[1]/i[2],width:r/i[2],height:n/i[2]};return mt(a,Vt(o))>0}const Qy=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`xy-edge__${e}${t||""}-${r}${n||""}`,Jy=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),gg=(e,t,r={})=>{if(!e.source||!e.target)return t;const n=r.getEdgeId||Qy;let i;return rg(e)?i={...e}:i={...e,id:n(e)},Jy(i,t)?t:(i.sourceHandle===null&&delete i.sourceHandle,i.targetHandle===null&&delete i.targetHandle,t.concat(i))};function vg({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[i,o,a,s]=pg({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,i,o,a,s]}const Gu={[K.Left]:{x:-1,y:0},[K.Right]:{x:1,y:0},[K.Top]:{x:0,y:-1},[K.Bottom]:{x:0,y:1}},eb=({source:e,sourcePosition:t=K.Bottom,target:r})=>t===K.Left||t===K.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},Uu=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function tb({source:e,sourcePosition:t=K.Bottom,target:r,targetPosition:n=K.Top,center:i,offset:o,stepPosition:a}){const s=Gu[t],c=Gu[n],u={x:e.x+s.x*o,y:e.y+s.y*o},d={x:r.x+c.x*o,y:r.y+c.y*o},l=eb({source:u,sourcePosition:t,target:d}),f=l.x!==0?"x":"y",p=l[f];let m=[],v,g;const y={x:0,y:0},b={x:0,y:0},[,,h,_]=pg({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(s[f]*c[f]===-1){f==="x"?(v=i.x??u.x+(d.x-u.x)*a,g=i.y??(u.y+d.y)/2):(v=i.x??(u.x+d.x)/2,g=i.y??u.y+(d.y-u.y)*a);const x=[{x:v,y:u.y},{x:v,y:d.y}],E=[{x:u.x,y:g},{x:d.x,y:g}];s[f]===p?m=f==="x"?x:E:m=f==="x"?E:x}else{const x=[{x:u.x,y:d.y}],E=[{x:d.x,y:u.y}];if(f==="x"?m=s.x===p?E:x:m=s.y===p?x:E,t===n){const N=Math.abs(e[f]-r[f]);if(N<=o){const M=Math.min(o-1,o-N);s[f]===p?y[f]=(u[f]>e[f]?-1:1)*M:b[f]=(d[f]>r[f]?-1:1)*M}}if(t!==n){const N=f==="x"?"y":"x",M=s[f]===c[N],O=u[N]>d[N],k=u[N]<d[N];(s[f]===1&&(!M&&O||M&&k)||s[f]!==1&&(!M&&k||M&&O))&&(m=f==="x"?x:E)}const q={x:u.x+y.x,y:u.y+y.y},S={x:d.x+b.x,y:d.y+b.y},A=Math.max(Math.abs(q.x-m[0].x),Math.abs(S.x-m[0].x)),C=Math.max(Math.abs(q.y-m[0].y),Math.abs(S.y-m[0].y));A>=C?(v=(q.x+S.x)/2,g=m[0].y):(v=m[0].x,g=(q.y+S.y)/2)}return[[e,{x:u.x+y.x,y:u.y+y.y},...m,{x:d.x+b.x,y:d.y+b.y},r],v,g,h,_]}function rb(e,t,r,n){const i=Math.min(Uu(e,t)/2,Uu(t,r)/2,n),{x:o,y:a}=t;if(e.x===o&&o===r.x||e.y===a&&a===r.y)return`L${o} ${a}`;if(e.y===a){const u=e.x<r.x?-1:1,d=e.y<r.y?1:-1;return`L ${o+i*u},${a}Q ${o},${a} ${o},${a+i*d}`}const s=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${o},${a+i*c}Q ${o},${a} ${o+i*s},${a}`}function Gs({sourceX:e,sourceY:t,sourcePosition:r=K.Bottom,targetX:n,targetY:i,targetPosition:o=K.Top,borderRadius:a=5,centerX:s,centerY:c,offset:u=20,stepPosition:d=.5}){const[l,f,p,m,v]=tb({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:i},targetPosition:o,center:{x:s,y:c},offset:u,stepPosition:d});return[l.reduce((y,b,h)=>{let _="";return h>0&&h<l.length-1?_=rb(l[h-1],b,l[h+1],a):_=`${h===0?"M":"L"}${b.x} ${b.y}`,y+=_,y},""),f,p,m,v]}function Wu(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function nb(e){const{sourceNode:t,targetNode:r}=e;if(!Wu(t)||!Wu(r))return null;const n=t.internals.handleBounds||Yu(t.handles),i=r.internals.handleBounds||Yu(r.handles),o=Ku(n?.source??[],e.sourceHandle),a=Ku(e.connectionMode===Je.Strict?i?.target??[]:(i?.target??[]).concat(i?.source??[]),e.targetHandle);if(!o||!a)return e.onError?.("008",Ee.error008(o?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=o?.position||K.Bottom,c=a?.position||K.Top,u=Ve(t,o,s),d=Ve(r,a,c);return{sourceX:u.x,sourceY:u.y,targetX:d.x,targetY:d.y,sourcePosition:s,targetPosition:c}}function Yu(e){if(!e)return null;const t=[],r=[];for(const n of e)n.width=n.width??1,n.height=n.height??1,n.type==="source"?t.push(n):n.type==="target"&&r.push(n);return{source:t,target:r}}function Ve(e,t,r=K.Left,n=!1){const i=(t?.x??0)+e.internals.positionAbsolute.x,o=(t?.y??0)+e.internals.positionAbsolute.y,{width:a,height:s}=t??Ie(e);if(n)return{x:i+a/2,y:o+s/2};switch(t?.position??r){case K.Top:return{x:i+a/2,y:o};case K.Right:return{x:i+a,y:o+s/2};case K.Bottom:return{x:i+a/2,y:o+s};case K.Left:return{x:i,y:o+s/2}}}function Ku(e,t){return e&&(t?e.find(r=>r.id===t):e[0])||null}function Us(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function ib(e,{id:t,defaultColor:r,defaultMarkerStart:n,defaultMarkerEnd:i}){const o=new Set;return e.reduce((a,s)=>([s.markerStart||n,s.markerEnd||i].forEach(c=>{if(c&&typeof c=="object"){const u=Us(c,t);o.has(u)||(a.push({id:u,color:c.color||r,...c}),o.add(u))}}),a),[]).sort((a,s)=>a.id.localeCompare(s.id))}const mg=1e3,ob=10,tu={nodeOrigin:[0,0],nodeExtent:gt,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},ab={...tu,checkEquality:!0};function ru(e,t){const r={...e};for(const n in t)t[n]!==void 0&&(r[n]=t[n]);return r}function sb(e,t,r){const n=ru(tu,r);for(const i of e.values())if(i.parentId)iu(i,e,t,n);else{const o=xt(i,n.nodeOrigin),a=nt(i.extent)?i.extent:n.nodeExtent,s=$e(o,a,Ie(i));i.internals.positionAbsolute=s}}function ub(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const r=[],n=[];for(const i of e.handles){const o={id:i.id,width:i.width??1,height:i.height??1,nodeId:e.id,x:i.x,y:i.y,position:i.position,type:i.type};i.type==="source"?r.push(o):i.type==="target"&&n.push(o)}return{source:r,target:n}}function nu(e){return e==="manual"}function Ws(e,t,r,n={}){const i=ru(ab,n),o={i:0},a=new Map(t),s=i?.elevateNodesOnSelect&&!nu(i.zIndexMode)?mg:0;let c=e.length>0;t.clear(),r.clear();for(const u of e){let d=a.get(u.id);if(i.checkEquality&&u===d?.internals.userNode)t.set(u.id,d);else{const l=xt(u,i.nodeOrigin),f=nt(u.extent)?u.extent:i.nodeExtent,p=$e(l,f,Ie(u));d={...i.defaults,...u,measured:{width:u.measured?.width,height:u.measured?.height},internals:{positionAbsolute:p,handleBounds:ub(u,d),z:yg(u,s,i.zIndexMode),userNode:u}},t.set(u.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(c=!1),u.parentId&&iu(d,t,r,n,o)}return c}function cb(e,t){if(!e.parentId)return;const r=t.get(e.parentId);r?r.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function iu(e,t,r,n,i){const{elevateNodesOnSelect:o,nodeOrigin:a,nodeExtent:s,zIndexMode:c}=ru(tu,n),u=e.parentId,d=t.get(u);if(!d){console.warn(`Parent node ${u} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}cb(e,r),i&&!d.parentId&&d.internals.rootParentIndex===void 0&&c==="auto"&&(d.internals.rootParentIndex=++i.i,d.internals.z=d.internals.z+i.i*ob),i&&d.internals.rootParentIndex!==void 0&&(i.i=d.internals.rootParentIndex);const l=o&&!nu(c)?mg:0,{x:f,y:p,z:m}=db(e,d,a,s,l,c),{positionAbsolute:v}=e.internals,g=f!==v.x||p!==v.y;(g||m!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:g?{x:f,y:p}:v,z:m}})}function yg(e,t,r){const n=me(e.zIndex)?e.zIndex:0;return nu(r)?n:n+(e.selected?t:0)}function db(e,t,r,n,i,o){const{x:a,y:s}=t.internals.positionAbsolute,c=Ie(e),u=xt(e,r),d=nt(e.extent)?$e(u,e.extent,c):u;let l=$e({x:a+d.x,y:s+d.y},n,c);e.extent==="parent"&&(l=ig(l,c,t));const f=yg(e,i,o),p=t.internals.z??0;return{x:l.x,y:l.y,z:p>=f?p+1:f}}function ou(e,t,r,n=[0,0]){const i=[],o=new Map;for(const a of e){const s=t.get(a.parentId);if(!s)continue;const c=o.get(a.parentId)?.expandedRect??rt(s),u=ag(c,a.rect);o.set(a.parentId,{expandedRect:u,parent:s})}return o.size>0&&o.forEach(({expandedRect:a,parent:s},c)=>{const u=s.internals.positionAbsolute,d=Ie(s),l=s.origin??n,f=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,p=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,m=Math.max(d.width,Math.round(a.width)),v=Math.max(d.height,Math.round(a.height)),g=(m-d.width)*l[0],y=(v-d.height)*l[1];(f>0||p>0||g||y)&&(i.push({id:c,type:"position",position:{x:s.position.x-f+g,y:s.position.y-p+y}}),r.get(c)?.forEach(b=>{e.some(h=>h.id===b.id)||i.push({id:b.id,type:"position",position:{x:b.position.x+f,y:b.position.y+p}})})),(d.width<a.width||d.height<a.height||f||p)&&i.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:m+(f?l[0]*f-g:0),height:v+(p?l[1]*p-y:0)}})}),i}function lb(e,t,r,n,i,o,a){const s=n?.querySelector(".xyflow__viewport");let c=!1;if(!s)return{changes:[],updatedInternals:c};const u=[],d=window.getComputedStyle(s),{m22:l}=new window.DOMMatrixReadOnly(d.transform),f=[];for(const p of e.values()){const m=t.get(p.id);if(!m)continue;if(m.hidden){t.set(m.id,{...m,internals:{...m.internals,handleBounds:void 0}}),c=!0;continue}const v=eu(p.nodeElement),g=m.measured.width!==v.width||m.measured.height!==v.height;if(!!(v.width&&v.height&&(g||!m.internals.handleBounds||p.force))){const b=p.nodeElement.getBoundingClientRect(),h=nt(m.extent)?m.extent:o;let{positionAbsolute:_}=m.internals;m.parentId&&m.extent==="parent"?_=ig(_,v,t.get(m.parentId)):h&&(_=$e(_,h,v));const w={...m,measured:v,internals:{...m.internals,positionAbsolute:_,handleBounds:{source:$u("source",p.nodeElement,b,l,m.id),target:$u("target",p.nodeElement,b,l,m.id)}}};t.set(m.id,w),m.parentId&&iu(w,t,r,{nodeOrigin:i,zIndexMode:a}),c=!0,g&&(u.push({id:m.id,type:"dimensions",dimensions:v}),m.expandParent&&m.parentId&&f.push({id:m.id,parentId:m.parentId,rect:rt(w,i)}))}}if(f.length>0){const p=ou(f,t,r,i);u.push(...p)}return{changes:u,updatedInternals:c}}async function fb({delta:e,panZoom:t,transform:r,translateExtent:n,width:i,height:o}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const a=await t.setViewportConstrained({x:r[0]+e.x,y:r[1]+e.y,zoom:r[2]},[[0,0],[i,o]],n),s=!!a&&(a.x!==r[0]||a.y!==r[1]||a.k!==r[2]);return Promise.resolve(s)}function Zu(e,t,r,n,i,o){let a=i;const s=n.get(a)||new Map;n.set(a,s.set(r,t)),a=`${i}-${e}`;const c=n.get(a)||new Map;if(n.set(a,c.set(r,t)),o){a=`${i}-${e}-${o}`;const u=n.get(a)||new Map;n.set(a,u.set(r,t))}}function bg(e,t,r){e.clear(),t.clear();for(const n of r){const{source:i,target:o,sourceHandle:a=null,targetHandle:s=null}=n,c={edgeId:n.id,source:i,target:o,sourceHandle:a,targetHandle:s},u=`${i}-${a}--${o}-${s}`,d=`${o}-${s}--${i}-${a}`;Zu("source",c,d,e,i,a),Zu("target",c,u,e,o,s),t.set(n.id,n)}}function _g(e,t){if(!e.parentId)return!1;const r=t.get(e.parentId);return r?r.selected?!0:_g(r,t):!1}function Xu(e,t,r){let n=e;do{if(n?.matches?.(t))return!0;if(n===r)return!1;n=n?.parentElement}while(n);return!1}function hb(e,t,r,n){const i=new Map;for(const[o,a]of e)if((a.selected||a.id===n)&&(!a.parentId||!_g(a,e))&&(a.draggable||t&&typeof a.draggable>"u")){const s=e.get(o);s&&i.set(o,{id:o,position:s.position||{x:0,y:0},distance:{x:r.x-s.internals.positionAbsolute.x,y:r.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return i}function vr({nodeId:e,dragItems:t,nodeLookup:r,dragging:n=!0}){const i=[];for(const[a,s]of t){const c=r.get(a)?.internals.userNode;c&&i.push({...c,position:s.position,dragging:n})}if(!e)return[i[0],i];const o=r.get(e)?.internals.userNode;return[o?{...o,position:t.get(e)?.position||o.position,dragging:n}:i[0],i]}function pb({dragItems:e,snapGrid:t,x:r,y:n}){const i=e.values().next().value;if(!i)return null;const o={x:r-i.distance.x,y:n-i.distance.y},a=Et(o,t);return{x:a.x-o.x,y:a.y-o.y}}function gb({onNodeMouseDown:e,getStoreItems:t,onDragStart:r,onDrag:n,onDragStop:i}){let o={x:null,y:null},a=0,s=new Map,c=!1,u={x:0,y:0},d=null,l=!1,f=null,p=!1,m=!1,v=null;function g({noDragClassName:b,handleSelector:h,domNode:_,isSelectable:w,nodeId:x,nodeClickDistance:E=0}){f=zt(_);function q({x:N,y:M}){const{nodeLookup:O,nodeExtent:k,snapGrid:$,snapToGrid:G,nodeOrigin:j,onNodeDrag:z,onSelectionDrag:L,onError:V,updateNodePositions:H}=t();o={x:N,y:M};let W=!1;const I=s.size>1,P=I&&k?Vs(wt(s)):null,D=I&&G?pb({dragItems:s,snapGrid:$,x:N,y:M}):null;for(const[F,B]of s){if(!O.has(F))continue;let U={x:N-B.distance.x,y:M-B.distance.y};G&&(U=D?{x:Math.round(U.x+D.x),y:Math.round(U.y+D.y)}:Et(U,$));let Z=null;if(I&&k&&!B.extent&&P){const{positionAbsolute:Y}=B.internals,te=Y.x-P.x+k[0][0],X=Y.x+B.measured.width-P.x2+k[1][0],ne=Y.y-P.y+k[0][1],ee=Y.y+B.measured.height-P.y2+k[1][1];Z=[[te,ne],[X,ee]]}const{position:J,positionAbsolute:Q}=ng({nodeId:F,nextPosition:U,nodeLookup:O,nodeExtent:Z||k,nodeOrigin:j,onError:V});W=W||B.position.x!==J.x||B.position.y!==J.y,B.position=J,B.internals.positionAbsolute=Q}if(m=m||W,!!W&&(H(s,!0),v&&(n||z||!x&&L))){const[F,B]=vr({nodeId:x,dragItems:s,nodeLookup:O});n?.(v,s,F,B),z?.(v,F,B),x||L?.(v,B)}}async function S(){if(!d)return;const{transform:N,panBy:M,autoPanSpeed:O,autoPanOnNodeDrag:k}=t();if(!k){c=!1,cancelAnimationFrame(a);return}const[$,G]=og(u,d,O);($!==0||G!==0)&&(o.x=(o.x??0)-$/N[2],o.y=(o.y??0)-G/N[2],await M({x:$,y:G})&&q(o)),a=requestAnimationFrame(S)}function A(N){const{nodeLookup:M,multiSelectionActive:O,nodesDraggable:k,transform:$,snapGrid:G,snapToGrid:j,selectNodesOnDrag:z,onNodeDragStart:L,onSelectionDragStart:V,unselectNodesAndEdges:H}=t();l=!0,(!z||!w)&&!O&&x&&(M.get(x)?.selected||H()),w&&z&&x&&e?.(x);const W=pt(N.sourceEvent,{transform:$,snapGrid:G,snapToGrid:j,containerBounds:d});if(o=W,s=hb(M,k,W,x),s.size>0&&(r||L||!x&&V)){const[I,P]=vr({nodeId:x,dragItems:s,nodeLookup:M});r?.(N.sourceEvent,s,I,P),L?.(N.sourceEvent,I,P),x||V?.(N.sourceEvent,P)}}const C=Xp().clickDistance(E).on("start",N=>{const{domNode:M,nodeDragThreshold:O,transform:k,snapGrid:$,snapToGrid:G}=t();d=M?.getBoundingClientRect()||null,p=!1,m=!1,v=N.sourceEvent,O===0&&A(N),o=pt(N.sourceEvent,{transform:k,snapGrid:$,snapToGrid:G,containerBounds:d}),u=ye(N.sourceEvent,d)}).on("drag",N=>{const{autoPanOnNodeDrag:M,transform:O,snapGrid:k,snapToGrid:$,nodeDragThreshold:G,nodeLookup:j}=t(),z=pt(N.sourceEvent,{transform:O,snapGrid:k,snapToGrid:$,containerBounds:d});if(v=N.sourceEvent,(N.sourceEvent.type==="touchmove"&&N.sourceEvent.touches.length>1||x&&!j.has(x))&&(p=!0),!p){if(!c&&M&&l&&(c=!0,S()),!l){const L=ye(N.sourceEvent,d),V=L.x-u.x,H=L.y-u.y;Math.sqrt(V*V+H*H)>G&&A(N)}(o.x!==z.xSnapped||o.y!==z.ySnapped)&&s&&l&&(u=ye(N.sourceEvent,d),q(z))}}).on("end",N=>{if(!(!l||p)&&(c=!1,l=!1,cancelAnimationFrame(a),s.size>0)){const{nodeLookup:M,updateNodePositions:O,onNodeDragStop:k,onSelectionDragStop:$}=t();if(m&&(O(s,!1),m=!1),i||k||!x&&$){const[G,j]=vr({nodeId:x,dragItems:s,nodeLookup:M,dragging:!1});i?.(N.sourceEvent,s,G,j),k?.(N.sourceEvent,G,j),x||$?.(N.sourceEvent,j)}}}).filter(N=>{const M=N.target;return!N.button&&(!b||!Xu(M,`.${b}`,_))&&(!h||Xu(M,h,_))});f.call(C)}function y(){f?.on(".drag",null)}return{update:g,destroy:y}}function vb(e,t,r){const n=[],i={x:e.x-r,y:e.y-r,width:r*2,height:r*2};for(const o of t.values())mt(i,rt(o))>0&&n.push(o);return n}const mb=250;function yb(e,t,r,n){let i=[],o=1/0;const a=vb(e,r,t+mb);for(const s of a){const c=[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]];for(const u of c){if(n.nodeId===u.nodeId&&n.type===u.type&&n.id===u.id)continue;const{x:d,y:l}=Ve(s,u,u.position,!0),f=Math.sqrt(Math.pow(d-e.x,2)+Math.pow(l-e.y,2));f>t||(f<o?(i=[{...u,x:d,y:l}],o=f):f===o&&i.push({...u,x:d,y:l}))}}if(!i.length)return null;if(i.length>1){const s=n.type==="source"?"target":"source";return i.find(c=>c.type===s)??i[0]}return i[0]}function xg(e,t,r,n,i,o=!1){const a=n.get(e);if(!a)return null;const s=i==="strict"?a.internals.handleBounds?.[t]:[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]],c=(r?s?.find(u=>u.id===r):s?.[0])??null;return c&&o?{...c,...Ve(a,c,c.position,!0)}:c}function wg(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function bb(e,t){let r=null;return t?r=!0:e&&!t&&(r=!1),r}const Eg=()=>!0;function _b(e,{connectionMode:t,connectionRadius:r,handleId:n,nodeId:i,edgeUpdaterType:o,isTarget:a,domNode:s,nodeLookup:c,lib:u,autoPanOnConnect:d,flowId:l,panBy:f,cancelConnection:p,onConnectStart:m,onConnect:v,onConnectEnd:g,isValidConnection:y=Eg,onReconnectEnd:b,updateConnection:h,getTransform:_,getFromHandle:w,autoPanSpeed:x,dragThreshold:E=1,handleDomNode:q}){const S=cg(e.target);let A=0,C;const{x:N,y:M}=ye(e),O=wg(o,q),k=s?.getBoundingClientRect();let $=!1;if(!k||!O)return;const G=xg(i,O,n,c,t);if(!G)return;let j=ye(e,k),z=!1,L=null,V=!1,H=null;function W(){if(!d||!k)return;const[J,Q]=og(j,k,x);f({x:J,y:Q}),A=requestAnimationFrame(W)}const I={...G,nodeId:i,type:O,position:G.position},P=c.get(i);let F={inProgress:!0,isValid:null,from:Ve(P,I,K.Left,!0),fromHandle:I,fromPosition:I.position,fromNode:P,to:j,toHandle:null,toPosition:Bu[I.position],toNode:null,pointer:j};function B(){$=!0,h(F),m?.(e,{nodeId:i,handleId:n,handleType:O})}E===0&&B();function U(J){if(!$){const{x:ee,y:le}=ye(J),de=ee-N,Se=le-M;if(!(de*de+Se*Se>E*E))return;B()}if(!w()||!I){Z(J);return}const Q=_();j=ye(J,k),C=yb(Ct(j,Q,!1,[1,1]),r,c,I),z||(W(),z=!0);const Y=Cg(J,{handle:C,connectionMode:t,fromNodeId:i,fromHandleId:n,fromType:a?"target":"source",isValidConnection:y,doc:S,lib:u,flowId:l,nodeLookup:c});H=Y.handleDomNode,L=Y.connection,V=bb(!!C,Y.isValid);const te=c.get(i),X=te?Ve(te,I,K.Left,!0):F.from,ne={...F,from:X,isValid:V,to:Y.toHandle&&V?Bt({x:Y.toHandle.x,y:Y.toHandle.y},Q):j,toHandle:Y.toHandle,toPosition:V&&Y.toHandle?Y.toHandle.position:Bu[I.position],toNode:Y.toHandle?c.get(Y.toHandle.nodeId):null,pointer:j};h(ne),F=ne}function Z(J){if(!("touches"in J&&J.touches.length>0)){if($){(C||H)&&L&&V&&v?.(L);const{inProgress:Q,...Y}=F,te={...Y,toPosition:F.toHandle?F.toPosition:null};g?.(J,te),o&&b?.(J,te)}p(),cancelAnimationFrame(A),z=!1,V=!1,L=null,H=null,S.removeEventListener("mousemove",U),S.removeEventListener("mouseup",Z),S.removeEventListener("touchmove",U),S.removeEventListener("touchend",Z)}}S.addEventListener("mousemove",U),S.addEventListener("mouseup",Z),S.addEventListener("touchmove",U),S.addEventListener("touchend",Z)}function Cg(e,{handle:t,connectionMode:r,fromNodeId:n,fromHandleId:i,fromType:o,doc:a,lib:s,flowId:c,isValidConnection:u=Eg,nodeLookup:d}){const l=o==="target",f=t?a.querySelector(`.${s}-flow__handle[data-id="${c}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:p,y:m}=ye(e),v=a.elementFromPoint(p,m),g=v?.classList.contains(`${s}-flow__handle`)?v:f,y={handleDomNode:g,isValid:!1,connection:null,toHandle:null};if(g){const b=wg(void 0,g),h=g.getAttribute("data-nodeid"),_=g.getAttribute("data-handleid"),w=g.classList.contains("connectable"),x=g.classList.contains("connectableend");if(!h||!b)return y;const E={source:l?h:n,sourceHandle:l?_:i,target:l?n:h,targetHandle:l?i:_};y.connection=E;const S=w&&x&&(r===Je.Strict?l&&b==="source"||!l&&b==="target":h!==n||_!==i);y.isValid=S&&u(E),y.toHandle=xg(h,b,_,d,r,!0)}return y}const Ys={onPointerDown:_b,isValid:Cg};function xb({domNode:e,panZoom:t,getTransform:r,getViewScale:n}){const i=zt(e);function o({translateExtent:s,width:c,height:u,zoomStep:d=1,pannable:l=!0,zoomable:f=!0,inversePan:p=!1}){const m=h=>{if(h.sourceEvent.type!=="wheel"||!t)return;const _=r(),w=h.sourceEvent.ctrlKey&&yt()?10:1,x=-h.sourceEvent.deltaY*(h.sourceEvent.deltaMode===1?.05:h.sourceEvent.deltaMode?1:.002)*d,E=_[2]*Math.pow(2,x*w);t.scaleTo(E)};let v=[0,0];const g=h=>{(h.sourceEvent.type==="mousedown"||h.sourceEvent.type==="touchstart")&&(v=[h.sourceEvent.clientX??h.sourceEvent.touches[0].clientX,h.sourceEvent.clientY??h.sourceEvent.touches[0].clientY])},y=h=>{const _=r();if(h.sourceEvent.type!=="mousemove"&&h.sourceEvent.type!=="touchmove"||!t)return;const w=[h.sourceEvent.clientX??h.sourceEvent.touches[0].clientX,h.sourceEvent.clientY??h.sourceEvent.touches[0].clientY],x=[w[0]-v[0],w[1]-v[1]];v=w;const E=n()*Math.max(_[2],Math.log(_[2]))*(p?-1:1),q={x:_[0]-x[0]*E,y:_[1]-x[1]*E},S=[[0,0],[c,u]];t.setViewportConstrained({x:q.x,y:q.y,zoom:_[2]},S,s)},b=Zp().on("start",g).on("zoom",l?y:null).on("zoom.wheel",f?m:null);i.call(b,{})}function a(){i.on("zoom",null)}return{update:o,destroy:a,pointer:Kp}}const Gt=e=>({x:e.x,y:e.y,zoom:e.k}),mr=({x:e,y:t,zoom:r})=>fy.translate(e,t).scale(r),Xe=(e,t)=>e.target.closest(`.${t}`),Sg=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),wb=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,yr=(e,t=0,r=wb,n=()=>{})=>{const i=typeof t=="number"&&t>0;return i||n(),i?e.transition().duration(t).ease(r).on("end",n):e},qg=e=>{const t=e.ctrlKey&&yt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Eb({zoomPanValues:e,noWheelClassName:t,d3Selection:r,d3Zoom:n,panOnScrollMode:i,panOnScrollSpeed:o,zoomOnPinch:a,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:u}){return d=>{if(Xe(d,t))return d.ctrlKey&&d.preventDefault(),!1;d.preventDefault(),d.stopImmediatePropagation();const l=r.property("__zoom").k||1;if(d.ctrlKey&&a){const g=Kp(d),y=qg(d),b=l*Math.pow(2,y);n.scaleTo(r,b,g,d);return}const f=d.deltaMode===1?20:1;let p=i===ze.Vertical?0:d.deltaX*f,m=i===ze.Horizontal?0:d.deltaY*f;!yt()&&d.shiftKey&&i!==ze.Vertical&&(p=d.deltaY*f,m=0),n.translateBy(r,-(p/l)*o,-(m/l)*o,{internal:!0});const v=Gt(r.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(c?.(d,v),e.panScrollTimeout=setTimeout(()=>{u?.(d,v),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,s?.(d,v))}}function Cb({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:r}){return function(n,i){const o=n.type==="wheel",a=!t&&o&&!n.ctrlKey,s=Xe(n,e);if(n.ctrlKey&&o&&s&&n.preventDefault(),a||s)return null;n.preventDefault(),r.call(this,n,i)}}function Sb({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:r}){return n=>{if(n.sourceEvent?.internal)return;const i=Gt(n.transform);e.mouseButton=n.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=i,n.sourceEvent?.type==="mousedown"&&t(!0),r&&r?.(n.sourceEvent,i)}}function qb({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:r,onTransformChange:n,onPanZoom:i}){return o=>{e.usedRightMouseButton=!!(r&&Sg(t,e.mouseButton??0)),o.sourceEvent?.sync||n([o.transform.x,o.transform.y,o.transform.k]),i&&!o.sourceEvent?.internal&&i?.(o.sourceEvent,Gt(o.transform))}}function Rb({zoomPanValues:e,panOnDrag:t,panOnScroll:r,onDraggingChange:n,onPanZoomEnd:i,onPaneContextMenu:o}){return a=>{if(!a.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,o&&Sg(t,e.mouseButton??0)&&!e.usedRightMouseButton&&a.sourceEvent&&o(a.sourceEvent),e.usedRightMouseButton=!1,n(!1),i)){const s=Gt(a.transform);e.prevViewport=s,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{i?.(a.sourceEvent,s)},r?150:0)}}}function Nb({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:r,panOnDrag:n,panOnScroll:i,zoomOnDoubleClick:o,userSelectionActive:a,noWheelClassName:s,noPanClassName:c,lib:u,connectionInProgress:d}){return l=>{const f=e||t,p=r&&l.ctrlKey,m=l.type==="wheel";if(l.button===1&&l.type==="mousedown"&&(Xe(l,`${u}-flow__node`)||Xe(l,`${u}-flow__edge`)))return!0;if(!n&&!f&&!i&&!o&&!r||a||d&&!m||Xe(l,s)&&m||Xe(l,c)&&(!m||i&&m&&!e)||!r&&l.ctrlKey&&m)return!1;if(!r&&l.type==="touchstart"&&l.touches?.length>1)return l.preventDefault(),!1;if(!f&&!i&&!p&&m||!n&&(l.type==="mousedown"||l.type==="touchstart")||Array.isArray(n)&&!n.includes(l.button)&&l.type==="mousedown")return!1;const v=Array.isArray(n)&&n.includes(l.button)||!l.button||l.button<=1;return(!l.ctrlKey||m)&&v}}function Ib({domNode:e,minZoom:t,maxZoom:r,translateExtent:n,viewport:i,onPanZoom:o,onPanZoomStart:a,onPanZoomEnd:s,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),l=Zp().scaleExtent([t,r]).translateExtent(n),f=zt(e).call(l);b({x:i.x,y:i.y,zoom:tt(i.zoom,t,r)},[[0,0],[d.width,d.height]],n);const p=f.on("wheel.zoom"),m=f.on("dblclick.zoom");l.wheelDelta(qg);function v(C,N){return f?new Promise(M=>{l?.interpolate(N?.interpolate==="linear"?ht:gr).transform(yr(f,N?.duration,N?.ease,()=>M(!0)),C)}):Promise.resolve(!1)}function g({noWheelClassName:C,noPanClassName:N,onPaneContextMenu:M,userSelectionActive:O,panOnScroll:k,panOnDrag:$,panOnScrollMode:G,panOnScrollSpeed:j,preventScrolling:z,zoomOnPinch:L,zoomOnScroll:V,zoomOnDoubleClick:H,zoomActivationKeyPressed:W,lib:I,onTransformChange:P,connectionInProgress:D,paneClickDistance:F,selectionOnDrag:B}){O&&!u.isZoomingOrPanning&&y();const U=k&&!W&&!O;l.clickDistance(B?1/0:!me(F)||F<0?0:F);const Z=U?Eb({zoomPanValues:u,noWheelClassName:C,d3Selection:f,d3Zoom:l,panOnScrollMode:G,panOnScrollSpeed:j,zoomOnPinch:L,onPanZoomStart:a,onPanZoom:o,onPanZoomEnd:s}):Cb({noWheelClassName:C,preventScrolling:z,d3ZoomHandler:p});if(f.on("wheel.zoom",Z,{passive:!1}),!O){const Q=Sb({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:a});l.on("start",Q);const Y=qb({zoomPanValues:u,panOnDrag:$,onPaneContextMenu:!!M,onPanZoom:o,onTransformChange:P});l.on("zoom",Y);const te=Rb({zoomPanValues:u,panOnDrag:$,panOnScroll:k,onPaneContextMenu:M,onPanZoomEnd:s,onDraggingChange:c});l.on("end",te)}const J=Nb({zoomActivationKeyPressed:W,panOnDrag:$,zoomOnScroll:V,panOnScroll:k,zoomOnDoubleClick:H,zoomOnPinch:L,userSelectionActive:O,noPanClassName:N,noWheelClassName:C,lib:I,connectionInProgress:D});l.filter(J),H?f.on("dblclick.zoom",m):f.on("dblclick.zoom",null)}function y(){l.on("zoom",null)}async function b(C,N,M){const O=mr(C),k=l?.constrain()(O,N,M);return k&&await v(k),new Promise($=>$(k))}async function h(C,N){const M=mr(C);return await v(M,N),new Promise(O=>O(M))}function _(C){if(f){const N=mr(C),M=f.property("__zoom");(M.k!==C.zoom||M.x!==C.x||M.y!==C.y)&&l?.transform(f,N,null,{sync:!0})}}function w(){const C=f?hy(f.node()):{x:0,y:0,k:1};return{x:C.x,y:C.y,zoom:C.k}}function x(C,N){return f?new Promise(M=>{l?.interpolate(N?.interpolate==="linear"?ht:gr).scaleTo(yr(f,N?.duration,N?.ease,()=>M(!0)),C)}):Promise.resolve(!1)}function E(C,N){return f?new Promise(M=>{l?.interpolate(N?.interpolate==="linear"?ht:gr).scaleBy(yr(f,N?.duration,N?.ease,()=>M(!0)),C)}):Promise.resolve(!1)}function q(C){l?.scaleExtent(C)}function S(C){l?.translateExtent(C)}function A(C){const N=!me(C)||C<0?0:C;l?.clickDistance(N)}return{update:g,destroy:y,setViewport:h,setViewportConstrained:b,getViewport:w,scaleTo:x,scaleBy:E,setScaleExtent:q,setTranslateExtent:S,syncViewport:_,setClickDistance:A}}var it;(function(e){e.Line="line",e.Handle="handle"})(it||(it={}));function Ab({width:e,prevWidth:t,height:r,prevHeight:n,affectsX:i,affectsY:o}){const a=e-t,s=r-n,c=[a>0?1:a<0?-1:0,s>0?1:s<0?-1:0];return a&&i&&(c[0]=c[0]*-1),s&&o&&(c[1]=c[1]*-1),c}function Qu(e){const t=e.includes("right")||e.includes("left"),r=e.includes("bottom")||e.includes("top"),n=e.includes("left"),i=e.includes("top");return{isHorizontal:t,isVertical:r,affectsX:n,affectsY:i}}function Oe(e,t){return Math.max(0,t-e)}function De(e,t){return Math.max(0,e-t)}function kt(e,t,r){return Math.max(0,t-e,e-r)}function Ju(e,t){return e?!t:t}function Mb(e,t,r,n,i,o,a,s){let{affectsX:c,affectsY:u}=t;const{isHorizontal:d,isVertical:l}=t,f=d&&l,{xSnapped:p,ySnapped:m}=r,{minWidth:v,maxWidth:g,minHeight:y,maxHeight:b}=n,{x:h,y:_,width:w,height:x,aspectRatio:E}=e;let q=Math.floor(d?p-e.pointerX:0),S=Math.floor(l?m-e.pointerY:0);const A=w+(c?-q:q),C=x+(u?-S:S),N=-o[0]*w,M=-o[1]*x;let O=kt(A,v,g),k=kt(C,y,b);if(a){let j=0,z=0;c&&q<0?j=Oe(h+q+N,a[0][0]):!c&&q>0&&(j=De(h+A+N,a[1][0])),u&&S<0?z=Oe(_+S+M,a[0][1]):!u&&S>0&&(z=De(_+C+M,a[1][1])),O=Math.max(O,j),k=Math.max(k,z)}if(s){let j=0,z=0;c&&q>0?j=De(h+q,s[0][0]):!c&&q<0&&(j=Oe(h+A,s[1][0])),u&&S>0?z=De(_+S,s[0][1]):!u&&S<0&&(z=Oe(_+C,s[1][1])),O=Math.max(O,j),k=Math.max(k,z)}if(i){if(d){const j=kt(A/E,y,b)*E;if(O=Math.max(O,j),a){let z=0;!c&&!u||c&&!u&&f?z=De(_+M+A/E,a[1][1])*E:z=Oe(_+M+(c?q:-q)/E,a[0][1])*E,O=Math.max(O,z)}if(s){let z=0;!c&&!u||c&&!u&&f?z=Oe(_+A/E,s[1][1])*E:z=De(_+(c?q:-q)/E,s[0][1])*E,O=Math.max(O,z)}}if(l){const j=kt(C*E,v,g)/E;if(k=Math.max(k,j),a){let z=0;!c&&!u||u&&!c&&f?z=De(h+C*E+N,a[1][0])/E:z=Oe(h+(u?S:-S)*E+N,a[0][0])/E,k=Math.max(k,z)}if(s){let z=0;!c&&!u||u&&!c&&f?z=Oe(h+C*E,s[1][0])/E:z=De(h+(u?S:-S)*E,s[0][0])/E,k=Math.max(k,z)}}}S=S+(S<0?k:-k),q=q+(q<0?O:-O),i&&(f?A>C*E?S=(Ju(c,u)?-q:q)/E:q=(Ju(c,u)?-S:S)*E:d?(S=q/E,u=c):(q=S*E,c=u));const $=c?h+q:h,G=u?_+S:_;return{width:w+(c?-q:q),height:x+(u?-S:S),x:o[0]*q*(c?-1:1)+$,y:o[1]*S*(u?-1:1)+G}}const Rg={width:0,height:0,x:0,y:0},Tb={...Rg,pointerX:0,pointerY:0,aspectRatio:1};function Pb(e){return[[0,0],[e.measured.width,e.measured.height]]}function kb(e,t,r){const n=t.position.x+e.position.x,i=t.position.y+e.position.y,o=e.measured.width??0,a=e.measured.height??0,s=r[0]*o,c=r[1]*a;return[[n-s,i-c],[n+o-s,i+a-c]]}function Ob({domNode:e,nodeId:t,getStoreItems:r,onChange:n,onEnd:i}){const o=zt(e);let a={controlDirection:Qu("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function s({controlPosition:u,boundaries:d,keepAspectRatio:l,resizeDirection:f,onResizeStart:p,onResize:m,onResizeEnd:v,shouldResize:g}){let y={...Rg},b={...Tb};a={boundaries:d,resizeDirection:f,keepAspectRatio:l,controlDirection:Qu(u)};let h,_=null,w=[],x,E,q,S=!1;const A=Xp().on("start",C=>{const{nodeLookup:N,transform:M,snapGrid:O,snapToGrid:k,nodeOrigin:$,paneDomNode:G}=r();if(h=N.get(t),!h)return;_=G?.getBoundingClientRect()??null;const{xSnapped:j,ySnapped:z}=pt(C.sourceEvent,{transform:M,snapGrid:O,snapToGrid:k,containerBounds:_});y={width:h.measured.width??0,height:h.measured.height??0,x:h.position.x??0,y:h.position.y??0},b={...y,pointerX:j,pointerY:z,aspectRatio:y.width/y.height},x=void 0,h.parentId&&(h.extent==="parent"||h.expandParent)&&(x=N.get(h.parentId),E=x&&h.extent==="parent"?Pb(x):void 0),w=[],q=void 0;for(const[L,V]of N)if(V.parentId===t&&(w.push({id:L,position:{...V.position},extent:V.extent}),V.extent==="parent"||V.expandParent)){const H=kb(V,h,V.origin??$);q?q=[[Math.min(H[0][0],q[0][0]),Math.min(H[0][1],q[0][1])],[Math.max(H[1][0],q[1][0]),Math.max(H[1][1],q[1][1])]]:q=H}p?.(C,{...y})}).on("drag",C=>{const{transform:N,snapGrid:M,snapToGrid:O,nodeOrigin:k}=r(),$=pt(C.sourceEvent,{transform:N,snapGrid:M,snapToGrid:O,containerBounds:_}),G=[];if(!h)return;const{x:j,y:z,width:L,height:V}=y,H={},W=h.origin??k,{width:I,height:P,x:D,y:F}=Mb(b,a.controlDirection,$,a.boundaries,a.keepAspectRatio,W,E,q),B=I!==L,U=P!==V,Z=D!==j&&B,J=F!==z&&U;if(!Z&&!J&&!B&&!U)return;if((Z||J||W[0]===1||W[1]===1)&&(H.x=Z?D:y.x,H.y=J?F:y.y,y.x=H.x,y.y=H.y,w.length>0)){const X=D-j,ne=F-z;for(const ee of w)ee.position={x:ee.position.x-X+W[0]*(I-L),y:ee.position.y-ne+W[1]*(P-V)},G.push(ee)}if((B||U)&&(H.width=B&&(!a.resizeDirection||a.resizeDirection==="horizontal")?I:y.width,H.height=U&&(!a.resizeDirection||a.resizeDirection==="vertical")?P:y.height,y.width=H.width,y.height=H.height),x&&h.expandParent){const X=W[0]*(H.width??0);H.x&&H.x<X&&(y.x=X,b.x=b.x-(H.x-X));const ne=W[1]*(H.height??0);H.y&&H.y<ne&&(y.y=ne,b.y=b.y-(H.y-ne))}const Q=Ab({width:y.width,prevWidth:L,height:y.height,prevHeight:V,affectsX:a.controlDirection.affectsX,affectsY:a.controlDirection.affectsY}),Y={...y,direction:Q};g?.(C,Y)!==!1&&(S=!0,m?.(C,Y),n(H,G))}).on("end",C=>{S&&(v?.(C,{...y}),i?.({...y}),S=!1)});o.call(A)}function c(){o.on(".drag",null)}return{update:s,destroy:c}}var br={exports:{}},_r={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ec;function Db(){if(ec)return _r;ec=1;var e=ay(),t=sy();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:r,i=t.useSyncExternalStore,o=e.useRef,a=e.useEffect,s=e.useMemo,c=e.useDebugValue;return _r.useSyncExternalStoreWithSelector=function(u,d,l,f,p){var m=o(null);if(m.current===null){var v={hasValue:!1,value:null};m.current=v}else v=m.current;m=s(function(){function y(x){if(!b){if(b=!0,h=x,x=f(x),p!==void 0&&v.hasValue){var E=v.value;if(p(E,x))return _=E}return _=x}if(E=_,n(h,x))return E;var q=f(x);return p!==void 0&&p(E,q)?(h=x,E):(h=x,_=q)}var b=!1,h,_,w=l===void 0?null:l;return[function(){return y(d())},w===null?void 0:function(){return y(w())}]},[d,l,f,p]);var g=i(u,m[0],m[1]);return a(function(){v.hasValue=!0,v.value=g},[g]),c(g),g},_r}var tc;function Lb(){return tc||(tc=1,br.exports=Db()),br.exports}var jb=Lb();const Bb=Yp(jb),Fb={},rc=e=>{let t;const r=new Set,n=(d,l)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const p=t;t=l??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(m=>m(t,p))}},i=()=>t,c={setState:n,getState:i,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(Fb?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,i,c);return c},Hb=e=>e?rc(e):rc,{useDebugValue:zb}=uy,{useSyncExternalStoreWithSelector:$b}=Bb,Vb=e=>e;function Ng(e,t=Vb,r){const n=$b(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return zb(n),n}const nc=(e,t)=>{const r=Hb(e),n=(i,o=t)=>Ng(r,i,o);return Object.assign(n,r),n},Gb=(e,t)=>e?nc(e,t):nc;function ie(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,i]of e)if(!Object.is(i,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}const Ut=T.createContext(null),Ub=Ut.Provider,Ig=Ee.error001();function re(e,t){const r=T.useContext(Ut);if(r===null)throw new Error(Ig);return Ng(r,e,t)}function oe(){const e=T.useContext(Ut);if(e===null)throw new Error(Ig);return T.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const ic={display:"none"},Wb={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ag="react-flow__node-desc",Mg="react-flow__edge-desc",Yb="react-flow__aria-live",Kb=e=>e.ariaLiveMessage,Zb=e=>e.ariaLabelConfig;function Xb({rfId:e}){const t=re(Kb);return R.jsx("div",{id:`${Yb}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Wb,children:t})}function Qb({rfId:e,disableKeyboardA11y:t}){const r=re(Zb);return R.jsxs(R.Fragment,{children:[R.jsx("div",{id:`${Ag}-${e}`,style:ic,children:t?r["node.a11yDescription.default"]:r["node.a11yDescription.keyboardDisabled"]}),R.jsx("div",{id:`${Mg}-${e}`,style:ic,children:r["edge.a11yDescription.default"]}),!t&&R.jsx(Xb,{rfId:e})]})}const Wt=T.forwardRef(({position:e="top-left",children:t,className:r,style:n,...i},o)=>{const a=`${e}`.split("-");return R.jsx("div",{className:ue(["react-flow__panel",r,...a]),style:n,ref:o,...i,children:t})});Wt.displayName="Panel";function Jb({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:R.jsx(Wt,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:R.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const e_=e=>{const t=[],r=[];for(const[,n]of e.nodeLookup)n.selected&&t.push(n.internals.userNode);for(const[,n]of e.edgeLookup)n.selected&&r.push(n);return{selectedNodes:t,selectedEdges:r}},Ot=e=>e.id;function t_(e,t){return ie(e.selectedNodes.map(Ot),t.selectedNodes.map(Ot))&&ie(e.selectedEdges.map(Ot),t.selectedEdges.map(Ot))}function r_({onSelectionChange:e}){const t=oe(),{selectedNodes:r,selectedEdges:n}=re(e_,t_);return T.useEffect(()=>{const i={nodes:r,edges:n};e?.(i),t.getState().onSelectionChangeHandlers.forEach(o=>o(i))},[r,n,e]),null}const n_=e=>!!e.onSelectionChangeHandlers;function i_({onSelectionChange:e}){const t=re(n_);return e||t?R.jsx(r_,{onSelectionChange:e}):null}const Tg=[0,0],o_={x:0,y:0,zoom:1},a_=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],oc=[...a_,"rfId"],s_=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),ac={translateExtent:gt,nodeOrigin:Tg,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function u_(e){const{setNodes:t,setEdges:r,setMinZoom:n,setMaxZoom:i,setTranslateExtent:o,setNodeExtent:a,reset:s,setDefaultNodesAndEdges:c}=re(s_,ie),u=oe();T.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=ac,s()}),[]);const d=T.useRef(ac);return T.useEffect(()=>{for(const l of oc){const f=e[l],p=d.current[l];f!==p&&(typeof e[l]>"u"||(l==="nodes"?t(f):l==="edges"?r(f):l==="minZoom"?n(f):l==="maxZoom"?i(f):l==="translateExtent"?o(f):l==="nodeExtent"?a(f):l==="ariaLabelConfig"?u.setState({ariaLabelConfig:Yy(f)}):l==="fitView"?u.setState({fitViewQueued:f}):l==="fitViewOptions"?u.setState({fitViewOptions:f}):u.setState({[l]:f})))}d.current=e},oc.map(l=>e[l])),null}function sc(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function c_(e){const[t,r]=T.useState(e==="system"?null:e);return T.useEffect(()=>{if(e!=="system"){r(e);return}const n=sc(),i=()=>r(n?.matches?"dark":"light");return i(),n?.addEventListener("change",i),()=>{n?.removeEventListener("change",i)}},[e]),t!==null?t:sc()?.matches?"dark":"light"}const uc=typeof document<"u"?document:null;function bt(e=null,t={target:uc,actInsideInputWithModifier:!0}){const[r,n]=T.useState(!1),i=T.useRef(!1),o=T.useRef(new Set([])),[a,s]=T.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(l=>typeof l=="string").map(l=>l.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=u.reduce((l,f)=>l.concat(...f),[]);return[u,d]}return[[],[]]},[e]);return T.useEffect(()=>{const c=t?.target??uc,u=t?.actInsideInputWithModifier??!0;if(e!==null){const d=p=>{if(i.current=p.ctrlKey||p.metaKey||p.shiftKey||p.altKey,(!i.current||i.current&&!u)&&dg(p))return!1;const v=dc(p.code,s);if(o.current.add(p[v]),cc(a,o.current,!1)){const g=p.composedPath?.()?.[0]||p.target,y=g?.nodeName==="BUTTON"||g?.nodeName==="A";t.preventDefault!==!1&&(i.current||!y)&&p.preventDefault(),n(!0)}},l=p=>{const m=dc(p.code,s);cc(a,o.current,!0)?(n(!1),o.current.clear()):o.current.delete(p[m]),p.key==="Meta"&&o.current.clear(),i.current=!1},f=()=>{o.current.clear(),n(!1)};return c?.addEventListener("keydown",d),c?.addEventListener("keyup",l),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{c?.removeEventListener("keydown",d),c?.removeEventListener("keyup",l),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,n]),r}function cc(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(i=>t.has(i)))}function dc(e,t){return t.includes(e)?"code":"key"}const d_=()=>{const e=oe();return T.useMemo(()=>({zoomIn:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,r)=>{const{panZoom:n}=e.getState();return n?n.scaleTo(t,{duration:r?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,r)=>{const{transform:[n,i,o],panZoom:a}=e.getState();return a?(await a.setViewport({x:t.x??n,y:t.y??i,zoom:t.zoom??o},r),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,r,n]=e.getState().transform;return{x:t,y:r,zoom:n}},setCenter:async(t,r,n)=>e.getState().setCenter(t,r,n),fitBounds:async(t,r)=>{const{width:n,height:i,minZoom:o,maxZoom:a,panZoom:s}=e.getState(),c=Js(t,n,i,o,a,r?.padding??.1);return s?(await s.setViewport(c,{duration:r?.duration,ease:r?.ease,interpolate:r?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,r={})=>{const{transform:n,snapGrid:i,snapToGrid:o,domNode:a}=e.getState();if(!a)return t;const{x:s,y:c}=a.getBoundingClientRect(),u={x:t.x-s,y:t.y-c},d=r.snapGrid??i,l=r.snapToGrid??o;return Ct(u,n,l,d)},flowToScreenPosition:t=>{const{transform:r,domNode:n}=e.getState();if(!n)return t;const{x:i,y:o}=n.getBoundingClientRect(),a=Bt(t,r);return{x:a.x+i,y:a.y+o}}}),[])};function Pg(e,t){const r=[],n=new Map,i=[];for(const o of e)if(o.type==="add"){i.push(o);continue}else if(o.type==="remove"||o.type==="replace")n.set(o.id,[o]);else{const a=n.get(o.id);a?a.push(o):n.set(o.id,[o])}for(const o of t){const a=n.get(o.id);if(!a){r.push(o);continue}if(a[0].type==="remove")continue;if(a[0].type==="replace"){r.push({...a[0].item});continue}const s={...o};for(const c of a)l_(c,s);r.push(s)}return i.length&&i.forEach(o=>{o.index!==void 0?r.splice(o.index,0,{...o.item}):r.push({...o.item})}),r}function l_(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function kg(e,t){return Pg(e,t)}function Og(e,t){return Pg(e,t)}function He(e,t){return{id:e,type:"select",selected:t}}function Qe(e,t=new Set,r=!1){const n=[];for(const[i,o]of e){const a=t.has(i);!(o.selected===void 0&&!a)&&o.selected!==a&&(r&&(o.selected=a),n.push(He(o.id,a)))}return n}function lc({items:e=[],lookup:t}){const r=[],n=new Map(e.map(i=>[i.id,i]));for(const[i,o]of e.entries()){const a=t.get(o.id),s=a?.internals?.userNode??a;s!==void 0&&s!==o&&r.push({id:o.id,item:o,type:"replace"}),s===void 0&&r.push({item:o,type:"add",index:i})}for(const[i]of t)n.get(i)===void 0&&r.push({id:i,type:"remove"});return r}function fc(e){return{id:e.id,type:"remove"}}const hc=e=>jy(e),f_=e=>rg(e);function Dg(e){return T.forwardRef(e)}const h_=typeof window<"u"?T.useLayoutEffect:T.useEffect;function pc(e){const[t,r]=T.useState(BigInt(0)),[n]=T.useState(()=>p_(()=>r(i=>i+BigInt(1))));return h_(()=>{const i=n.get();i.length&&(e(i),n.reset())},[t]),n}function p_(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:r=>{t.push(r),e()}}}const Lg=T.createContext(null);function g_({children:e}){const t=oe(),r=T.useCallback(s=>{const{nodes:c=[],setNodes:u,hasDefaultNodes:d,onNodesChange:l,nodeLookup:f,fitViewQueued:p,onNodesChangeMiddlewareMap:m}=t.getState();let v=c;for(const y of s)v=typeof y=="function"?y(v):y;let g=lc({items:v,lookup:f});for(const y of m.values())g=y(g);d&&u(v),g.length>0?l?.(g):p&&window.requestAnimationFrame(()=>{const{fitViewQueued:y,nodes:b,setNodes:h}=t.getState();y&&h(b)})},[]),n=pc(r),i=T.useCallback(s=>{const{edges:c=[],setEdges:u,hasDefaultEdges:d,onEdgesChange:l,edgeLookup:f}=t.getState();let p=c;for(const m of s)p=typeof m=="function"?m(p):m;d?u(p):l&&l(lc({items:p,lookup:f}))},[]),o=pc(i),a=T.useMemo(()=>({nodeQueue:n,edgeQueue:o}),[]);return R.jsx(Lg.Provider,{value:a,children:e})}function v_(){const e=T.useContext(Lg);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const m_=e=>!!e.panZoom;function au(){const e=d_(),t=oe(),r=v_(),n=re(m_),i=T.useMemo(()=>{const o=l=>t.getState().nodeLookup.get(l),a=l=>{r.nodeQueue.push(l)},s=l=>{r.edgeQueue.push(l)},c=l=>{const{nodeLookup:f,nodeOrigin:p}=t.getState(),m=hc(l)?l:f.get(l.id),v=m.parentId?ug(m.position,m.measured,m.parentId,f,p):m.position,g={...m,position:v,width:m.measured?.width??m.width,height:m.measured?.height??m.height};return rt(g)},u=(l,f,p={replace:!1})=>{a(m=>m.map(v=>{if(v.id===l){const g=typeof f=="function"?f(v):f;return p.replace&&hc(g)?g:{...v,...g}}return v}))},d=(l,f,p={replace:!1})=>{s(m=>m.map(v=>{if(v.id===l){const g=typeof f=="function"?f(v):f;return p.replace&&f_(g)?g:{...v,...g}}return v}))};return{getNodes:()=>t.getState().nodes.map(l=>({...l})),getNode:l=>o(l)?.internals.userNode,getInternalNode:o,getEdges:()=>{const{edges:l=[]}=t.getState();return l.map(f=>({...f}))},getEdge:l=>t.getState().edgeLookup.get(l),setNodes:a,setEdges:s,addNodes:l=>{const f=Array.isArray(l)?l:[l];r.nodeQueue.push(p=>[...p,...f])},addEdges:l=>{const f=Array.isArray(l)?l:[l];r.edgeQueue.push(p=>[...p,...f])},toObject:()=>{const{nodes:l=[],edges:f=[],transform:p}=t.getState(),[m,v,g]=p;return{nodes:l.map(y=>({...y})),edges:f.map(y=>({...y})),viewport:{x:m,y:v,zoom:g}}},deleteElements:async({nodes:l=[],edges:f=[]})=>{const{nodes:p,edges:m,onNodesDelete:v,onEdgesDelete:g,triggerNodeChanges:y,triggerEdgeChanges:b,onDelete:h,onBeforeDelete:_}=t.getState(),{nodes:w,edges:x}=await $y({nodesToRemove:l,edgesToRemove:f,nodes:p,edges:m,onBeforeDelete:_}),E=x.length>0,q=w.length>0;if(E){const S=x.map(fc);g?.(x),b(S)}if(q){const S=w.map(fc);v?.(w),y(S)}return(q||E)&&h?.({nodes:w,edges:x}),{deletedNodes:w,deletedEdges:x}},getIntersectingNodes:(l,f=!0,p)=>{const m=Hu(l),v=m?l:c(l),g=p!==void 0;return v?(p||t.getState().nodes).filter(y=>{const b=t.getState().nodeLookup.get(y.id);if(b&&!m&&(y.id===l.id||!b.internals.positionAbsolute))return!1;const h=rt(g?y:b),_=mt(h,v);return f&&_>0||_>=h.width*h.height||_>=v.width*v.height}):[]},isNodeIntersecting:(l,f,p=!0)=>{const v=Hu(l)?l:c(l);if(!v)return!1;const g=mt(v,f);return p&&g>0||g>=f.width*f.height||g>=v.width*v.height},updateNode:u,updateNodeData:(l,f,p={replace:!1})=>{u(l,m=>{const v=typeof f=="function"?f(m):f;return p.replace?{...m,data:v}:{...m,data:{...m.data,...v}}},p)},updateEdge:d,updateEdgeData:(l,f,p={replace:!1})=>{d(l,m=>{const v=typeof f=="function"?f(m):f;return p.replace?{...m,data:v}:{...m,data:{...m.data,...v}}},p)},getNodesBounds:l=>{const{nodeLookup:f,nodeOrigin:p}=t.getState();return By(l,{nodeLookup:f,nodeOrigin:p})},getHandleConnections:({type:l,id:f,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}-${l}${f?`-${f}`:""}`)?.values()??[]),getNodeConnections:({type:l,handleId:f,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}${l?f?`-${l}-${f}`:`-${l}`:""}`)?.values()??[]),fitView:async l=>{const f=t.getState().fitViewResolver??Wy();return t.setState({fitViewQueued:!0,fitViewOptions:l,fitViewResolver:f}),r.nodeQueue.push(p=>[...p]),f.promise}}},[]);return T.useMemo(()=>({...i,...e,viewportInitialized:n}),[n])}const gc=e=>e.selected,y_=typeof window<"u"?window:void 0;function b_({deleteKeyCode:e,multiSelectionKeyCode:t}){const r=oe(),{deleteElements:n}=au(),i=bt(e,{actInsideInputWithModifier:!1}),o=bt(t,{target:y_});T.useEffect(()=>{if(i){const{edges:a,nodes:s}=r.getState();n({nodes:s.filter(gc),edges:a.filter(gc)}),r.setState({nodesSelectionActive:!1})}},[i]),T.useEffect(()=>{r.setState({multiSelectionActive:o})},[o])}function __(e){const t=oe();T.useEffect(()=>{const r=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const n=eu(e.current);(n.height===0||n.width===0)&&t.getState().onError?.("004",Ee.error004()),t.setState({width:n.width||500,height:n.height||500})};if(e.current){r(),window.addEventListener("resize",r);const n=new ResizeObserver(()=>r());return n.observe(e.current),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}}},[])}const Yt={position:"absolute",width:"100%",height:"100%",top:0,left:0},x_=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function w_({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:r=!0,panOnScroll:n=!1,panOnScrollSpeed:i=.5,panOnScrollMode:o=ze.Free,zoomOnDoubleClick:a=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:u,minZoom:d,maxZoom:l,zoomActivationKeyCode:f,preventScrolling:p=!0,children:m,noWheelClassName:v,noPanClassName:g,onViewportChange:y,isControlledViewport:b,paneClickDistance:h,selectionOnDrag:_}){const w=oe(),x=T.useRef(null),{userSelectionActive:E,lib:q,connectionInProgress:S}=re(x_,ie),A=bt(f),C=T.useRef();__(x);const N=T.useCallback(M=>{y?.({x:M[0],y:M[1],zoom:M[2]}),b||w.setState({transform:M})},[y,b]);return T.useEffect(()=>{if(x.current){C.current=Ib({domNode:x.current,minZoom:d,maxZoom:l,translateExtent:u,viewport:c,onDraggingChange:$=>w.setState({paneDragging:$}),onPanZoomStart:($,G)=>{const{onViewportChangeStart:j,onMoveStart:z}=w.getState();z?.($,G),j?.(G)},onPanZoom:($,G)=>{const{onViewportChange:j,onMove:z}=w.getState();z?.($,G),j?.(G)},onPanZoomEnd:($,G)=>{const{onViewportChangeEnd:j,onMoveEnd:z}=w.getState();z?.($,G),j?.(G)}});const{x:M,y:O,zoom:k}=C.current.getViewport();return w.setState({panZoom:C.current,transform:[M,O,k],domNode:x.current.closest(".react-flow")}),()=>{C.current?.destroy()}}},[]),T.useEffect(()=>{C.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:r,panOnScroll:n,panOnScrollSpeed:i,panOnScrollMode:o,zoomOnDoubleClick:a,panOnDrag:s,zoomActivationKeyPressed:A,preventScrolling:p,noPanClassName:g,userSelectionActive:E,noWheelClassName:v,lib:q,onTransformChange:N,connectionInProgress:S,selectionOnDrag:_,paneClickDistance:h})},[e,t,r,n,i,o,a,s,A,p,g,E,v,q,N,S,_,h]),R.jsx("div",{className:"react-flow__renderer",ref:x,style:Yt,children:m})}const E_=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function C_(){const{userSelectionActive:e,userSelectionRect:t}=re(E_,ie);return e&&t?R.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const xr=(e,t)=>r=>{r.target===t.current&&e?.(r)},S_=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function q_({isSelecting:e,selectionKeyPressed:t,selectionMode:r=vt.Full,panOnDrag:n,paneClickDistance:i,selectionOnDrag:o,onSelectionStart:a,onSelectionEnd:s,onPaneClick:c,onPaneContextMenu:u,onPaneScroll:d,onPaneMouseEnter:l,onPaneMouseMove:f,onPaneMouseLeave:p,children:m}){const v=oe(),{userSelectionActive:g,elementsSelectable:y,dragging:b,connectionInProgress:h}=re(S_,ie),_=y&&(e||g),w=T.useRef(null),x=T.useRef(),E=T.useRef(new Set),q=T.useRef(new Set),S=T.useRef(!1),A=j=>{if(S.current||h){S.current=!1;return}c?.(j),v.getState().resetSelectedElements(),v.setState({nodesSelectionActive:!1})},C=j=>{if(Array.isArray(n)&&n?.includes(2)){j.preventDefault();return}u?.(j)},N=d?j=>d(j):void 0,M=j=>{S.current&&(j.stopPropagation(),S.current=!1)},O=j=>{const{domNode:z}=v.getState();if(x.current=z?.getBoundingClientRect(),!x.current)return;const L=j.target===w.current;if(!L&&!!j.target.closest(".nokey")||!e||!(o&&L||t)||j.button!==0||!j.isPrimary)return;j.target?.setPointerCapture?.(j.pointerId),S.current=!1;const{x:W,y:I}=ye(j.nativeEvent,x.current);v.setState({userSelectionRect:{width:0,height:0,startX:W,startY:I,x:W,y:I}}),L||(j.stopPropagation(),j.preventDefault())},k=j=>{const{userSelectionRect:z,transform:L,nodeLookup:V,edgeLookup:H,connectionLookup:W,triggerNodeChanges:I,triggerEdgeChanges:P,defaultEdgeOptions:D,resetSelectedElements:F}=v.getState();if(!x.current||!z)return;const{x:B,y:U}=ye(j.nativeEvent,x.current),{startX:Z,startY:J}=z;if(!S.current){const ne=t?0:i;if(Math.hypot(B-Z,U-J)<=ne)return;F(),a?.(j)}S.current=!0;const Q={startX:Z,startY:J,x:B<Z?B:Z,y:U<J?U:J,width:Math.abs(B-Z),height:Math.abs(U-J)},Y=E.current,te=q.current;E.current=new Set(Qs(V,Q,L,r===vt.Partial,!0).map(ne=>ne.id)),q.current=new Set;const X=D?.selectable??!0;for(const ne of E.current){const ee=W.get(ne);if(ee)for(const{edgeId:le}of ee.values()){const de=H.get(le);de&&(de.selectable??X)&&q.current.add(le)}}if(!zu(Y,E.current)){const ne=Qe(V,E.current,!0);I(ne)}if(!zu(te,q.current)){const ne=Qe(H,q.current);P(ne)}v.setState({userSelectionRect:Q,userSelectionActive:!0,nodesSelectionActive:!1})},$=j=>{j.button===0&&(j.target?.releasePointerCapture?.(j.pointerId),!g&&j.target===w.current&&v.getState().userSelectionRect&&A?.(j),v.setState({userSelectionActive:!1,userSelectionRect:null}),S.current&&(s?.(j),v.setState({nodesSelectionActive:E.current.size>0})))},G=n===!0||Array.isArray(n)&&n.includes(0);return R.jsxs("div",{className:ue(["react-flow__pane",{draggable:G,dragging:b,selection:e}]),onClick:_?void 0:xr(A,w),onContextMenu:xr(C,w),onWheel:xr(N,w),onPointerEnter:_?void 0:l,onPointerMove:_?k:f,onPointerUp:_?$:void 0,onPointerDownCapture:_?O:void 0,onClickCapture:_?M:void 0,onPointerLeave:p,ref:w,style:Yt,children:[m,R.jsx(C_,{})]})}function Ks({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:i,unselectNodesAndEdges:o,multiSelectionActive:a,nodeLookup:s,onError:c}=t.getState(),u=s.get(e);if(!u){c?.("012",Ee.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&a)&&(o({nodes:[u],edges:[]}),requestAnimationFrame(()=>n?.current?.blur())):i([e])}function jg({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:i,isSelectable:o,nodeClickDistance:a}){const s=oe(),[c,u]=T.useState(!1),d=T.useRef();return T.useEffect(()=>{d.current=gb({getStoreItems:()=>s.getState(),onNodeMouseDown:l=>{Ks({id:l,store:s,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),T.useEffect(()=>{if(t)d.current?.destroy();else if(e.current)return d.current?.update({noDragClassName:r,handleSelector:n,domNode:e.current,isSelectable:o,nodeId:i,nodeClickDistance:a}),()=>{d.current?.destroy()}},[r,n,t,o,e,i]),c}const R_=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Bg(){const e=oe();return T.useCallback(r=>{const{nodeExtent:n,snapToGrid:i,snapGrid:o,nodesDraggable:a,onError:s,updateNodePositions:c,nodeLookup:u,nodeOrigin:d}=e.getState(),l=new Map,f=R_(a),p=i?o[0]:5,m=i?o[1]:5,v=r.direction.x*p*r.factor,g=r.direction.y*m*r.factor;for(const[,y]of u){if(!f(y))continue;let b={x:y.internals.positionAbsolute.x+v,y:y.internals.positionAbsolute.y+g};i&&(b=Et(b,o));const{position:h,positionAbsolute:_}=ng({nodeId:y.id,nextPosition:b,nodeLookup:u,nodeExtent:n,nodeOrigin:d,onError:s});y.position=h,y.internals.positionAbsolute=_,l.set(y.id,y)}c(l)},[])}const su=T.createContext(null),N_=su.Provider;su.Consumer;const Fg=()=>T.useContext(su),I_=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),A_=(e,t,r)=>n=>{const{connectionClickStartHandle:i,connectionMode:o,connection:a}=n,{fromHandle:s,toHandle:c,isValid:u}=a,d=c?.nodeId===e&&c?.id===t&&c?.type===r;return{connectingFrom:s?.nodeId===e&&s?.id===t&&s?.type===r,connectingTo:d,clickConnecting:i?.nodeId===e&&i?.id===t&&i?.type===r,isPossibleEndHandle:o===Je.Strict?s?.type!==r:e!==s?.nodeId||t!==s?.id,connectionInProcess:!!s,clickConnectionInProcess:!!i,valid:d&&u}};function M_({type:e="source",position:t=K.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:i=!0,isConnectableEnd:o=!0,id:a,onConnect:s,children:c,className:u,onMouseDown:d,onTouchStart:l,...f},p){const m=a||null,v=e==="target",g=oe(),y=Fg(),{connectOnClick:b,noPanClassName:h,rfId:_}=re(I_,ie),{connectingFrom:w,connectingTo:x,clickConnecting:E,isPossibleEndHandle:q,connectionInProcess:S,clickConnectionInProcess:A,valid:C}=re(A_(y,m,e),ie);y||g.getState().onError?.("010",Ee.error010());const N=k=>{const{defaultEdgeOptions:$,onConnect:G,hasDefaultEdges:j}=g.getState(),z={...$,...k};if(j){const{edges:L,setEdges:V}=g.getState();V(gg(z,L))}G?.(z),s?.(z)},M=k=>{if(!y)return;const $=lg(k.nativeEvent);if(i&&($&&k.button===0||!$)){const G=g.getState();Ys.onPointerDown(k.nativeEvent,{handleDomNode:k.currentTarget,autoPanOnConnect:G.autoPanOnConnect,connectionMode:G.connectionMode,connectionRadius:G.connectionRadius,domNode:G.domNode,nodeLookup:G.nodeLookup,lib:G.lib,isTarget:v,handleId:m,nodeId:y,flowId:G.rfId,panBy:G.panBy,cancelConnection:G.cancelConnection,onConnectStart:G.onConnectStart,onConnectEnd:G.onConnectEnd,updateConnection:G.updateConnection,onConnect:N,isValidConnection:r||G.isValidConnection,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,autoPanSpeed:G.autoPanSpeed,dragThreshold:G.connectionDragThreshold})}$?d?.(k):l?.(k)},O=k=>{const{onClickConnectStart:$,onClickConnectEnd:G,connectionClickStartHandle:j,connectionMode:z,isValidConnection:L,lib:V,rfId:H,nodeLookup:W,connection:I}=g.getState();if(!y||!j&&!i)return;if(!j){$?.(k.nativeEvent,{nodeId:y,handleId:m,handleType:e}),g.setState({connectionClickStartHandle:{nodeId:y,type:e,id:m}});return}const P=cg(k.target),D=r||L,{connection:F,isValid:B}=Ys.isValid(k.nativeEvent,{handle:{nodeId:y,id:m,type:e},connectionMode:z,fromNodeId:j.nodeId,fromHandleId:j.id||null,fromType:j.type,isValidConnection:D,flowId:H,doc:P,lib:V,nodeLookup:W});B&&F&&N(F);const U=structuredClone(I);delete U.inProgress,U.toPosition=U.toHandle?U.toHandle.position:null,G?.(k,U),g.setState({connectionClickStartHandle:null})};return R.jsx("div",{"data-handleid":m,"data-nodeid":y,"data-handlepos":t,"data-id":`${_}-${y}-${m}-${e}`,className:ue(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",h,u,{source:!v,target:v,connectable:n,connectablestart:i,connectableend:o,clickconnecting:E,connectingfrom:w,connectingto:x,valid:C,connectionindicator:n&&(!S||q)&&(S||A?o:i)}]),onMouseDown:M,onTouchStart:M,onClick:b?O:void 0,ref:p,...f,children:c})}const je=T.memo(Dg(M_));function T_({data:e,isConnectable:t,sourcePosition:r=K.Bottom}){return R.jsxs(R.Fragment,{children:[e?.label,R.jsx(je,{type:"source",position:r,isConnectable:t})]})}function P_({data:e,isConnectable:t,targetPosition:r=K.Top,sourcePosition:n=K.Bottom}){return R.jsxs(R.Fragment,{children:[R.jsx(je,{type:"target",position:r,isConnectable:t}),e?.label,R.jsx(je,{type:"source",position:n,isConnectable:t})]})}function k_(){return null}function O_({data:e,isConnectable:t,targetPosition:r=K.Top}){return R.jsxs(R.Fragment,{children:[R.jsx(je,{type:"target",position:r,isConnectable:t}),e?.label]})}const Ft={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},vc={input:T_,default:P_,output:O_,group:k_};function D_(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const L_=e=>{const{width:t,height:r,x:n,y:i}=wt(e.nodeLookup,{filter:o=>!!o.selected});return{width:me(t)?t:null,height:me(r)?r:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${n}px,${i}px)`}};function j_({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=oe(),{width:i,height:o,transformString:a,userSelectionActive:s}=re(L_,ie),c=Bg(),u=T.useRef(null);if(T.useEffect(()=>{r||u.current?.focus({preventScroll:!0})},[r]),jg({nodeRef:u}),s||!i||!o)return null;const d=e?f=>{const p=n.getState().nodes.filter(m=>m.selected);e(f,p)}:void 0,l=f=>{Object.prototype.hasOwnProperty.call(Ft,f.key)&&(f.preventDefault(),c({direction:Ft[f.key],factor:f.shiftKey?4:1}))};return R.jsx("div",{className:ue(["react-flow__nodesselection","react-flow__container",t]),style:{transform:a},children:R.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:r?void 0:-1,onKeyDown:r?void 0:l,style:{width:i,height:o}})})}const mc=typeof window<"u"?window:void 0,B_=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Hg({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:o,onPaneScroll:a,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:u,selectionOnDrag:d,selectionMode:l,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:m,panActivationKeyCode:v,zoomActivationKeyCode:g,elementsSelectable:y,zoomOnScroll:b,zoomOnPinch:h,panOnScroll:_,panOnScrollSpeed:w,panOnScrollMode:x,zoomOnDoubleClick:E,panOnDrag:q,defaultViewport:S,translateExtent:A,minZoom:C,maxZoom:N,preventScrolling:M,onSelectionContextMenu:O,noWheelClassName:k,noPanClassName:$,disableKeyboardA11y:G,onViewportChange:j,isControlledViewport:z}){const{nodesSelectionActive:L,userSelectionActive:V}=re(B_,ie),H=bt(u,{target:mc}),W=bt(v,{target:mc}),I=W||q,P=W||_,D=d&&I!==!0,F=H||V||D;return b_({deleteKeyCode:c,multiSelectionKeyCode:m}),R.jsx(w_,{onPaneContextMenu:o,elementsSelectable:y,zoomOnScroll:b,zoomOnPinch:h,panOnScroll:P,panOnScrollSpeed:w,panOnScrollMode:x,zoomOnDoubleClick:E,panOnDrag:!H&&I,defaultViewport:S,translateExtent:A,minZoom:C,maxZoom:N,zoomActivationKeyCode:g,preventScrolling:M,noWheelClassName:k,noPanClassName:$,onViewportChange:j,isControlledViewport:z,paneClickDistance:s,selectionOnDrag:D,children:R.jsxs(q_,{onSelectionStart:f,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:o,onPaneScroll:a,panOnDrag:I,isSelecting:!!F,selectionMode:l,selectionKeyPressed:H,paneClickDistance:s,selectionOnDrag:D,children:[e,L&&R.jsx(j_,{onSelectionContextMenu:O,noPanClassName:$,disableKeyboardA11y:G})]})})}Hg.displayName="FlowRenderer";const F_=T.memo(Hg),H_=e=>t=>e?Qs(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(r=>r.id):Array.from(t.nodeLookup.keys());function z_(e){return re(T.useCallback(H_(e),[e]),ie)}const $_=e=>e.updateNodeInternals;function V_(){const e=re($_),[t]=T.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(r=>{const n=new Map;r.forEach(i=>{const o=i.target.getAttribute("data-id");n.set(o,{id:o,nodeElement:i.target,force:!0})}),e(n)}));return T.useEffect(()=>()=>{t?.disconnect()},[t]),t}function G_({node:e,nodeType:t,hasDimensions:r,resizeObserver:n}){const i=oe(),o=T.useRef(null),a=T.useRef(null),s=T.useRef(e.sourcePosition),c=T.useRef(e.targetPosition),u=T.useRef(t),d=r&&!!e.internals.handleBounds;return T.useEffect(()=>{o.current&&!e.hidden&&(!d||a.current!==o.current)&&(a.current&&n?.unobserve(a.current),n?.observe(o.current),a.current=o.current)},[d,e.hidden]),T.useEffect(()=>()=>{a.current&&(n?.unobserve(a.current),a.current=null)},[]),T.useEffect(()=>{if(o.current){const l=u.current!==t,f=s.current!==e.sourcePosition,p=c.current!==e.targetPosition;(l||f||p)&&(u.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,i.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:o.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),o}function U_({id:e,onClick:t,onMouseEnter:r,onMouseMove:n,onMouseLeave:i,onContextMenu:o,onDoubleClick:a,nodesDraggable:s,elementsSelectable:c,nodesConnectable:u,nodesFocusable:d,resizeObserver:l,noDragClassName:f,noPanClassName:p,disableKeyboardA11y:m,rfId:v,nodeTypes:g,nodeClickDistance:y,onError:b}){const{node:h,internals:_,isParent:w}=re(B=>{const U=B.nodeLookup.get(e),Z=B.parentLookup.has(e);return{node:U,internals:U.internals,isParent:Z}},ie);let x=h.type||"default",E=g?.[x]||vc[x];E===void 0&&(b?.("003",Ee.error003(x)),x="default",E=g?.default||vc.default);const q=!!(h.draggable||s&&typeof h.draggable>"u"),S=!!(h.selectable||c&&typeof h.selectable>"u"),A=!!(h.connectable||u&&typeof h.connectable>"u"),C=!!(h.focusable||d&&typeof h.focusable>"u"),N=oe(),M=sg(h),O=G_({node:h,nodeType:x,hasDimensions:M,resizeObserver:l}),k=jg({nodeRef:O,disabled:h.hidden||!q,noDragClassName:f,handleSelector:h.dragHandle,nodeId:e,isSelectable:S,nodeClickDistance:y}),$=Bg();if(h.hidden)return null;const G=Ie(h),j=D_(h),z=S||q||t||r||n||i,L=r?B=>r(B,{..._.userNode}):void 0,V=n?B=>n(B,{..._.userNode}):void 0,H=i?B=>i(B,{..._.userNode}):void 0,W=o?B=>o(B,{..._.userNode}):void 0,I=a?B=>a(B,{..._.userNode}):void 0,P=B=>{const{selectNodesOnDrag:U,nodeDragThreshold:Z}=N.getState();S&&(!U||!q||Z>0)&&Ks({id:e,store:N,nodeRef:O}),t&&t(B,{..._.userNode})},D=B=>{if(!(dg(B.nativeEvent)||m)){if(Qp.includes(B.key)&&S){const U=B.key==="Escape";Ks({id:e,store:N,unselect:U,nodeRef:O})}else if(q&&h.selected&&Object.prototype.hasOwnProperty.call(Ft,B.key)){B.preventDefault();const{ariaLabelConfig:U}=N.getState();N.setState({ariaLiveMessage:U["node.a11yDescription.ariaLiveMessage"]({direction:B.key.replace("Arrow","").toLowerCase(),x:~~_.positionAbsolute.x,y:~~_.positionAbsolute.y})}),$({direction:Ft[B.key],factor:B.shiftKey?4:1})}}},F=()=>{if(m||!O.current?.matches(":focus-visible"))return;const{transform:B,width:U,height:Z,autoPanOnNodeFocus:J,setCenter:Q}=N.getState();if(!J)return;Qs(new Map([[e,h]]),{x:0,y:0,width:U,height:Z},B,!0).length>0||Q(h.position.x+G.width/2,h.position.y+G.height/2,{zoom:B[2]})};return R.jsx("div",{className:ue(["react-flow__node",`react-flow__node-${x}`,{[p]:q},h.className,{selected:h.selected,selectable:S,parent:w,draggable:q,dragging:k}]),ref:O,style:{zIndex:_.z,transform:`translate(${_.positionAbsolute.x}px,${_.positionAbsolute.y}px)`,pointerEvents:z?"all":"none",visibility:M?"visible":"hidden",...h.style,...j},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:L,onMouseMove:V,onMouseLeave:H,onContextMenu:W,onClick:P,onDoubleClick:I,onKeyDown:C?D:void 0,tabIndex:C?0:void 0,onFocus:C?F:void 0,role:h.ariaRole??(C?"group":void 0),"aria-roledescription":"node","aria-describedby":m?void 0:`${Ag}-${v}`,"aria-label":h.ariaLabel,...h.domAttributes,children:R.jsx(N_,{value:e,children:R.jsx(E,{id:e,data:h.data,type:x,positionAbsoluteX:_.positionAbsolute.x,positionAbsoluteY:_.positionAbsolute.y,selected:h.selected??!1,selectable:S,draggable:q,deletable:h.deletable??!0,isConnectable:A,sourcePosition:h.sourcePosition,targetPosition:h.targetPosition,dragging:k,dragHandle:h.dragHandle,zIndex:_.z,parentId:h.parentId,...G})})})}var W_=T.memo(U_);const Y_=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function zg(e){const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:i,onError:o}=re(Y_,ie),a=z_(e.onlyRenderVisibleElements),s=V_();return R.jsx("div",{className:"react-flow__nodes",style:Yt,children:a.map(c=>R.jsx(W_,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:i,nodeClickDistance:e.nodeClickDistance,onError:o},c))})}zg.displayName="NodeRenderer";const K_=T.memo(zg);function Z_(e){return re(T.useCallback(r=>{if(!e)return r.edges.map(i=>i.id);const n=[];if(r.width&&r.height)for(const i of r.edges){const o=r.nodeLookup.get(i.source),a=r.nodeLookup.get(i.target);o&&a&&Xy({sourceNode:o,targetNode:a,width:r.width,height:r.height,transform:r.transform})&&n.push(i.id)}return n},[e]),ie)}const X_=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e}};return R.jsx("polyline",{className:"arrow",style:r,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},Q_=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e,fill:e}};return R.jsx("polyline",{className:"arrowclosed",style:r,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},yc={[et.Arrow]:X_,[et.ArrowClosed]:Q_};function J_(e){const t=oe();return T.useMemo(()=>Object.prototype.hasOwnProperty.call(yc,e)?yc[e]:(t.getState().onError?.("009",Ee.error009(e)),null),[e])}const ex=({id:e,type:t,color:r,width:n=12.5,height:i=12.5,markerUnits:o="strokeWidth",strokeWidth:a,orient:s="auto-start-reverse"})=>{const c=J_(t);return c?R.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:s,refX:"0",refY:"0",children:R.jsx(c,{color:r,strokeWidth:a})}):null},$g=({defaultColor:e,rfId:t})=>{const r=re(o=>o.edges),n=re(o=>o.defaultEdgeOptions),i=T.useMemo(()=>ib(r,{id:t,defaultColor:e,defaultMarkerStart:n?.markerStart,defaultMarkerEnd:n?.markerEnd}),[r,n,t,e]);return i.length?R.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:R.jsx("defs",{children:i.map(o=>R.jsx(ex,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})}):null};$g.displayName="MarkerDefinitions";var tx=T.memo($g);function Vg({x:e,y:t,label:r,labelStyle:n,labelShowBg:i=!0,labelBgStyle:o,labelBgPadding:a=[2,4],labelBgBorderRadius:s=2,children:c,className:u,...d}){const[l,f]=T.useState({x:1,y:0,width:0,height:0}),p=ue(["react-flow__edge-textwrapper",u]),m=T.useRef(null);return T.useEffect(()=>{if(m.current){const v=m.current.getBBox();f({x:v.x,y:v.y,width:v.width,height:v.height})}},[r]),r?R.jsxs("g",{transform:`translate(${e-l.width/2} ${t-l.height/2})`,className:p,visibility:l.width?"visible":"hidden",...d,children:[i&&R.jsx("rect",{width:l.width+2*a[0],x:-a[0],y:-a[1],height:l.height+2*a[1],className:"react-flow__edge-textbg",style:o,rx:s,ry:s}),R.jsx("text",{className:"react-flow__edge-text",y:l.height/2,dy:"0.3em",ref:m,style:n,children:r}),c]}):null}Vg.displayName="EdgeText";const rx=T.memo(Vg);function Kt({path:e,labelX:t,labelY:r,label:n,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:s,labelBgBorderRadius:c,interactionWidth:u=20,...d}){return R.jsxs(R.Fragment,{children:[R.jsx("path",{...d,d:e,fill:"none",className:ue(["react-flow__edge-path",d.className])}),u?R.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:u,className:"react-flow__edge-interaction"}):null,n&&me(t)&&me(r)?R.jsx(rx,{x:t,y:r,label:n,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:s,labelBgBorderRadius:c}):null]})}function bc({pos:e,x1:t,y1:r,x2:n,y2:i}){return e===K.Left||e===K.Right?[.5*(t+n),r]:[t,.5*(r+i)]}function Gg({sourceX:e,sourceY:t,sourcePosition:r=K.Bottom,targetX:n,targetY:i,targetPosition:o=K.Top}){const[a,s]=bc({pos:r,x1:e,y1:t,x2:n,y2:i}),[c,u]=bc({pos:o,x1:n,y1:i,x2:e,y2:t}),[d,l,f,p]=fg({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:a,sourceControlY:s,targetControlX:c,targetControlY:u});return[`M${e},${t} C${a},${s} ${c},${u} ${n},${i}`,d,l,f,p]}function Ug(e){return T.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:o,sourcePosition:a,targetPosition:s,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:v,markerStart:g,interactionWidth:y})=>{const[b,h,_]=Gg({sourceX:r,sourceY:n,sourcePosition:a,targetX:i,targetY:o,targetPosition:s}),w=e.isInternal?void 0:t;return R.jsx(Kt,{id:w,path:b,labelX:h,labelY:_,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:v,markerStart:g,interactionWidth:y})})}const nx=Ug({isInternal:!1}),Wg=Ug({isInternal:!0});nx.displayName="SimpleBezierEdge";Wg.displayName="SimpleBezierEdgeInternal";function Yg(e){return T.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:o,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:l,style:f,sourcePosition:p=K.Bottom,targetPosition:m=K.Top,markerEnd:v,markerStart:g,pathOptions:y,interactionWidth:b})=>{const[h,_,w]=Gs({sourceX:r,sourceY:n,sourcePosition:p,targetX:i,targetY:o,targetPosition:m,borderRadius:y?.borderRadius,offset:y?.offset,stepPosition:y?.stepPosition}),x=e.isInternal?void 0:t;return R.jsx(Kt,{id:x,path:h,labelX:_,labelY:w,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:l,style:f,markerEnd:v,markerStart:g,interactionWidth:b})})}const Kg=Yg({isInternal:!1}),Zg=Yg({isInternal:!0});Kg.displayName="SmoothStepEdge";Zg.displayName="SmoothStepEdgeInternal";function Xg(e){return T.memo(({id:t,...r})=>{const n=e.isInternal?void 0:t;return R.jsx(Kg,{...r,id:n,pathOptions:T.useMemo(()=>({borderRadius:0,offset:r.pathOptions?.offset}),[r.pathOptions?.offset])})})}const ix=Xg({isInternal:!1}),Qg=Xg({isInternal:!0});ix.displayName="StepEdge";Qg.displayName="StepEdgeInternal";function Jg(e){return T.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:o,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:l,style:f,markerEnd:p,markerStart:m,interactionWidth:v})=>{const[g,y,b]=vg({sourceX:r,sourceY:n,targetX:i,targetY:o}),h=e.isInternal?void 0:t;return R.jsx(Kt,{id:h,path:g,labelX:y,labelY:b,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:l,style:f,markerEnd:p,markerStart:m,interactionWidth:v})})}const ox=Jg({isInternal:!1}),ev=Jg({isInternal:!0});ox.displayName="StraightEdge";ev.displayName="StraightEdgeInternal";function tv(e){return T.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:o,sourcePosition:a=K.Bottom,targetPosition:s=K.Top,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:v,markerStart:g,pathOptions:y,interactionWidth:b})=>{const[h,_,w]=hg({sourceX:r,sourceY:n,sourcePosition:a,targetX:i,targetY:o,targetPosition:s,curvature:y?.curvature}),x=e.isInternal?void 0:t;return R.jsx(Kt,{id:x,path:h,labelX:_,labelY:w,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:v,markerStart:g,interactionWidth:b})})}const ax=tv({isInternal:!1}),rv=tv({isInternal:!0});ax.displayName="BezierEdge";rv.displayName="BezierEdgeInternal";const _c={default:rv,straight:ev,step:Qg,smoothstep:Zg,simplebezier:Wg},xc={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},sx=(e,t,r)=>r===K.Left?e-t:r===K.Right?e+t:e,ux=(e,t,r)=>r===K.Top?e-t:r===K.Bottom?e+t:e,wc="react-flow__edgeupdater";function Ec({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:i,onMouseEnter:o,onMouseOut:a,type:s}){return R.jsx("circle",{onMouseDown:i,onMouseEnter:o,onMouseOut:a,className:ue([wc,`${wc}-${s}`]),cx:sx(t,n,e),cy:ux(r,n,e),r:n,stroke:"transparent",fill:"transparent"})}function cx({isReconnectable:e,reconnectRadius:t,edge:r,sourceX:n,sourceY:i,targetX:o,targetY:a,sourcePosition:s,targetPosition:c,onReconnect:u,onReconnectStart:d,onReconnectEnd:l,setReconnecting:f,setUpdateHover:p}){const m=oe(),v=(_,w)=>{if(_.button!==0)return;const{autoPanOnConnect:x,domNode:E,isValidConnection:q,connectionMode:S,connectionRadius:A,lib:C,onConnectStart:N,onConnectEnd:M,cancelConnection:O,nodeLookup:k,rfId:$,panBy:G,updateConnection:j}=m.getState(),z=w.type==="target",L=(W,I)=>{f(!1),l?.(W,r,w.type,I)},V=W=>u?.(r,W),H=(W,I)=>{f(!0),d?.(_,r,w.type),N?.(W,I)};Ys.onPointerDown(_.nativeEvent,{autoPanOnConnect:x,connectionMode:S,connectionRadius:A,domNode:E,handleId:w.id,nodeId:w.nodeId,nodeLookup:k,isTarget:z,edgeUpdaterType:w.type,lib:C,flowId:$,cancelConnection:O,panBy:G,isValidConnection:q,onConnect:V,onConnectStart:H,onConnectEnd:M,onReconnectEnd:L,updateConnection:j,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold,handleDomNode:_.currentTarget})},g=_=>v(_,{nodeId:r.target,id:r.targetHandle??null,type:"target"}),y=_=>v(_,{nodeId:r.source,id:r.sourceHandle??null,type:"source"}),b=()=>p(!0),h=()=>p(!1);return R.jsxs(R.Fragment,{children:[(e===!0||e==="source")&&R.jsx(Ec,{position:s,centerX:n,centerY:i,radius:t,onMouseDown:g,onMouseEnter:b,onMouseOut:h,type:"source"}),(e===!0||e==="target")&&R.jsx(Ec,{position:c,centerX:o,centerY:a,radius:t,onMouseDown:y,onMouseEnter:b,onMouseOut:h,type:"target"})]})}function dx({id:e,edgesFocusable:t,edgesReconnectable:r,elementsSelectable:n,onClick:i,onDoubleClick:o,onContextMenu:a,onMouseEnter:s,onMouseMove:c,onMouseLeave:u,reconnectRadius:d,onReconnect:l,onReconnectStart:f,onReconnectEnd:p,rfId:m,edgeTypes:v,noPanClassName:g,onError:y,disableKeyboardA11y:b}){let h=re(Q=>Q.edgeLookup.get(e));const _=re(Q=>Q.defaultEdgeOptions);h=_?{..._,...h}:h;let w=h.type||"default",x=v?.[w]||_c[w];x===void 0&&(y?.("011",Ee.error011(w)),w="default",x=v?.default||_c.default);const E=!!(h.focusable||t&&typeof h.focusable>"u"),q=typeof l<"u"&&(h.reconnectable||r&&typeof h.reconnectable>"u"),S=!!(h.selectable||n&&typeof h.selectable>"u"),A=T.useRef(null),[C,N]=T.useState(!1),[M,O]=T.useState(!1),k=oe(),{zIndex:$,sourceX:G,sourceY:j,targetX:z,targetY:L,sourcePosition:V,targetPosition:H}=re(T.useCallback(Q=>{const Y=Q.nodeLookup.get(h.source),te=Q.nodeLookup.get(h.target);if(!Y||!te)return{zIndex:h.zIndex,...xc};const X=nb({id:e,sourceNode:Y,targetNode:te,sourceHandle:h.sourceHandle||null,targetHandle:h.targetHandle||null,connectionMode:Q.connectionMode,onError:y});return{zIndex:Zy({selected:h.selected,zIndex:h.zIndex,sourceNode:Y,targetNode:te,elevateOnSelect:Q.elevateEdgesOnSelect,zIndexMode:Q.zIndexMode}),...X||xc}},[h.source,h.target,h.sourceHandle,h.targetHandle,h.selected,h.zIndex]),ie),W=T.useMemo(()=>h.markerStart?`url('#${Us(h.markerStart,m)}')`:void 0,[h.markerStart,m]),I=T.useMemo(()=>h.markerEnd?`url('#${Us(h.markerEnd,m)}')`:void 0,[h.markerEnd,m]);if(h.hidden||G===null||j===null||z===null||L===null)return null;const P=Q=>{const{addSelectedEdges:Y,unselectNodesAndEdges:te,multiSelectionActive:X}=k.getState();S&&(k.setState({nodesSelectionActive:!1}),h.selected&&X?(te({nodes:[],edges:[h]}),A.current?.blur()):Y([e])),i&&i(Q,h)},D=o?Q=>{o(Q,{...h})}:void 0,F=a?Q=>{a(Q,{...h})}:void 0,B=s?Q=>{s(Q,{...h})}:void 0,U=c?Q=>{c(Q,{...h})}:void 0,Z=u?Q=>{u(Q,{...h})}:void 0,J=Q=>{if(!b&&Qp.includes(Q.key)&&S){const{unselectNodesAndEdges:Y,addSelectedEdges:te}=k.getState();Q.key==="Escape"?(A.current?.blur(),Y({edges:[h]})):te([e])}};return R.jsx("svg",{style:{zIndex:$},children:R.jsxs("g",{className:ue(["react-flow__edge",`react-flow__edge-${w}`,h.className,g,{selected:h.selected,animated:h.animated,inactive:!S&&!i,updating:C,selectable:S}]),onClick:P,onDoubleClick:D,onContextMenu:F,onMouseEnter:B,onMouseMove:U,onMouseLeave:Z,onKeyDown:E?J:void 0,tabIndex:E?0:void 0,role:h.ariaRole??(E?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":h.ariaLabel===null?void 0:h.ariaLabel||`Edge from ${h.source} to ${h.target}`,"aria-describedby":E?`${Mg}-${m}`:void 0,ref:A,...h.domAttributes,children:[!M&&R.jsx(x,{id:e,source:h.source,target:h.target,type:h.type,selected:h.selected,animated:h.animated,selectable:S,deletable:h.deletable??!0,label:h.label,labelStyle:h.labelStyle,labelShowBg:h.labelShowBg,labelBgStyle:h.labelBgStyle,labelBgPadding:h.labelBgPadding,labelBgBorderRadius:h.labelBgBorderRadius,sourceX:G,sourceY:j,targetX:z,targetY:L,sourcePosition:V,targetPosition:H,data:h.data,style:h.style,sourceHandleId:h.sourceHandle,targetHandleId:h.targetHandle,markerStart:W,markerEnd:I,pathOptions:"pathOptions"in h?h.pathOptions:void 0,interactionWidth:h.interactionWidth}),q&&R.jsx(cx,{edge:h,isReconnectable:q,reconnectRadius:d,onReconnect:l,onReconnectStart:f,onReconnectEnd:p,sourceX:G,sourceY:j,targetX:z,targetY:L,sourcePosition:V,targetPosition:H,setUpdateHover:N,setReconnecting:O})]})})}var lx=T.memo(dx);const fx=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function nv({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:r,edgeTypes:n,noPanClassName:i,onReconnect:o,onEdgeContextMenu:a,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:d,reconnectRadius:l,onEdgeDoubleClick:f,onReconnectStart:p,onReconnectEnd:m,disableKeyboardA11y:v}){const{edgesFocusable:g,edgesReconnectable:y,elementsSelectable:b,onError:h}=re(fx,ie),_=Z_(t);return R.jsxs("div",{className:"react-flow__edges",children:[R.jsx(tx,{defaultColor:e,rfId:r}),_.map(w=>R.jsx(lx,{id:w,edgesFocusable:g,edgesReconnectable:y,elementsSelectable:b,noPanClassName:i,onReconnect:o,onContextMenu:a,onMouseEnter:s,onMouseMove:c,onMouseLeave:u,onClick:d,reconnectRadius:l,onDoubleClick:f,onReconnectStart:p,onReconnectEnd:m,rfId:r,onError:h,edgeTypes:n,disableKeyboardA11y:v},w))]})}nv.displayName="EdgeRenderer";const hx=T.memo(nv),px=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function gx({children:e}){const t=re(px);return R.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function vx(e){const t=au(),r=T.useRef(!1);T.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const mx=e=>e.panZoom?.syncViewport;function yx(e){const t=re(mx),r=oe();return T.useEffect(()=>{e&&(t?.(e),r.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function bx(e){return e.connection.inProgress?{...e.connection,to:Ct(e.connection.to,e.transform)}:{...e.connection}}function _x(e){return bx}function xx(e){const t=_x();return re(t,ie)}const wx=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Ex({containerStyle:e,style:t,type:r,component:n}){const{nodesConnectable:i,width:o,height:a,isValid:s,inProgress:c}=re(wx,ie);return!(o&&i&&c)?null:R.jsx("svg",{style:e,width:o,height:a,className:"react-flow__connectionline react-flow__container",children:R.jsx("g",{className:ue(["react-flow__connection",tg(s)]),children:R.jsx(iv,{style:t,type:r,CustomComponent:n,isValid:s})})})}const iv=({style:e,type:t=Le.Bezier,CustomComponent:r,isValid:n})=>{const{inProgress:i,from:o,fromNode:a,fromHandle:s,fromPosition:c,to:u,toNode:d,toHandle:l,toPosition:f,pointer:p}=xx();if(!i)return;if(r)return R.jsx(r,{connectionLineType:t,connectionLineStyle:e,fromNode:a,fromHandle:s,fromX:o.x,fromY:o.y,toX:u.x,toY:u.y,fromPosition:c,toPosition:f,connectionStatus:tg(n),toNode:d,toHandle:l,pointer:p});let m="";const v={sourceX:o.x,sourceY:o.y,sourcePosition:c,targetX:u.x,targetY:u.y,targetPosition:f};switch(t){case Le.Bezier:[m]=hg(v);break;case Le.SimpleBezier:[m]=Gg(v);break;case Le.Step:[m]=Gs({...v,borderRadius:0});break;case Le.SmoothStep:[m]=Gs(v);break;default:[m]=vg(v)}return R.jsx("path",{d:m,fill:"none",className:"react-flow__connection-path",style:e})};iv.displayName="ConnectionLine";const Cx={};function Cc(e=Cx){T.useRef(e),oe(),T.useEffect(()=>{},[e])}function Sx(){oe(),T.useRef(!1),T.useEffect(()=>{},[])}function ov({nodeTypes:e,edgeTypes:t,onInit:r,onNodeClick:n,onEdgeClick:i,onNodeDoubleClick:o,onEdgeDoubleClick:a,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:d,onSelectionContextMenu:l,onSelectionStart:f,onSelectionEnd:p,connectionLineType:m,connectionLineStyle:v,connectionLineComponent:g,connectionLineContainerStyle:y,selectionKeyCode:b,selectionOnDrag:h,selectionMode:_,multiSelectionKeyCode:w,panActivationKeyCode:x,zoomActivationKeyCode:E,deleteKeyCode:q,onlyRenderVisibleElements:S,elementsSelectable:A,defaultViewport:C,translateExtent:N,minZoom:M,maxZoom:O,preventScrolling:k,defaultMarkerColor:$,zoomOnScroll:G,zoomOnPinch:j,panOnScroll:z,panOnScrollSpeed:L,panOnScrollMode:V,zoomOnDoubleClick:H,panOnDrag:W,onPaneClick:I,onPaneMouseEnter:P,onPaneMouseMove:D,onPaneMouseLeave:F,onPaneScroll:B,onPaneContextMenu:U,paneClickDistance:Z,nodeClickDistance:J,onEdgeContextMenu:Q,onEdgeMouseEnter:Y,onEdgeMouseMove:te,onEdgeMouseLeave:X,reconnectRadius:ne,onReconnect:ee,onReconnectStart:le,onReconnectEnd:de,noDragClassName:Se,noWheelClassName:xe,noPanClassName:fe,disableKeyboardA11y:se,nodeExtent:Te,rfId:qe,viewport:Pe,onViewportChange:ke}){return Cc(e),Cc(t),Sx(),vx(r),yx(Pe),R.jsx(F_,{onPaneClick:I,onPaneMouseEnter:P,onPaneMouseMove:D,onPaneMouseLeave:F,onPaneContextMenu:U,onPaneScroll:B,paneClickDistance:Z,deleteKeyCode:q,selectionKeyCode:b,selectionOnDrag:h,selectionMode:_,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:w,panActivationKeyCode:x,zoomActivationKeyCode:E,elementsSelectable:A,zoomOnScroll:G,zoomOnPinch:j,zoomOnDoubleClick:H,panOnScroll:z,panOnScrollSpeed:L,panOnScrollMode:V,panOnDrag:W,defaultViewport:C,translateExtent:N,minZoom:M,maxZoom:O,onSelectionContextMenu:l,preventScrolling:k,noDragClassName:Se,noWheelClassName:xe,noPanClassName:fe,disableKeyboardA11y:se,onViewportChange:ke,isControlledViewport:!!Pe,children:R.jsxs(gx,{children:[R.jsx(hx,{edgeTypes:t,onEdgeClick:i,onEdgeDoubleClick:a,onReconnect:ee,onReconnectStart:le,onReconnectEnd:de,onlyRenderVisibleElements:S,onEdgeContextMenu:Q,onEdgeMouseEnter:Y,onEdgeMouseMove:te,onEdgeMouseLeave:X,reconnectRadius:ne,defaultMarkerColor:$,noPanClassName:fe,disableKeyboardA11y:se,rfId:qe}),R.jsx(Ex,{style:v,type:m,component:g,containerStyle:y}),R.jsx("div",{className:"react-flow__edgelabel-renderer"}),R.jsx(K_,{nodeTypes:e,onNodeClick:n,onNodeDoubleClick:o,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:d,nodeClickDistance:J,onlyRenderVisibleElements:S,noPanClassName:fe,noDragClassName:Se,disableKeyboardA11y:se,nodeExtent:Te,rfId:qe}),R.jsx("div",{className:"react-flow__viewport-portal"})]})})}ov.displayName="GraphView";const qx=T.memo(ov),Sc=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:i,height:o,fitView:a,fitViewOptions:s,minZoom:c=.5,maxZoom:u=2,nodeOrigin:d,nodeExtent:l,zIndexMode:f="basic"}={})=>{const p=new Map,m=new Map,v=new Map,g=new Map,y=n??t??[],b=r??e??[],h=d??[0,0],_=l??gt;bg(v,g,y);const w=Ws(b,p,m,{nodeOrigin:h,nodeExtent:_,zIndexMode:f});let x=[0,0,1];if(a&&i&&o){const E=wt(p,{filter:C=>!!((C.width||C.initialWidth)&&(C.height||C.initialHeight))}),{x:q,y:S,zoom:A}=Js(E,i,o,c,u,s?.padding??.1);x=[q,S,A]}return{rfId:"1",width:i??0,height:o??0,transform:x,nodes:b,nodesInitialized:w,nodeLookup:p,parentLookup:m,edges:y,edgeLookup:g,connectionLookup:v,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:r!==void 0,hasDefaultEdges:n!==void 0,panZoom:null,minZoom:c,maxZoom:u,translateExtent:gt,nodeExtent:_,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Je.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:h,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:a??!1,fitViewOptions:s,fitViewResolver:null,connection:{...eg},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Vy,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Jp,zIndexMode:f,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},Rx=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:i,height:o,fitView:a,fitViewOptions:s,minZoom:c,maxZoom:u,nodeOrigin:d,nodeExtent:l,zIndexMode:f})=>Gb((p,m)=>{async function v(){const{nodeLookup:g,panZoom:y,fitViewOptions:b,fitViewResolver:h,width:_,height:w,minZoom:x,maxZoom:E}=m();y&&(await zy({nodes:g,width:_,height:w,panZoom:y,minZoom:x,maxZoom:E},b),h?.resolve(!0),p({fitViewResolver:null}))}return{...Sc({nodes:e,edges:t,width:i,height:o,fitView:a,fitViewOptions:s,minZoom:c,maxZoom:u,nodeOrigin:d,nodeExtent:l,defaultNodes:r,defaultEdges:n,zIndexMode:f}),setNodes:g=>{const{nodeLookup:y,parentLookup:b,nodeOrigin:h,elevateNodesOnSelect:_,fitViewQueued:w,zIndexMode:x}=m(),E=Ws(g,y,b,{nodeOrigin:h,nodeExtent:l,elevateNodesOnSelect:_,checkEquality:!0,zIndexMode:x});w&&E?(v(),p({nodes:g,nodesInitialized:E,fitViewQueued:!1,fitViewOptions:void 0})):p({nodes:g,nodesInitialized:E})},setEdges:g=>{const{connectionLookup:y,edgeLookup:b}=m();bg(y,b,g),p({edges:g})},setDefaultNodesAndEdges:(g,y)=>{if(g){const{setNodes:b}=m();b(g),p({hasDefaultNodes:!0})}if(y){const{setEdges:b}=m();b(y),p({hasDefaultEdges:!0})}},updateNodeInternals:g=>{const{triggerNodeChanges:y,nodeLookup:b,parentLookup:h,domNode:_,nodeOrigin:w,nodeExtent:x,debug:E,fitViewQueued:q,zIndexMode:S}=m(),{changes:A,updatedInternals:C}=lb(g,b,h,_,w,x,S);C&&(sb(b,h,{nodeOrigin:w,nodeExtent:x,zIndexMode:S}),q?(v(),p({fitViewQueued:!1,fitViewOptions:void 0})):p({}),A?.length>0&&(E&&console.log("React Flow: trigger node changes",A),y?.(A)))},updateNodePositions:(g,y=!1)=>{const b=[];let h=[];const{nodeLookup:_,triggerNodeChanges:w,connection:x,updateConnection:E,onNodesChangeMiddlewareMap:q}=m();for(const[S,A]of g){const C=_.get(S),N=!!(C?.expandParent&&C?.parentId&&A?.position),M={id:S,type:"position",position:N?{x:Math.max(0,A.position.x),y:Math.max(0,A.position.y)}:A.position,dragging:y};if(C&&x.inProgress&&x.fromNode.id===C.id){const O=Ve(C,x.fromHandle,K.Left,!0);E({...x,from:O})}N&&C.parentId&&b.push({id:S,parentId:C.parentId,rect:{...A.internals.positionAbsolute,width:A.measured.width??0,height:A.measured.height??0}}),h.push(M)}if(b.length>0){const{parentLookup:S,nodeOrigin:A}=m(),C=ou(b,_,S,A);h.push(...C)}for(const S of q.values())h=S(h);w(h)},triggerNodeChanges:g=>{const{onNodesChange:y,setNodes:b,nodes:h,hasDefaultNodes:_,debug:w}=m();if(g?.length){if(_){const x=kg(g,h);b(x)}w&&console.log("React Flow: trigger node changes",g),y?.(g)}},triggerEdgeChanges:g=>{const{onEdgesChange:y,setEdges:b,edges:h,hasDefaultEdges:_,debug:w}=m();if(g?.length){if(_){const x=Og(g,h);b(x)}w&&console.log("React Flow: trigger edge changes",g),y?.(g)}},addSelectedNodes:g=>{const{multiSelectionActive:y,edgeLookup:b,nodeLookup:h,triggerNodeChanges:_,triggerEdgeChanges:w}=m();if(y){const x=g.map(E=>He(E,!0));_(x);return}_(Qe(h,new Set([...g]),!0)),w(Qe(b))},addSelectedEdges:g=>{const{multiSelectionActive:y,edgeLookup:b,nodeLookup:h,triggerNodeChanges:_,triggerEdgeChanges:w}=m();if(y){const x=g.map(E=>He(E,!0));w(x);return}w(Qe(b,new Set([...g]))),_(Qe(h,new Set,!0))},unselectNodesAndEdges:({nodes:g,edges:y}={})=>{const{edges:b,nodes:h,nodeLookup:_,triggerNodeChanges:w,triggerEdgeChanges:x}=m(),E=g||h,q=y||b,S=E.map(C=>{const N=_.get(C.id);return N&&(N.selected=!1),He(C.id,!1)}),A=q.map(C=>He(C.id,!1));w(S),x(A)},setMinZoom:g=>{const{panZoom:y,maxZoom:b}=m();y?.setScaleExtent([g,b]),p({minZoom:g})},setMaxZoom:g=>{const{panZoom:y,minZoom:b}=m();y?.setScaleExtent([b,g]),p({maxZoom:g})},setTranslateExtent:g=>{m().panZoom?.setTranslateExtent(g),p({translateExtent:g})},resetSelectedElements:()=>{const{edges:g,nodes:y,triggerNodeChanges:b,triggerEdgeChanges:h,elementsSelectable:_}=m();if(!_)return;const w=y.reduce((E,q)=>q.selected?[...E,He(q.id,!1)]:E,[]),x=g.reduce((E,q)=>q.selected?[...E,He(q.id,!1)]:E,[]);b(w),h(x)},setNodeExtent:g=>{const{nodes:y,nodeLookup:b,parentLookup:h,nodeOrigin:_,elevateNodesOnSelect:w,nodeExtent:x,zIndexMode:E}=m();g[0][0]===x[0][0]&&g[0][1]===x[0][1]&&g[1][0]===x[1][0]&&g[1][1]===x[1][1]||(Ws(y,b,h,{nodeOrigin:_,nodeExtent:g,elevateNodesOnSelect:w,checkEquality:!1,zIndexMode:E}),p({nodeExtent:g}))},panBy:g=>{const{transform:y,width:b,height:h,panZoom:_,translateExtent:w}=m();return fb({delta:g,panZoom:_,transform:y,translateExtent:w,width:b,height:h})},setCenter:async(g,y,b)=>{const{width:h,height:_,maxZoom:w,panZoom:x}=m();if(!x)return Promise.resolve(!1);const E=typeof b?.zoom<"u"?b.zoom:w;return await x.setViewport({x:h/2-g*E,y:_/2-y*E,zoom:E},{duration:b?.duration,ease:b?.ease,interpolate:b?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{p({connection:{...eg}})},updateConnection:g=>{p({connection:g})},reset:()=>p({...Sc()})}},Object.is);function Nx({initialNodes:e,initialEdges:t,defaultNodes:r,defaultEdges:n,initialWidth:i,initialHeight:o,initialMinZoom:a,initialMaxZoom:s,initialFitViewOptions:c,fitView:u,nodeOrigin:d,nodeExtent:l,zIndexMode:f,children:p}){const[m]=T.useState(()=>Rx({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:i,height:o,fitView:u,minZoom:a,maxZoom:s,fitViewOptions:c,nodeOrigin:d,nodeExtent:l,zIndexMode:f}));return R.jsx(Ub,{value:m,children:R.jsx(g_,{children:p})})}function Ix({children:e,nodes:t,edges:r,defaultNodes:n,defaultEdges:i,width:o,height:a,fitView:s,fitViewOptions:c,minZoom:u,maxZoom:d,nodeOrigin:l,nodeExtent:f,zIndexMode:p}){return T.useContext(Ut)?R.jsx(R.Fragment,{children:e}):R.jsx(Nx,{initialNodes:t,initialEdges:r,defaultNodes:n,defaultEdges:i,initialWidth:o,initialHeight:a,fitView:s,initialFitViewOptions:c,initialMinZoom:u,initialMaxZoom:d,nodeOrigin:l,nodeExtent:f,zIndexMode:p,children:e})}const Ax={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Mx({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:i,nodeTypes:o,edgeTypes:a,onNodeClick:s,onEdgeClick:c,onInit:u,onMove:d,onMoveStart:l,onMoveEnd:f,onConnect:p,onConnectStart:m,onConnectEnd:v,onClickConnectStart:g,onClickConnectEnd:y,onNodeMouseEnter:b,onNodeMouseMove:h,onNodeMouseLeave:_,onNodeContextMenu:w,onNodeDoubleClick:x,onNodeDragStart:E,onNodeDrag:q,onNodeDragStop:S,onNodesDelete:A,onEdgesDelete:C,onDelete:N,onSelectionChange:M,onSelectionDragStart:O,onSelectionDrag:k,onSelectionDragStop:$,onSelectionContextMenu:G,onSelectionStart:j,onSelectionEnd:z,onBeforeDelete:L,connectionMode:V,connectionLineType:H=Le.Bezier,connectionLineStyle:W,connectionLineComponent:I,connectionLineContainerStyle:P,deleteKeyCode:D="Backspace",selectionKeyCode:F="Shift",selectionOnDrag:B=!1,selectionMode:U=vt.Full,panActivationKeyCode:Z="Space",multiSelectionKeyCode:J=yt()?"Meta":"Control",zoomActivationKeyCode:Q=yt()?"Meta":"Control",snapToGrid:Y,snapGrid:te,onlyRenderVisibleElements:X=!1,selectNodesOnDrag:ne,nodesDraggable:ee,autoPanOnNodeFocus:le,nodesConnectable:de,nodesFocusable:Se,nodeOrigin:xe=Tg,edgesFocusable:fe,edgesReconnectable:se,elementsSelectable:Te=!0,defaultViewport:qe=o_,minZoom:Pe=.5,maxZoom:ke=2,translateExtent:Re=gt,preventScrolling:At=!0,nodeExtent:Ke,defaultMarkerColor:hr="#b1b1b7",zoomOnScroll:Mt=!0,zoomOnPinch:we=!0,panOnScroll:Ne=!1,panOnScrollSpeed:um=.5,panOnScrollMode:cm=ze.Free,zoomOnDoubleClick:dm=!0,panOnDrag:lm=!0,onPaneClick:fm,onPaneMouseEnter:hm,onPaneMouseMove:pm,onPaneMouseLeave:gm,onPaneScroll:vm,onPaneContextMenu:mm,paneClickDistance:ym=1,nodeClickDistance:bm=0,children:_m,onReconnect:xm,onReconnectStart:wm,onReconnectEnd:Em,onEdgeContextMenu:Cm,onEdgeDoubleClick:Sm,onEdgeMouseEnter:qm,onEdgeMouseMove:Rm,onEdgeMouseLeave:Nm,reconnectRadius:Im=10,onNodesChange:Am,onEdgesChange:Mm,noDragClassName:Tm="nodrag",noWheelClassName:Pm="nowheel",noPanClassName:qu="nopan",fitView:Ru,fitViewOptions:Nu,connectOnClick:km,attributionPosition:Om,proOptions:Dm,defaultEdgeOptions:Lm,elevateNodesOnSelect:jm=!0,elevateEdgesOnSelect:Bm=!1,disableKeyboardA11y:Iu=!1,autoPanOnConnect:Fm,autoPanOnNodeDrag:Hm,autoPanSpeed:zm,connectionRadius:$m,isValidConnection:Vm,onError:Gm,style:Um,id:Au,nodeDragThreshold:Wm,connectionDragThreshold:Ym,viewport:Km,onViewportChange:Zm,width:Xm,height:Qm,colorMode:Jm="light",debug:ey,onScroll:Mu,ariaLabelConfig:ty,zIndexMode:Tu="basic",...ry},ny){const pr=Au||"1",iy=c_(Jm),oy=T.useCallback(Pu=>{Pu.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Mu?.(Pu)},[Mu]);return R.jsx("div",{"data-testid":"rf__wrapper",...ry,onScroll:oy,style:{...Um,...Ax},ref:ny,className:ue(["react-flow",i,iy]),id:Au,role:"application",children:R.jsxs(Ix,{nodes:e,edges:t,width:Xm,height:Qm,fitView:Ru,fitViewOptions:Nu,minZoom:Pe,maxZoom:ke,nodeOrigin:xe,nodeExtent:Ke,zIndexMode:Tu,children:[R.jsx(qx,{onInit:u,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:b,onNodeMouseMove:h,onNodeMouseLeave:_,onNodeContextMenu:w,onNodeDoubleClick:x,nodeTypes:o,edgeTypes:a,connectionLineType:H,connectionLineStyle:W,connectionLineComponent:I,connectionLineContainerStyle:P,selectionKeyCode:F,selectionOnDrag:B,selectionMode:U,deleteKeyCode:D,multiSelectionKeyCode:J,panActivationKeyCode:Z,zoomActivationKeyCode:Q,onlyRenderVisibleElements:X,defaultViewport:qe,translateExtent:Re,minZoom:Pe,maxZoom:ke,preventScrolling:At,zoomOnScroll:Mt,zoomOnPinch:we,zoomOnDoubleClick:dm,panOnScroll:Ne,panOnScrollSpeed:um,panOnScrollMode:cm,panOnDrag:lm,onPaneClick:fm,onPaneMouseEnter:hm,onPaneMouseMove:pm,onPaneMouseLeave:gm,onPaneScroll:vm,onPaneContextMenu:mm,paneClickDistance:ym,nodeClickDistance:bm,onSelectionContextMenu:G,onSelectionStart:j,onSelectionEnd:z,onReconnect:xm,onReconnectStart:wm,onReconnectEnd:Em,onEdgeContextMenu:Cm,onEdgeDoubleClick:Sm,onEdgeMouseEnter:qm,onEdgeMouseMove:Rm,onEdgeMouseLeave:Nm,reconnectRadius:Im,defaultMarkerColor:hr,noDragClassName:Tm,noWheelClassName:Pm,noPanClassName:qu,rfId:pr,disableKeyboardA11y:Iu,nodeExtent:Ke,viewport:Km,onViewportChange:Zm}),R.jsx(u_,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:p,onConnectStart:m,onConnectEnd:v,onClickConnectStart:g,onClickConnectEnd:y,nodesDraggable:ee,autoPanOnNodeFocus:le,nodesConnectable:de,nodesFocusable:Se,edgesFocusable:fe,edgesReconnectable:se,elementsSelectable:Te,elevateNodesOnSelect:jm,elevateEdgesOnSelect:Bm,minZoom:Pe,maxZoom:ke,nodeExtent:Ke,onNodesChange:Am,onEdgesChange:Mm,snapToGrid:Y,snapGrid:te,connectionMode:V,translateExtent:Re,connectOnClick:km,defaultEdgeOptions:Lm,fitView:Ru,fitViewOptions:Nu,onNodesDelete:A,onEdgesDelete:C,onDelete:N,onNodeDragStart:E,onNodeDrag:q,onNodeDragStop:S,onSelectionDrag:k,onSelectionDragStart:O,onSelectionDragStop:$,onMove:d,onMoveStart:l,onMoveEnd:f,noPanClassName:qu,nodeOrigin:xe,rfId:pr,autoPanOnConnect:Fm,autoPanOnNodeDrag:Hm,autoPanSpeed:zm,onError:Gm,connectionRadius:$m,isValidConnection:Vm,selectNodesOnDrag:ne,nodeDragThreshold:Wm,connectionDragThreshold:Ym,onBeforeDelete:L,debug:ey,ariaLabelConfig:ty,zIndexMode:Tu}),R.jsx(i_,{onSelectionChange:M}),_m,R.jsx(Jb,{proOptions:Dm,position:Om}),R.jsx(Qb,{rfId:pr,disableKeyboardA11y:Iu})]})})}var Tx=Dg(Mx);function Px(e){const[t,r]=T.useState(e),n=T.useCallback(i=>r(o=>kg(i,o)),[]);return[t,r,n]}function kx(e){const[t,r]=T.useState(e),n=T.useCallback(i=>r(o=>Og(i,o)),[]);return[t,r,n]}function Ox({dimensions:e,lineWidth:t,variant:r,className:n}){return R.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ue(["react-flow__background-pattern",r,n])})}function Dx({radius:e,className:t}){return R.jsx("circle",{cx:e,cy:e,r:e,className:ue(["react-flow__background-pattern","dots",t])})}var Be;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Be||(Be={}));const Lx={[Be.Dots]:1,[Be.Lines]:1,[Be.Cross]:6},jx=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function av({id:e,variant:t=Be.Dots,gap:r=20,size:n,lineWidth:i=1,offset:o=0,color:a,bgColor:s,style:c,className:u,patternClassName:d}){const l=T.useRef(null),{transform:f,patternId:p}=re(jx,ie),m=n||Lx[t],v=t===Be.Dots,g=t===Be.Cross,y=Array.isArray(r)?r:[r,r],b=[y[0]*f[2]||1,y[1]*f[2]||1],h=m*f[2],_=Array.isArray(o)?o:[o,o],w=g?[h,h]:b,x=[_[0]*f[2]||1+w[0]/2,_[1]*f[2]||1+w[1]/2],E=`${p}${e||""}`;return R.jsxs("svg",{className:ue(["react-flow__background",u]),style:{...c,...Yt,"--xy-background-color-props":s,"--xy-background-pattern-color-props":a},ref:l,"data-testid":"rf__background",children:[R.jsx("pattern",{id:E,x:f[0]%b[0],y:f[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${x[0]},-${x[1]})`,children:v?R.jsx(Dx,{radius:h/2,className:d}):R.jsx(Ox,{dimensions:w,lineWidth:i,variant:t,className:d})}),R.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${E})`})]})}av.displayName="Background";const Bx=T.memo(av);function Fx(){return R.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:R.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Hx(){return R.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:R.jsx("path",{d:"M0 0h32v4.2H0z"})})}function zx(){return R.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:R.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function $x(){return R.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:R.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Vx(){return R.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:R.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Dt({children:e,className:t,...r}){return R.jsx("button",{type:"button",className:ue(["react-flow__controls-button",t]),...r,children:e})}const Gx=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function sv({style:e,showZoom:t=!0,showFitView:r=!0,showInteractive:n=!0,fitViewOptions:i,onZoomIn:o,onZoomOut:a,onFitView:s,onInteractiveChange:c,className:u,children:d,position:l="bottom-left",orientation:f="vertical","aria-label":p}){const m=oe(),{isInteractive:v,minZoomReached:g,maxZoomReached:y,ariaLabelConfig:b}=re(Gx,ie),{zoomIn:h,zoomOut:_,fitView:w}=au(),x=()=>{h(),o?.()},E=()=>{_(),a?.()},q=()=>{w(i),s?.()},S=()=>{m.setState({nodesDraggable:!v,nodesConnectable:!v,elementsSelectable:!v}),c?.(!v)},A=f==="horizontal"?"horizontal":"vertical";return R.jsxs(Wt,{className:ue(["react-flow__controls",A,u]),position:l,style:e,"data-testid":"rf__controls","aria-label":p??b["controls.ariaLabel"],children:[t&&R.jsxs(R.Fragment,{children:[R.jsx(Dt,{onClick:x,className:"react-flow__controls-zoomin",title:b["controls.zoomIn.ariaLabel"],"aria-label":b["controls.zoomIn.ariaLabel"],disabled:y,children:R.jsx(Fx,{})}),R.jsx(Dt,{onClick:E,className:"react-flow__controls-zoomout",title:b["controls.zoomOut.ariaLabel"],"aria-label":b["controls.zoomOut.ariaLabel"],disabled:g,children:R.jsx(Hx,{})})]}),r&&R.jsx(Dt,{className:"react-flow__controls-fitview",onClick:q,title:b["controls.fitView.ariaLabel"],"aria-label":b["controls.fitView.ariaLabel"],children:R.jsx(zx,{})}),n&&R.jsx(Dt,{className:"react-flow__controls-interactive",onClick:S,title:b["controls.interactive.ariaLabel"],"aria-label":b["controls.interactive.ariaLabel"],children:v?R.jsx(Vx,{}):R.jsx($x,{})}),d]})}sv.displayName="Controls";const Ux=T.memo(sv);function Wx({id:e,x:t,y:r,width:n,height:i,style:o,color:a,strokeColor:s,strokeWidth:c,className:u,borderRadius:d,shapeRendering:l,selected:f,onClick:p}){const{background:m,backgroundColor:v}=o||{},g=a||m||v;return R.jsx("rect",{className:ue(["react-flow__minimap-node",{selected:f},u]),x:t,y:r,rx:d,ry:d,width:n,height:i,style:{fill:g,stroke:s,strokeWidth:c},shapeRendering:l,onClick:p?y=>p(y,e):void 0})}const Yx=T.memo(Wx),Kx=e=>e.nodes.map(t=>t.id),wr=e=>e instanceof Function?e:()=>e;function Zx({nodeStrokeColor:e,nodeColor:t,nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:i,nodeComponent:o=Yx,onClick:a}){const s=re(Kx,ie),c=wr(t),u=wr(e),d=wr(r),l=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return R.jsx(R.Fragment,{children:s.map(f=>R.jsx(Qx,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:u,nodeClassNameFunc:d,nodeBorderRadius:n,nodeStrokeWidth:i,NodeComponent:o,onClick:a,shapeRendering:l},f))})}function Xx({id:e,nodeColorFunc:t,nodeStrokeColorFunc:r,nodeClassNameFunc:n,nodeBorderRadius:i,nodeStrokeWidth:o,shapeRendering:a,NodeComponent:s,onClick:c}){const{node:u,x:d,y:l,width:f,height:p}=re(m=>{const{internals:v}=m.nodeLookup.get(e),g=v.userNode,{x:y,y:b}=v.positionAbsolute,{width:h,height:_}=Ie(g);return{node:g,x:y,y:b,width:h,height:_}},ie);return!u||u.hidden||!sg(u)?null:R.jsx(s,{x:d,y:l,width:f,height:p,style:u.style,selected:!!u.selected,className:n(u),color:t(u),borderRadius:i,strokeColor:r(u),strokeWidth:o,shapeRendering:a,onClick:c,id:u.id})}const Qx=T.memo(Xx);var Jx=T.memo(Zx);const e0=200,t0=150,r0=e=>!e.hidden,n0=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?ag(wt(e.nodeLookup,{filter:r0}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},i0="react-flow__minimap-desc";function uv({style:e,className:t,nodeStrokeColor:r,nodeColor:n,nodeClassName:i="",nodeBorderRadius:o=5,nodeStrokeWidth:a,nodeComponent:s,bgColor:c,maskColor:u,maskStrokeColor:d,maskStrokeWidth:l,position:f="bottom-right",onClick:p,onNodeClick:m,pannable:v=!1,zoomable:g=!1,ariaLabel:y,inversePan:b,zoomStep:h=1,offsetScale:_=5}){const w=oe(),x=T.useRef(null),{boundingRect:E,viewBB:q,rfId:S,panZoom:A,translateExtent:C,flowWidth:N,flowHeight:M,ariaLabelConfig:O}=re(n0,ie),k=e?.width??e0,$=e?.height??t0,G=E.width/k,j=E.height/$,z=Math.max(G,j),L=z*k,V=z*$,H=_*z,W=E.x-(L-E.width)/2-H,I=E.y-(V-E.height)/2-H,P=L+H*2,D=V+H*2,F=`${i0}-${S}`,B=T.useRef(0),U=T.useRef();B.current=z,T.useEffect(()=>{if(x.current&&A)return U.current=xb({domNode:x.current,panZoom:A,getTransform:()=>w.getState().transform,getViewScale:()=>B.current}),()=>{U.current?.destroy()}},[A]),T.useEffect(()=>{U.current?.update({translateExtent:C,width:N,height:M,inversePan:b,pannable:v,zoomStep:h,zoomable:g})},[v,g,b,h,C,N,M]);const Z=p?Y=>{const[te,X]=U.current?.pointer(Y)||[0,0];p(Y,{x:te,y:X})}:void 0,J=m?T.useCallback((Y,te)=>{const X=w.getState().nodeLookup.get(te).internals.userNode;m(Y,X)},[]):void 0,Q=y??O["minimap.ariaLabel"];return R.jsx(Wt,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof l=="number"?l*z:void 0,"--xy-minimap-node-background-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-width-props":typeof a=="number"?a:void 0},className:ue(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:R.jsxs("svg",{width:k,height:$,viewBox:`${W} ${I} ${P} ${D}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":F,ref:x,onClick:Z,children:[Q&&R.jsx("title",{id:F,children:Q}),R.jsx(Jx,{onClick:J,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:o,nodeClassName:i,nodeStrokeWidth:a,nodeComponent:s}),R.jsx("path",{className:"react-flow__minimap-mask",d:`M${W-H},${I-H}h${P+H*2}v${D+H*2}h${-P-H*2}z
        M${q.x},${q.y}h${q.width}v${q.height}h${-q.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}uv.displayName="MiniMap";const o0=T.memo(uv),a0=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,s0={[it.Line]:"right",[it.Handle]:"bottom-right"};function u0({nodeId:e,position:t,variant:r=it.Handle,className:n,style:i=void 0,children:o,color:a,minWidth:s=10,minHeight:c=10,maxWidth:u=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:l=!1,resizeDirection:f,autoScale:p=!0,shouldResize:m,onResizeStart:v,onResize:g,onResizeEnd:y}){const b=Fg(),h=typeof e=="string"?e:b,_=oe(),w=T.useRef(null),x=r===it.Handle,E=re(T.useCallback(a0(x&&p),[x,p]),ie),q=T.useRef(null),S=t??s0[r];T.useEffect(()=>{if(!(!w.current||!h))return q.current||(q.current=Ob({domNode:w.current,nodeId:h,getStoreItems:()=>{const{nodeLookup:C,transform:N,snapGrid:M,snapToGrid:O,nodeOrigin:k,domNode:$}=_.getState();return{nodeLookup:C,transform:N,snapGrid:M,snapToGrid:O,nodeOrigin:k,paneDomNode:$}},onChange:(C,N)=>{const{triggerNodeChanges:M,nodeLookup:O,parentLookup:k,nodeOrigin:$}=_.getState(),G=[],j={x:C.x,y:C.y},z=O.get(h);if(z&&z.expandParent&&z.parentId){const L=z.origin??$,V=C.width??z.measured.width??0,H=C.height??z.measured.height??0,W={id:z.id,parentId:z.parentId,rect:{width:V,height:H,...ug({x:C.x??z.position.x,y:C.y??z.position.y},{width:V,height:H},z.parentId,O,L)}},I=ou([W],O,k,$);G.push(...I),j.x=C.x?Math.max(L[0]*V,C.x):void 0,j.y=C.y?Math.max(L[1]*H,C.y):void 0}if(j.x!==void 0&&j.y!==void 0){const L={id:h,type:"position",position:{...j}};G.push(L)}if(C.width!==void 0&&C.height!==void 0){const V={id:h,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:C.width,height:C.height}};G.push(V)}for(const L of N){const V={...L,type:"position"};G.push(V)}M(G)},onEnd:({width:C,height:N})=>{const M={id:h,type:"dimensions",resizing:!1,dimensions:{width:C,height:N}};_.getState().triggerNodeChanges([M])}})),q.current.update({controlPosition:S,boundaries:{minWidth:s,minHeight:c,maxWidth:u,maxHeight:d},keepAspectRatio:l,resizeDirection:f,onResizeStart:v,onResize:g,onResizeEnd:y,shouldResize:m}),()=>{q.current?.destroy()}},[S,s,c,u,d,l,v,g,y,m]);const A=S.split("-");return R.jsx("div",{className:ue(["react-flow__resize-control","nodrag",...A,r,n]),ref:w,style:{...i,scale:E,...a&&{[x?"backgroundColor":"borderColor"]:a}},children:o})}T.memo(u0);function uu(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Er,qc;function c0(){if(qc)return Er;qc=1;function e(){this.__data__=[],this.size=0}return Er=e,Er}var Cr,Rc;function ot(){if(Rc)return Cr;Rc=1;function e(t,r){return t===r||t!==t&&r!==r}return Cr=e,Cr}var Sr,Nc;function Zt(){if(Nc)return Sr;Nc=1;var e=ot();function t(r,n){for(var i=r.length;i--;)if(e(r[i][0],n))return i;return-1}return Sr=t,Sr}var qr,Ic;function d0(){if(Ic)return qr;Ic=1;var e=Zt(),t=Array.prototype,r=t.splice;function n(i){var o=this.__data__,a=e(o,i);if(a<0)return!1;var s=o.length-1;return a==s?o.pop():r.call(o,a,1),--this.size,!0}return qr=n,qr}var Rr,Ac;function l0(){if(Ac)return Rr;Ac=1;var e=Zt();function t(r){var n=this.__data__,i=e(n,r);return i<0?void 0:n[i][1]}return Rr=t,Rr}var Nr,Mc;function f0(){if(Mc)return Nr;Mc=1;var e=Zt();function t(r){return e(this.__data__,r)>-1}return Nr=t,Nr}var Ir,Tc;function h0(){if(Tc)return Ir;Tc=1;var e=Zt();function t(r,n){var i=this.__data__,o=e(i,r);return o<0?(++this.size,i.push([r,n])):i[o][1]=n,this}return Ir=t,Ir}var Ar,Pc;function Xt(){if(Pc)return Ar;Pc=1;var e=c0(),t=d0(),r=l0(),n=f0(),i=h0();function o(a){var s=-1,c=a==null?0:a.length;for(this.clear();++s<c;){var u=a[s];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=i,Ar=o,Ar}var Mr,kc;function p0(){if(kc)return Mr;kc=1;var e=Xt();function t(){this.__data__=new e,this.size=0}return Mr=t,Mr}var Tr,Oc;function g0(){if(Oc)return Tr;Oc=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return Tr=e,Tr}var Pr,Dc;function v0(){if(Dc)return Pr;Dc=1;function e(t){return this.__data__.get(t)}return Pr=e,Pr}var kr,Lc;function m0(){if(Lc)return kr;Lc=1;function e(t){return this.__data__.has(t)}return kr=e,kr}var Or,jc;function cv(){if(jc)return Or;jc=1;var e=typeof Tt=="object"&&Tt&&Tt.Object===Object&&Tt;return Or=e,Or}var Dr,Bc;function _e(){if(Bc)return Dr;Bc=1;var e=cv(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return Dr=r,Dr}var Lr,Fc;function at(){if(Fc)return Lr;Fc=1;var e=_e(),t=e.Symbol;return Lr=t,Lr}var jr,Hc;function y0(){if(Hc)return jr;Hc=1;var e=at(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,i=e?e.toStringTag:void 0;function o(a){var s=r.call(a,i),c=a[i];try{a[i]=void 0;var u=!0}catch{}var d=n.call(a);return u&&(s?a[i]=c:delete a[i]),d}return jr=o,jr}var Br,zc;function b0(){if(zc)return Br;zc=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Br=r,Br}var Fr,$c;function Ge(){if($c)return Fr;$c=1;var e=at(),t=y0(),r=b0(),n="[object Null]",i="[object Undefined]",o=e?e.toStringTag:void 0;function a(s){return s==null?s===void 0?i:n:o&&o in Object(s)?t(s):r(s)}return Fr=a,Fr}var Hr,Vc;function ge(){if(Vc)return Hr;Vc=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Hr=e,Hr}var zr,Gc;function St(){if(Gc)return zr;Gc=1;var e=Ge(),t=ge(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",o="[object Proxy]";function a(s){if(!t(s))return!1;var c=e(s);return c==n||c==i||c==r||c==o}return zr=a,zr}var $r,Uc;function _0(){if(Uc)return $r;Uc=1;var e=_e(),t=e["__core-js_shared__"];return $r=t,$r}var Vr,Wc;function x0(){if(Wc)return Vr;Wc=1;var e=_0(),t=(function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!t&&t in n}return Vr=r,Vr}var Gr,Yc;function dv(){if(Yc)return Gr;Yc=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Gr=r,Gr}var Ur,Kc;function w0(){if(Kc)return Ur;Kc=1;var e=St(),t=x0(),r=ge(),n=dv(),i=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,a=Function.prototype,s=Object.prototype,c=a.toString,u=s.hasOwnProperty,d=RegExp("^"+c.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function l(f){if(!r(f)||t(f))return!1;var p=e(f)?d:o;return p.test(n(f))}return Ur=l,Ur}var Wr,Zc;function E0(){if(Zc)return Wr;Zc=1;function e(t,r){return t?.[r]}return Wr=e,Wr}var Yr,Xc;function Ue(){if(Xc)return Yr;Xc=1;var e=w0(),t=E0();function r(n,i){var o=t(n,i);return e(o)?o:void 0}return Yr=r,Yr}var Kr,Qc;function cu(){if(Qc)return Kr;Qc=1;var e=Ue(),t=_e(),r=e(t,"Map");return Kr=r,Kr}var Zr,Jc;function Qt(){if(Jc)return Zr;Jc=1;var e=Ue(),t=e(Object,"create");return Zr=t,Zr}var Xr,ed;function C0(){if(ed)return Xr;ed=1;var e=Qt();function t(){this.__data__=e?e(null):{},this.size=0}return Xr=t,Xr}var Qr,td;function S0(){if(td)return Qr;td=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Qr=e,Qr}var Jr,rd;function q0(){if(rd)return Jr;rd=1;var e=Qt(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(o){var a=this.__data__;if(e){var s=a[o];return s===t?void 0:s}return n.call(a,o)?a[o]:void 0}return Jr=i,Jr}var en,nd;function R0(){if(nd)return en;nd=1;var e=Qt(),t=Object.prototype,r=t.hasOwnProperty;function n(i){var o=this.__data__;return e?o[i]!==void 0:r.call(o,i)}return en=n,en}var tn,id;function N0(){if(id)return tn;id=1;var e=Qt(),t="__lodash_hash_undefined__";function r(n,i){var o=this.__data__;return this.size+=this.has(n)?0:1,o[n]=e&&i===void 0?t:i,this}return tn=r,tn}var rn,od;function I0(){if(od)return rn;od=1;var e=C0(),t=S0(),r=q0(),n=R0(),i=N0();function o(a){var s=-1,c=a==null?0:a.length;for(this.clear();++s<c;){var u=a[s];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=i,rn=o,rn}var nn,ad;function A0(){if(ad)return nn;ad=1;var e=I0(),t=Xt(),r=cu();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return nn=n,nn}var on,sd;function M0(){if(sd)return on;sd=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return on=e,on}var an,ud;function Jt(){if(ud)return an;ud=1;var e=M0();function t(r,n){var i=r.__data__;return e(n)?i[typeof n=="string"?"string":"hash"]:i.map}return an=t,an}var sn,cd;function T0(){if(cd)return sn;cd=1;var e=Jt();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return sn=t,sn}var un,dd;function P0(){if(dd)return un;dd=1;var e=Jt();function t(r){return e(this,r).get(r)}return un=t,un}var cn,ld;function k0(){if(ld)return cn;ld=1;var e=Jt();function t(r){return e(this,r).has(r)}return cn=t,cn}var dn,fd;function O0(){if(fd)return dn;fd=1;var e=Jt();function t(r,n){var i=e(this,r),o=i.size;return i.set(r,n),this.size+=i.size==o?0:1,this}return dn=t,dn}var ln,hd;function du(){if(hd)return ln;hd=1;var e=A0(),t=T0(),r=P0(),n=k0(),i=O0();function o(a){var s=-1,c=a==null?0:a.length;for(this.clear();++s<c;){var u=a[s];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=i,ln=o,ln}var fn,pd;function D0(){if(pd)return fn;pd=1;var e=Xt(),t=cu(),r=du(),n=200;function i(o,a){var s=this.__data__;if(s instanceof e){var c=s.__data__;if(!t||c.length<n-1)return c.push([o,a]),this.size=++s.size,this;s=this.__data__=new r(c)}return s.set(o,a),this.size=s.size,this}return fn=i,fn}var hn,gd;function er(){if(gd)return hn;gd=1;var e=Xt(),t=p0(),r=g0(),n=v0(),i=m0(),o=D0();function a(s){var c=this.__data__=new e(s);this.size=c.size}return a.prototype.clear=t,a.prototype.delete=r,a.prototype.get=n,a.prototype.has=i,a.prototype.set=o,hn=a,hn}var pn,vd;function lu(){if(vd)return pn;vd=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i&&r(t[n],n,t)!==!1;);return t}return pn=e,pn}var gn,md;function lv(){if(md)return gn;md=1;var e=Ue(),t=(function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}})();return gn=t,gn}var vn,yd;function tr(){if(yd)return vn;yd=1;var e=lv();function t(r,n,i){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return vn=t,vn}var mn,bd;function rr(){if(bd)return mn;bd=1;var e=tr(),t=ot(),r=Object.prototype,n=r.hasOwnProperty;function i(o,a,s){var c=o[a];(!(n.call(o,a)&&t(c,s))||s===void 0&&!(a in o))&&e(o,a,s)}return mn=i,mn}var yn,_d;function qt(){if(_d)return yn;_d=1;var e=rr(),t=tr();function r(n,i,o,a){var s=!o;o||(o={});for(var c=-1,u=i.length;++c<u;){var d=i[c],l=a?a(o[d],n[d],d,o,n):void 0;l===void 0&&(l=n[d]),s?t(o,d,l):e(o,d,l)}return o}return yn=r,yn}var bn,xd;function L0(){if(xd)return bn;xd=1;function e(t,r){for(var n=-1,i=Array(t);++n<t;)i[n]=r(n);return i}return bn=e,bn}var _n,wd;function Ce(){if(wd)return _n;wd=1;function e(t){return t!=null&&typeof t=="object"}return _n=e,_n}var xn,Ed;function j0(){if(Ed)return xn;Ed=1;var e=Ge(),t=Ce(),r="[object Arguments]";function n(i){return t(i)&&e(i)==r}return xn=n,xn}var wn,Cd;function Rt(){if(Cd)return wn;Cd=1;var e=j0(),t=Ce(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,o=e((function(){return arguments})())?e:function(a){return t(a)&&n.call(a,"callee")&&!i.call(a,"callee")};return wn=o,wn}var En,Sd;function ce(){if(Sd)return En;Sd=1;var e=Array.isArray;return En=e,En}var dt={exports:{}},Cn,qd;function B0(){if(qd)return Cn;qd=1;function e(){return!1}return Cn=e,Cn}dt.exports;var Rd;function st(){return Rd||(Rd=1,(function(e,t){var r=_e(),n=B0(),i=t&&!t.nodeType&&t,o=i&&!0&&e&&!e.nodeType&&e,a=o&&o.exports===i,s=a?r.Buffer:void 0,c=s?s.isBuffer:void 0,u=c||n;e.exports=u})(dt,dt.exports)),dt.exports}var Sn,Nd;function nr(){if(Nd)return Sn;Nd=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,i){var o=typeof n;return i=i??e,!!i&&(o=="number"||o!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}return Sn=r,Sn}var qn,Id;function fu(){if(Id)return qn;Id=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return qn=t,qn}var Rn,Ad;function F0(){if(Ad)return Rn;Ad=1;var e=Ge(),t=fu(),r=Ce(),n="[object Arguments]",i="[object Array]",o="[object Boolean]",a="[object Date]",s="[object Error]",c="[object Function]",u="[object Map]",d="[object Number]",l="[object Object]",f="[object RegExp]",p="[object Set]",m="[object String]",v="[object WeakMap]",g="[object ArrayBuffer]",y="[object DataView]",b="[object Float32Array]",h="[object Float64Array]",_="[object Int8Array]",w="[object Int16Array]",x="[object Int32Array]",E="[object Uint8Array]",q="[object Uint8ClampedArray]",S="[object Uint16Array]",A="[object Uint32Array]",C={};C[b]=C[h]=C[_]=C[w]=C[x]=C[E]=C[q]=C[S]=C[A]=!0,C[n]=C[i]=C[g]=C[o]=C[y]=C[a]=C[s]=C[c]=C[u]=C[d]=C[l]=C[f]=C[p]=C[m]=C[v]=!1;function N(M){return r(M)&&t(M.length)&&!!C[e(M)]}return Rn=N,Rn}var Nn,Md;function ir(){if(Md)return Nn;Md=1;function e(t){return function(r){return t(r)}}return Nn=e,Nn}var lt={exports:{}};lt.exports;var Td;function hu(){return Td||(Td=1,(function(e,t){var r=cv(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===n,a=o&&r.process,s=(function(){try{var c=i&&i.require&&i.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}})();e.exports=s})(lt,lt.exports)),lt.exports}var In,Pd;function Nt(){if(Pd)return In;Pd=1;var e=F0(),t=ir(),r=hu(),n=r&&r.isTypedArray,i=n?t(n):e;return In=i,In}var An,kd;function fv(){if(kd)return An;kd=1;var e=L0(),t=Rt(),r=ce(),n=st(),i=nr(),o=Nt(),a=Object.prototype,s=a.hasOwnProperty;function c(u,d){var l=r(u),f=!l&&t(u),p=!l&&!f&&n(u),m=!l&&!f&&!p&&o(u),v=l||f||p||m,g=v?e(u.length,String):[],y=g.length;for(var b in u)(d||s.call(u,b))&&!(v&&(b=="length"||p&&(b=="offset"||b=="parent")||m&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||i(b,y)))&&g.push(b);return g}return An=c,An}var Mn,Od;function or(){if(Od)return Mn;Od=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||e;return r===i}return Mn=t,Mn}var Tn,Dd;function hv(){if(Dd)return Tn;Dd=1;function e(t,r){return function(n){return t(r(n))}}return Tn=e,Tn}var Pn,Ld;function H0(){if(Ld)return Pn;Ld=1;var e=hv(),t=e(Object.keys,Object);return Pn=t,Pn}var kn,jd;function pu(){if(jd)return kn;jd=1;var e=or(),t=H0(),r=Object.prototype,n=r.hasOwnProperty;function i(o){if(!e(o))return t(o);var a=[];for(var s in Object(o))n.call(o,s)&&s!="constructor"&&a.push(s);return a}return kn=i,kn}var On,Bd;function Ae(){if(Bd)return On;Bd=1;var e=St(),t=fu();function r(n){return n!=null&&t(n.length)&&!e(n)}return On=r,On}var Dn,Fd;function Fe(){if(Fd)return Dn;Fd=1;var e=fv(),t=pu(),r=Ae();function n(i){return r(i)?e(i):t(i)}return Dn=n,Dn}var Ln,Hd;function z0(){if(Hd)return Ln;Hd=1;var e=qt(),t=Fe();function r(n,i){return n&&e(i,t(i),n)}return Ln=r,Ln}var jn,zd;function $0(){if(zd)return jn;zd=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return jn=e,jn}var Bn,$d;function V0(){if($d)return Bn;$d=1;var e=ge(),t=or(),r=$0(),n=Object.prototype,i=n.hasOwnProperty;function o(a){if(!e(a))return r(a);var s=t(a),c=[];for(var u in a)u=="constructor"&&(s||!i.call(a,u))||c.push(u);return c}return Bn=o,Bn}var Fn,Vd;function We(){if(Vd)return Fn;Vd=1;var e=fv(),t=V0(),r=Ae();function n(i){return r(i)?e(i,!0):t(i)}return Fn=n,Fn}var Hn,Gd;function G0(){if(Gd)return Hn;Gd=1;var e=qt(),t=We();function r(n,i){return n&&e(i,t(i),n)}return Hn=r,Hn}var ft={exports:{}};ft.exports;var Ud;function pv(){return Ud||(Ud=1,(function(e,t){var r=_e(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===n,a=o?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;function c(u,d){if(d)return u.slice();var l=u.length,f=s?s(l):new u.constructor(l);return u.copy(f),f}e.exports=c})(ft,ft.exports)),ft.exports}var zn,Wd;function gv(){if(Wd)return zn;Wd=1;function e(t,r){var n=-1,i=t.length;for(r||(r=Array(i));++n<i;)r[n]=t[n];return r}return zn=e,zn}var $n,Yd;function vv(){if(Yd)return $n;Yd=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,o=0,a=[];++n<i;){var s=t[n];r(s,n,t)&&(a[o++]=s)}return a}return $n=e,$n}var Vn,Kd;function mv(){if(Kd)return Vn;Kd=1;function e(){return[]}return Vn=e,Vn}var Gn,Zd;function gu(){if(Zd)return Gn;Zd=1;var e=vv(),t=mv(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,o=i?function(a){return a==null?[]:(a=Object(a),e(i(a),function(s){return n.call(a,s)}))}:t;return Gn=o,Gn}var Un,Xd;function U0(){if(Xd)return Un;Xd=1;var e=qt(),t=gu();function r(n,i){return e(n,t(n),i)}return Un=r,Un}var Wn,Qd;function vu(){if(Qd)return Wn;Qd=1;function e(t,r){for(var n=-1,i=r.length,o=t.length;++n<i;)t[o+n]=r[n];return t}return Wn=e,Wn}var Yn,Jd;function ar(){if(Jd)return Yn;Jd=1;var e=hv(),t=e(Object.getPrototypeOf,Object);return Yn=t,Yn}var Kn,el;function yv(){if(el)return Kn;el=1;var e=vu(),t=ar(),r=gu(),n=mv(),i=Object.getOwnPropertySymbols,o=i?function(a){for(var s=[];a;)e(s,r(a)),a=t(a);return s}:n;return Kn=o,Kn}var Zn,tl;function W0(){if(tl)return Zn;tl=1;var e=qt(),t=yv();function r(n,i){return e(n,t(n),i)}return Zn=r,Zn}var Xn,rl;function bv(){if(rl)return Xn;rl=1;var e=vu(),t=ce();function r(n,i,o){var a=i(n);return t(n)?a:e(a,o(n))}return Xn=r,Xn}var Qn,nl;function _v(){if(nl)return Qn;nl=1;var e=bv(),t=gu(),r=Fe();function n(i){return e(i,r,t)}return Qn=n,Qn}var Jn,il;function Y0(){if(il)return Jn;il=1;var e=bv(),t=yv(),r=We();function n(i){return e(i,r,t)}return Jn=n,Jn}var ei,ol;function K0(){if(ol)return ei;ol=1;var e=Ue(),t=_e(),r=e(t,"DataView");return ei=r,ei}var ti,al;function Z0(){if(al)return ti;al=1;var e=Ue(),t=_e(),r=e(t,"Promise");return ti=r,ti}var ri,sl;function xv(){if(sl)return ri;sl=1;var e=Ue(),t=_e(),r=e(t,"Set");return ri=r,ri}var ni,ul;function X0(){if(ul)return ni;ul=1;var e=Ue(),t=_e(),r=e(t,"WeakMap");return ni=r,ni}var ii,cl;function ut(){if(cl)return ii;cl=1;var e=K0(),t=cu(),r=Z0(),n=xv(),i=X0(),o=Ge(),a=dv(),s="[object Map]",c="[object Object]",u="[object Promise]",d="[object Set]",l="[object WeakMap]",f="[object DataView]",p=a(e),m=a(t),v=a(r),g=a(n),y=a(i),b=o;return(e&&b(new e(new ArrayBuffer(1)))!=f||t&&b(new t)!=s||r&&b(r.resolve())!=u||n&&b(new n)!=d||i&&b(new i)!=l)&&(b=function(h){var _=o(h),w=_==c?h.constructor:void 0,x=w?a(w):"";if(x)switch(x){case p:return f;case m:return s;case v:return u;case g:return d;case y:return l}return _}),ii=b,ii}var oi,dl;function Q0(){if(dl)return oi;dl=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var i=n.length,o=new n.constructor(i);return i&&typeof n[0]=="string"&&t.call(n,"index")&&(o.index=n.index,o.input=n.input),o}return oi=r,oi}var ai,ll;function wv(){if(ll)return ai;ll=1;var e=_e(),t=e.Uint8Array;return ai=t,ai}var si,fl;function mu(){if(fl)return si;fl=1;var e=wv();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return si=t,si}var ui,hl;function J0(){if(hl)return ui;hl=1;var e=mu();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return ui=t,ui}var ci,pl;function ew(){if(pl)return ci;pl=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return ci=t,ci}var di,gl;function tw(){if(gl)return di;gl=1;var e=at(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return di=n,di}var li,vl;function Ev(){if(vl)return li;vl=1;var e=mu();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return li=t,li}var fi,ml;function rw(){if(ml)return fi;ml=1;var e=mu(),t=J0(),r=ew(),n=tw(),i=Ev(),o="[object Boolean]",a="[object Date]",s="[object Map]",c="[object Number]",u="[object RegExp]",d="[object Set]",l="[object String]",f="[object Symbol]",p="[object ArrayBuffer]",m="[object DataView]",v="[object Float32Array]",g="[object Float64Array]",y="[object Int8Array]",b="[object Int16Array]",h="[object Int32Array]",_="[object Uint8Array]",w="[object Uint8ClampedArray]",x="[object Uint16Array]",E="[object Uint32Array]";function q(S,A,C){var N=S.constructor;switch(A){case p:return e(S);case o:case a:return new N(+S);case m:return t(S,C);case v:case g:case y:case b:case h:case _:case w:case x:case E:return i(S,C);case s:return new N;case c:case l:return new N(S);case u:return r(S);case d:return new N;case f:return n(S)}}return fi=q,fi}var hi,yl;function Cv(){if(yl)return hi;yl=1;var e=ge(),t=Object.create,r=(function(){function n(){}return function(i){if(!e(i))return{};if(t)return t(i);n.prototype=i;var o=new n;return n.prototype=void 0,o}})();return hi=r,hi}var pi,bl;function Sv(){if(bl)return pi;bl=1;var e=Cv(),t=ar(),r=or();function n(i){return typeof i.constructor=="function"&&!r(i)?e(t(i)):{}}return pi=n,pi}var gi,_l;function nw(){if(_l)return gi;_l=1;var e=ut(),t=Ce(),r="[object Map]";function n(i){return t(i)&&e(i)==r}return gi=n,gi}var vi,xl;function iw(){if(xl)return vi;xl=1;var e=nw(),t=ir(),r=hu(),n=r&&r.isMap,i=n?t(n):e;return vi=i,vi}var mi,wl;function ow(){if(wl)return mi;wl=1;var e=ut(),t=Ce(),r="[object Set]";function n(i){return t(i)&&e(i)==r}return mi=n,mi}var yi,El;function aw(){if(El)return yi;El=1;var e=ow(),t=ir(),r=hu(),n=r&&r.isSet,i=n?t(n):e;return yi=i,yi}var bi,Cl;function qv(){if(Cl)return bi;Cl=1;var e=er(),t=lu(),r=rr(),n=z0(),i=G0(),o=pv(),a=gv(),s=U0(),c=W0(),u=_v(),d=Y0(),l=ut(),f=Q0(),p=rw(),m=Sv(),v=ce(),g=st(),y=iw(),b=ge(),h=aw(),_=Fe(),w=We(),x=1,E=2,q=4,S="[object Arguments]",A="[object Array]",C="[object Boolean]",N="[object Date]",M="[object Error]",O="[object Function]",k="[object GeneratorFunction]",$="[object Map]",G="[object Number]",j="[object Object]",z="[object RegExp]",L="[object Set]",V="[object String]",H="[object Symbol]",W="[object WeakMap]",I="[object ArrayBuffer]",P="[object DataView]",D="[object Float32Array]",F="[object Float64Array]",B="[object Int8Array]",U="[object Int16Array]",Z="[object Int32Array]",J="[object Uint8Array]",Q="[object Uint8ClampedArray]",Y="[object Uint16Array]",te="[object Uint32Array]",X={};X[S]=X[A]=X[I]=X[P]=X[C]=X[N]=X[D]=X[F]=X[B]=X[U]=X[Z]=X[$]=X[G]=X[j]=X[z]=X[L]=X[V]=X[H]=X[J]=X[Q]=X[Y]=X[te]=!0,X[M]=X[O]=X[W]=!1;function ne(ee,le,de,Se,xe,fe){var se,Te=le&x,qe=le&E,Pe=le&q;if(de&&(se=xe?de(ee,Se,xe,fe):de(ee)),se!==void 0)return se;if(!b(ee))return ee;var ke=v(ee);if(ke){if(se=f(ee),!Te)return a(ee,se)}else{var Re=l(ee),At=Re==O||Re==k;if(g(ee))return o(ee,Te);if(Re==j||Re==S||At&&!xe){if(se=qe||At?{}:m(ee),!Te)return qe?c(ee,i(se,ee)):s(ee,n(se,ee))}else{if(!X[Re])return xe?ee:{};se=p(ee,Re,Te)}}fe||(fe=new e);var Ke=fe.get(ee);if(Ke)return Ke;fe.set(ee,se),h(ee)?ee.forEach(function(we){se.add(ne(we,le,de,we,ee,fe))}):y(ee)&&ee.forEach(function(we,Ne){se.set(Ne,ne(we,le,de,Ne,ee,fe))});var hr=Pe?qe?d:u:qe?w:_,Mt=ke?void 0:hr(ee);return t(Mt||ee,function(we,Ne){Mt&&(Ne=we,we=ee[Ne]),r(se,Ne,ne(we,le,de,Ne,ee,fe))}),se}return bi=ne,bi}var _i,Sl;function sw(){if(Sl)return _i;Sl=1;var e=qv(),t=4;function r(n){return e(n,t)}return _i=r,_i}var xi,ql;function yu(){if(ql)return xi;ql=1;function e(t){return function(){return t}}return xi=e,xi}var wi,Rl;function uw(){if(Rl)return wi;Rl=1;function e(t){return function(r,n,i){for(var o=-1,a=Object(r),s=i(r),c=s.length;c--;){var u=s[t?c:++o];if(n(a[u],u,a)===!1)break}return r}}return wi=e,wi}var Ei,Nl;function bu(){if(Nl)return Ei;Nl=1;var e=uw(),t=e();return Ei=t,Ei}var Ci,Il;function _u(){if(Il)return Ci;Il=1;var e=bu(),t=Fe();function r(n,i){return n&&e(n,i,t)}return Ci=r,Ci}var Si,Al;function cw(){if(Al)return Si;Al=1;var e=Ae();function t(r,n){return function(i,o){if(i==null)return i;if(!e(i))return r(i,o);for(var a=i.length,s=n?a:-1,c=Object(i);(n?s--:++s<a)&&o(c[s],s,c)!==!1;);return i}}return Si=t,Si}var qi,Ml;function sr(){if(Ml)return qi;Ml=1;var e=_u(),t=cw(),r=t(e);return qi=r,qi}var Ri,Tl;function Ye(){if(Tl)return Ri;Tl=1;function e(t){return t}return Ri=e,Ri}var Ni,Pl;function Rv(){if(Pl)return Ni;Pl=1;var e=Ye();function t(r){return typeof r=="function"?r:e}return Ni=t,Ni}var Ii,kl;function Nv(){if(kl)return Ii;kl=1;var e=lu(),t=sr(),r=Rv(),n=ce();function i(o,a){var s=n(o)?e:t;return s(o,r(a))}return Ii=i,Ii}var Ai,Ol;function Iv(){return Ol||(Ol=1,Ai=Nv()),Ai}var Mi,Dl;function dw(){if(Dl)return Mi;Dl=1;var e=sr();function t(r,n){var i=[];return e(r,function(o,a,s){n(o,a,s)&&i.push(o)}),i}return Mi=t,Mi}var Ti,Ll;function lw(){if(Ll)return Ti;Ll=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return Ti=t,Ti}var Pi,jl;function fw(){if(jl)return Pi;jl=1;function e(t){return this.__data__.has(t)}return Pi=e,Pi}var ki,Bl;function Av(){if(Bl)return ki;Bl=1;var e=du(),t=lw(),r=fw();function n(i){var o=-1,a=i==null?0:i.length;for(this.__data__=new e;++o<a;)this.add(i[o])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,ki=n,ki}var Oi,Fl;function hw(){if(Fl)return Oi;Fl=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(t[n],n,t))return!0;return!1}return Oi=e,Oi}var Di,Hl;function Mv(){if(Hl)return Di;Hl=1;function e(t,r){return t.has(r)}return Di=e,Di}var Li,zl;function Tv(){if(zl)return Li;zl=1;var e=Av(),t=hw(),r=Mv(),n=1,i=2;function o(a,s,c,u,d,l){var f=c&n,p=a.length,m=s.length;if(p!=m&&!(f&&m>p))return!1;var v=l.get(a),g=l.get(s);if(v&&g)return v==s&&g==a;var y=-1,b=!0,h=c&i?new e:void 0;for(l.set(a,s),l.set(s,a);++y<p;){var _=a[y],w=s[y];if(u)var x=f?u(w,_,y,s,a,l):u(_,w,y,a,s,l);if(x!==void 0){if(x)continue;b=!1;break}if(h){if(!t(s,function(E,q){if(!r(h,q)&&(_===E||d(_,E,c,u,l)))return h.push(q)})){b=!1;break}}else if(!(_===w||d(_,w,c,u,l))){b=!1;break}}return l.delete(a),l.delete(s),b}return Li=o,Li}var ji,$l;function pw(){if($l)return ji;$l=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i,o){n[++r]=[o,i]}),n}return ji=e,ji}var Bi,Vl;function xu(){if(Vl)return Bi;Vl=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i){n[++r]=i}),n}return Bi=e,Bi}var Fi,Gl;function gw(){if(Gl)return Fi;Gl=1;var e=at(),t=wv(),r=ot(),n=Tv(),i=pw(),o=xu(),a=1,s=2,c="[object Boolean]",u="[object Date]",d="[object Error]",l="[object Map]",f="[object Number]",p="[object RegExp]",m="[object Set]",v="[object String]",g="[object Symbol]",y="[object ArrayBuffer]",b="[object DataView]",h=e?e.prototype:void 0,_=h?h.valueOf:void 0;function w(x,E,q,S,A,C,N){switch(q){case b:if(x.byteLength!=E.byteLength||x.byteOffset!=E.byteOffset)return!1;x=x.buffer,E=E.buffer;case y:return!(x.byteLength!=E.byteLength||!C(new t(x),new t(E)));case c:case u:case f:return r(+x,+E);case d:return x.name==E.name&&x.message==E.message;case p:case v:return x==E+"";case l:var M=i;case m:var O=S&a;if(M||(M=o),x.size!=E.size&&!O)return!1;var k=N.get(x);if(k)return k==E;S|=s,N.set(x,E);var $=n(M(x),M(E),S,A,C,N);return N.delete(x),$;case g:if(_)return _.call(x)==_.call(E)}return!1}return Fi=w,Fi}var Hi,Ul;function vw(){if(Ul)return Hi;Ul=1;var e=_v(),t=1,r=Object.prototype,n=r.hasOwnProperty;function i(o,a,s,c,u,d){var l=s&t,f=e(o),p=f.length,m=e(a),v=m.length;if(p!=v&&!l)return!1;for(var g=p;g--;){var y=f[g];if(!(l?y in a:n.call(a,y)))return!1}var b=d.get(o),h=d.get(a);if(b&&h)return b==a&&h==o;var _=!0;d.set(o,a),d.set(a,o);for(var w=l;++g<p;){y=f[g];var x=o[y],E=a[y];if(c)var q=l?c(E,x,y,a,o,d):c(x,E,y,o,a,d);if(!(q===void 0?x===E||u(x,E,s,c,d):q)){_=!1;break}w||(w=y=="constructor")}if(_&&!w){var S=o.constructor,A=a.constructor;S!=A&&"constructor"in o&&"constructor"in a&&!(typeof S=="function"&&S instanceof S&&typeof A=="function"&&A instanceof A)&&(_=!1)}return d.delete(o),d.delete(a),_}return Hi=i,Hi}var zi,Wl;function mw(){if(Wl)return zi;Wl=1;var e=er(),t=Tv(),r=gw(),n=vw(),i=ut(),o=ce(),a=st(),s=Nt(),c=1,u="[object Arguments]",d="[object Array]",l="[object Object]",f=Object.prototype,p=f.hasOwnProperty;function m(v,g,y,b,h,_){var w=o(v),x=o(g),E=w?d:i(v),q=x?d:i(g);E=E==u?l:E,q=q==u?l:q;var S=E==l,A=q==l,C=E==q;if(C&&a(v)){if(!a(g))return!1;w=!0,S=!1}if(C&&!S)return _||(_=new e),w||s(v)?t(v,g,y,b,h,_):r(v,g,E,y,b,h,_);if(!(y&c)){var N=S&&p.call(v,"__wrapped__"),M=A&&p.call(g,"__wrapped__");if(N||M){var O=N?v.value():v,k=M?g.value():g;return _||(_=new e),h(O,k,y,b,_)}}return C?(_||(_=new e),n(v,g,y,b,h,_)):!1}return zi=m,zi}var $i,Yl;function Pv(){if(Yl)return $i;Yl=1;var e=mw(),t=Ce();function r(n,i,o,a,s){return n===i?!0:n==null||i==null||!t(n)&&!t(i)?n!==n&&i!==i:e(n,i,o,a,r,s)}return $i=r,$i}var Vi,Kl;function yw(){if(Kl)return Vi;Kl=1;var e=er(),t=Pv(),r=1,n=2;function i(o,a,s,c){var u=s.length,d=u,l=!c;if(o==null)return!d;for(o=Object(o);u--;){var f=s[u];if(l&&f[2]?f[1]!==o[f[0]]:!(f[0]in o))return!1}for(;++u<d;){f=s[u];var p=f[0],m=o[p],v=f[1];if(l&&f[2]){if(m===void 0&&!(p in o))return!1}else{var g=new e;if(c)var y=c(m,v,p,o,a,g);if(!(y===void 0?t(v,m,r|n,c,g):y))return!1}}return!0}return Vi=i,Vi}var Gi,Zl;function kv(){if(Zl)return Gi;Zl=1;var e=ge();function t(r){return r===r&&!e(r)}return Gi=t,Gi}var Ui,Xl;function bw(){if(Xl)return Ui;Xl=1;var e=kv(),t=Fe();function r(n){for(var i=t(n),o=i.length;o--;){var a=i[o],s=n[a];i[o]=[a,s,e(s)]}return i}return Ui=r,Ui}var Wi,Ql;function Ov(){if(Ql)return Wi;Ql=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Wi=e,Wi}var Yi,Jl;function _w(){if(Jl)return Yi;Jl=1;var e=yw(),t=bw(),r=Ov();function n(i){var o=t(i);return o.length==1&&o[0][2]?r(o[0][0],o[0][1]):function(a){return a===i||e(a,i,o)}}return Yi=n,Yi}var Ki,ef;function ct(){if(ef)return Ki;ef=1;var e=Ge(),t=Ce(),r="[object Symbol]";function n(i){return typeof i=="symbol"||t(i)&&e(i)==r}return Ki=n,Ki}var Zi,tf;function wu(){if(tf)return Zi;tf=1;var e=ce(),t=ct(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(o,a){if(e(o))return!1;var s=typeof o;return s=="number"||s=="symbol"||s=="boolean"||o==null||t(o)?!0:n.test(o)||!r.test(o)||a!=null&&o in Object(a)}return Zi=i,Zi}var Xi,rf;function xw(){if(rf)return Xi;rf=1;var e=du(),t="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var o=function(){var a=arguments,s=i?i.apply(this,a):a[0],c=o.cache;if(c.has(s))return c.get(s);var u=n.apply(this,a);return o.cache=c.set(s,u)||c,u};return o.cache=new(r.Cache||e),o}return r.Cache=e,Xi=r,Xi}var Qi,nf;function ww(){if(nf)return Qi;nf=1;var e=xw(),t=500;function r(n){var i=e(n,function(a){return o.size===t&&o.clear(),a}),o=i.cache;return i}return Qi=r,Qi}var Ji,of;function Ew(){if(of)return Ji;of=1;var e=ww(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(i){var o=[];return i.charCodeAt(0)===46&&o.push(""),i.replace(t,function(a,s,c,u){o.push(c?u.replace(r,"$1"):s||a)}),o});return Ji=n,Ji}var eo,af;function ur(){if(af)return eo;af=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,o=Array(i);++n<i;)o[n]=r(t[n],n,t);return o}return eo=e,eo}var to,sf;function Cw(){if(sf)return to;sf=1;var e=at(),t=ur(),r=ce(),n=ct(),i=e?e.prototype:void 0,o=i?i.toString:void 0;function a(s){if(typeof s=="string")return s;if(r(s))return t(s,a)+"";if(n(s))return o?o.call(s):"";var c=s+"";return c=="0"&&1/s==-1/0?"-0":c}return to=a,to}var ro,uf;function Dv(){if(uf)return ro;uf=1;var e=Cw();function t(r){return r==null?"":e(r)}return ro=t,ro}var no,cf;function cr(){if(cf)return no;cf=1;var e=ce(),t=wu(),r=Ew(),n=Dv();function i(o,a){return e(o)?o:t(o,a)?[o]:r(n(o))}return no=i,no}var io,df;function It(){if(df)return io;df=1;var e=ct();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return io=t,io}var oo,lf;function dr(){if(lf)return oo;lf=1;var e=cr(),t=It();function r(n,i){i=e(i,n);for(var o=0,a=i.length;n!=null&&o<a;)n=n[t(i[o++])];return o&&o==a?n:void 0}return oo=r,oo}var ao,ff;function Sw(){if(ff)return ao;ff=1;var e=dr();function t(r,n,i){var o=r==null?void 0:e(r,n);return o===void 0?i:o}return ao=t,ao}var so,hf;function qw(){if(hf)return so;hf=1;function e(t,r){return t!=null&&r in Object(t)}return so=e,so}var uo,pf;function Lv(){if(pf)return uo;pf=1;var e=cr(),t=Rt(),r=ce(),n=nr(),i=fu(),o=It();function a(s,c,u){c=e(c,s);for(var d=-1,l=c.length,f=!1;++d<l;){var p=o(c[d]);if(!(f=s!=null&&u(s,p)))break;s=s[p]}return f||++d!=l?f:(l=s==null?0:s.length,!!l&&i(l)&&n(p,l)&&(r(s)||t(s)))}return uo=a,uo}var co,gf;function jv(){if(gf)return co;gf=1;var e=qw(),t=Lv();function r(n,i){return n!=null&&t(n,i,e)}return co=r,co}var lo,vf;function Rw(){if(vf)return lo;vf=1;var e=Pv(),t=Sw(),r=jv(),n=wu(),i=kv(),o=Ov(),a=It(),s=1,c=2;function u(d,l){return n(d)&&i(l)?o(a(d),l):function(f){var p=t(f,d);return p===void 0&&p===l?r(f,d):e(l,p,s|c)}}return lo=u,lo}var fo,mf;function Bv(){if(mf)return fo;mf=1;function e(t){return function(r){return r?.[t]}}return fo=e,fo}var ho,yf;function Nw(){if(yf)return ho;yf=1;var e=dr();function t(r){return function(n){return e(n,r)}}return ho=t,ho}var po,bf;function Iw(){if(bf)return po;bf=1;var e=Bv(),t=Nw(),r=wu(),n=It();function i(o){return r(o)?e(n(o)):t(o)}return po=i,po}var go,_f;function Me(){if(_f)return go;_f=1;var e=_w(),t=Rw(),r=Ye(),n=ce(),i=Iw();function o(a){return typeof a=="function"?a:a==null?r:typeof a=="object"?n(a)?t(a[0],a[1]):e(a):i(a)}return go=o,go}var vo,xf;function Fv(){if(xf)return vo;xf=1;var e=vv(),t=dw(),r=Me(),n=ce();function i(o,a){var s=n(o)?e:t;return s(o,r(a,3))}return vo=i,vo}var mo,wf;function Aw(){if(wf)return mo;wf=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,i){return n!=null&&t.call(n,i)}return mo=r,mo}var yo,Ef;function Hv(){if(Ef)return yo;Ef=1;var e=Aw(),t=Lv();function r(n,i){return n!=null&&t(n,i,e)}return yo=r,yo}var bo,Cf;function Mw(){if(Cf)return bo;Cf=1;var e=pu(),t=ut(),r=Rt(),n=ce(),i=Ae(),o=st(),a=or(),s=Nt(),c="[object Map]",u="[object Set]",d=Object.prototype,l=d.hasOwnProperty;function f(p){if(p==null)return!0;if(i(p)&&(n(p)||typeof p=="string"||typeof p.splice=="function"||o(p)||s(p)||r(p)))return!p.length;var m=t(p);if(m==c||m==u)return!p.size;if(a(p))return!e(p).length;for(var v in p)if(l.call(p,v))return!1;return!0}return bo=f,bo}var _o,Sf;function zv(){if(Sf)return _o;Sf=1;function e(t){return t===void 0}return _o=e,_o}var xo,qf;function $v(){if(qf)return xo;qf=1;var e=sr(),t=Ae();function r(n,i){var o=-1,a=t(n)?Array(n.length):[];return e(n,function(s,c,u){a[++o]=i(s,c,u)}),a}return xo=r,xo}var wo,Rf;function Vv(){if(Rf)return wo;Rf=1;var e=ur(),t=Me(),r=$v(),n=ce();function i(o,a){var s=n(o)?e:r;return s(o,t(a,3))}return wo=i,wo}var Eo,Nf;function Tw(){if(Nf)return Eo;Nf=1;function e(t,r,n,i){var o=-1,a=t==null?0:t.length;for(i&&a&&(n=t[++o]);++o<a;)n=r(n,t[o],o,t);return n}return Eo=e,Eo}var Co,If;function Pw(){if(If)return Co;If=1;function e(t,r,n,i,o){return o(t,function(a,s,c){n=i?(i=!1,a):r(n,a,s,c)}),n}return Co=e,Co}var So,Af;function Gv(){if(Af)return So;Af=1;var e=Tw(),t=sr(),r=Me(),n=Pw(),i=ce();function o(a,s,c){var u=i(a)?e:n,d=arguments.length<3;return u(a,r(s,4),c,d,t)}return So=o,So}var qo,Mf;function kw(){if(Mf)return qo;Mf=1;var e=Ge(),t=ce(),r=Ce(),n="[object String]";function i(o){return typeof o=="string"||!t(o)&&r(o)&&e(o)==n}return qo=i,qo}var Ro,Tf;function Ow(){if(Tf)return Ro;Tf=1;var e=Bv(),t=e("length");return Ro=t,Ro}var No,Pf;function Dw(){if(Pf)return No;Pf=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,o="\\ufe0e\\ufe0f",a="\\u200d",s=RegExp("["+a+e+i+o+"]");function c(u){return s.test(u)}return No=c,No}var Io,kf;function Lw(){if(kf)return Io;kf=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,o="\\ufe0e\\ufe0f",a="["+e+"]",s="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",u="(?:"+s+"|"+c+")",d="[^"+e+"]",l="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",p="\\u200d",m=u+"?",v="["+o+"]?",g="(?:"+p+"(?:"+[d,l,f].join("|")+")"+v+m+")*",y=v+m+g,b="(?:"+[d+s+"?",s,l,f,a].join("|")+")",h=RegExp(c+"(?="+c+")|"+b+y,"g");function _(w){for(var x=h.lastIndex=0;h.test(w);)++x;return x}return Io=_,Io}var Ao,Of;function jw(){if(Of)return Ao;Of=1;var e=Ow(),t=Dw(),r=Lw();function n(i){return t(i)?r(i):e(i)}return Ao=n,Ao}var Mo,Df;function Bw(){if(Df)return Mo;Df=1;var e=pu(),t=ut(),r=Ae(),n=kw(),i=jw(),o="[object Map]",a="[object Set]";function s(c){if(c==null)return 0;if(r(c))return n(c)?i(c):c.length;var u=t(c);return u==o||u==a?c.size:e(c).length}return Mo=s,Mo}var To,Lf;function Fw(){if(Lf)return To;Lf=1;var e=lu(),t=Cv(),r=_u(),n=Me(),i=ar(),o=ce(),a=st(),s=St(),c=ge(),u=Nt();function d(l,f,p){var m=o(l),v=m||a(l)||u(l);if(f=n(f,4),p==null){var g=l&&l.constructor;v?p=m?new g:[]:c(l)?p=s(g)?t(i(l)):{}:p={}}return(v?e:r)(l,function(y,b,h){return f(p,y,b,h)}),p}return To=d,To}var Po,jf;function Hw(){if(jf)return Po;jf=1;var e=at(),t=Rt(),r=ce(),n=e?e.isConcatSpreadable:void 0;function i(o){return r(o)||t(o)||!!(n&&o&&o[n])}return Po=i,Po}var ko,Bf;function Eu(){if(Bf)return ko;Bf=1;var e=vu(),t=Hw();function r(n,i,o,a,s){var c=-1,u=n.length;for(o||(o=t),s||(s=[]);++c<u;){var d=n[c];i>0&&o(d)?i>1?r(d,i-1,o,a,s):e(s,d):a||(s[s.length]=d)}return s}return ko=r,ko}var Oo,Ff;function zw(){if(Ff)return Oo;Ff=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return Oo=e,Oo}var Do,Hf;function Uv(){if(Hf)return Do;Hf=1;var e=zw(),t=Math.max;function r(n,i,o){return i=t(i===void 0?n.length-1:i,0),function(){for(var a=arguments,s=-1,c=t(a.length-i,0),u=Array(c);++s<c;)u[s]=a[i+s];s=-1;for(var d=Array(i+1);++s<i;)d[s]=a[s];return d[i]=o(u),e(n,this,d)}}return Do=r,Do}var Lo,zf;function $w(){if(zf)return Lo;zf=1;var e=yu(),t=lv(),r=Ye(),n=t?function(i,o){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:r;return Lo=n,Lo}var jo,$f;function Vw(){if($f)return jo;$f=1;var e=800,t=16,r=Date.now;function n(i){var o=0,a=0;return function(){var s=r(),c=t-(s-a);if(a=s,c>0){if(++o>=e)return arguments[0]}else o=0;return i.apply(void 0,arguments)}}return jo=n,jo}var Bo,Vf;function Wv(){if(Vf)return Bo;Vf=1;var e=$w(),t=Vw(),r=t(e);return Bo=r,Bo}var Fo,Gf;function lr(){if(Gf)return Fo;Gf=1;var e=Ye(),t=Uv(),r=Wv();function n(i,o){return r(t(i,o,e),i+"")}return Fo=n,Fo}var Ho,Uf;function Yv(){if(Uf)return Ho;Uf=1;function e(t,r,n,i){for(var o=t.length,a=n+(i?1:-1);i?a--:++a<o;)if(r(t[a],a,t))return a;return-1}return Ho=e,Ho}var zo,Wf;function Gw(){if(Wf)return zo;Wf=1;function e(t){return t!==t}return zo=e,zo}var $o,Yf;function Uw(){if(Yf)return $o;Yf=1;function e(t,r,n){for(var i=n-1,o=t.length;++i<o;)if(t[i]===r)return i;return-1}return $o=e,$o}var Vo,Kf;function Ww(){if(Kf)return Vo;Kf=1;var e=Yv(),t=Gw(),r=Uw();function n(i,o,a){return o===o?r(i,o,a):e(i,t,a)}return Vo=n,Vo}var Go,Zf;function Yw(){if(Zf)return Go;Zf=1;var e=Ww();function t(r,n){var i=r==null?0:r.length;return!!i&&e(r,n,0)>-1}return Go=t,Go}var Uo,Xf;function Kw(){if(Xf)return Uo;Xf=1;function e(t,r,n){for(var i=-1,o=t==null?0:t.length;++i<o;)if(n(r,t[i]))return!0;return!1}return Uo=e,Uo}var Wo,Qf;function Zw(){if(Qf)return Wo;Qf=1;function e(){}return Wo=e,Wo}var Yo,Jf;function Xw(){if(Jf)return Yo;Jf=1;var e=xv(),t=Zw(),r=xu(),n=1/0,i=e&&1/r(new e([,-0]))[1]==n?function(o){return new e(o)}:t;return Yo=i,Yo}var Ko,eh;function Qw(){if(eh)return Ko;eh=1;var e=Av(),t=Yw(),r=Kw(),n=Mv(),i=Xw(),o=xu(),a=200;function s(c,u,d){var l=-1,f=t,p=c.length,m=!0,v=[],g=v;if(d)m=!1,f=r;else if(p>=a){var y=u?null:i(c);if(y)return o(y);m=!1,f=n,g=new e}else g=u?[]:v;e:for(;++l<p;){var b=c[l],h=u?u(b):b;if(b=d||b!==0?b:0,m&&h===h){for(var _=g.length;_--;)if(g[_]===h)continue e;u&&g.push(h),v.push(b)}else f(g,h,d)||(g!==v&&g.push(h),v.push(b))}return v}return Ko=s,Ko}var Zo,th;function Kv(){if(th)return Zo;th=1;var e=Ae(),t=Ce();function r(n){return t(n)&&e(n)}return Zo=r,Zo}var Xo,rh;function Jw(){if(rh)return Xo;rh=1;var e=Eu(),t=lr(),r=Qw(),n=Kv(),i=t(function(o){return r(e(o,1,n,!0))});return Xo=i,Xo}var Qo,nh;function e1(){if(nh)return Qo;nh=1;var e=ur();function t(r,n){return e(n,function(i){return r[i]})}return Qo=t,Qo}var Jo,ih;function Zv(){if(ih)return Jo;ih=1;var e=e1(),t=Fe();function r(n){return n==null?[]:e(n,t(n))}return Jo=r,Jo}var ea,oh;function ve(){if(oh)return ea;oh=1;var e;if(typeof uu=="function")try{e={clone:sw(),constant:yu(),each:Iv(),filter:Fv(),has:Hv(),isArray:ce(),isEmpty:Mw(),isFunction:St(),isUndefined:zv(),keys:Fe(),map:Vv(),reduce:Gv(),size:Bw(),transform:Fw(),union:Jw(),values:Zv()}}catch{}return e||(e=window._),ea=e,ea}var ta,ah;function Cu(){if(ah)return ta;ah=1;var e=ve();ta=i;var t="\0",r="\0",n="";function i(d){this._isDirected=e.has(d,"directed")?d.directed:!0,this._isMultigraph=e.has(d,"multigraph")?d.multigraph:!1,this._isCompound=e.has(d,"compound")?d.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(d){return this._label=d,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultNodeLabelFn=d,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var d=this;return e.filter(this.nodes(),function(l){return e.isEmpty(d._in[l])})},i.prototype.sinks=function(){var d=this;return e.filter(this.nodes(),function(l){return e.isEmpty(d._out[l])})},i.prototype.setNodes=function(d,l){var f=arguments,p=this;return e.each(d,function(m){f.length>1?p.setNode(m,l):p.setNode(m)}),this},i.prototype.setNode=function(d,l){return e.has(this._nodes,d)?(arguments.length>1&&(this._nodes[d]=l),this):(this._nodes[d]=arguments.length>1?l:this._defaultNodeLabelFn(d),this._isCompound&&(this._parent[d]=r,this._children[d]={},this._children[r][d]=!0),this._in[d]={},this._preds[d]={},this._out[d]={},this._sucs[d]={},++this._nodeCount,this)},i.prototype.node=function(d){return this._nodes[d]},i.prototype.hasNode=function(d){return e.has(this._nodes,d)},i.prototype.removeNode=function(d){var l=this;if(e.has(this._nodes,d)){var f=function(p){l.removeEdge(l._edgeObjs[p])};delete this._nodes[d],this._isCompound&&(this._removeFromParentsChildList(d),delete this._parent[d],e.each(this.children(d),function(p){l.setParent(p)}),delete this._children[d]),e.each(e.keys(this._in[d]),f),delete this._in[d],delete this._preds[d],e.each(e.keys(this._out[d]),f),delete this._out[d],delete this._sucs[d],--this._nodeCount}return this},i.prototype.setParent=function(d,l){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(l))l=r;else{l+="";for(var f=l;!e.isUndefined(f);f=this.parent(f))if(f===d)throw new Error("Setting "+l+" as parent of "+d+" would create a cycle");this.setNode(l)}return this.setNode(d),this._removeFromParentsChildList(d),this._parent[d]=l,this._children[l][d]=!0,this},i.prototype._removeFromParentsChildList=function(d){delete this._children[this._parent[d]][d]},i.prototype.parent=function(d){if(this._isCompound){var l=this._parent[d];if(l!==r)return l}},i.prototype.children=function(d){if(e.isUndefined(d)&&(d=r),this._isCompound){var l=this._children[d];if(l)return e.keys(l)}else{if(d===r)return this.nodes();if(this.hasNode(d))return[]}},i.prototype.predecessors=function(d){var l=this._preds[d];if(l)return e.keys(l)},i.prototype.successors=function(d){var l=this._sucs[d];if(l)return e.keys(l)},i.prototype.neighbors=function(d){var l=this.predecessors(d);if(l)return e.union(l,this.successors(d))},i.prototype.isLeaf=function(d){var l;return this.isDirected()?l=this.successors(d):l=this.neighbors(d),l.length===0},i.prototype.filterNodes=function(d){var l=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});l.setGraph(this.graph());var f=this;e.each(this._nodes,function(v,g){d(g)&&l.setNode(g,v)}),e.each(this._edgeObjs,function(v){l.hasNode(v.v)&&l.hasNode(v.w)&&l.setEdge(v,f.edge(v))});var p={};function m(v){var g=f.parent(v);return g===void 0||l.hasNode(g)?(p[v]=g,g):g in p?p[g]:m(g)}return this._isCompound&&e.each(l.nodes(),function(v){l.setParent(v,m(v))}),l},i.prototype.setDefaultEdgeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultEdgeLabelFn=d,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(d,l){var f=this,p=arguments;return e.reduce(d,function(m,v){return p.length>1?f.setEdge(m,v,l):f.setEdge(m,v),v}),this},i.prototype.setEdge=function(){var d,l,f,p,m=!1,v=arguments[0];typeof v=="object"&&v!==null&&"v"in v?(d=v.v,l=v.w,f=v.name,arguments.length===2&&(p=arguments[1],m=!0)):(d=v,l=arguments[1],f=arguments[3],arguments.length>2&&(p=arguments[2],m=!0)),d=""+d,l=""+l,e.isUndefined(f)||(f=""+f);var g=s(this._isDirected,d,l,f);if(e.has(this._edgeLabels,g))return m&&(this._edgeLabels[g]=p),this;if(!e.isUndefined(f)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(d),this.setNode(l),this._edgeLabels[g]=m?p:this._defaultEdgeLabelFn(d,l,f);var y=c(this._isDirected,d,l,f);return d=y.v,l=y.w,Object.freeze(y),this._edgeObjs[g]=y,o(this._preds[l],d),o(this._sucs[d],l),this._in[l][g]=y,this._out[d][g]=y,this._edgeCount++,this},i.prototype.edge=function(d,l,f){var p=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,d,l,f);return this._edgeLabels[p]},i.prototype.hasEdge=function(d,l,f){var p=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,d,l,f);return e.has(this._edgeLabels,p)},i.prototype.removeEdge=function(d,l,f){var p=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,d,l,f),m=this._edgeObjs[p];return m&&(d=m.v,l=m.w,delete this._edgeLabels[p],delete this._edgeObjs[p],a(this._preds[l],d),a(this._sucs[d],l),delete this._in[l][p],delete this._out[d][p],this._edgeCount--),this},i.prototype.inEdges=function(d,l){var f=this._in[d];if(f){var p=e.values(f);return l?e.filter(p,function(m){return m.v===l}):p}},i.prototype.outEdges=function(d,l){var f=this._out[d];if(f){var p=e.values(f);return l?e.filter(p,function(m){return m.w===l}):p}},i.prototype.nodeEdges=function(d,l){var f=this.inEdges(d,l);if(f)return f.concat(this.outEdges(d,l))};function o(d,l){d[l]?d[l]++:d[l]=1}function a(d,l){--d[l]||delete d[l]}function s(d,l,f,p){var m=""+l,v=""+f;if(!d&&m>v){var g=m;m=v,v=g}return m+n+v+n+(e.isUndefined(p)?t:p)}function c(d,l,f,p){var m=""+l,v=""+f;if(!d&&m>v){var g=m;m=v,v=g}var y={v:m,w:v};return p&&(y.name=p),y}function u(d,l){return s(d,l.v,l.w,l.name)}return ta}var ra,sh;function t1(){return sh||(sh=1,ra="2.1.8"),ra}var na,uh;function r1(){return uh||(uh=1,na={Graph:Cu(),version:t1()}),na}var ia,ch;function n1(){if(ch)return ia;ch=1;var e=ve(),t=Cu();ia={write:r,read:o};function r(a){var s={options:{directed:a.isDirected(),multigraph:a.isMultigraph(),compound:a.isCompound()},nodes:n(a),edges:i(a)};return e.isUndefined(a.graph())||(s.value=e.clone(a.graph())),s}function n(a){return e.map(a.nodes(),function(s){var c=a.node(s),u=a.parent(s),d={v:s};return e.isUndefined(c)||(d.value=c),e.isUndefined(u)||(d.parent=u),d})}function i(a){return e.map(a.edges(),function(s){var c=a.edge(s),u={v:s.v,w:s.w};return e.isUndefined(s.name)||(u.name=s.name),e.isUndefined(c)||(u.value=c),u})}function o(a){var s=new t(a.options).setGraph(a.value);return e.each(a.nodes,function(c){s.setNode(c.v,c.value),c.parent&&s.setParent(c.v,c.parent)}),e.each(a.edges,function(c){s.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),s}return ia}var oa,dh;function i1(){if(dh)return oa;dh=1;var e=ve();oa=t;function t(r){var n={},i=[],o;function a(s){e.has(n,s)||(n[s]=!0,o.push(s),e.each(r.successors(s),a),e.each(r.predecessors(s),a))}return e.each(r.nodes(),function(s){o=[],a(s),o.length&&i.push(o)}),i}return oa}var aa,lh;function Xv(){if(lh)return aa;lh=1;var e=ve();aa=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var i=this._keyIndices;if(r=String(r),!e.has(i,r)){var o=this._arr,a=o.length;return i[r]=a,o.push({key:r,priority:n}),this._decrease(a),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var i=this._keyIndices[r];if(n>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[i].priority+" New: "+n);this._arr[i].priority=n,this._decrease(i)},t.prototype._heapify=function(r){var n=this._arr,i=2*r,o=i+1,a=r;i<n.length&&(a=n[i].priority<n[a].priority?i:a,o<n.length&&(a=n[o].priority<n[a].priority?o:a),a!==r&&(this._swap(r,a),this._heapify(a)))},t.prototype._decrease=function(r){for(var n=this._arr,i=n[r].priority,o;r!==0&&(o=r>>1,!(n[o].priority<i));)this._swap(r,o),r=o},t.prototype._swap=function(r,n){var i=this._arr,o=this._keyIndices,a=i[r],s=i[n];i[r]=s,i[n]=a,o[s.key]=r,o[a.key]=n},aa}var sa,fh;function Qv(){if(fh)return sa;fh=1;var e=ve(),t=Xv();sa=n;var r=e.constant(1);function n(o,a,s,c){return i(o,String(a),s||r,c||function(u){return o.outEdges(u)})}function i(o,a,s,c){var u={},d=new t,l,f,p=function(m){var v=m.v!==l?m.v:m.w,g=u[v],y=s(m),b=f.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+m+" Weight: "+y);b<g.distance&&(g.distance=b,g.predecessor=l,d.decrease(v,b))};for(o.nodes().forEach(function(m){var v=m===a?0:Number.POSITIVE_INFINITY;u[m]={distance:v},d.add(m,v)});d.size()>0&&(l=d.removeMin(),f=u[l],f.distance!==Number.POSITIVE_INFINITY);)c(l).forEach(p);return u}return sa}var ua,hh;function o1(){if(hh)return ua;hh=1;var e=Qv(),t=ve();ua=r;function r(n,i,o){return t.transform(n.nodes(),function(a,s){a[s]=e(n,s,i,o)},{})}return ua}var ca,ph;function Jv(){if(ph)return ca;ph=1;var e=ve();ca=t;function t(r){var n=0,i=[],o={},a=[];function s(c){var u=o[c]={onStack:!0,lowlink:n,index:n++};if(i.push(c),r.successors(c).forEach(function(f){e.has(o,f)?o[f].onStack&&(u.lowlink=Math.min(u.lowlink,o[f].index)):(s(f),u.lowlink=Math.min(u.lowlink,o[f].lowlink))}),u.lowlink===u.index){var d=[],l;do l=i.pop(),o[l].onStack=!1,d.push(l);while(c!==l);a.push(d)}}return r.nodes().forEach(function(c){e.has(o,c)||s(c)}),a}return ca}var da,gh;function a1(){if(gh)return da;gh=1;var e=ve(),t=Jv();da=r;function r(n){return e.filter(t(n),function(i){return i.length>1||i.length===1&&n.hasEdge(i[0],i[0])})}return da}var la,vh;function s1(){if(vh)return la;vh=1;var e=ve();la=r;var t=e.constant(1);function r(i,o,a){return n(i,o||t,a||function(s){return i.outEdges(s)})}function n(i,o,a){var s={},c=i.nodes();return c.forEach(function(u){s[u]={},s[u][u]={distance:0},c.forEach(function(d){u!==d&&(s[u][d]={distance:Number.POSITIVE_INFINITY})}),a(u).forEach(function(d){var l=d.v===u?d.w:d.v,f=o(d);s[u][l]={distance:f,predecessor:u}})}),c.forEach(function(u){var d=s[u];c.forEach(function(l){var f=s[l];c.forEach(function(p){var m=f[u],v=d[p],g=f[p],y=m.distance+v.distance;y<g.distance&&(g.distance=y,g.predecessor=v.predecessor)})})}),s}return la}var fa,mh;function em(){if(mh)return fa;mh=1;var e=ve();fa=t,t.CycleException=r;function t(n){var i={},o={},a=[];function s(c){if(e.has(o,c))throw new r;e.has(i,c)||(o[c]=!0,i[c]=!0,e.each(n.predecessors(c),s),delete o[c],a.push(c))}if(e.each(n.sinks(),s),e.size(i)!==n.nodeCount())throw new r;return a}function r(){}return r.prototype=new Error,fa}var ha,yh;function u1(){if(yh)return ha;yh=1;var e=em();ha=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return ha}var pa,bh;function tm(){if(bh)return pa;bh=1;var e=ve();pa=t;function t(n,i,o){e.isArray(i)||(i=[i]);var a=(n.isDirected()?n.successors:n.neighbors).bind(n),s=[],c={};return e.each(i,function(u){if(!n.hasNode(u))throw new Error("Graph does not have node: "+u);r(n,u,o==="post",c,a,s)}),s}function r(n,i,o,a,s,c){e.has(a,i)||(a[i]=!0,o||c.push(i),e.each(s(i),function(u){r(n,u,o,a,s,c)}),o&&c.push(i))}return pa}var ga,_h;function c1(){if(_h)return ga;_h=1;var e=tm();ga=t;function t(r,n){return e(r,n,"post")}return ga}var va,xh;function d1(){if(xh)return va;xh=1;var e=tm();va=t;function t(r,n){return e(r,n,"pre")}return va}var ma,wh;function l1(){if(wh)return ma;wh=1;var e=ve(),t=Cu(),r=Xv();ma=n;function n(i,o){var a=new t,s={},c=new r,u;function d(f){var p=f.v===u?f.w:f.v,m=c.priority(p);if(m!==void 0){var v=o(f);v<m&&(s[p]=u,c.decrease(p,v))}}if(i.nodeCount()===0)return a;e.each(i.nodes(),function(f){c.add(f,Number.POSITIVE_INFINITY),a.setNode(f)}),c.decrease(i.nodes()[0],0);for(var l=!1;c.size()>0;){if(u=c.removeMin(),e.has(s,u))a.setEdge(u,s[u]);else{if(l)throw new Error("Input graph is not connected: "+i);l=!0}i.nodeEdges(u).forEach(d)}return a}return ma}var ya,Eh;function f1(){return Eh||(Eh=1,ya={components:i1(),dijkstra:Qv(),dijkstraAll:o1(),findCycles:a1(),floydWarshall:s1(),isAcyclic:u1(),postorder:c1(),preorder:d1(),prim:l1(),tarjan:Jv(),topsort:em()}),ya}var ba,Ch;function h1(){if(Ch)return ba;Ch=1;var e=r1();return ba={Graph:e.Graph,json:n1(),alg:f1(),version:e.version},ba}var _a,Sh;function be(){if(Sh)return _a;Sh=1;var e;if(typeof uu=="function")try{e=h1()}catch{}return e||(e=window.graphlib),_a=e,_a}var xa,qh;function p1(){if(qh)return xa;qh=1;var e=qv(),t=1,r=4;function n(i){return e(i,t|r)}return xa=n,xa}var wa,Rh;function fr(){if(Rh)return wa;Rh=1;var e=ot(),t=Ae(),r=nr(),n=ge();function i(o,a,s){if(!n(s))return!1;var c=typeof a;return(c=="number"?t(s)&&r(a,s.length):c=="string"&&a in s)?e(s[a],o):!1}return wa=i,wa}var Ea,Nh;function g1(){if(Nh)return Ea;Nh=1;var e=lr(),t=ot(),r=fr(),n=We(),i=Object.prototype,o=i.hasOwnProperty,a=e(function(s,c){s=Object(s);var u=-1,d=c.length,l=d>2?c[2]:void 0;for(l&&r(c[0],c[1],l)&&(d=1);++u<d;)for(var f=c[u],p=n(f),m=-1,v=p.length;++m<v;){var g=p[m],y=s[g];(y===void 0||t(y,i[g])&&!o.call(s,g))&&(s[g]=f[g])}return s});return Ea=a,Ea}var Ca,Ih;function v1(){if(Ih)return Ca;Ih=1;var e=Me(),t=Ae(),r=Fe();function n(i){return function(o,a,s){var c=Object(o);if(!t(o)){var u=e(a,3);o=r(o),a=function(l){return u(c[l],l,c)}}var d=i(o,a,s);return d>-1?c[u?o[d]:d]:void 0}}return Ca=n,Ca}var Sa,Ah;function m1(){if(Ah)return Sa;Ah=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return Sa=t,Sa}var qa,Mh;function y1(){if(Mh)return qa;Mh=1;var e=m1(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return qa=r,qa}var Ra,Th;function b1(){if(Th)return Ra;Th=1;var e=y1(),t=ge(),r=ct(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,s=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=e(u);var l=o.test(u);return l||a.test(u)?s(u.slice(2),l?2:8):i.test(u)?n:+u}return Ra=c,Ra}var Na,Ph;function rm(){if(Ph)return Na;Ph=1;var e=b1(),t=1/0,r=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var o=i<0?-1:1;return o*r}return i===i?i:0}return Na=n,Na}var Ia,kh;function _1(){if(kh)return Ia;kh=1;var e=rm();function t(r){var n=e(r),i=n%1;return n===n?i?n-i:n:0}return Ia=t,Ia}var Aa,Oh;function x1(){if(Oh)return Aa;Oh=1;var e=Yv(),t=Me(),r=_1(),n=Math.max;function i(o,a,s){var c=o==null?0:o.length;if(!c)return-1;var u=s==null?0:r(s);return u<0&&(u=n(c+u,0)),e(o,t(a,3),u)}return Aa=i,Aa}var Ma,Dh;function w1(){if(Dh)return Ma;Dh=1;var e=v1(),t=x1(),r=e(t);return Ma=r,Ma}var Ta,Lh;function nm(){if(Lh)return Ta;Lh=1;var e=Eu();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return Ta=t,Ta}var Pa,jh;function E1(){if(jh)return Pa;jh=1;var e=bu(),t=Rv(),r=We();function n(i,o){return i==null?i:e(i,t(o),r)}return Pa=n,Pa}var ka,Bh;function C1(){if(Bh)return ka;Bh=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return ka=e,ka}var Oa,Fh;function S1(){if(Fh)return Oa;Fh=1;var e=tr(),t=_u(),r=Me();function n(i,o){var a={};return o=r(o,3),t(i,function(s,c,u){e(a,c,o(s,c,u))}),a}return Oa=n,Oa}var Da,Hh;function Su(){if(Hh)return Da;Hh=1;var e=ct();function t(r,n,i){for(var o=-1,a=r.length;++o<a;){var s=r[o],c=n(s);if(c!=null&&(u===void 0?c===c&&!e(c):i(c,u)))var u=c,d=s}return d}return Da=t,Da}var La,zh;function q1(){if(zh)return La;zh=1;function e(t,r){return t>r}return La=e,La}var ja,$h;function R1(){if($h)return ja;$h=1;var e=Su(),t=q1(),r=Ye();function n(i){return i&&i.length?e(i,r,t):void 0}return ja=n,ja}var Ba,Vh;function im(){if(Vh)return Ba;Vh=1;var e=tr(),t=ot();function r(n,i,o){(o!==void 0&&!t(n[i],o)||o===void 0&&!(i in n))&&e(n,i,o)}return Ba=r,Ba}var Fa,Gh;function N1(){if(Gh)return Fa;Gh=1;var e=Ge(),t=ar(),r=Ce(),n="[object Object]",i=Function.prototype,o=Object.prototype,a=i.toString,s=o.hasOwnProperty,c=a.call(Object);function u(d){if(!r(d)||e(d)!=n)return!1;var l=t(d);if(l===null)return!0;var f=s.call(l,"constructor")&&l.constructor;return typeof f=="function"&&f instanceof f&&a.call(f)==c}return Fa=u,Fa}var Ha,Uh;function om(){if(Uh)return Ha;Uh=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return Ha=e,Ha}var za,Wh;function I1(){if(Wh)return za;Wh=1;var e=qt(),t=We();function r(n){return e(n,t(n))}return za=r,za}var $a,Yh;function A1(){if(Yh)return $a;Yh=1;var e=im(),t=pv(),r=Ev(),n=gv(),i=Sv(),o=Rt(),a=ce(),s=Kv(),c=st(),u=St(),d=ge(),l=N1(),f=Nt(),p=om(),m=I1();function v(g,y,b,h,_,w,x){var E=p(g,b),q=p(y,b),S=x.get(q);if(S){e(g,b,S);return}var A=w?w(E,q,b+"",g,y,x):void 0,C=A===void 0;if(C){var N=a(q),M=!N&&c(q),O=!N&&!M&&f(q);A=q,N||M||O?a(E)?A=E:s(E)?A=n(E):M?(C=!1,A=t(q,!0)):O?(C=!1,A=r(q,!0)):A=[]:l(q)||o(q)?(A=E,o(E)?A=m(E):(!d(E)||u(E))&&(A=i(q))):C=!1}C&&(x.set(q,A),_(A,q,h,w,x),x.delete(q)),e(g,b,A)}return $a=v,$a}var Va,Kh;function M1(){if(Kh)return Va;Kh=1;var e=er(),t=im(),r=bu(),n=A1(),i=ge(),o=We(),a=om();function s(c,u,d,l,f){c!==u&&r(u,function(p,m){if(f||(f=new e),i(p))n(c,u,m,d,s,l,f);else{var v=l?l(a(c,m),p,m+"",c,u,f):void 0;v===void 0&&(v=p),t(c,m,v)}},o)}return Va=s,Va}var Ga,Zh;function T1(){if(Zh)return Ga;Zh=1;var e=lr(),t=fr();function r(n){return e(function(i,o){var a=-1,s=o.length,c=s>1?o[s-1]:void 0,u=s>2?o[2]:void 0;for(c=n.length>3&&typeof c=="function"?(s--,c):void 0,u&&t(o[0],o[1],u)&&(c=s<3?void 0:c,s=1),i=Object(i);++a<s;){var d=o[a];d&&n(i,d,a,c)}return i})}return Ga=r,Ga}var Ua,Xh;function P1(){if(Xh)return Ua;Xh=1;var e=M1(),t=T1(),r=t(function(n,i,o){e(n,i,o)});return Ua=r,Ua}var Wa,Qh;function am(){if(Qh)return Wa;Qh=1;function e(t,r){return t<r}return Wa=e,Wa}var Ya,Jh;function k1(){if(Jh)return Ya;Jh=1;var e=Su(),t=am(),r=Ye();function n(i){return i&&i.length?e(i,r,t):void 0}return Ya=n,Ya}var Ka,ep;function O1(){if(ep)return Ka;ep=1;var e=Su(),t=Me(),r=am();function n(i,o){return i&&i.length?e(i,t(o,2),r):void 0}return Ka=n,Ka}var Za,tp;function D1(){if(tp)return Za;tp=1;var e=_e(),t=function(){return e.Date.now()};return Za=t,Za}var Xa,rp;function L1(){if(rp)return Xa;rp=1;var e=rr(),t=cr(),r=nr(),n=ge(),i=It();function o(a,s,c,u){if(!n(a))return a;s=t(s,a);for(var d=-1,l=s.length,f=l-1,p=a;p!=null&&++d<l;){var m=i(s[d]),v=c;if(m==="__proto__"||m==="constructor"||m==="prototype")return a;if(d!=f){var g=p[m];v=u?u(g,m,p):void 0,v===void 0&&(v=n(g)?g:r(s[d+1])?[]:{})}e(p,m,v),p=p[m]}return a}return Xa=o,Xa}var Qa,np;function j1(){if(np)return Qa;np=1;var e=dr(),t=L1(),r=cr();function n(i,o,a){for(var s=-1,c=o.length,u={};++s<c;){var d=o[s],l=e(i,d);a(l,d)&&t(u,r(d,i),l)}return u}return Qa=n,Qa}var Ja,ip;function B1(){if(ip)return Ja;ip=1;var e=j1(),t=jv();function r(n,i){return e(n,i,function(o,a){return t(n,a)})}return Ja=r,Ja}var es,op;function F1(){if(op)return es;op=1;var e=nm(),t=Uv(),r=Wv();function n(i){return r(t(i,void 0,e),i+"")}return es=n,es}var ts,ap;function H1(){if(ap)return ts;ap=1;var e=B1(),t=F1(),r=t(function(n,i){return n==null?{}:e(n,i)});return ts=r,ts}var rs,sp;function z1(){if(sp)return rs;sp=1;var e=Math.ceil,t=Math.max;function r(n,i,o,a){for(var s=-1,c=t(e((i-n)/(o||1)),0),u=Array(c);c--;)u[a?c:++s]=n,n+=o;return u}return rs=r,rs}var ns,up;function $1(){if(up)return ns;up=1;var e=z1(),t=fr(),r=rm();function n(i){return function(o,a,s){return s&&typeof s!="number"&&t(o,a,s)&&(a=s=void 0),o=r(o),a===void 0?(a=o,o=0):a=r(a),s=s===void 0?o<a?1:-1:r(s),e(o,a,s,i)}}return ns=n,ns}var is,cp;function V1(){if(cp)return is;cp=1;var e=$1(),t=e();return is=t,is}var os,dp;function G1(){if(dp)return os;dp=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return os=e,os}var as,lp;function U1(){if(lp)return as;lp=1;var e=ct();function t(r,n){if(r!==n){var i=r!==void 0,o=r===null,a=r===r,s=e(r),c=n!==void 0,u=n===null,d=n===n,l=e(n);if(!u&&!l&&!s&&r>n||s&&c&&d&&!u&&!l||o&&c&&d||!i&&d||!a)return 1;if(!o&&!s&&!l&&r<n||l&&i&&a&&!o&&!s||u&&i&&a||!c&&a||!d)return-1}return 0}return as=t,as}var ss,fp;function W1(){if(fp)return ss;fp=1;var e=U1();function t(r,n,i){for(var o=-1,a=r.criteria,s=n.criteria,c=a.length,u=i.length;++o<c;){var d=e(a[o],s[o]);if(d){if(o>=u)return d;var l=i[o];return d*(l=="desc"?-1:1)}}return r.index-n.index}return ss=t,ss}var us,hp;function Y1(){if(hp)return us;hp=1;var e=ur(),t=dr(),r=Me(),n=$v(),i=G1(),o=ir(),a=W1(),s=Ye(),c=ce();function u(d,l,f){l.length?l=e(l,function(v){return c(v)?function(g){return t(g,v.length===1?v[0]:v)}:v}):l=[s];var p=-1;l=e(l,o(r));var m=n(d,function(v,g,y){var b=e(l,function(h){return h(v)});return{criteria:b,index:++p,value:v}});return i(m,function(v,g){return a(v,g,f)})}return us=u,us}var cs,pp;function K1(){if(pp)return cs;pp=1;var e=Eu(),t=Y1(),r=lr(),n=fr(),i=r(function(o,a){if(o==null)return[];var s=a.length;return s>1&&n(o,a[0],a[1])?a=[]:s>2&&n(a[0],a[1],a[2])&&(a=[a[0]]),t(o,e(a,1),[])});return cs=i,cs}var ds,gp;function Z1(){if(gp)return ds;gp=1;var e=Dv(),t=0;function r(n){var i=++t;return e(n)+i}return ds=r,ds}var ls,vp;function X1(){if(vp)return ls;vp=1;function e(t,r,n){for(var i=-1,o=t.length,a=r.length,s={};++i<o;){var c=i<a?r[i]:void 0;n(s,t[i],c)}return s}return ls=e,ls}var fs,mp;function Q1(){if(mp)return fs;mp=1;var e=rr(),t=X1();function r(n,i){return t(n||[],i||[],e)}return fs=r,fs}var hs,yp;function ae(){if(yp)return hs;yp=1;var e;if(typeof uu=="function")try{e={cloneDeep:p1(),constant:yu(),defaults:g1(),each:Iv(),filter:Fv(),find:w1(),flatten:nm(),forEach:Nv(),forIn:E1(),has:Hv(),isUndefined:zv(),last:C1(),map:Vv(),mapValues:S1(),max:R1(),merge:P1(),min:k1(),minBy:O1(),now:D1(),pick:H1(),range:V1(),reduce:Gv(),sortBy:K1(),uniqueId:Z1(),values:Zv(),zipObject:Q1()}}catch{}return e||(e=window._),hs=e,hs}var ps,bp;function J1(){if(bp)return ps;bp=1,ps=e;function e(){var n={};n._next=n._prev=n,this._sentinel=n}e.prototype.dequeue=function(){var n=this._sentinel,i=n._prev;if(i!==n)return t(i),i},e.prototype.enqueue=function(n){var i=this._sentinel;n._prev&&n._next&&t(n),n._next=i._next,i._next._prev=n,i._next=n,n._prev=i},e.prototype.toString=function(){for(var n=[],i=this._sentinel,o=i._prev;o!==i;)n.push(JSON.stringify(o,r)),o=o._prev;return"["+n.join(", ")+"]"};function t(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function r(n,i){if(n!=="_next"&&n!=="_prev")return i}return ps}var gs,_p;function eE(){if(_p)return gs;_p=1;var e=ae(),t=be().Graph,r=J1();gs=i;var n=e.constant(1);function i(u,d){if(u.nodeCount()<=1)return[];var l=s(u,d||n),f=o(l.graph,l.buckets,l.zeroIdx);return e.flatten(e.map(f,function(p){return u.outEdges(p.v,p.w)}),!0)}function o(u,d,l){for(var f=[],p=d[d.length-1],m=d[0],v;u.nodeCount();){for(;v=m.dequeue();)a(u,d,l,v);for(;v=p.dequeue();)a(u,d,l,v);if(u.nodeCount()){for(var g=d.length-2;g>0;--g)if(v=d[g].dequeue(),v){f=f.concat(a(u,d,l,v,!0));break}}}return f}function a(u,d,l,f,p){var m=p?[]:void 0;return e.forEach(u.inEdges(f.v),function(v){var g=u.edge(v),y=u.node(v.v);p&&m.push({v:v.v,w:v.w}),y.out-=g,c(d,l,y)}),e.forEach(u.outEdges(f.v),function(v){var g=u.edge(v),y=v.w,b=u.node(y);b.in-=g,c(d,l,b)}),u.removeNode(f.v),m}function s(u,d){var l=new t,f=0,p=0;e.forEach(u.nodes(),function(g){l.setNode(g,{v:g,in:0,out:0})}),e.forEach(u.edges(),function(g){var y=l.edge(g.v,g.w)||0,b=d(g),h=y+b;l.setEdge(g.v,g.w,h),p=Math.max(p,l.node(g.v).out+=b),f=Math.max(f,l.node(g.w).in+=b)});var m=e.range(p+f+3).map(function(){return new r}),v=f+1;return e.forEach(l.nodes(),function(g){c(m,v,l.node(g))}),{graph:l,buckets:m,zeroIdx:v}}function c(u,d,l){l.out?l.in?u[l.out-l.in+d].enqueue(l):u[u.length-1].enqueue(l):u[0].enqueue(l)}return gs}var vs,xp;function tE(){if(xp)return vs;xp=1;var e=ae(),t=eE();vs={run:r,undo:i};function r(o){var a=o.graph().acyclicer==="greedy"?t(o,s(o)):n(o);e.forEach(a,function(c){var u=o.edge(c);o.removeEdge(c),u.forwardName=c.name,u.reversed=!0,o.setEdge(c.w,c.v,u,e.uniqueId("rev"))});function s(c){return function(u){return c.edge(u).weight}}}function n(o){var a=[],s={},c={};function u(d){e.has(c,d)||(c[d]=!0,s[d]=!0,e.forEach(o.outEdges(d),function(l){e.has(s,l.w)?a.push(l):u(l.w)}),delete s[d])}return e.forEach(o.nodes(),u),a}function i(o){e.forEach(o.edges(),function(a){var s=o.edge(a);if(s.reversed){o.removeEdge(a);var c=s.forwardName;delete s.reversed,delete s.forwardName,o.setEdge(a.w,a.v,s,c)}})}return vs}var ms,wp;function he(){if(wp)return ms;wp=1;var e=ae(),t=be().Graph;ms={addDummyNode:r,simplify:n,asNonCompoundGraph:i,successorWeights:o,predecessorWeights:a,intersectRect:s,buildLayerMatrix:c,normalizeRanks:u,removeEmptyRanks:d,addBorderNode:l,maxRank:f,partition:p,time:m,notime:v};function r(g,y,b,h){var _;do _=e.uniqueId(h);while(g.hasNode(_));return b.dummy=y,g.setNode(_,b),_}function n(g){var y=new t().setGraph(g.graph());return e.forEach(g.nodes(),function(b){y.setNode(b,g.node(b))}),e.forEach(g.edges(),function(b){var h=y.edge(b.v,b.w)||{weight:0,minlen:1},_=g.edge(b);y.setEdge(b.v,b.w,{weight:h.weight+_.weight,minlen:Math.max(h.minlen,_.minlen)})}),y}function i(g){var y=new t({multigraph:g.isMultigraph()}).setGraph(g.graph());return e.forEach(g.nodes(),function(b){g.children(b).length||y.setNode(b,g.node(b))}),e.forEach(g.edges(),function(b){y.setEdge(b,g.edge(b))}),y}function o(g){var y=e.map(g.nodes(),function(b){var h={};return e.forEach(g.outEdges(b),function(_){h[_.w]=(h[_.w]||0)+g.edge(_).weight}),h});return e.zipObject(g.nodes(),y)}function a(g){var y=e.map(g.nodes(),function(b){var h={};return e.forEach(g.inEdges(b),function(_){h[_.v]=(h[_.v]||0)+g.edge(_).weight}),h});return e.zipObject(g.nodes(),y)}function s(g,y){var b=g.x,h=g.y,_=y.x-b,w=y.y-h,x=g.width/2,E=g.height/2;if(!_&&!w)throw new Error("Not possible to find intersection inside of the rectangle");var q,S;return Math.abs(w)*x>Math.abs(_)*E?(w<0&&(E=-E),q=E*_/w,S=E):(_<0&&(x=-x),q=x,S=x*w/_),{x:b+q,y:h+S}}function c(g){var y=e.map(e.range(f(g)+1),function(){return[]});return e.forEach(g.nodes(),function(b){var h=g.node(b),_=h.rank;e.isUndefined(_)||(y[_][h.order]=b)}),y}function u(g){var y=e.min(e.map(g.nodes(),function(b){return g.node(b).rank}));e.forEach(g.nodes(),function(b){var h=g.node(b);e.has(h,"rank")&&(h.rank-=y)})}function d(g){var y=e.min(e.map(g.nodes(),function(w){return g.node(w).rank})),b=[];e.forEach(g.nodes(),function(w){var x=g.node(w).rank-y;b[x]||(b[x]=[]),b[x].push(w)});var h=0,_=g.graph().nodeRankFactor;e.forEach(b,function(w,x){e.isUndefined(w)&&x%_!==0?--h:h&&e.forEach(w,function(E){g.node(E).rank+=h})})}function l(g,y,b,h){var _={width:0,height:0};return arguments.length>=4&&(_.rank=b,_.order=h),r(g,"border",_,y)}function f(g){return e.max(e.map(g.nodes(),function(y){var b=g.node(y).rank;if(!e.isUndefined(b))return b}))}function p(g,y){var b={lhs:[],rhs:[]};return e.forEach(g,function(h){y(h)?b.lhs.push(h):b.rhs.push(h)}),b}function m(g,y){var b=e.now();try{return y()}finally{console.log(g+" time: "+(e.now()-b)+"ms")}}function v(g,y){return y()}return ms}var ys,Ep;function rE(){if(Ep)return ys;Ep=1;var e=ae(),t=he();ys={run:r,undo:i};function r(o){o.graph().dummyChains=[],e.forEach(o.edges(),function(a){n(o,a)})}function n(o,a){var s=a.v,c=o.node(s).rank,u=a.w,d=o.node(u).rank,l=a.name,f=o.edge(a),p=f.labelRank;if(d!==c+1){o.removeEdge(a);var m,v,g;for(g=0,++c;c<d;++g,++c)f.points=[],v={width:0,height:0,edgeLabel:f,edgeObj:a,rank:c},m=t.addDummyNode(o,"edge",v,"_d"),c===p&&(v.width=f.width,v.height=f.height,v.dummy="edge-label",v.labelpos=f.labelpos),o.setEdge(s,m,{weight:f.weight},l),g===0&&o.graph().dummyChains.push(m),s=m;o.setEdge(s,u,{weight:f.weight},l)}}function i(o){e.forEach(o.graph().dummyChains,function(a){var s=o.node(a),c=s.edgeLabel,u;for(o.setEdge(s.edgeObj,c);s.dummy;)u=o.successors(a)[0],o.removeNode(a),c.points.push({x:s.x,y:s.y}),s.dummy==="edge-label"&&(c.x=s.x,c.y=s.y,c.width=s.width,c.height=s.height),a=u,s=o.node(a)})}return ys}var bs,Cp;function Ht(){if(Cp)return bs;Cp=1;var e=ae();bs={longestPath:t,slack:r};function t(n){var i={};function o(a){var s=n.node(a);if(e.has(i,a))return s.rank;i[a]=!0;var c=e.min(e.map(n.outEdges(a),function(u){return o(u.w)-n.edge(u).minlen}));return(c===Number.POSITIVE_INFINITY||c===void 0||c===null)&&(c=0),s.rank=c}e.forEach(n.sources(),o)}function r(n,i){return n.node(i.w).rank-n.node(i.v).rank-n.edge(i).minlen}return bs}var _s,Sp;function sm(){if(Sp)return _s;Sp=1;var e=ae(),t=be().Graph,r=Ht().slack;_s=n;function n(s){var c=new t({directed:!1}),u=s.nodes()[0],d=s.nodeCount();c.setNode(u,{});for(var l,f;i(c,s)<d;)l=o(c,s),f=c.hasNode(l.v)?r(s,l):-r(s,l),a(c,s,f);return c}function i(s,c){function u(d){e.forEach(c.nodeEdges(d),function(l){var f=l.v,p=d===f?l.w:f;!s.hasNode(p)&&!r(c,l)&&(s.setNode(p,{}),s.setEdge(d,p,{}),u(p))})}return e.forEach(s.nodes(),u),s.nodeCount()}function o(s,c){return e.minBy(c.edges(),function(u){if(s.hasNode(u.v)!==s.hasNode(u.w))return r(c,u)})}function a(s,c,u){e.forEach(s.nodes(),function(d){c.node(d).rank+=u})}return _s}var xs,qp;function nE(){if(qp)return xs;qp=1;var e=ae(),t=sm(),r=Ht().slack,n=Ht().longestPath,i=be().alg.preorder,o=be().alg.postorder,a=he().simplify;xs=s,s.initLowLimValues=l,s.initCutValues=c,s.calcCutValue=d,s.leaveEdge=p,s.enterEdge=m,s.exchangeEdges=v;function s(h){h=a(h),n(h);var _=t(h);l(_),c(_,h);for(var w,x;w=p(_);)x=m(_,h,w),v(_,h,w,x)}function c(h,_){var w=o(h,h.nodes());w=w.slice(0,w.length-1),e.forEach(w,function(x){u(h,_,x)})}function u(h,_,w){var x=h.node(w),E=x.parent;h.edge(w,E).cutvalue=d(h,_,w)}function d(h,_,w){var x=h.node(w),E=x.parent,q=!0,S=_.edge(w,E),A=0;return S||(q=!1,S=_.edge(E,w)),A=S.weight,e.forEach(_.nodeEdges(w),function(C){var N=C.v===w,M=N?C.w:C.v;if(M!==E){var O=N===q,k=_.edge(C).weight;if(A+=O?k:-k,y(h,w,M)){var $=h.edge(w,M).cutvalue;A+=O?-$:$}}}),A}function l(h,_){arguments.length<2&&(_=h.nodes()[0]),f(h,{},1,_)}function f(h,_,w,x,E){var q=w,S=h.node(x);return _[x]=!0,e.forEach(h.neighbors(x),function(A){e.has(_,A)||(w=f(h,_,w,A,x))}),S.low=q,S.lim=w++,E?S.parent=E:delete S.parent,w}function p(h){return e.find(h.edges(),function(_){return h.edge(_).cutvalue<0})}function m(h,_,w){var x=w.v,E=w.w;_.hasEdge(x,E)||(x=w.w,E=w.v);var q=h.node(x),S=h.node(E),A=q,C=!1;q.lim>S.lim&&(A=S,C=!0);var N=e.filter(_.edges(),function(M){return C===b(h,h.node(M.v),A)&&C!==b(h,h.node(M.w),A)});return e.minBy(N,function(M){return r(_,M)})}function v(h,_,w,x){var E=w.v,q=w.w;h.removeEdge(E,q),h.setEdge(x.v,x.w,{}),l(h),c(h,_),g(h,_)}function g(h,_){var w=e.find(h.nodes(),function(E){return!_.node(E).parent}),x=i(h,w);x=x.slice(1),e.forEach(x,function(E){var q=h.node(E).parent,S=_.edge(E,q),A=!1;S||(S=_.edge(q,E),A=!0),_.node(E).rank=_.node(q).rank+(A?S.minlen:-S.minlen)})}function y(h,_,w){return h.hasEdge(_,w)}function b(h,_,w){return w.low<=_.lim&&_.lim<=w.lim}return xs}var ws,Rp;function iE(){if(Rp)return ws;Rp=1;var e=Ht(),t=e.longestPath,r=sm(),n=nE();ws=i;function i(c){switch(c.graph().ranker){case"network-simplex":s(c);break;case"tight-tree":a(c);break;case"longest-path":o(c);break;default:s(c)}}var o=t;function a(c){t(c),r(c)}function s(c){n(c)}return ws}var Es,Np;function oE(){if(Np)return Es;Np=1;var e=ae();Es=t;function t(i){var o=n(i);e.forEach(i.graph().dummyChains,function(a){for(var s=i.node(a),c=s.edgeObj,u=r(i,o,c.v,c.w),d=u.path,l=u.lca,f=0,p=d[f],m=!0;a!==c.w;){if(s=i.node(a),m){for(;(p=d[f])!==l&&i.node(p).maxRank<s.rank;)f++;p===l&&(m=!1)}if(!m){for(;f<d.length-1&&i.node(p=d[f+1]).minRank<=s.rank;)f++;p=d[f]}i.setParent(a,p),a=i.successors(a)[0]}})}function r(i,o,a,s){var c=[],u=[],d=Math.min(o[a].low,o[s].low),l=Math.max(o[a].lim,o[s].lim),f,p;f=a;do f=i.parent(f),c.push(f);while(f&&(o[f].low>d||l>o[f].lim));for(p=f,f=s;(f=i.parent(f))!==p;)u.push(f);return{path:c.concat(u.reverse()),lca:p}}function n(i){var o={},a=0;function s(c){var u=a;e.forEach(i.children(c),s),o[c]={low:u,lim:a++}}return e.forEach(i.children(),s),o}return Es}var Cs,Ip;function aE(){if(Ip)return Cs;Ip=1;var e=ae(),t=he();Cs={run:r,cleanup:a};function r(s){var c=t.addDummyNode(s,"root",{},"_root"),u=i(s),d=e.max(e.values(u))-1,l=2*d+1;s.graph().nestingRoot=c,e.forEach(s.edges(),function(p){s.edge(p).minlen*=l});var f=o(s)+1;e.forEach(s.children(),function(p){n(s,c,l,f,d,u,p)}),s.graph().nodeRankFactor=l}function n(s,c,u,d,l,f,p){var m=s.children(p);if(!m.length){p!==c&&s.setEdge(c,p,{weight:0,minlen:u});return}var v=t.addBorderNode(s,"_bt"),g=t.addBorderNode(s,"_bb"),y=s.node(p);s.setParent(v,p),y.borderTop=v,s.setParent(g,p),y.borderBottom=g,e.forEach(m,function(b){n(s,c,u,d,l,f,b);var h=s.node(b),_=h.borderTop?h.borderTop:b,w=h.borderBottom?h.borderBottom:b,x=h.borderTop?d:2*d,E=_!==w?1:l-f[p]+1;s.setEdge(v,_,{weight:x,minlen:E,nestingEdge:!0}),s.setEdge(w,g,{weight:x,minlen:E,nestingEdge:!0})}),s.parent(p)||s.setEdge(c,v,{weight:0,minlen:l+f[p]})}function i(s){var c={};function u(d,l){var f=s.children(d);f&&f.length&&e.forEach(f,function(p){u(p,l+1)}),c[d]=l}return e.forEach(s.children(),function(d){u(d,1)}),c}function o(s){return e.reduce(s.edges(),function(c,u){return c+s.edge(u).weight},0)}function a(s){var c=s.graph();s.removeNode(c.nestingRoot),delete c.nestingRoot,e.forEach(s.edges(),function(u){var d=s.edge(u);d.nestingEdge&&s.removeEdge(u)})}return Cs}var Ss,Ap;function sE(){if(Ap)return Ss;Ap=1;var e=ae(),t=he();Ss=r;function r(i){function o(a){var s=i.children(a),c=i.node(a);if(s.length&&e.forEach(s,o),e.has(c,"minRank")){c.borderLeft=[],c.borderRight=[];for(var u=c.minRank,d=c.maxRank+1;u<d;++u)n(i,"borderLeft","_bl",a,c,u),n(i,"borderRight","_br",a,c,u)}}e.forEach(i.children(),o)}function n(i,o,a,s,c,u){var d={width:0,height:0,rank:u,borderType:o},l=c[o][u-1],f=t.addDummyNode(i,"border",d,a);c[o][u]=f,i.setParent(f,s),l&&i.setEdge(l,f,{weight:1})}return Ss}var qs,Mp;function uE(){if(Mp)return qs;Mp=1;var e=ae();qs={adjust:t,undo:r};function t(u){var d=u.graph().rankdir.toLowerCase();(d==="lr"||d==="rl")&&n(u)}function r(u){var d=u.graph().rankdir.toLowerCase();(d==="bt"||d==="rl")&&o(u),(d==="lr"||d==="rl")&&(s(u),n(u))}function n(u){e.forEach(u.nodes(),function(d){i(u.node(d))}),e.forEach(u.edges(),function(d){i(u.edge(d))})}function i(u){var d=u.width;u.width=u.height,u.height=d}function o(u){e.forEach(u.nodes(),function(d){a(u.node(d))}),e.forEach(u.edges(),function(d){var l=u.edge(d);e.forEach(l.points,a),e.has(l,"y")&&a(l)})}function a(u){u.y=-u.y}function s(u){e.forEach(u.nodes(),function(d){c(u.node(d))}),e.forEach(u.edges(),function(d){var l=u.edge(d);e.forEach(l.points,c),e.has(l,"x")&&c(l)})}function c(u){var d=u.x;u.x=u.y,u.y=d}return qs}var Rs,Tp;function cE(){if(Tp)return Rs;Tp=1;var e=ae();Rs=t;function t(r){var n={},i=e.filter(r.nodes(),function(u){return!r.children(u).length}),o=e.max(e.map(i,function(u){return r.node(u).rank})),a=e.map(e.range(o+1),function(){return[]});function s(u){if(!e.has(n,u)){n[u]=!0;var d=r.node(u);a[d.rank].push(u),e.forEach(r.successors(u),s)}}var c=e.sortBy(i,function(u){return r.node(u).rank});return e.forEach(c,s),a}return Rs}var Ns,Pp;function dE(){if(Pp)return Ns;Pp=1;var e=ae();Ns=t;function t(n,i){for(var o=0,a=1;a<i.length;++a)o+=r(n,i[a-1],i[a]);return o}function r(n,i,o){for(var a=e.zipObject(o,e.map(o,function(f,p){return p})),s=e.flatten(e.map(i,function(f){return e.sortBy(e.map(n.outEdges(f),function(p){return{pos:a[p.w],weight:n.edge(p).weight}}),"pos")}),!0),c=1;c<o.length;)c<<=1;var u=2*c-1;c-=1;var d=e.map(new Array(u),function(){return 0}),l=0;return e.forEach(s.forEach(function(f){var p=f.pos+c;d[p]+=f.weight;for(var m=0;p>0;)p%2&&(m+=d[p+1]),p=p-1>>1,d[p]+=f.weight;l+=f.weight*m})),l}return Ns}var Is,kp;function lE(){if(kp)return Is;kp=1;var e=ae();Is=t;function t(r,n){return e.map(n,function(i){var o=r.inEdges(i);if(o.length){var a=e.reduce(o,function(s,c){var u=r.edge(c),d=r.node(c.v);return{sum:s.sum+u.weight*d.order,weight:s.weight+u.weight}},{sum:0,weight:0});return{v:i,barycenter:a.sum/a.weight,weight:a.weight}}else return{v:i}})}return Is}var As,Op;function fE(){if(Op)return As;Op=1;var e=ae();As=t;function t(i,o){var a={};e.forEach(i,function(c,u){var d=a[c.v]={indegree:0,in:[],out:[],vs:[c.v],i:u};e.isUndefined(c.barycenter)||(d.barycenter=c.barycenter,d.weight=c.weight)}),e.forEach(o.edges(),function(c){var u=a[c.v],d=a[c.w];!e.isUndefined(u)&&!e.isUndefined(d)&&(d.indegree++,u.out.push(a[c.w]))});var s=e.filter(a,function(c){return!c.indegree});return r(s)}function r(i){var o=[];function a(u){return function(d){d.merged||(e.isUndefined(d.barycenter)||e.isUndefined(u.barycenter)||d.barycenter>=u.barycenter)&&n(u,d)}}function s(u){return function(d){d.in.push(u),--d.indegree===0&&i.push(d)}}for(;i.length;){var c=i.pop();o.push(c),e.forEach(c.in.reverse(),a(c)),e.forEach(c.out,s(c))}return e.map(e.filter(o,function(u){return!u.merged}),function(u){return e.pick(u,["vs","i","barycenter","weight"])})}function n(i,o){var a=0,s=0;i.weight&&(a+=i.barycenter*i.weight,s+=i.weight),o.weight&&(a+=o.barycenter*o.weight,s+=o.weight),i.vs=o.vs.concat(i.vs),i.barycenter=a/s,i.weight=s,i.i=Math.min(o.i,i.i),o.merged=!0}return As}var Ms,Dp;function hE(){if(Dp)return Ms;Dp=1;var e=ae(),t=he();Ms=r;function r(o,a){var s=t.partition(o,function(v){return e.has(v,"barycenter")}),c=s.lhs,u=e.sortBy(s.rhs,function(v){return-v.i}),d=[],l=0,f=0,p=0;c.sort(i(!!a)),p=n(d,u,p),e.forEach(c,function(v){p+=v.vs.length,d.push(v.vs),l+=v.barycenter*v.weight,f+=v.weight,p=n(d,u,p)});var m={vs:e.flatten(d,!0)};return f&&(m.barycenter=l/f,m.weight=f),m}function n(o,a,s){for(var c;a.length&&(c=e.last(a)).i<=s;)a.pop(),o.push(c.vs),s++;return s}function i(o){return function(a,s){return a.barycenter<s.barycenter?-1:a.barycenter>s.barycenter?1:o?s.i-a.i:a.i-s.i}}return Ms}var Ts,Lp;function pE(){if(Lp)return Ts;Lp=1;var e=ae(),t=lE(),r=fE(),n=hE();Ts=i;function i(s,c,u,d){var l=s.children(c),f=s.node(c),p=f?f.borderLeft:void 0,m=f?f.borderRight:void 0,v={};p&&(l=e.filter(l,function(w){return w!==p&&w!==m}));var g=t(s,l);e.forEach(g,function(w){if(s.children(w.v).length){var x=i(s,w.v,u,d);v[w.v]=x,e.has(x,"barycenter")&&a(w,x)}});var y=r(g,u);o(y,v);var b=n(y,d);if(p&&(b.vs=e.flatten([p,b.vs,m],!0),s.predecessors(p).length)){var h=s.node(s.predecessors(p)[0]),_=s.node(s.predecessors(m)[0]);e.has(b,"barycenter")||(b.barycenter=0,b.weight=0),b.barycenter=(b.barycenter*b.weight+h.order+_.order)/(b.weight+2),b.weight+=2}return b}function o(s,c){e.forEach(s,function(u){u.vs=e.flatten(u.vs.map(function(d){return c[d]?c[d].vs:d}),!0)})}function a(s,c){e.isUndefined(s.barycenter)?(s.barycenter=c.barycenter,s.weight=c.weight):(s.barycenter=(s.barycenter*s.weight+c.barycenter*c.weight)/(s.weight+c.weight),s.weight+=c.weight)}return Ts}var Ps,jp;function gE(){if(jp)return Ps;jp=1;var e=ae(),t=be().Graph;Ps=r;function r(i,o,a){var s=n(i),c=new t({compound:!0}).setGraph({root:s}).setDefaultNodeLabel(function(u){return i.node(u)});return e.forEach(i.nodes(),function(u){var d=i.node(u),l=i.parent(u);(d.rank===o||d.minRank<=o&&o<=d.maxRank)&&(c.setNode(u),c.setParent(u,l||s),e.forEach(i[a](u),function(f){var p=f.v===u?f.w:f.v,m=c.edge(p,u),v=e.isUndefined(m)?0:m.weight;c.setEdge(p,u,{weight:i.edge(f).weight+v})}),e.has(d,"minRank")&&c.setNode(u,{borderLeft:d.borderLeft[o],borderRight:d.borderRight[o]}))}),c}function n(i){for(var o;i.hasNode(o=e.uniqueId("_root")););return o}return Ps}var ks,Bp;function vE(){if(Bp)return ks;Bp=1;var e=ae();ks=t;function t(r,n,i){var o={},a;e.forEach(i,function(s){for(var c=r.parent(s),u,d;c;){if(u=r.parent(c),u?(d=o[u],o[u]=c):(d=a,a=c),d&&d!==c){n.setEdge(d,c);return}c=u}})}return ks}var Os,Fp;function mE(){if(Fp)return Os;Fp=1;var e=ae(),t=cE(),r=dE(),n=pE(),i=gE(),o=vE(),a=be().Graph,s=he();Os=c;function c(f){var p=s.maxRank(f),m=u(f,e.range(1,p+1),"inEdges"),v=u(f,e.range(p-1,-1,-1),"outEdges"),g=t(f);l(f,g);for(var y=Number.POSITIVE_INFINITY,b,h=0,_=0;_<4;++h,++_){d(h%2?m:v,h%4>=2),g=s.buildLayerMatrix(f);var w=r(f,g);w<y&&(_=0,b=e.cloneDeep(g),y=w)}l(f,b)}function u(f,p,m){return e.map(p,function(v){return i(f,v,m)})}function d(f,p){var m=new a;e.forEach(f,function(v){var g=v.graph().root,y=n(v,g,m,p);e.forEach(y.vs,function(b,h){v.node(b).order=h}),o(v,m,y.vs)})}function l(f,p){e.forEach(p,function(m){e.forEach(m,function(v,g){f.node(v).order=g})})}return Os}var Ds,Hp;function yE(){if(Hp)return Ds;Hp=1;var e=ae(),t=be().Graph,r=he();Ds={positionX:m,findType1Conflicts:n,findType2Conflicts:i,addConflict:a,hasConflict:s,verticalAlignment:c,horizontalCompaction:u,alignCoordinates:f,findSmallestWidthAlignment:l,balance:p};function n(y,b){var h={};function _(w,x){var E=0,q=0,S=w.length,A=e.last(x);return e.forEach(x,function(C,N){var M=o(y,C),O=M?y.node(M).order:S;(M||C===A)&&(e.forEach(x.slice(q,N+1),function(k){e.forEach(y.predecessors(k),function($){var G=y.node($),j=G.order;(j<E||O<j)&&!(G.dummy&&y.node(k).dummy)&&a(h,$,k)})}),q=N+1,E=O)}),x}return e.reduce(b,_),h}function i(y,b){var h={};function _(x,E,q,S,A){var C;e.forEach(e.range(E,q),function(N){C=x[N],y.node(C).dummy&&e.forEach(y.predecessors(C),function(M){var O=y.node(M);O.dummy&&(O.order<S||O.order>A)&&a(h,M,C)})})}function w(x,E){var q=-1,S,A=0;return e.forEach(E,function(C,N){if(y.node(C).dummy==="border"){var M=y.predecessors(C);M.length&&(S=y.node(M[0]).order,_(E,A,N,q,S),A=N,q=S)}_(E,A,E.length,S,x.length)}),E}return e.reduce(b,w),h}function o(y,b){if(y.node(b).dummy)return e.find(y.predecessors(b),function(h){return y.node(h).dummy})}function a(y,b,h){if(b>h){var _=b;b=h,h=_}var w=y[b];w||(y[b]=w={}),w[h]=!0}function s(y,b,h){if(b>h){var _=b;b=h,h=_}return e.has(y[b],h)}function c(y,b,h,_){var w={},x={},E={};return e.forEach(b,function(q){e.forEach(q,function(S,A){w[S]=S,x[S]=S,E[S]=A})}),e.forEach(b,function(q){var S=-1;e.forEach(q,function(A){var C=_(A);if(C.length){C=e.sortBy(C,function($){return E[$]});for(var N=(C.length-1)/2,M=Math.floor(N),O=Math.ceil(N);M<=O;++M){var k=C[M];x[A]===A&&S<E[k]&&!s(h,A,k)&&(x[k]=A,x[A]=w[A]=w[k],S=E[k])}}})}),{root:w,align:x}}function u(y,b,h,_,w){var x={},E=d(y,b,h,w),q=w?"borderLeft":"borderRight";function S(N,M){for(var O=E.nodes(),k=O.pop(),$={};k;)$[k]?N(k):($[k]=!0,O.push(k),O=O.concat(M(k))),k=O.pop()}function A(N){x[N]=E.inEdges(N).reduce(function(M,O){return Math.max(M,x[O.v]+E.edge(O))},0)}function C(N){var M=E.outEdges(N).reduce(function(k,$){return Math.min(k,x[$.w]-E.edge($))},Number.POSITIVE_INFINITY),O=y.node(N);M!==Number.POSITIVE_INFINITY&&O.borderType!==q&&(x[N]=Math.max(x[N],M))}return S(A,E.predecessors.bind(E)),S(C,E.successors.bind(E)),e.forEach(_,function(N){x[N]=x[h[N]]}),x}function d(y,b,h,_){var w=new t,x=y.graph(),E=v(x.nodesep,x.edgesep,_);return e.forEach(b,function(q){var S;e.forEach(q,function(A){var C=h[A];if(w.setNode(C),S){var N=h[S],M=w.edge(N,C);w.setEdge(N,C,Math.max(E(y,A,S),M||0))}S=A})}),w}function l(y,b){return e.minBy(e.values(b),function(h){var _=Number.NEGATIVE_INFINITY,w=Number.POSITIVE_INFINITY;return e.forIn(h,function(x,E){var q=g(y,E)/2;_=Math.max(x+q,_),w=Math.min(x-q,w)}),_-w})}function f(y,b){var h=e.values(b),_=e.min(h),w=e.max(h);e.forEach(["u","d"],function(x){e.forEach(["l","r"],function(E){var q=x+E,S=y[q],A;if(S!==b){var C=e.values(S);A=E==="l"?_-e.min(C):w-e.max(C),A&&(y[q]=e.mapValues(S,function(N){return N+A}))}})})}function p(y,b){return e.mapValues(y.ul,function(h,_){if(b)return y[b.toLowerCase()][_];var w=e.sortBy(e.map(y,_));return(w[1]+w[2])/2})}function m(y){var b=r.buildLayerMatrix(y),h=e.merge(n(y,b),i(y,b)),_={},w;e.forEach(["u","d"],function(E){w=E==="u"?b:e.values(b).reverse(),e.forEach(["l","r"],function(q){q==="r"&&(w=e.map(w,function(N){return e.values(N).reverse()}));var S=(E==="u"?y.predecessors:y.successors).bind(y),A=c(y,w,h,S),C=u(y,w,A.root,A.align,q==="r");q==="r"&&(C=e.mapValues(C,function(N){return-N})),_[E+q]=C})});var x=l(y,_);return f(_,x),p(_,y.graph().align)}function v(y,b,h){return function(_,w,x){var E=_.node(w),q=_.node(x),S=0,A;if(S+=E.width/2,e.has(E,"labelpos"))switch(E.labelpos.toLowerCase()){case"l":A=-E.width/2;break;case"r":A=E.width/2;break}if(A&&(S+=h?A:-A),A=0,S+=(E.dummy?b:y)/2,S+=(q.dummy?b:y)/2,S+=q.width/2,e.has(q,"labelpos"))switch(q.labelpos.toLowerCase()){case"l":A=q.width/2;break;case"r":A=-q.width/2;break}return A&&(S+=h?A:-A),A=0,S}}function g(y,b){return y.node(b).width}return Ds}var Ls,zp;function bE(){if(zp)return Ls;zp=1;var e=ae(),t=he(),r=yE().positionX;Ls=n;function n(o){o=t.asNonCompoundGraph(o),i(o),e.forEach(r(o),function(a,s){o.node(s).x=a})}function i(o){var a=t.buildLayerMatrix(o),s=o.graph().ranksep,c=0;e.forEach(a,function(u){var d=e.max(e.map(u,function(l){return o.node(l).height}));e.forEach(u,function(l){o.node(l).y=c+d/2}),c+=d+s})}return Ls}var js,$p;function _E(){if($p)return js;$p=1;var e=ae(),t=tE(),r=rE(),n=iE(),i=he().normalizeRanks,o=oE(),a=he().removeEmptyRanks,s=aE(),c=sE(),u=uE(),d=mE(),l=bE(),f=he(),p=be().Graph;js=m;function m(I,P){var D=P&&P.debugTiming?f.time:f.notime;D("layout",function(){var F=D("  buildLayoutGraph",function(){return S(I)});D("  runLayout",function(){v(F,D)}),D("  updateInputGraph",function(){g(I,F)})})}function v(I,P){P("    makeSpaceForEdgeLabels",function(){A(I)}),P("    removeSelfEdges",function(){z(I)}),P("    acyclic",function(){t.run(I)}),P("    nestingGraph.run",function(){s.run(I)}),P("    rank",function(){n(f.asNonCompoundGraph(I))}),P("    injectEdgeLabelProxies",function(){C(I)}),P("    removeEmptyRanks",function(){a(I)}),P("    nestingGraph.cleanup",function(){s.cleanup(I)}),P("    normalizeRanks",function(){i(I)}),P("    assignRankMinMax",function(){N(I)}),P("    removeEdgeLabelProxies",function(){M(I)}),P("    normalize.run",function(){r.run(I)}),P("    parentDummyChains",function(){o(I)}),P("    addBorderSegments",function(){c(I)}),P("    order",function(){d(I)}),P("    insertSelfEdges",function(){L(I)}),P("    adjustCoordinateSystem",function(){u.adjust(I)}),P("    position",function(){l(I)}),P("    positionSelfEdges",function(){V(I)}),P("    removeBorderNodes",function(){j(I)}),P("    normalize.undo",function(){r.undo(I)}),P("    fixupEdgeLabelCoords",function(){$(I)}),P("    undoCoordinateSystem",function(){u.undo(I)}),P("    translateGraph",function(){O(I)}),P("    assignNodeIntersects",function(){k(I)}),P("    reversePoints",function(){G(I)}),P("    acyclic.undo",function(){t.undo(I)})}function g(I,P){e.forEach(I.nodes(),function(D){var F=I.node(D),B=P.node(D);F&&(F.x=B.x,F.y=B.y,P.children(D).length&&(F.width=B.width,F.height=B.height))}),e.forEach(I.edges(),function(D){var F=I.edge(D),B=P.edge(D);F.points=B.points,e.has(B,"x")&&(F.x=B.x,F.y=B.y)}),I.graph().width=P.graph().width,I.graph().height=P.graph().height}var y=["nodesep","edgesep","ranksep","marginx","marginy"],b={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},h=["acyclicer","ranker","rankdir","align"],_=["width","height"],w={width:0,height:0},x=["minlen","weight","width","height","labeloffset"],E={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},q=["labelpos"];function S(I){var P=new p({multigraph:!0,compound:!0}),D=W(I.graph());return P.setGraph(e.merge({},b,H(D,y),e.pick(D,h))),e.forEach(I.nodes(),function(F){var B=W(I.node(F));P.setNode(F,e.defaults(H(B,_),w)),P.setParent(F,I.parent(F))}),e.forEach(I.edges(),function(F){var B=W(I.edge(F));P.setEdge(F,e.merge({},E,H(B,x),e.pick(B,q)))}),P}function A(I){var P=I.graph();P.ranksep/=2,e.forEach(I.edges(),function(D){var F=I.edge(D);F.minlen*=2,F.labelpos.toLowerCase()!=="c"&&(P.rankdir==="TB"||P.rankdir==="BT"?F.width+=F.labeloffset:F.height+=F.labeloffset)})}function C(I){e.forEach(I.edges(),function(P){var D=I.edge(P);if(D.width&&D.height){var F=I.node(P.v),B=I.node(P.w),U={rank:(B.rank-F.rank)/2+F.rank,e:P};f.addDummyNode(I,"edge-proxy",U,"_ep")}})}function N(I){var P=0;e.forEach(I.nodes(),function(D){var F=I.node(D);F.borderTop&&(F.minRank=I.node(F.borderTop).rank,F.maxRank=I.node(F.borderBottom).rank,P=e.max(P,F.maxRank))}),I.graph().maxRank=P}function M(I){e.forEach(I.nodes(),function(P){var D=I.node(P);D.dummy==="edge-proxy"&&(I.edge(D.e).labelRank=D.rank,I.removeNode(P))})}function O(I){var P=Number.POSITIVE_INFINITY,D=0,F=Number.POSITIVE_INFINITY,B=0,U=I.graph(),Z=U.marginx||0,J=U.marginy||0;function Q(Y){var te=Y.x,X=Y.y,ne=Y.width,ee=Y.height;P=Math.min(P,te-ne/2),D=Math.max(D,te+ne/2),F=Math.min(F,X-ee/2),B=Math.max(B,X+ee/2)}e.forEach(I.nodes(),function(Y){Q(I.node(Y))}),e.forEach(I.edges(),function(Y){var te=I.edge(Y);e.has(te,"x")&&Q(te)}),P-=Z,F-=J,e.forEach(I.nodes(),function(Y){var te=I.node(Y);te.x-=P,te.y-=F}),e.forEach(I.edges(),function(Y){var te=I.edge(Y);e.forEach(te.points,function(X){X.x-=P,X.y-=F}),e.has(te,"x")&&(te.x-=P),e.has(te,"y")&&(te.y-=F)}),U.width=D-P+Z,U.height=B-F+J}function k(I){e.forEach(I.edges(),function(P){var D=I.edge(P),F=I.node(P.v),B=I.node(P.w),U,Z;D.points?(U=D.points[0],Z=D.points[D.points.length-1]):(D.points=[],U=B,Z=F),D.points.unshift(f.intersectRect(F,U)),D.points.push(f.intersectRect(B,Z))})}function $(I){e.forEach(I.edges(),function(P){var D=I.edge(P);if(e.has(D,"x"))switch((D.labelpos==="l"||D.labelpos==="r")&&(D.width-=D.labeloffset),D.labelpos){case"l":D.x-=D.width/2+D.labeloffset;break;case"r":D.x+=D.width/2+D.labeloffset;break}})}function G(I){e.forEach(I.edges(),function(P){var D=I.edge(P);D.reversed&&D.points.reverse()})}function j(I){e.forEach(I.nodes(),function(P){if(I.children(P).length){var D=I.node(P),F=I.node(D.borderTop),B=I.node(D.borderBottom),U=I.node(e.last(D.borderLeft)),Z=I.node(e.last(D.borderRight));D.width=Math.abs(Z.x-U.x),D.height=Math.abs(B.y-F.y),D.x=U.x+D.width/2,D.y=F.y+D.height/2}}),e.forEach(I.nodes(),function(P){I.node(P).dummy==="border"&&I.removeNode(P)})}function z(I){e.forEach(I.edges(),function(P){if(P.v===P.w){var D=I.node(P.v);D.selfEdges||(D.selfEdges=[]),D.selfEdges.push({e:P,label:I.edge(P)}),I.removeEdge(P)}})}function L(I){var P=f.buildLayerMatrix(I);e.forEach(P,function(D){var F=0;e.forEach(D,function(B,U){var Z=I.node(B);Z.order=U+F,e.forEach(Z.selfEdges,function(J){f.addDummyNode(I,"selfedge",{width:J.label.width,height:J.label.height,rank:Z.rank,order:U+ ++F,e:J.e,label:J.label},"_se")}),delete Z.selfEdges})})}function V(I){e.forEach(I.nodes(),function(P){var D=I.node(P);if(D.dummy==="selfedge"){var F=I.node(D.e.v),B=F.x+F.width/2,U=F.y,Z=D.x-B,J=F.height/2;I.setEdge(D.e,D.label),I.removeNode(P),D.label.points=[{x:B+2*Z/3,y:U-J},{x:B+5*Z/6,y:U-J},{x:B+Z,y:U},{x:B+5*Z/6,y:U+J},{x:B+2*Z/3,y:U+J}],D.label.x=D.x,D.label.y=D.y}})}function H(I,P){return e.mapValues(e.pick(I,P),Number)}function W(I){var P={};return e.forEach(I,function(D,F){P[F.toLowerCase()]=D}),P}return js}var Bs,Vp;function xE(){if(Vp)return Bs;Vp=1;var e=ae(),t=he(),r=be().Graph;Bs={debugOrdering:n};function n(i){var o=t.buildLayerMatrix(i),a=new r({compound:!0,multigraph:!0}).setGraph({});return e.forEach(i.nodes(),function(s){a.setNode(s,{label:s}),a.setParent(s,"layer"+i.node(s).rank)}),e.forEach(i.edges(),function(s){a.setEdge(s.v,s.w,{},s.name)}),e.forEach(o,function(s,c){var u="layer"+c;a.setNode(u,{rank:"same"}),e.reduce(s,function(d,l){return a.setEdge(d,l,{style:"invis"}),l})}),a}return Bs}var Fs,Gp;function wE(){return Gp||(Gp=1,Fs="0.8.5"),Fs}var Hs,Up;function EE(){return Up||(Up=1,Hs={graphlib:be(),layout:_E(),debug:xE(),util:{time:he().time,notime:he().notime},version:wE()}),Hs}var CE=EE();const Wp=Yp(CE),SE=/^graph\s+(TD|TB|LR|RL|BT)/i,qE=/^\s*(\w+)\["([^"]+)"\]/,RE=/^\s*(\w+)\(["']?([^)"']+)["']?\)/,NE=/^\s*(\w+)\{["']?([^}"']+)["']?\}/,IE=/^\s*(\w+)\s*-->\s*\|([^|]+)\|\s*(\w+)/,AE=/^\s*(\w+)\s*-->\s*(\w+)/,ME=/^\s*(\w+)\s*-->\s*(\w+)\["([^"]+)"\]/;function TE(e){const t=e.split(`
`).map(s=>s.trim()).filter(Boolean);let r="TB";const n=new Map,i=[];let o=0;for(const s of t){const c=s.match(SE);if(c){const v=c[1].toUpperCase();r=v==="LR"||v==="RL"?"LR":"TB";continue}if(/^(subgraph|end|style|class|classDef|linkStyle)\b/i.test(s))continue;const u=s.match(IE);if(u){const[,v,g,y]=u;n.has(v)||n.set(v,v),n.has(y)||n.set(y,y),i.push({id:`e${o++}`,source:v,target:y,label:g.trim()});continue}const d=s.match(ME);if(d){const[,v,g,y]=d;n.has(v)||n.set(v,v),n.set(g,y),i.push({id:`e${o++}`,source:v,target:g});continue}const l=s.match(AE);if(l){const[,v,g]=l;n.has(v)||n.set(v,v),n.has(g)||n.set(g,g),i.push({id:`e${o++}`,source:v,target:g});continue}const f=s.match(qE);if(f){const[,v,g]=f;n.set(v,g);continue}const p=s.match(RE);if(p){const[,v,g]=p;n.set(v,g);continue}const m=s.match(NE);if(m){const[,v,g]=m;n.set(v,g);continue}}return{nodes:Array.from(n.entries()).map(([s,c])=>({id:s,type:"arcade",position:{x:0,y:0},data:{label:c}})),edges:i,direction:r}}function zs(e,t,r="TB"){const n=[`graph ${r}`];for(const i of e){const o=i.data.label||i.id;n.push(`    ${i.id}["${o}"]`)}n.push("");for(const i of t)i.label?n.push(`    ${i.source} -->|${i.label}| ${i.target}`):n.push(`    ${i.source} --> ${i.target}`);return n.join(`
`)}function $s(e,t,r){const{direction:n,nodeWidth:i=180,nodeHeight:o=50,rankSep:a=80,nodeSep:s=40}=r,c=new Wp.graphlib.Graph;c.setDefaultEdgeLabel(()=>({})),c.setGraph({rankdir:n,ranksep:a,nodesep:s});for(const u of e)c.setNode(u.id,{width:i,height:o});for(const u of t)c.setEdge(u.source,u.target);return Wp.layout(c),e.map(u=>{const d=c.node(u.id);return{...u,position:{x:d.x-i/2,y:d.y-o/2}}})}const PE=[{id:"basic-concept-map",name:"Concept Map",description:"Central concept with labeled branches",category:"concept-map",mermaid:`graph TD
    A["Central Concept"]
    B["Related Idea 1"]
    C["Related Idea 2"]
    D["Related Idea 3"]
    E["Related Idea 4"]
    A -->|"causes"| B
    A -->|"includes"| C
    A -->|"affects"| D
    B -->|"leads to"| E`},{id:"process-flowchart",name:"Process Flowchart",description:"Linear process with decision point",category:"flowchart",mermaid:`graph TD
    A["Start / Input"]
    B["Step 1"]
    C{"Decision?"}
    D["Path A"]
    E["Path B"]
    F["Outcome"]
    A --> B
    B --> C
    C -->|"Yes"| D
    C -->|"No"| E
    D --> F
    E --> F`},{id:"clinical-decision-tree",name:"Clinical Decision Tree",description:"Presentation to diagnosis reasoning",category:"decision-tree",mermaid:`graph TD
    A["Patient Presentation"]
    B{"Key Finding 1?"}
    C{"Key Finding 2?"}
    D["Differential A"]
    E["Differential B"]
    F["Confirm: Test X"]
    G["Confirm: Test Y"]
    A --> B
    B -->|"Present"| D
    B -->|"Absent"| C
    C -->|"Positive"| E
    C -->|"Negative"| D
    D --> F
    E --> G`},{id:"physiological-pathway",name:"Physiological Pathway",description:"Stimulus to response cascade",category:"pathway",mermaid:`graph TD
    A["Stimulus"]
    B["Receptor / Sensor"]
    C["Signal Transduction"]
    D["Effector Response"]
    E["Outcome / Adaptation"]
    F["Feedback Loop"]
    A --> B
    B --> C
    C --> D
    D --> E
    E -->|"negative feedback"| A
    E -->|"modulates"| F
    F --> B`},{id:"compare-contrast",name:"Compare & Contrast",description:"Two concepts with shared and unique features",category:"compare",mermaid:`graph LR
    A["Concept A"]
    B["Shared Feature 1"]
    C["Shared Feature 2"]
    D["Concept B"]
    E["Unique to A"]
    F["Unique to B"]
    A --> B
    D --> B
    A --> C
    D --> C
    A --> E
    D --> F`}],Zs=[{name:"Default",border:"border-secondary",bg:"bg-black/80",text:"text-secondary-foreground",hex:""},{name:"Red",border:"border-red-500",bg:"bg-red-500/10",text:"text-red-400",hex:"#ef4444"},{name:"Blue",border:"border-blue-500",bg:"bg-blue-500/10",text:"text-blue-400",hex:"#3b82f6"},{name:"Green",border:"border-green-500",bg:"bg-green-500/10",text:"text-green-400",hex:"#22c55e"},{name:"Yellow",border:"border-yellow-500",bg:"bg-yellow-500/10",text:"text-yellow-400",hex:"#eab308"},{name:"Purple",border:"border-purple-500",bg:"bg-purple-500/10",text:"text-purple-400",hex:"#a855f7"},{name:"Cyan",border:"border-cyan-400",bg:"bg-cyan-400/10",text:"text-cyan-400",hex:"#22d3ee"},{name:"Orange",border:"border-orange-500",bg:"bg-orange-500/10",text:"text-orange-400",hex:"#f97316"},{name:"Pink",border:"border-pink-500",bg:"bg-pink-500/10",text:"text-pink-400",hex:"#ec4899"}],kE=[{name:"Primary",stroke:"hsl(var(--primary))"},{name:"Red",stroke:"#ef4444"},{name:"Blue",stroke:"#3b82f6"},{name:"Green",stroke:"#22c55e"},{name:"Yellow",stroke:"#eab308"},{name:"Purple",stroke:"#a855f7"},{name:"Cyan",stroke:"#22d3ee"},{name:"Orange",stroke:"#f97316"},{name:"Pink",stroke:"#ec4899"}];function OE({data:e,selected:t}){const r=e.label,n=e.colorIdx||0,i=Zs[n]||Zs[0];return R.jsxs("div",{className:Lt("px-3 py-2 font-terminal text-xs border-2 rounded-none min-w-[100px] text-center",t?"border-primary text-primary ring-1 ring-primary":`${i.border} ${i.text}`,i.bg),children:[R.jsx(je,{type:"target",position:K.Top,className:"!bg-primary !border-primary !w-2 !h-2"}),R.jsx(je,{type:"target",position:K.Left,className:"!bg-primary !border-primary !w-2 !h-2"}),r,R.jsx(je,{type:"source",position:K.Bottom,className:"!bg-primary !border-primary !w-2 !h-2"}),R.jsx(je,{type:"source",position:K.Right,className:"!bg-primary !border-primary !w-2 !h-2"})]})}const DE={arcade:OE},LE={type:"smoothstep",style:{stroke:"hsl(var(--primary))",strokeWidth:2},markerEnd:{type:et.ArrowClosed,color:"hsl(var(--primary))"}};function iC({initialMermaid:e,onSave:t,className:r}){const[n,i,o]=Px([]),[a,s,c]=kx([]),[u,d]=T.useState("TB"),[l,f]=T.useState(!e&&n.length===0),[p,m]=T.useState(e||""),[v,g]=T.useState(0),[y,b]=T.useState(!1),[h,_]=T.useState(null),w=T.useRef(null),{toast:x}=cy();T.useEffect(()=>{if(!y)return;const L=V=>{V.key==="Escape"&&b(!1)};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[y]);const E=T.useCallback(L=>{s(V=>gg(L,V))},[s]),q=T.useCallback(L=>{if(!L.trim())return;const V=TE(L);d(V.direction);const H=$s(V.nodes,V.edges,{direction:V.direction});i(H),s(V.edges),g(V.nodes.length),f(!1)},[i,s]),S=T.useCallback(()=>{const L=$s(n,a,{direction:u});i(L)},[n,a,u,i]),A=T.useCallback(()=>{const L=u==="TB"?"LR":"TB";d(L);const V=$s(n,a,{direction:L});i(V)},[u,n,a,i]),C=T.useCallback(()=>{const L=`N${v+1}`;g(H=>H+1);const V={id:L,type:"arcade",position:{x:Math.random()*300+50,y:Math.random()*200+50},data:{label:`New Node ${v+1}`,colorIdx:0}};i(H=>[...H,V])},[v,i]),N=T.useCallback(()=>{i(L=>L.filter(V=>!V.selected)),s(L=>L.filter(V=>!V.selected))},[i,s]),M=T.useCallback(L=>{i(V=>V.map(H=>H.selected?{...H,data:{...H.data,colorIdx:L}}:H)),_(null)},[i]),O=T.useCallback(L=>{s(V=>V.map(H=>H.selected?{...H,style:{...H.style,stroke:L,strokeWidth:2},markerEnd:{type:et.ArrowClosed,color:L}}:H)),_(null)},[s]),k=T.useCallback(async()=>{if(w.current)try{const L=w.current.querySelector(".react-flow__viewport");if(!L)return;const V=await py(L,{backgroundColor:"#000",quality:1}),H=document.createElement("a");H.download="concept-map.png",H.href=V,H.click(),x({title:"PNG exported"})}catch(L){x({title:"Export failed",description:String(L),variant:"destructive"})}},[x]),$=T.useCallback(()=>{const L=zs(n,a,u);navigator.clipboard.writeText(L),x({title:"Mermaid copied to clipboard"})},[n,a,u,x]),G=T.useCallback(async()=>{const L=zs(n,a,u),V=(n[0]?.data?.label||"Untitled").replace(/[/\\?%*:|"<>]/g,"-"),H=`---
type: concept-map
created: ${new Date().toISOString()}
---

# ${V} Concept Map

\`\`\`mermaid
${L}
\`\`\`
`,W=`Concept Maps/${V}.md`;try{await by.obsidian.saveFile(W,H),x({title:"Saved to vault",description:W}),t?.(L)}catch(I){x({title:"Save failed",description:String(I),variant:"destructive"})}},[n,a,u,x,t]),j=T.useCallback(()=>{f(!0),m(n.length>0?zs(n,a,u):"")},[n,a,u]);return l&&n.length===0?R.jsxs("div",{className:Lt("flex flex-col items-center h-full p-4 gap-3 overflow-auto",r),children:[R.jsx("p",{className:"font-arcade text-[10px] text-primary",children:"CONCEPT MAP EDITOR"}),R.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground",children:"START FROM TEMPLATE"}),R.jsx("div",{className:"grid grid-cols-2 gap-2 w-full max-w-md",children:PE.map(L=>R.jsxs("button",{onClick:()=>q(L.mermaid),className:"border-2 border-secondary/50 hover:border-primary p-3 cursor-pointer text-left transition-colors bg-black/40",children:[R.jsx("p",{className:"font-terminal text-[10px] text-primary",children:L.name}),R.jsx("p",{className:"font-terminal text-[9px] text-muted-foreground mt-0.5",children:L.description})]},L.id))}),R.jsx("div",{className:"w-px h-2"}),R.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground",children:"OR PASTE MERMAID CODE"}),R.jsx(_y,{value:p,onChange:L=>m(L.target.value),placeholder:`graph TD
    A["Main Topic"]
    B["Subtopic 1"]
    C["Subtopic 2"]
    A --> B
    A --> C`,className:"w-full max-w-md h-32 font-mono text-xs rounded-none border-secondary bg-black/60"}),R.jsxs("div",{className:"flex gap-2",children:[R.jsxs(pe,{size:"sm",className:"font-terminal text-xs rounded-none",onClick:()=>q(p),disabled:!p.trim(),children:[R.jsx(ju,{className:"w-3 h-3 mr-1"}),"Import"]}),R.jsxs(pe,{size:"sm",variant:"outline",className:"font-terminal text-xs rounded-none",onClick:()=>{f(!1),C()},children:[R.jsx(Lu,{className:"w-3 h-3 mr-1"}),"Blank Canvas"]})]})]}):R.jsxs("div",{className:Lt("flex flex-col",y?"fixed inset-0 z-[100010] bg-black":"h-full",r),children:[R.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 border-b border-secondary/30 bg-black/40 shrink-0 flex-wrap",children:[R.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:j,title:"Back to import",children:R.jsx(gy,{className:"w-3 h-3"})}),R.jsx("div",{className:"w-px h-4 bg-secondary/30"}),R.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:C,title:"Add node",children:R.jsx(Lu,{className:"w-3 h-3"})}),R.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:N,title:"Delete selected",children:R.jsx(xy,{className:"w-3 h-3"})}),R.jsxs("div",{className:"relative",children:[R.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:()=>_(h?null:"node"),title:"Color selected",children:R.jsx(Ty,{className:"w-3 h-3"})}),h&&R.jsxs("div",{className:"absolute top-full left-0 mt-1 p-2 bg-black border-2 border-primary/50 z-50 space-y-2 min-w-[160px]",children:[R.jsx("p",{className:"font-terminal text-[9px] text-muted-foreground",children:"NODE COLORS"}),R.jsx("div",{className:"flex flex-wrap gap-1",children:Zs.map((L,V)=>R.jsx("button",{onClick:()=>M(V),className:Lt("w-5 h-5 border-2 rounded-none",L.border,L.bg),title:L.name},L.name))}),R.jsx("p",{className:"font-terminal text-[9px] text-muted-foreground pt-1",children:"EDGE COLORS"}),R.jsx("div",{className:"flex flex-wrap gap-1",children:kE.map(L=>R.jsx("button",{onClick:()=>O(L.stroke),className:"w-5 h-5 border-2 border-secondary/50 rounded-none",style:{backgroundColor:L.stroke},title:L.name},L.name))})]})]}),R.jsx("div",{className:"w-px h-4 bg-secondary/30"}),R.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:S,title:"Auto layout",children:R.jsx(Ay,{className:"w-3 h-3"})}),R.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:A,title:`Direction: ${u}`,children:u==="TB"?R.jsx(Ry,{className:"w-3 h-3"}):R.jsx(Sy,{className:"w-3 h-3"})}),R.jsx("div",{className:"w-px h-4 bg-secondary/30"}),R.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:$,title:"Copy Mermaid",children:R.jsx(Ey,{className:"w-3 h-3"})}),R.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:k,title:"Export PNG",children:R.jsx(vy,{className:"w-3 h-3"})}),R.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:G,title:"Save to vault",children:R.jsx(wy,{className:"w-3 h-3"})}),R.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:()=>b(!y),title:y?"Exit fullscreen":"Fullscreen",children:y?R.jsx(my,{className:"w-3 h-3"}):R.jsx(yy,{className:"w-3 h-3"})}),R.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:()=>{f(!0),i([]),s([])},title:"Import Mermaid",children:R.jsx(ju,{className:"w-3 h-3"})}),R.jsxs("span",{className:"ml-auto text-[9px] font-terminal text-muted-foreground",children:[n.length,"N / ",a.length,"E"]})]}),R.jsx("div",{className:"flex-1 min-h-0",ref:w,children:R.jsxs(Tx,{nodes:n,edges:a,onNodesChange:o,onEdgesChange:c,onConnect:E,nodeTypes:DE,defaultEdgeOptions:LE,fitView:!0,className:"bg-black/80",proOptions:{hideAttribution:!0},onPaneClick:()=>_(null),children:[R.jsx(Bx,{color:"hsl(var(--primary) / 0.1)",gap:20}),R.jsx(Ux,{className:"!bg-black !border-primary [&_button]:!bg-black/80 [&_button]:!border-primary/50 [&_button]:!text-primary"}),R.jsx(o0,{className:"!bg-black/80 !border-primary",nodeColor:"hsl(var(--primary))",maskColor:"rgba(0,0,0,0.5)"})]})})]})}export{iC as ConceptMapEditor};
