import{c as Se,r as u,j as e,b as Z,R as rt,d as ot,e as H,f as lt,P as xs,g as it,u as Me,X as je}from"./index-BIDjTSt1.js";import{h as dt,i as ct,j as hs,u as q,a as V,g as S,S as pe,B as R,L as mt,k as ut,C as Ae,f as xt,l as _e,T as he,P as De,I as Ee,D as as,c as ns,d as rs,e as os,m as ls,n as le,o as is}from"./layout-DpJf8aOa.js";import{C as G,a as de,b as ce,c as Q}from"./card-BPAaAEjA.js";import{e as ht,S as Ne,a as ve,b as we,c as Ce,d as $,C as pt}from"./select-Brac1y4r.js";import{B as Be,S as bt,R as ds}from"./badge-C2cucOY8.js";import{M as ft,T as gt,a as yt,b as Ie,c as Te}from"./tabs-eyUuQY63.js";import{c as ps,R as jt,T as Nt,C as vt,a as ie,E as wt}from"./index-7YxX1s4B.js";import{A as bs,a as fs,b as gs,c as ys,d as js,e as Ns,f as vs,g as ws}from"./alert-dialog-HtQ1LcWr.js";import{B as Ct}from"./book-open-DYwYtr36.js";import{L as St}from"./loader-circle-C9K5_vNj.js";import{M as kt,r as At,F as Dt,a as cs}from"./index-CmzGJq0r.js";import{F as Et}from"./file-text-BfxQTnHI.js";import{i as It,f as Tt}from"./format-D7m0hUtg.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],Pt=Se("brain-circuit",Ot);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Rt=Se("database",Mt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Lt=Se("file",Ft);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],$t=Se("image",qt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Je=Se("layers",_t),Cs=u.forwardRef(({className:n,...o},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:Z("w-full caption-bottom text-sm",n),...o})}));Cs.displayName="Table";const Ss=u.forwardRef(({className:n,...o},a)=>e.jsx("thead",{ref:a,className:Z("[&_tr]:border-b",n),...o}));Ss.displayName="TableHeader";const ks=u.forwardRef(({className:n,...o},a)=>e.jsx("tbody",{ref:a,className:Z("[&_tr:last-child]:border-0",n),...o}));ks.displayName="TableBody";const zt=u.forwardRef(({className:n,...o},a)=>e.jsx("tfoot",{ref:a,className:Z("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",n),...o}));zt.displayName="TableFooter";const Ke=u.forwardRef(({className:n,...o},a)=>e.jsx("tr",{ref:a,className:Z("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",n),...o}));Ke.displayName="TableRow";const ae=u.forwardRef(({className:n,...o},a)=>e.jsx("th",{ref:a,className:Z("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),...o}));ae.displayName="TableHead";const ne=u.forwardRef(({className:n,...o},a)=>e.jsx("td",{ref:a,className:Z("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),...o}));ne.displayName="TableCell";const Bt=u.forwardRef(({className:n,...o},a)=>e.jsx("caption",{ref:a,className:Z("mt-4 text-sm text-muted-foreground",n),...o}));Bt.displayName="TableCaption";function Kt(n,o,{checkForDefaultPrevented:a=!0}={}){return function(r){if(n?.(r),a===!1||!r.defaultPrevented)return o?.(r)}}var Ut=rt[" useInsertionEffect ".trim().toString()]||ot;function As({prop:n,defaultProp:o,onChange:a=()=>{},caller:m}){const[r,c,p]=Vt({defaultProp:o,onChange:a}),b=n!==void 0,C=b?n:r;{const f=u.useRef(n!==void 0);u.useEffect(()=>{const x=f.current;x!==b&&console.warn(`${m} is changing from ${x?"controlled":"uncontrolled"} to ${b?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=b},[b,m])}const w=u.useCallback(f=>{if(b){const x=Wt(f)?f(n):f;x!==n&&p.current?.(x)}else c(f)},[b,n,c,p]);return[C,w]}function Vt({defaultProp:n,onChange:o}){const[a,m]=u.useState(n),r=u.useRef(a),c=u.useRef(o);return Ut(()=>{c.current=o},[o]),u.useEffect(()=>{r.current!==a&&(c.current?.(a),r.current=a)},[a,r]),[a,m,c]}function Wt(n){return typeof n=="function"}var ee="Accordion",Ht=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Ye,Jt,Yt]=ht(ee),[Re]=lt(ee,[Yt,ps]),Ge=ps(),Ds=H.forwardRef((n,o)=>{const{type:a,...m}=n,r=m,c=m;return e.jsx(Ye.Provider,{scope:n.__scopeAccordion,children:a==="multiple"?e.jsx(Zt,{...c,ref:o}):e.jsx(Xt,{...r,ref:o})})});Ds.displayName=ee;var[Es,Gt]=Re(ee),[Is,Qt]=Re(ee,{collapsible:!1}),Xt=H.forwardRef((n,o)=>{const{value:a,defaultValue:m,onValueChange:r=()=>{},collapsible:c=!1,...p}=n,[b,C]=As({prop:a,defaultProp:m??"",onChange:r,caller:ee});return e.jsx(Es,{scope:n.__scopeAccordion,value:H.useMemo(()=>b?[b]:[],[b]),onItemOpen:C,onItemClose:H.useCallback(()=>c&&C(""),[c,C]),children:e.jsx(Is,{scope:n.__scopeAccordion,collapsible:c,children:e.jsx(Ts,{...p,ref:o})})})}),Zt=H.forwardRef((n,o)=>{const{value:a,defaultValue:m,onValueChange:r=()=>{},...c}=n,[p,b]=As({prop:a,defaultProp:m??[],onChange:r,caller:ee}),C=H.useCallback(f=>b((x=[])=>[...x,f]),[b]),w=H.useCallback(f=>b((x=[])=>x.filter(k=>k!==f)),[b]);return e.jsx(Es,{scope:n.__scopeAccordion,value:p,onItemOpen:C,onItemClose:w,children:e.jsx(Is,{scope:n.__scopeAccordion,collapsible:!0,children:e.jsx(Ts,{...c,ref:o})})})}),[ea,Fe]=Re(ee),Ts=H.forwardRef((n,o)=>{const{__scopeAccordion:a,disabled:m,dir:r,orientation:c="vertical",...p}=n,b=H.useRef(null),C=it(b,o),w=Jt(a),x=ct(r)==="ltr",k=Kt(n.onKeyDown,y=>{if(!Ht.includes(y.key))return;const D=y.target,F=w().filter(t=>!t.ref.current?.disabled),T=F.findIndex(t=>t.ref.current===D),E=F.length;if(T===-1)return;y.preventDefault();let O=T;const J=0,z=E-1,B=()=>{O=T+1,O>z&&(O=J)},_=()=>{O=T-1,O<J&&(O=z)};switch(y.key){case"Home":O=J;break;case"End":O=z;break;case"ArrowRight":c==="horizontal"&&(x?B():_());break;case"ArrowDown":c==="vertical"&&B();break;case"ArrowLeft":c==="horizontal"&&(x?_():B());break;case"ArrowUp":c==="vertical"&&_();break}const K=O%E;F[K].ref.current?.focus()});return e.jsx(ea,{scope:a,disabled:m,direction:r,orientation:c,children:e.jsx(Ye.Slot,{scope:a,children:e.jsx(xs.div,{...p,"data-orientation":c,ref:C,onKeyDown:m?void 0:k})})})}),Pe="AccordionItem",[sa,Qe]=Re(Pe),Os=H.forwardRef((n,o)=>{const{__scopeAccordion:a,value:m,...r}=n,c=Fe(Pe,a),p=Gt(Pe,a),b=Ge(a),C=dt(),w=m&&p.value.includes(m)||!1,f=c.disabled||n.disabled;return e.jsx(sa,{scope:a,open:w,disabled:f,triggerId:C,children:e.jsx(jt,{"data-orientation":c.orientation,"data-state":qs(w),...b,...r,ref:o,disabled:f,open:w,onOpenChange:x=>{x?p.onItemOpen(m):p.onItemClose(m)}})})});Os.displayName=Pe;var Ps="AccordionHeader",Ms=H.forwardRef((n,o)=>{const{__scopeAccordion:a,...m}=n,r=Fe(ee,a),c=Qe(Ps,a);return e.jsx(xs.h3,{"data-orientation":r.orientation,"data-state":qs(c.open),"data-disabled":c.disabled?"":void 0,...m,ref:o})});Ms.displayName=Ps;var Ue="AccordionTrigger",Rs=H.forwardRef((n,o)=>{const{__scopeAccordion:a,...m}=n,r=Fe(ee,a),c=Qe(Ue,a),p=Qt(Ue,a),b=Ge(a);return e.jsx(Ye.ItemSlot,{scope:a,children:e.jsx(Nt,{"aria-disabled":c.open&&!p.collapsible||void 0,"data-orientation":r.orientation,id:c.triggerId,...b,...m,ref:o})})});Rs.displayName=Ue;var Fs="AccordionContent",Ls=H.forwardRef((n,o)=>{const{__scopeAccordion:a,...m}=n,r=Fe(ee,a),c=Qe(Fs,a),p=Ge(a);return e.jsx(vt,{role:"region","aria-labelledby":c.triggerId,"data-orientation":r.orientation,...p,...m,ref:o,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...n.style}})});Ls.displayName=Fs;function qs(n){return n?"open":"closed"}var ta=Ds,aa=Os,na=Ms,$s=Rs,_s=Ls;const ra=ta,Ve=u.forwardRef(({className:n,...o},a)=>e.jsx(aa,{ref:a,className:Z("border-b",n),...o}));Ve.displayName="AccordionItem";const We=u.forwardRef(({className:n,children:o,...a},m)=>e.jsx(na,{className:"flex",children:e.jsxs($s,{ref:m,className:Z("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",n),...a,children:[o,e.jsx(hs,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));We.displayName=$s.displayName;const He=u.forwardRef(({className:n,children:o,...a},m)=>e.jsx(_s,{ref:m,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:e.jsx("div",{className:Z("pb-4 pt-0",n),children:o})}));He.displayName=_s.displayName;const oa=`You are extracting a full course syllabus for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Top-level structure:
{
  "term": {
    "startDate": "2026-01-05",
    "endDate": "2026-04-24",
    "timezone": "America/Chicago"
  },
  "modules": [
    {
      "name": "Module 1: ...",
      "orderIndex": 1,
      "topics": ["..."],
      "readings": ["..."],
      "assessments": ["..."]
    }
  ],
  "events": [
    {
      "type": "class" | "lecture" | "reading" | "topic" | "assignment" | "quiz" | "exam" | "assessment",
      "title": "string",
      "date": "YYYY-MM-DD",
      "dueDate": "YYYY-MM-DD | null",
      "startTime": "HH:MM | null",
      "endTime": "HH:MM | null",
      "daysOfWeek": ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
      "delivery": "in_person" | "virtual_sync" | "virtual_async" | "hybrid",
      "assessmentType": "EA | null",
      "moduleName": "Module 1: ... | null",
      "notes": "string | null"
    }
  ]
}

Rules:
1. Include ALL items: class meetings, assignments, quizzes, exams, topics, readings, virtual synchronous/asynchronous activities, and learning assessments (EA).
2. For repeating class meetings, set daysOfWeek + startTime/endTime, and include term start/end.
3. For one-off items, set date or dueDate.
4. Keep moduleName when items belong to a module.
5. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,la=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,ia=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function da(){const n=Me(),[o,a]=u.useState(null),[m,r]=u.useState(null),[c,p]=u.useState(""),[b,C]=u.useState(""),[w,f]=u.useState(null),[x,k]=u.useState(""),[y,D]=u.useState(null),[F,T]=u.useState(null),[E,O]=u.useState(null),{data:J=[]}=q({queryKey:["courses"],queryFn:()=>S.courses.getActive()}),{data:z=[]}=q({queryKey:["modules",o],queryFn:()=>o?S.modules.getByCourse(o):Promise.resolve([]),enabled:!!o}),{data:B=[]}=q({queryKey:["learningObjectives",o],queryFn:()=>o?S.learningObjectives.getByCourse(o):Promise.resolve([]),enabled:!!o}),_=V({mutationFn:async i=>{if(!o)throw new Error("Select a course first");const g=JSON.parse(l(i));return S.syllabus.importBulk(o,g)},onSuccess:i=>{n.invalidateQueries({queryKey:["scheduleEvents"]}),n.invalidateQueries({queryKey:["modules"]}),p(""),T({type:"success",message:`Imported: ${i.modulesCreated} modules, ${i.eventsCreated} events (${i.classMeetingsExpanded} class meetings expanded)`}),f(null)},onError:i=>{T({type:"error",message:i.message||"Failed to import syllabus"}),f(i.message||"Failed to import syllabus")}}),K=V({mutationFn:async i=>{if(!o)throw new Error("Select a course first");const g=JSON.parse(l(i));return S.learningObjectives.createBulk(o,m,g)},onSuccess:()=>{n.invalidateQueries({queryKey:["learningObjectives"]}),C(""),f(null)},onError:i=>{f(i.message||"Failed to import LOs")}}),t=i=>{navigator.clipboard.writeText(i)},l=i=>{const g=i.trim();if(!g)return"";const N=g.match(/```json\s*([\s\S]*?)```/i)||g.match(/```\s*([\s\S]*?)```/i),I=N?N[1].trim():g,P=I.indexOf("{"),W=I.lastIndexOf("}");return P!==-1&&W!==-1&&W>P?I.slice(P,W+1).trim():I},h=i=>{const g=[];let N=null;try{const j=l(i);if(!j){g.push("No JSON found in input"),O({isValid:!1,errors:g});return}N=JSON.parse(j)}catch(j){g.push(`Invalid JSON: ${j.message}`),O({isValid:!1,errors:g});return}(!N||typeof N!="object")&&g.push("JSON must be an object");const I=N.name&&typeof N.name=="string"&&N.name.trim(),P=N.term&&typeof N.term=="object",W=Array.isArray(N.modules),se=Array.isArray(N.events);if(I||g.push("Missing or invalid 'name' field"),P||g.push("Missing or invalid 'term' object"),W||g.push("Missing or invalid 'modules' array"),se||g.push("Missing or invalid 'events' array"),P&&(N.term.startDate||g.push("term.startDate is required"),N.term.endDate||g.push("term.endDate is required")),g.length===0){const j={courseName:N.name,moduleCount:N.modules?.length||0,eventCount:N.events?.length||0,startDate:N.term?.startDate,endDate:N.term?.endDate};O({isValid:!0,errors:[],preview:j})}else O({isValid:!1,errors:g})},v=async()=>{try{D(null);const i=x,N=await S.brain.ingest(i,"pasted_wrap.md");N.sessionSaved?(D({type:"success",message:`✓ Session saved! ID: ${N.sessionId}, Cards: ${N.cardsCreated||0}`}),k("")):D({type:"error",message:N.errors?.join(", ")||N.message})}catch(i){D({type:"error",message:i.message||"Failed to ingest"})}};return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:o||"",onChange:i=>{a(i.target.value?parseInt(i.target.value):null),r(null)},children:[e.jsx("option",{value:"",children:"-- Select Course --"}),J.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})]}),!o&&e.jsx("p",{className:"text-center text-muted-foreground font-terminal text-sm py-8",children:"Select a course above to begin ingestion."}),o&&e.jsxs("div",{className:"border border-secondary/40 rounded-none p-4 bg-primary/5",children:[e.jsx("h2",{className:"text-xl font-arcade text-primary mb-4",children:"WRAP SESSION INGESTION"}),y&&e.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${y.type==="success"?"bg-green-900/30 border border-green-500 text-green-400":"bg-red-900/30 border border-red-500 text-red-400"}`,children:y.message}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>t(ia),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:x,onChange:i=>{k(i.target.value),D(null)}})]}),e.jsx("button",{onClick:v,disabled:!x,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-arcade text-primary",children:"MATERIAL INGESTION"}),w&&e.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:w}),o&&e.jsxs(ra,{type:"multiple",className:"border border-secondary/40 rounded-none divide-y divide-secondary/40",children:[e.jsxs(Ve,{value:"syllabus-import",className:"border-secondary/40",children:[e.jsx(We,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"SYLLABUS IMPORT (MODULES + SCHEDULE)"}),e.jsxs(He,{className:"px-3",children:[e.jsx("button",{onClick:()=>t(oa),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (combined JSON object) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"term":{"startDate":"2026-01-15","endDate":"2026-05-01","timezone":"America/Chicago"},"modules":[...],"events":[...]}',value:c,onChange:i=>{p(i.target.value),T(null),i.target.value.trim()?h(i.target.value):O(null)}}),E&&!E.isValid&&e.jsxs("div",{className:"mt-2 p-2 border border-red-500 bg-red-900/30 rounded-none font-terminal text-xs text-red-400",children:[e.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),E.errors.map((i,g)=>e.jsxs("div",{children:["• ",i]},g))]}),E&&E.isValid&&E.preview&&e.jsxs("div",{className:"mt-2 p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[e.jsx("div",{className:"font-bold mb-2",children:"✓ Valid JSON Preview:"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Course:"})," ",E.preview.courseName]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Modules:"})," ",E.preview.moduleCount]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Events:"})," ",E.preview.eventCount]}),E.preview.startDate&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Start:"})," ",E.preview.startDate]}),E.preview.endDate&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"End:"})," ",E.preview.endDate]})]})]}),e.jsx("button",{onClick:()=>_.mutate(c),disabled:!E?.isValid||_.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:_.isPending?"Importing...":"Import Syllabus"}),F&&e.jsx("div",{className:`mt-2 p-2 border font-terminal text-xs ${F.type==="success"?"border-green-500 text-green-400":"border-red-500 text-red-400"}`,children:F.message})]})]}),e.jsxs(Ve,{value:"learning-objectives",className:"border-secondary/40",children:[e.jsx(We,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"LEARNING OBJECTIVES IMPORT"}),e.jsxs(He,{className:"px-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:m||"",onChange:i=>r(i.target.value?parseInt(i.target.value):null),children:[e.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),z.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})]}),e.jsx("button",{onClick:()=>t(la),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:b,onChange:i=>C(i.target.value)}),e.jsx("button",{onClick:()=>K.mutate(b),disabled:!b||K.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:K.isPending?"Importing...":"Import LOs"}),B.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",B.length,")"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:B.map(i=>e.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[e.jsx("span",{className:"text-primary",children:i.loCode}),": ",i.title,e.jsx("span",{className:`ml-2 text-[10px] px-1 rounded ${i.status==="solid"?"bg-green-600":i.status==="in_progress"?"bg-yellow-600":i.status==="need_review"?"bg-orange-600":"bg-gray-600"}`,children:i.status})]},i.id))})]})]})]})]})]})]})}function ca(){const n=Me(),[o,a]=u.useState(null),[m,r]=u.useState({}),[c,p]=u.useState({}),[b,C]=u.useState(new Set),[w,f]=u.useState(new Set),[x,k]=u.useState(null),y=u.useRef(null),{data:D=[]}=q({queryKey:["courses"],queryFn:()=>S.courses.getActive()}),{data:F=[]}=q({queryKey:["modules",o],queryFn:()=>o?S.modules.getByCourse(o):Promise.resolve([]),enabled:!!o}),{data:T=[]}=q({queryKey:["scheduleEvents",o],queryFn:()=>o?S.scheduleEvents.getByCourse(o):Promise.resolve([]),enabled:!!o}),E=V({mutationFn:({id:t,data:l})=>S.modules.update(t,l),onSuccess:()=>{n.invalidateQueries({queryKey:["modules"]})}}),O=V({mutationFn:t=>S.modules.delete(t),onSuccess:()=>{n.invalidateQueries({queryKey:["modules"]})}}),J=V({mutationFn:t=>S.modules.deleteMany(t),onSuccess:()=>{n.invalidateQueries({queryKey:["modules"]}),C(new Set)}}),z=V({mutationFn:({id:t,data:l})=>S.scheduleEvents.update(t,l),onSuccess:()=>{n.invalidateQueries({queryKey:["scheduleEvents"]})}}),B=V({mutationFn:t=>S.scheduleEvents.delete(t),onSuccess:()=>{n.invalidateQueries({queryKey:["scheduleEvents"]})}}),_=V({mutationFn:t=>S.scheduleEvents.deleteMany(t),onSuccess:()=>{n.invalidateQueries({queryKey:["scheduleEvents"]}),f(new Set)}}),K=(t,l,h)=>{if(!l.length)return;const v={type:t,ids:l,label:h};y.current=v,k(v)};return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:o||"",onChange:t=>{a(t.target.value?parseInt(t.target.value):null)},children:[e.jsx("option",{value:"",children:"-- Select Course --"}),D.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),o&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(G,{className:"brain-card rounded-none",children:[e.jsx(de,{className:"border-b border-secondary/50 p-3",children:e.jsxs(ce,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4"}),"MODULES (",F.length,")"]})}),e.jsx(Q,{className:"p-0",children:F.length===0?e.jsx("p",{className:"text-xs text-muted-foreground font-terminal p-4",children:"No modules yet. Import a syllabus to add modules."}):e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const t=new Set;b.size!==F.length&&F.forEach(l=>t.add(l.id)),C(t)},children:b.size===F.length?"Uncheck All":"Check All"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:b.size===0,onClick:()=>{K("modules",Array.from(b),`Delete ${b.size} module(s)? This cannot be undone.`)},children:"Delete"}),e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:b.size===0,onClick:()=>{b.forEach(t=>{const l=m[t];l&&E.mutate({id:t,data:l})}),r(t=>{const l={...t};return b.forEach(h=>{delete l[h]}),l})},children:"Save"})]}),e.jsx(pe,{className:"h-[280px]",children:e.jsxs("table",{className:"w-full text-sm font-terminal",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-secondary/50",children:[e.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),e.jsx("th",{className:"text-left p-2",children:"Module"}),e.jsx("th",{className:"text-center p-2",children:"Order"}),e.jsx("th",{className:"text-center p-2",children:"Files"}),e.jsx("th",{className:"text-center p-2",children:"NotebookLM"}),e.jsx("th",{className:"text-center p-2",children:"Status"}),e.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),e.jsx("tbody",{children:F.map(t=>e.jsxs("tr",{className:"border-b border-secondary/30",children:[e.jsx("td",{className:"text-center p-2",children:e.jsx(ie,{checked:b.has(t.id),onCheckedChange:l=>C(h=>{const v=new Set(h);return l?v.add(t.id):v.delete(t.id),v}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:m[t.id]?.name??t.name,onChange:l=>r(h=>({...h,[t.id]:{...h[t.id],name:l.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"number",className:"w-16 bg-black border border-secondary rounded-none p-1 text-xs font-terminal text-center",value:m[t.id]?.orderIndex??t.orderIndex??0,onChange:l=>r(h=>({...h,[t.id]:{...h[t.id],orderIndex:parseInt(l.target.value||"0",10)}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx(ie,{checked:t.filesDownloaded,onCheckedChange:l=>E.mutate({id:t.id,data:{filesDownloaded:!!l}}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"text-center p-2",children:e.jsx(ie,{checked:t.notebooklmLoaded,onCheckedChange:l=>E.mutate({id:t.id,data:{notebooklmLoaded:!!l}}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"text-center p-2",children:t.filesDownloaded&&t.notebooklmLoaded?e.jsx("span",{className:"text-green-400",children:"Ready"}):e.jsx("span",{className:"text-yellow-400",children:"Pending"})}),e.jsxs("td",{className:"text-center p-2 space-x-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!m[t.id],onClick:()=>{const l=m[t.id];l&&(E.mutate({id:t.id,data:l}),r(h=>{const v={...h};return delete v[t.id],v}))},children:"Save"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>O.mutate(t.id),children:"Delete"})]})]},t.id))})]})})]})})]}),e.jsxs(G,{className:"brain-card rounded-none",children:[e.jsx(de,{className:"border-b border-secondary/50 p-3",children:e.jsxs(ce,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4"}),"SCHEDULE ITEMS (",T.length,")"]})}),e.jsx(Q,{className:"p-0",children:T.length===0?e.jsx("p",{className:"text-xs text-muted-foreground font-terminal p-4",children:"No schedule items yet. Import a syllabus to add events."}):e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const t=new Set;w.size!==T.length&&T.forEach(l=>t.add(l.id)),f(t)},children:w.size===T.length?"Uncheck All":"Check All"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:w.size===0,onClick:()=>{K("schedule",Array.from(w),`Delete ${w.size} schedule item(s)? This cannot be undone.`)},children:"Delete"}),e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:w.size===0,onClick:()=>{w.forEach(t=>{const l=c[t];l&&z.mutate({id:t,data:l})}),p(t=>{const l={...t};return w.forEach(h=>{delete l[h]}),l})},children:"Save"})]}),e.jsx(pe,{className:"h-[280px]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs font-terminal",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-secondary/50",children:[e.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),e.jsx("th",{className:"text-left p-2",children:"Type"}),e.jsx("th",{className:"text-left p-2",children:"Delivery"}),e.jsx("th",{className:"text-left p-2",children:"Title"}),e.jsx("th",{className:"text-center p-2",children:"Date"}),e.jsx("th",{className:"text-center p-2",children:"Start"}),e.jsx("th",{className:"text-center p-2",children:"End"}),e.jsx("th",{className:"text-center p-2",children:"Due"}),e.jsx("th",{className:"text-left p-2",children:"Notes"}),e.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),e.jsx("tbody",{children:T.map(t=>{const l=c[t.id]||{},h=l.type??t.type??"",v=l.delivery??t.delivery??"",i=l.title??t.title??"",g=l.date??t.date??"",N=l.startTime??t.startTime??"",I=l.endTime??t.endTime??"",P=l.dueDate??t.dueDate??"",W=l.notes??t.notes??"",se=!!c[t.id];return e.jsxs("tr",{className:"border-b border-secondary/30 align-top",children:[e.jsx("td",{className:"text-center p-2",children:e.jsx(ie,{checked:w.has(t.id),onCheckedChange:j=>f(A=>{const Y=new Set(A);return j?Y.add(t.id):Y.delete(t.id),Y}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"p-2",children:e.jsx("select",{className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:h,onChange:j=>p(A=>({...A,[t.id]:{...A[t.id],type:j.target.value}})),children:["class","lecture","reading","topic","assignment","quiz","exam","assessment","other"].map(j=>e.jsx("option",{value:j,children:j},j))})}),e.jsx("td",{className:"p-2",children:e.jsx("select",{className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:v,onChange:j=>p(A=>({...A,[t.id]:{...A[t.id],delivery:j.target.value}})),children:["","in_person","virtual_sync","virtual_async","online_module","hybrid"].map(j=>e.jsx("option",{value:j,children:j||"--"},j))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:i,onChange:j=>p(A=>({...A,[t.id]:{...A[t.id],title:j.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:g||"",onChange:j=>p(A=>({...A,[t.id]:{...A[t.id],date:j.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:N||"",onChange:j=>p(A=>({...A,[t.id]:{...A[t.id],startTime:j.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:I||"",onChange:j=>p(A=>({...A,[t.id]:{...A[t.id],endTime:j.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:P||"",onChange:j=>p(A=>({...A,[t.id]:{...A[t.id],dueDate:j.target.value}}))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:W||"",onChange:j=>p(A=>({...A,[t.id]:{...A[t.id],notes:j.target.value}}))})}),e.jsxs("td",{className:"text-center p-2 space-x-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!se,onClick:()=>{z.mutate({id:t.id,data:{type:h,title:i,date:g,startTime:N,endTime:I,dueDate:P,notes:W,delivery:v}}),p(j=>{const A={...j};return delete A[t.id],A})},children:"Save"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>B.mutate(t.id),children:"Delete"})]})]},t.id)})})]})})})]})})]})]}),e.jsx(bs,{open:!!x,onOpenChange:t=>!t&&k(null),children:e.jsxs(fs,{className:"bg-black border-2 border-primary rounded-none font-terminal text-primary shadow-none max-w-md translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(gs,{className:"text-left",children:[e.jsx(ys,{className:"font-arcade text-destructive",children:"CONFIRM_DELETE"}),e.jsx(js,{className:"font-terminal text-muted-foreground",children:x?.label})]}),e.jsxs(Ns,{className:"gap-2 sm:justify-end",children:[e.jsx(vs,{className:"rounded-none border-secondary font-terminal text-xs hover:bg-secondary/20",onClick:()=>{y.current=null,k(null)},children:"CANCEL"}),e.jsx(ws,{className:"rounded-none bg-destructive text-destructive-foreground font-arcade text-xs hover:bg-destructive/80",type:"button",onClick:()=>{const t=y.current;t&&(t.type==="modules"?J.mutate(t.ids):_.mutate(t.ids),y.current=null,k(null))},children:"DELETE"})]})]})})]})}function ma(){const[n,o]=u.useState(null),{data:a=[]}=q({queryKey:["courses"],queryFn:async()=>{const x=await fetch("/api/courses");if(!x.ok)throw new Error("Failed to fetch courses");return x.json()}}),{data:m=[],isLoading:r}=q({queryKey:["modules",n],queryFn:()=>n?S.modules.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:c=[]}=q({queryKey:["learningObjectives",n],queryFn:()=>n?S.learningObjectives.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:p=[]}=q({queryKey:["scheduleEvents",n],queryFn:()=>n?S.scheduleEvents.getByCourse(n):Promise.resolve([]),enabled:!!n}),b=m.reduce((x,k)=>{const y=k.orderIndex||0;return x[y]||(x[y]=[]),x[y].push(k),x},{}),C=c.reduce((x,k)=>{const y=k.moduleId||0;return x[y]||(x[y]=[]),x[y].push(k),x},{}),w=p.reduce((x,k)=>{const y=k.linkedModuleId||0;return x[y]||(x[y]=[]),x[y].push(k),x},{}),f=m.length>0||c.length>0||p.length>0;return e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs(G,{className:"brain-card rounded-none",children:[e.jsx(de,{className:"border-b border-secondary/50 p-3",children:e.jsx(ce,{className:"font-arcade text-sm",children:"SELECT COURSE"})}),e.jsx(Q,{className:"p-3",children:e.jsxs(Ne,{value:n?.toString()||"",onValueChange:x=>o(x?parseInt(x):null),children:[e.jsx(ve,{className:"rounded-none border-primary",children:e.jsx(we,{placeholder:"Choose a course..."})}),e.jsx(Ce,{children:a.map(x=>e.jsx($,{value:x.id.toString(),children:x.name},x.id))})]})})]}),n?r?e.jsx(G,{className:"brain-card rounded-none",children:e.jsx(Q,{className:"p-8 text-center",children:e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Loading syllabus..."})})}):f?e.jsx(pe,{className:"h-[600px]",children:e.jsx("div",{className:"space-y-4 pr-4",children:Object.entries(b).sort(([x],[k])=>parseInt(x)-parseInt(k)).map(([x,k])=>e.jsxs(G,{className:"brain-card rounded-none",children:[e.jsx(de,{className:"border-b border-secondary/50 p-3",children:e.jsxs(ce,{className:"font-arcade text-sm",children:["WEEK ",x]})}),e.jsx(Q,{className:"p-3 space-y-3",children:k.map(y=>e.jsxs("div",{className:"space-y-2 border-l-2 border-secondary/40 pl-3",children:[e.jsx("div",{className:"font-arcade text-xs text-primary",children:y.name}),C[y.id]&&C[y.id].length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground uppercase",children:"Objectives"}),e.jsx("div",{className:"space-y-1",children:C[y.id].map(D=>e.jsxs("div",{className:"font-terminal text-xs text-secondary",children:["• ",D.loCode,": ",D.title]},D.id))})]}),w[y.id]&&w[y.id].length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground uppercase",children:"Events"}),e.jsx("div",{className:"space-y-1",children:w[y.id].map(D=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{variant:"outline",className:`text-[10px] font-terminal ${D.type==="quiz"?"border-yellow-500/50 text-yellow-400":D.type==="exam"?"border-red-500/50 text-red-400":"border-blue-500/50 text-blue-400"}`,children:D.type?.toUpperCase()}),e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:D.title}),D.dueDate&&e.jsx("span",{className:"font-terminal text-[10px] text-secondary ml-auto",children:new Date(D.dueDate).toLocaleDateString()})]},D.id))})]})]},y.id))})]},x))})}):e.jsx(G,{className:"brain-card rounded-none",children:e.jsx(Q,{className:"p-8 text-center",children:e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"No syllabus imported"})})}):e.jsx(G,{className:"brain-card rounded-none",children:e.jsx(Q,{className:"p-8 text-center",children:e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Select a course to view syllabus"})})})]})}function ms(n,o){if(o.length===0)return n;const a=[];for(const m of o)a.push({type:"image_url",image_url:{url:m}});return n.trim()&&a.push({type:"text",text:n}),a}function ua(){const[n,o]=u.useState(!1),[a,m]=u.useState("chat"),[r,c]=u.useState([]),[p,b]=u.useState(""),[C,w]=u.useState([]),[f,x]=u.useState(!1),[k,y]=u.useState("anki"),D=u.useRef(null),F=u.useRef(null),T=Me(),E=u.useCallback(()=>{D.current&&(D.current.scrollTop=D.current.scrollHeight)},[]);u.useEffect(()=>{E()},[r,E]);const O=l=>{const h=new FileReader;h.onload=()=>{typeof h.result=="string"&&w(v=>[...v,h.result])},h.readAsDataURL(l)},J=l=>{const h=l.clipboardData?.items;if(h){for(const v of Array.from(h))if(v.type.startsWith("image/")){l.preventDefault();const i=v.getAsFile();i&&O(i)}}},z=l=>{const h=l.target.files;if(h){for(const v of Array.from(h))v.type.startsWith("image/")&&O(v);l.target.value=""}},B=async(l,h)=>{c(P=>[...P,{role:"assistant",content:""}]);const v=r.map(P=>({role:P.role,content:P.images?.length?ms(P.content,P.images):P.content})).concat([{role:"user",content:ms(l,h)}]),g=(await fetch("/api/brain/quick-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:v})})).body?.getReader(),N=new TextDecoder;if(!g)throw new Error("No response body");let I="";for(;;){const{done:P,value:W}=await g.read();if(P)break;I+=N.decode(W,{stream:!0});const se=I.split(`
`);I=se.pop()??"";for(const j of se){if(!j.startsWith("data: "))continue;const A=j.slice(6);if(A==="[DONE]")break;try{const Y=JSON.parse(A);if(Y.error){c(me=>{const X=[...me];return X[X.length-1]={role:"assistant",content:`Error: ${Y.error}`},X});return}Y.content&&c(me=>{const X=[...me],U=X[X.length-1];return X[X.length-1]={...U,content:U.content+Y.content},X})}catch{}}}},_=async l=>{try{const h=k==="both"?"all":k,v=k==="obsidian"||k==="both",i=await S.brain.chat(l,v,h);let g=i.response;const N={cardsCreated:i.cardsCreated,sessionSaved:i.sessionSaved,sessionId:i.sessionId},I=[];i.sessionSaved&&I.push(`Session saved (ID: ${i.sessionId})`),i.cardsCreated&&I.push(`${i.cardsCreated} Anki cards created`),i.obsidianSynced&&I.push("Synced to Obsidian"),i.obsidianError&&I.push(`Obsidian error: ${i.obsidianError}`),I.length>0&&(g=`${I.join(" | ")}

${g}`),c(P=>[...P,{role:"assistant",content:g,meta:N}]),T.invalidateQueries({queryKey:["anki","drafts"]}),T.invalidateQueries({queryKey:["brain","metrics"]}),T.invalidateQueries({queryKey:["sessions"]})}catch(h){c(v=>[...v,{role:"assistant",content:`Error: ${h}`}])}},K=async()=>{const l=p.trim();if(!l&&C.length===0)return;const h={role:"user",content:l,images:[...C]};c(v=>[...v,h]),b(""),w([]),x(!0);try{a==="chat"?await B(l,h.images??[]):await _(l)}catch(v){c(i=>{const g=i[i.length-1];if(g?.role==="assistant"&&!g.content){const N=[...i];return N[N.length-1]={role:"assistant",content:`Error: ${v}`},N}return[...i,{role:"assistant",content:`Error: ${v}`}]})}finally{x(!1)}},t=l=>{l.key==="Enter"&&!l.shiftKey&&(l.preventDefault(),K())};return n?e.jsxs(G,{className:"brain-card border-primary/30 mb-4",children:[e.jsxs(de,{className:"py-2 px-4 flex flex-row items-center justify-between",children:[e.jsx(ce,{className:"text-xs",children:"BRAIN CHAT"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("div",{className:"flex bg-secondary/40 border border-secondary/60 rounded overflow-hidden mr-2",children:[e.jsxs("button",{onClick:()=>m("chat"),className:`flex items-center gap-1 px-2 py-0.5 text-[10px] transition-colors ${a==="chat"?"bg-primary/30 text-primary":"text-muted-foreground hover:text-foreground"}`,children:[e.jsx(ft,{className:"w-3 h-3"})," CHAT"]}),e.jsxs("button",{onClick:()=>m("ingest"),className:`flex items-center gap-1 px-2 py-0.5 text-[10px] transition-colors ${a==="ingest"?"bg-primary/30 text-primary":"text-muted-foreground hover:text-foreground"}`,children:[e.jsx(Pt,{className:"w-3 h-3"})," INGEST"]})]}),e.jsx(R,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>o(!1),children:e.jsx(pt,{className:"w-4 h-4"})})]})]}),e.jsxs(Q,{className:"p-0",children:[e.jsxs("div",{className:"px-4 py-1 border-b border-border flex items-center justify-between",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground",children:a==="chat"?"General chat with Gemini Flash — ask anything, paste screenshots":"Study ingestion — paste notes to create Anki cards & save sessions"}),a==="ingest"&&e.jsx("div",{className:"flex bg-secondary/40 border border-secondary/60 rounded overflow-hidden",children:["anki","obsidian","both"].map(l=>e.jsxs("button",{onClick:()=>y(l),className:`flex items-center gap-1 px-2 py-0.5 text-[10px] transition-colors ${k===l?"bg-primary/30 text-primary":"text-muted-foreground hover:text-foreground"}`,children:[l==="anki"&&e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-3 h-3"})," ANKI"]}),l==="obsidian"&&e.jsxs(e.Fragment,{children:[e.jsx(Ct,{className:"w-3 h-3"})," OBSIDIAN"]}),l==="both"&&e.jsx(e.Fragment,{children:"BOTH"})]},l))})]}),e.jsxs("div",{ref:D,className:"h-64 overflow-y-auto px-4 py-2 space-y-3",children:[r.length===0&&e.jsx("p",{className:"text-muted-foreground text-xs text-center py-8",children:a==="chat"?"Ask anything. Paste screenshots with Ctrl+V.":"Paste your study notes to ingest into Brain."}),r.map((l,h)=>e.jsx("div",{className:`flex ${l.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] rounded px-3 py-2 text-sm whitespace-pre-wrap ${l.role==="user"?"bg-primary/20 text-foreground border border-primary/30":"bg-secondary/40 text-foreground border border-secondary/60"}`,children:[l.images?.map((v,i)=>e.jsx("img",{src:v,alt:"attached",className:"max-h-32 rounded mb-1"},i)),l.content]})},h)),f&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-secondary/40 border border-secondary/60 rounded px-3 py-2",children:e.jsx(St,{className:"w-4 h-4 animate-spin text-primary"})})})]}),C.length>0&&e.jsx("div",{className:"px-4 py-1 flex gap-2 flex-wrap",children:C.map((l,h)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:l,alt:"pending",className:"h-12 rounded border border-primary/30"}),e.jsx("button",{onClick:()=>w(v=>v.filter((i,g)=>g!==h)),className:"absolute -top-1 -right-1 bg-destructive rounded-full p-0.5",children:e.jsx(je,{className:"w-3 h-3"})})]},h))}),e.jsxs("div",{className:"flex items-end gap-2 px-4 py-2 border-t border-border",children:[e.jsx("input",{ref:F,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:z}),a==="chat"&&e.jsx(R,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:()=>F.current?.click(),children:e.jsx($t,{className:"w-4 h-4 text-primary"})}),e.jsx("textarea",{value:p,onChange:l=>b(l.target.value),onKeyDown:t,onPaste:J,placeholder:a==="chat"?"Ask anything... (Ctrl+V to paste images)":"Paste study notes to ingest...",rows:a==="ingest"?3:1,className:"flex-1 bg-transparent border border-input rounded px-3 py-1.5 text-sm resize-none focus:outline-none focus:ring-1 focus:ring-ring"}),e.jsx(R,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:K,disabled:f,children:e.jsx(bt,{className:"w-4 h-4 text-primary"})})]})]})]}):e.jsxs("button",{onClick:()=>o(!0),className:"w-full flex items-center justify-between brain-card border border-primary/30 px-4 py-2 mb-4 text-sm text-primary hover:bg-primary/10 transition-colors",children:[e.jsx("span",{className:"font-arcade text-xs tracking-widest uppercase",children:"BRAIN CHAT"}),e.jsx(hs,{className:"w-4 h-4"})]})}const xa=/(\[\[.*?\]\])/g,ha=/!\[\[(.*?)\]\]/g,pa=[".png",".jpg",".jpeg",".gif",".svg",".webp",".bmp"],ba=/^\[!([\w-]+)\]\s*(.*)?$/,us={note:"border-blue-500/50 bg-blue-500/10",tip:"border-green-500/50 bg-green-500/10",important:"border-purple-500/50 bg-purple-500/10",warning:"border-yellow-500/50 bg-yellow-500/10",caution:"border-red-500/50 bg-red-500/10",info:"border-blue-400/50 bg-blue-400/10",abstract:"border-cyan-500/50 bg-cyan-500/10",summary:"border-cyan-500/50 bg-cyan-500/10",todo:"border-blue-500/50 bg-blue-500/10",success:"border-green-500/50 bg-green-500/10",question:"border-yellow-400/50 bg-yellow-400/10",example:"border-purple-400/50 bg-purple-400/10",quote:"border-gray-400/50 bg-gray-400/10",bug:"border-red-400/50 bg-red-400/10",danger:"border-red-500/50 bg-red-500/10",fail:"border-red-500/50 bg-red-500/10",failure:"border-red-500/50 bg-red-500/10"};function ze(n,o){return n.split(xa).map((a,m)=>{const r=a.match(/^\[\[(.*?)\]\]$/);if(r){const c=r[1].includes("|")?r[1].split("|")[1]:r[1],p=r[1].includes("|")?r[1].split("|")[0]:r[1];return e.jsx("span",{className:"text-blue-400 hover:text-blue-300 cursor-pointer underline decoration-dotted",onClick:b=>o?.(p,b.shiftKey),title:`${p} (Shift+click for Obsidian app)`,children:c},m)}return e.jsx("span",{children:a},m)})}function fa(n){return n.replace(ha,(o,a)=>{const m=a.toLowerCase();return pa.some(c=>m.endsWith(c))?`![${a}](/api/obsidian/vault-file/${encodeURIComponent(a)})`:`[[${a}]]`})}function ga(n){const o=n.split(`
`),a=[];let m=!1,r="",c="",p=[];const b=()=>{if(!m)return;const C=us[r.toLowerCase()]||us.note,w=c||r.charAt(0).toUpperCase()+r.slice(1);a.push(`<div class="callout ${C} border-l-4 rounded px-3 py-2 my-2">`),a.push(`<div class="font-bold text-xs uppercase tracking-wider mb-1">${w}</div>`),a.push(""),a.push(p.join(`
`)),a.push(""),a.push("</div>"),m=!1,p=[]};for(const C of o){if(C.startsWith("> ")){const w=C.slice(2),f=w.match(ba);if(f&&!m){m=!0,r=f[1],c=f[2]||"";continue}if(m){p.push(w);continue}}else if(C===">"&&m){p.push("");continue}else b();a.push(C)}return b(),a.join(`
`)}function ya({content:n,onWikilinkClick:o}){const a=ga(fa(n)),m={h1:({children:r})=>e.jsx("h1",{className:"text-xl font-bold text-primary border-b border-primary/30 pb-1 mb-3 mt-4",children:r}),h2:({children:r})=>e.jsx("h2",{className:"text-lg font-bold text-primary/90 border-b border-primary/20 pb-1 mb-2 mt-3",children:r}),h3:({children:r})=>e.jsx("h3",{className:"text-base font-semibold text-primary/80 mb-2 mt-3",children:r}),h4:({children:r})=>e.jsx("h4",{className:"text-sm font-semibold text-primary/70 mb-1 mt-2",children:r}),p:({children:r})=>typeof r=="string"?e.jsx("p",{className:"mb-2 leading-relaxed",children:ze(r,o)}):e.jsx("p",{className:"mb-2 leading-relaxed",children:r}),strong:({children:r})=>e.jsx("strong",{className:"font-bold text-foreground",children:r}),em:({children:r})=>e.jsx("em",{className:"italic text-foreground/90",children:r}),ul:({children:r})=>e.jsx("ul",{className:"list-disc list-inside mb-2 space-y-0.5 ml-2",children:r}),ol:({children:r})=>e.jsx("ol",{className:"list-decimal list-inside mb-2 space-y-0.5 ml-2",children:r}),li:({children:r})=>typeof r=="string"?e.jsx("li",{className:"leading-relaxed",children:ze(r,o)}):e.jsx("li",{className:"leading-relaxed",children:r}),blockquote:({children:r})=>e.jsx("blockquote",{className:"border-l-4 border-primary/30 pl-3 my-2 text-muted-foreground italic",children:r}),code:({children:r,className:c})=>c?.startsWith("language-")?e.jsx("code",{className:"block bg-black/80 border border-secondary/40 rounded p-3 my-2 text-xs font-mono overflow-x-auto whitespace-pre",children:r}):e.jsx("code",{className:"bg-secondary/40 px-1.5 py-0.5 rounded text-xs font-mono text-primary",children:r}),pre:({children:r})=>e.jsx("pre",{className:"my-2",children:r}),hr:()=>e.jsx("hr",{className:"border-primary/20 my-4"}),a:({href:r,children:c})=>e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:c}),table:({children:r})=>e.jsx("div",{className:"overflow-x-auto my-2",children:e.jsx("table",{className:"w-full text-xs border-collapse border border-secondary/40",children:r})}),th:({children:r})=>e.jsx("th",{className:"border border-secondary/40 bg-secondary/20 px-2 py-1 text-left font-semibold",children:r}),td:({children:r})=>typeof r=="string"?e.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:ze(r,o)}):e.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:r}),img:({src:r,alt:c})=>e.jsx("img",{src:r,alt:c||"",className:"max-w-full rounded border border-secondary/40 my-2",loading:"lazy"}),del:({children:r})=>e.jsx("del",{className:"line-through text-muted-foreground",children:r}),input:({checked:r,...c})=>e.jsx("input",{type:"checkbox",checked:r,readOnly:!0,className:"mr-1.5 accent-primary",...c})};return e.jsx("div",{className:"obsidian-preview prose-invert max-w-none text-sm leading-relaxed",children:e.jsx(kt,{remarkPlugins:[At],components:m,allowedElements:void 0,unwrapDisallowed:!1,children:a})})}const ja=(n,o="MM/dd")=>{if(!n)return"-";try{const a=n instanceof Date?n:new Date(n);return It(a)?Tt(a,o):"-"}catch{return"-"}},Oe=n=>{if(Array.isArray(n))return n.filter(o=>typeof o=="string");if(typeof n=="string"){const o=n.trim();if(!o)return[];try{const a=JSON.parse(o);if(Array.isArray(a))return a.filter(m=>typeof m=="string")}catch{}return o.split(",").map(a=>a.trim()).filter(Boolean)}return[]};function Ra(){const[n,o]=u.useState(new Set),[a,m]=u.useState(null),[r,c]=u.useState(!1),[p,b]=u.useState([]),[C,w]=u.useState(!1),[f,x]=u.useState(new Set),[k,y]=u.useState(null),[D,F]=u.useState({front:"",back:"",deckName:""}),[T,E]=u.useState("all"),[O,J]=u.useState("all"),[z,B]=u.useState(""),[_,K]=u.useState(""),[t,l]=u.useState({mode:"",minutes:"",cards:"",confusions:"",weakAnchors:"",concepts:"",issues:"",notes:""}),[h,v]=u.useState("School"),[i,g]=u.useState(null),[N,I]=u.useState(""),[P,W]=u.useState(!1),[se,j]=u.useState(!1),[A,Y]=u.useState(!1),me=[{name:"EBP",path:"School/Evidence Based Practice"},{name:"ExPhys",path:"School/Exercise Physiology"},{name:"MS1",path:"School/Movement Science 1"},{name:"Neuro",path:"School/Neuroscience"},{name:"TI",path:"School/Theraputic Intervention"}];u.useEffect(()=>{const s=new URLSearchParams(window.location.search),d=s.get("semester")||"all",M=s.get("start")||"",L=s.get("end")||"";E(d),B(M),K(L)},[]);const{data:X=[]}=q({queryKey:["courses"],queryFn:()=>S.courses.getActive()}),{data:U=[],isLoading:be}=q({queryKey:["sessions",T,z,_],queryFn:async()=>{const s=new URLSearchParams;T!=="all"&&s.append("semester",T),z&&s.append("start",z),_&&s.append("end",_);const d=s.toString(),M=d?`/sessions?${d}`:"/sessions",L=await fetch(`/api${M}`);if(!L.ok)throw new Error(`API Error: ${L.statusText}`);return L.json()}}),{data:Xe}=q({queryKey:["brain","metrics"],queryFn:S.brain.getMetrics}),fe=Me(),zs=V({mutationFn:s=>S.sessions.deleteMany(s),onSuccess:()=>{fe.invalidateQueries({queryKey:["sessions"]}),fe.invalidateQueries({queryKey:["brain","metrics"]}),o(new Set)}}),Bs=V({mutationFn:({id:s,updates:d})=>S.sessions.update(s,d),onSuccess:()=>{fe.invalidateQueries({queryKey:["sessions"]}),fe.invalidateQueries({queryKey:["brain","metrics"]}),m(null)}}),Ks=s=>{o(d=>{const M=new Set(d);return M.has(s)?M.delete(s):M.add(s),M})},Us=()=>{n.size===U.length?o(new Set):o(new Set(U.map(s=>s.id)))},Vs=()=>{n.size!==0&&(b(Array.from(n)),c(!0))},Ws=s=>{b([s]),c(!0)},Hs=()=>{zs.mutate(p),c(!1),b([])};u.useEffect(()=>{if(a!==null){const s=U.find(d=>d.id===a);s&&l({mode:s.mode||"",minutes:s.minutes?.toString()||"",cards:s.cards?.toString()||"",confusions:Oe(s.confusions).join(", "),weakAnchors:Oe(s.weakAnchors).join(", "),concepts:Oe(s.concepts).join(", "),issues:Oe(s.issues).join(", "),notes:s.notes||""})}},[a,U]);const ue=a!==null?U.find(s=>s.id===a):null,ge=typeof window<"u"&&new URLSearchParams(window.location.search).has("debugModals");u.useEffect(()=>{a!==null&&!be&&!ue&&(ge&&console.warn("[ModalDebug][Brain] Missing session for edit; closing.",{editingSession:a,sessionsCount:U.length}),m(null))},[ge,a,ue,U.length,be]),u.useEffect(()=>{ge&&console.info("[ModalDebug][Brain] state",{editingSession:a,hasEditingSessionData:!!ue,deleteDialogOpen:r,sessionsToDelete:p.length,sessionsLoading:be})},[ge,r,a,ue,be,p.length]);const Js=()=>{if(a===null)return;const s=L=>L?L.split(",").map(xe=>xe.trim()).filter(Boolean):[],d=L=>L.length?JSON.stringify(L):null,M={mode:t.mode||"study",minutes:parseInt(t.minutes)||0,cards:parseInt(t.cards)||0,confusions:d(s(t.confusions)),weakAnchors:d(s(t.weakAnchors)),concepts:d(s(t.concepts)),issues:d(s(t.issues)),notes:t.notes||null};Bs.mutate({id:a,updates:M})},{data:re}=q({queryKey:["obsidian","status"],queryFn:S.obsidian.getStatus,refetchInterval:3e4}),{data:Ze}=q({queryKey:["obsidian","config"],queryFn:S.obsidian.getConfig}),{data:Ys}=q({queryKey:["obsidian","vault-index"],queryFn:()=>S.obsidian.getVaultIndex(),enabled:re?.connected===!0}),{data:Gs,refetch:Na}=q({queryKey:["obsidian","files",h],queryFn:()=>S.obsidian.getFiles(h),enabled:re?.connected===!0}),Le=async s=>{try{const d=await S.obsidian.getFile(s);d.success&&d.content!==void 0&&(g(s),I(d.content),j(!1))}catch(d){console.error("Failed to load file:",d)}},Qs=async(s,d)=>{if(d){const L=Ze?.vaultName||"PT School Semester 2";window.open(`obsidian://open?vault=${encodeURIComponent(L)}&file=${encodeURIComponent(s)}`,"_blank");return}const M=Ys?.paths?.[s];if(M){await Le(M),Y(!0);return}for(const L of me)try{await Le(`${L.path}/${s}.md`),Y(!0);return}catch{}console.warn(`Note not found: ${s}`)},Xs=async()=>{if(i){W(!0);try{(await S.obsidian.saveFile(i,N)).success&&j(!1)}catch(s){console.error("Failed to save file:",s)}finally{W(!1)}}},ye=s=>{v(s),g(null),I("")},Zs=()=>{const s=new Date().toISOString().split("T")[0],d=h?`${h}/Session-${s}.md`:`Session-${s}.md`,M=`# Study Session - ${s}

## Summary


## Concepts Covered
- 

## Strengths
- 

## Areas to Review
- 

## Notes

`;g(d),I(M),j(!0)},{data:te,isLoading:et,refetch:es}=q({queryKey:["anki","status"],queryFn:S.anki.getStatus,refetchInterval:3e4}),{data:st}=q({queryKey:["anki","due"],queryFn:S.anki.getDue,enabled:te?.connected===!0}),{data:tt=[],refetch:ke}=q({queryKey:["anki","drafts"],queryFn:S.anki.getDrafts}),oe=tt.filter(s=>s.status==="pending"),qe=V({mutationFn:S.anki.sync,onSuccess:()=>{fe.invalidateQueries({queryKey:["anki"]}),ke()}}),ss=V({mutationFn:s=>S.anki.approveDraft(s),onSuccess:()=>{ke()}}),ts=V({mutationFn:s=>S.anki.deleteDraft(s),onSuccess:()=>{ke()}}),$e=V({mutationFn:({id:s,data:d})=>S.anki.updateDraft(s,d),onSuccess:()=>{ke(),y(null)}}),at=s=>{y(s.id),F({front:s.front,back:s.back,deckName:s.deckName})},nt=()=>{k!==null&&$e.mutate({id:k,data:D})};return e.jsxs(mt,{children:[ge&&e.jsxs("div",{className:"fixed bottom-12 right-4 z-[70] bg-black/80 border border-primary text-primary font-terminal text-[10px] px-2 py-1 rounded-none",children:[e.jsx("div",{children:"Brain modals"}),e.jsxs("div",{children:["Edit session: ",a??"none"]}),e.jsxs("div",{children:["Edit data: ",ue?"yes":"no"]}),e.jsxs("div",{children:["Delete open: ",r?"yes":"no"]}),e.jsxs("div",{children:["Delete count: ",p.length]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h1",{className:"font-arcade text-xl text-primary flex items-center gap-2",children:[e.jsx(ut,{className:"w-6 h-6"}),"BRAIN ANALYTICS"]})}),e.jsx(ua,{}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SYSTEM STATUS"}),e.jsx(G,{className:"brain-card rounded-none",children:e.jsx(Q,{className:"p-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 font-terminal text-xs",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${re?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Obsidian"}),e.jsx("span",{className:"text-primary",children:re?.connected?"Online":"Offline"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${te?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Anki"}),e.jsx("span",{className:"text-primary",children:te?.connected?"Connected":"Offline"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-muted-foreground",children:[e.jsxs("span",{children:["Cards: ",e.jsx("span",{className:"text-primary",children:Xe?.totalCards||0})]}),e.jsxs("span",{children:["Drafts: ",e.jsx("span",{className:"text-primary",children:oe.length})]})]})]})})})]}),e.jsxs(gt,{defaultValue:"ingestion",className:"w-full",children:[e.jsxs(yt,{className:"grid w-full grid-cols-4 rounded-none bg-black border border-secondary/40",children:[e.jsx(Ie,{value:"ingestion",className:"font-arcade text-xs rounded-none data-[state=active]:bg-primary/20 data-[state=active]:text-primary",children:"INGESTION"}),e.jsx(Ie,{value:"data",className:"font-arcade text-xs rounded-none data-[state=active]:bg-primary/20 data-[state=active]:text-primary",children:"DATA"}),e.jsx(Ie,{value:"integrations",className:"font-arcade text-xs rounded-none data-[state=active]:bg-primary/20 data-[state=active]:text-primary",children:"INTEGRATIONS"}),e.jsx(Ie,{value:"syllabus",className:"font-arcade text-xs rounded-none data-[state=active]:bg-primary/20 data-[state=active]:text-primary",children:"SYLLABUS VIEW"})]}),e.jsx(Te,{value:"ingestion",className:"border border-t-0 border-secondary/40 rounded-none",children:e.jsx(da,{})}),e.jsx(Te,{value:"data",className:"border border-t-0 border-secondary/40 rounded-none",children:e.jsx(ca,{})}),e.jsx(Te,{value:"integrations",className:"border border-t-0 border-secondary/40 rounded-none",children:e.jsxs("div",{className:"space-y-4 p-4 min-w-0",children:[e.jsxs(G,{className:"brain-card rounded-none",children:[e.jsxs(de,{className:"border-b border-secondary/50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ce,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),"OBSIDIAN VAULT",re?.connected?e.jsx(Ae,{className:"w-3 h-3 text-green-500"}):e.jsx(je,{className:"w-3 h-3 text-red-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(R,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:Zs,disabled:!re?.connected,children:[e.jsx(Et,{className:"w-3 h-3 mr-1"}),"New Note"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:C,onChange:s=>w(s.target.checked),disabled:!re?.connected,className:"w-4 h-4 accent-primary"}),e.jsx("span",{className:"font-terminal text-xs",children:"Auto-Sync"})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 mt-2 flex-wrap",children:me.map(s=>e.jsx(R,{size:"sm",variant:h===s.path?"default":"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:()=>ye(s.path),children:s.name},s.path))}),h&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 font-terminal text-xs text-muted-foreground",children:[e.jsx("button",{onClick:()=>ye(""),className:"hover:text-primary",children:"vault"}),h.split("/").map((s,d,M)=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xt,{className:"w-3 h-3"}),e.jsx("button",{onClick:()=>ye(M.slice(0,d+1).join("/")),className:"hover:text-primary",children:s})]},d))]})]}),e.jsx(Q,{className:"p-0",children:re?.connected?e.jsxs("div",{className:"grid md:grid-cols-2 h-[240px] md:h-[300px]",children:[e.jsx("div",{className:"border-r border-secondary/30",children:e.jsx(pe,{className:"h-[240px] md:h-[300px]",children:e.jsxs("div",{className:"p-2 space-y-1",children:[h&&e.jsxs("button",{onClick:()=>{const s=h.split("/");s.pop(),ye(s.join("/"))},className:"w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs text-muted-foreground",children:[e.jsx(cs,{className:"w-3 h-3"}),".."]}),Gs?.files?.map(s=>{const d=typeof s=="string"?s:s.path,M=d.endsWith("/"),L=d.replace(/\/$/,"").split("/").pop()||d;return e.jsxs("button",{onClick:()=>{if(M){const xe=L.replace(/\/$/,"");ye(h?`${h}/${xe}`:xe)}else{const xe=h?`${h}/${L}`:L;Le(xe)}},className:`w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs ${i?.endsWith(L)?"bg-primary/20 text-primary":""}`,children:[M?e.jsx(cs,{className:"w-3 h-3 text-yellow-500"}):e.jsx(Lt,{className:"w-3 h-3 text-blue-400"}),L]},d)})]})})}),e.jsx("div",{className:"flex flex-col h-[240px] md:h-[300px]",children:i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-secondary/30",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsxs("span",{className:"font-terminal text-xs text-primary truncate",children:[i.split("/").pop(),se&&e.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),e.jsx("button",{onClick:()=>{const s=Ze?.vaultName||"PT School Semester 2",d=i.replace(/\.md$/,"");window.open(`obsidian://open?vault=${encodeURIComponent(s)}&file=${encodeURIComponent(d)}`,"_blank")},className:"text-muted-foreground hover:text-primary shrink-0",title:"Open in Obsidian app",children:e.jsx(wt,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{size:"sm",variant:"ghost",className:"h-6 px-2 text-[10px]",onClick:()=>Y(!A),children:A?"Edit":"Preview"}),e.jsxs(R,{size:"sm",variant:"ghost",onClick:Xs,disabled:!se||P,className:"h-6 px-2",children:[e.jsx(_e,{className:"w-3 h-3 mr-1"}),P?"Saving...":"Save"]})]})]}),A?e.jsx("div",{className:"flex-1 w-full p-3 bg-black/60 font-terminal overflow-y-auto",children:e.jsx(ya,{content:N,onWikilinkClick:Qs})}):e.jsx("textarea",{value:N,onChange:s=>{I(s.target.value),j(!0)},className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"File content..."})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center font-terminal text-xs text-muted-foreground",children:"Select a file to edit"})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400 mb-2",children:"Obsidian Offline"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Obsidian with Local REST API plugin enabled"})]})})]}),e.jsxs(G,{className:"brain-card rounded-none",children:[e.jsx(de,{className:"border-b border-secondary/50 p-3",children:e.jsxs(ce,{className:"font-arcade text-xs flex items-center gap-2 text-muted-foreground",children:[e.jsx(Je,{className:"w-3 h-3"}),"ANKI INTEGRATION",te?.connected?e.jsx(Ae,{className:"w-3 h-3 text-green-500 ml-auto"}):e.jsx(je,{className:"w-3 h-3 text-red-500 ml-auto"})]})}),e.jsx(Q,{className:"p-4 space-y-3",children:et?e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):te?.connected?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Status:"}),e.jsx(Be,{variant:"outline",className:"bg-green-500/20 text-green-400 border-green-500",children:"Connected"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Cards Created:"}),e.jsx("span",{className:"font-arcade text-xs text-primary",children:Xe?.totalCards||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Due Today:"}),e.jsx("span",{className:"font-arcade text-xs text-secondary",children:st?.dueCount||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Reviewed Today:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:te.reviewedToday||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Decks:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:te.decks?.length||0})]}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[e.jsxs(R,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>es(),children:[e.jsx(ds,{className:"w-3 h-3 mr-1"}),"Refresh"]}),e.jsx(R,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>qe.mutate(),disabled:qe.isPending,children:qe.isPending?"Syncing...":"Sync Cards"})]}),oe.length>0&&e.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-arcade text-[10px] text-yellow-400",children:["PENDING CARDS (",oe.length,")"]}),e.jsx("div",{className:"flex gap-1",children:e.jsx(R,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{f.size===oe.length?x(new Set):x(new Set(oe.map(s=>s.id)))},children:f.size===oe.length?"None":"All"})})]}),f.size>0&&e.jsxs("div",{className:"flex gap-1 mb-2",children:[e.jsxs(R,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-green-600 hover:bg-green-700",onClick:()=>{f.forEach(s=>ss.mutate(s)),x(new Set)},children:[e.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Approve (",f.size,")"]}),e.jsxs(R,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{f.forEach(s=>ts.mutate(s)),x(new Set)},children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"Delete (",f.size,")"]})]}),e.jsx(pe,{className:"h-[200px]",children:e.jsx("div",{className:"space-y-2",children:oe.map(s=>e.jsx("div",{className:`p-2 bg-black/40 border text-xs ${f.has(s.id)?"border-primary":"border-secondary/30"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ie,{checked:f.has(s.id),onCheckedChange:d=>{const M=new Set(f);d?M.add(s.id):M.delete(s.id),x(M)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsx("div",{className:"font-terminal text-primary truncate",children:s.front}),e.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:s.back}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Be,{variant:"outline",className:"text-[9px] border-blue-500/50 text-blue-400 shrink-0",children:s.deckName}),e.jsx(R,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>at(s),title:"Edit card",children:e.jsx(De,{className:"w-3 h-3"})}),e.jsx(R,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-green-500/50 text-green-400 hover:bg-green-500/20",onClick:()=>ss.mutate(s.id),title:"Approve card",children:e.jsx(Ae,{className:"w-3 h-3"})}),e.jsx(R,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>ts.mutate(s.id),title:"Delete card",children:e.jsx(he,{className:"w-3 h-3"})})]})]})]})},s.id))})})]})]}):e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400",children:te?.error||"Anki not connected"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),e.jsxs(R,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>es(),children:[e.jsx(ds,{className:"w-3 h-3 mr-1"}),"Retry"]})]})})]})]})}),e.jsx(Te,{value:"syllabus",className:"border border-t-0 border-secondary/40 rounded-none",children:e.jsx(ma,{})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SESSION EVIDENCE"}),e.jsx(G,{className:"brain-card rounded-none",children:e.jsxs(Q,{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"Semester"}),e.jsxs(Ne,{value:T,onValueChange:s=>{E(s);const d=new URLSearchParams(window.location.search);s==="all"?d.delete("semester"):d.set("semester",s),window.history.replaceState({},"",`?${d.toString()}`)},children:[e.jsx(ve,{className:"rounded-none border-primary",children:e.jsx(we,{})}),e.jsxs(Ce,{className:"bg-black border-primary",children:[e.jsx($,{value:"all",children:"All"}),e.jsx($,{value:"1",children:"Semester 1 (Fall 2025)"}),e.jsx($,{value:"2",children:"Semester 2 (Spring 2026)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"Course"}),e.jsxs(Ne,{value:O,onValueChange:s=>J(s),children:[e.jsx(ve,{className:"rounded-none border-primary",children:e.jsx(we,{})}),e.jsxs(Ce,{className:"bg-black border-primary",children:[e.jsx($,{value:"all",children:"All"}),X.map(s=>e.jsx($,{value:String(s.id),children:s.name},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"Start Date"}),e.jsx(Ee,{type:"date",value:z,onChange:s=>{B(s.target.value);const d=new URLSearchParams(window.location.search);s.target.value?d.set("start",s.target.value):d.delete("start"),window.history.replaceState({},"",`?${d.toString()}`)},className:"rounded-none border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"End Date"}),e.jsx(Ee,{type:"date",value:_,onChange:s=>{K(s.target.value);const d=new URLSearchParams(window.location.search);s.target.value?d.set("end",s.target.value):d.delete("end"),window.history.replaceState({},"",`?${d.toString()}`)},className:"rounded-none border-primary"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(R,{variant:"outline",onClick:()=>{E("all"),J("all"),B(""),K(""),window.history.replaceState({},"",window.location.pathname)},className:"rounded-none border-primary w-full",children:"Clear Filters"})})]}),be?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Loading sessions..."})}):U.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"No sessions found"})}):e.jsx(pe,{className:"h-[400px]",children:e.jsxs(Cs,{children:[e.jsx(Ss,{children:e.jsxs(Ke,{className:"border-secondary/30",children:[e.jsx(ae,{className:"w-12",children:e.jsx(ie,{checked:n.size===U.length&&U.length>0,onCheckedChange:Us,className:"border-secondary"})}),e.jsx(ae,{className:"font-arcade text-xs text-primary",children:"Date"}),e.jsx(ae,{className:"font-arcade text-xs text-primary",children:"Course"}),e.jsx(ae,{className:"font-arcade text-xs text-primary",children:"Mode"}),e.jsx(ae,{className:"font-arcade text-xs text-primary",children:"Minutes"}),e.jsx(ae,{className:"font-arcade text-xs text-primary",children:"Cards"}),e.jsx(ae,{className:"font-arcade text-xs text-primary",children:"Concepts"}),e.jsx(ae,{className:"font-arcade text-xs text-primary",children:"Actions"})]})}),e.jsx(ks,{children:U.filter(s=>O==="all"||String(s.courseId)===O).map(s=>e.jsxs(Ke,{className:"border-secondary/30 hover:bg-secondary/10",children:[e.jsx(ne,{children:e.jsx(ie,{checked:n.has(s.id),onCheckedChange:()=>Ks(s.id),className:"border-secondary"})}),e.jsx(ne,{className:"font-terminal text-xs",children:ja(s.createdAt,"MMM dd, yyyy")}),e.jsx(ne,{className:"font-terminal text-xs text-muted-foreground",children:s.topic||"-"}),e.jsx(ne,{className:"font-terminal text-xs text-muted-foreground",children:s.mode||"-"}),e.jsx(ne,{className:"font-terminal text-xs text-muted-foreground",children:s.minutes||"-"}),e.jsx(ne,{className:"font-terminal text-xs text-muted-foreground",children:s.cards||"-"}),e.jsx(ne,{className:"font-terminal text-xs text-muted-foreground",children:Array.isArray(s.concepts)?s.concepts.length:0}),e.jsxs(ne,{className:"flex gap-1",children:[e.jsx(R,{size:"icon",variant:"outline",className:"h-6 w-6 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>m(s.id),children:e.jsx(De,{className:"w-3 h-3"})}),e.jsx(R,{size:"icon",variant:"outline",className:"h-6 w-6 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>Ws(s.id),children:e.jsx(he,{className:"w-3 h-3"})})]})]},s.id))})]})}),n.size>0&&e.jsx("div",{className:"flex gap-2 pt-4 border-t border-secondary/30",children:e.jsxs(R,{size:"sm",className:"flex-1 font-terminal text-xs bg-red-600 hover:bg-red-700",onClick:Vs,children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"Delete Selected (",n.size,")"]})})]})})]})]})]}),e.jsx(as,{open:!!ue,onOpenChange:s=>{s||m(null)},children:e.jsxs(ns,{"data-modal":"brain-edit-session",className:"bg-black border-2 border-primary rounded-none max-w-2xl translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(rs,{children:[e.jsxs(os,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5"}),"EDIT SESSION #",a]}),e.jsx(ls,{className:"font-terminal text-muted-foreground",children:"Update WRAP methodology fields for this study session"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Mode"}),e.jsxs(Ne,{value:t.mode,onValueChange:s=>l(d=>({...d,mode:s})),children:[e.jsx(ve,{className:"rounded-none border-secondary",children:e.jsx(we,{placeholder:"Select mode"})}),e.jsxs(Ce,{className:"rounded-none border-secondary bg-black",children:[e.jsx($,{value:"Core",children:"Core"}),e.jsx($,{value:"Sprint",children:"Sprint"}),e.jsx($,{value:"Drill",children:"Drill"}),e.jsx($,{value:"study",children:"Study"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Minutes"}),e.jsx(Ee,{type:"number",value:t.minutes,onChange:s=>l(d=>({...d,minutes:s.target.value})),className:"rounded-none border-secondary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Cards"}),e.jsx(Ee,{type:"number",value:t.cards,onChange:s=>l(d=>({...d,cards:s.target.value})),className:"rounded-none border-secondary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Confusions (comma-separated)"}),e.jsx(le,{value:t.confusions,onChange:s=>l(d=>({...d,confusions:s.target.value})),placeholder:"e.g., muscle insertion points, nerve pathways",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Weak Anchors (comma-separated)"}),e.jsx(le,{value:t.weakAnchors,onChange:s=>l(d=>({...d,weakAnchors:s.target.value})),placeholder:"e.g., brachial plexus diagram, ROM measurements",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Concepts (comma-separated)"}),e.jsx(le,{value:t.concepts,onChange:s=>l(d=>({...d,concepts:s.target.value})),placeholder:"e.g., upper extremity anatomy, peripheral nerves",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Issues (comma-separated)"}),e.jsx(le,{value:t.issues,onChange:s=>l(d=>({...d,issues:s.target.value})),placeholder:"e.g., interrupted by phone, lost focus after 30 min",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Notes"}),e.jsx(le,{value:t.notes,onChange:s=>l(d=>({...d,notes:s.target.value})),placeholder:"Free-form observations about the session",className:"rounded-none border-secondary min-h-[80px]"})]})]}),e.jsxs(is,{className:"gap-2",children:[e.jsxs(R,{variant:"outline",onClick:()=>m(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(R,{onClick:Js,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})}),e.jsx(bs,{open:r&&p.length>0,onOpenChange:c,children:e.jsxs(fs,{"data-modal":"brain-delete-session",className:"bg-black border-2 border-destructive rounded-none translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(gs,{children:[e.jsxs(ys,{className:"font-arcade text-destructive flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),"CONFIRM DELETE"]}),e.jsxs(js,{className:"font-terminal text-muted-foreground",children:["Are you sure you want to delete ",p.length," session",p.length!==1?"s":"","? This action cannot be undone."]})]}),e.jsxs(Ns,{className:"gap-2",children:[e.jsx(vs,{className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:"Cancel"}),e.jsxs(ws,{onClick:Hs,className:"font-terminal rounded-none bg-destructive hover:bg-destructive/80 text-destructive-foreground",children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})}),e.jsx(as,{open:k!==null,onOpenChange:s=>{s||y(null)},children:e.jsxs(ns,{"data-modal":"brain-edit-draft",className:"bg-black border-2 border-primary rounded-none max-w-lg translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(rs,{children:[e.jsxs(os,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5"}),"EDIT CARD"]}),e.jsx(ls,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),e.jsx(le,{value:D.front,onChange:s=>F(d=>({...d,front:s.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),e.jsx(le,{value:D.back,onChange:s=>F(d=>({...d,back:s.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),e.jsxs(Ne,{value:D.deckName,onValueChange:s=>F(d=>({...d,deckName:s})),children:[e.jsx(ve,{className:"rounded-none border-secondary",children:e.jsx(we,{placeholder:"Select deck"})}),e.jsxs(Ce,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[e.jsx($,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),e.jsx($,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),e.jsx($,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),e.jsx($,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),e.jsx($,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),e.jsx($,{value:"PT::General",children:"PT::General"}),te?.decks?.filter(s=>!s.startsWith("PT::")).map(s=>e.jsx($,{value:s,children:s},s))]})]}),e.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",e.jsx("span",{className:"text-blue-400",children:D.deckName})]})]})]}),e.jsxs(is,{className:"gap-2",children:[e.jsxs(R,{variant:"outline",onClick:()=>y(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(R,{onClick:nt,disabled:$e.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),$e.isPending?"Saving...":"Save"]})]})]})})]})}export{Ra as default};
