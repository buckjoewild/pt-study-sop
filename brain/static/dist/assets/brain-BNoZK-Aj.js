import{c as kt,r as P,u as gt,a as Mr,j as l,R as To,d as Eo,e as Es,P as $n,f as Pr,g as Oo,h as Mo,b as Ue,X as Kt,i as Po,k as Ro}from"./index-BUIwUX8F.js";import{u as Q,a as de,i as V,b as te,S as Ie,B as Yt,j as Io,k as Do,D as Rr,d as Ir,e as Dr,f as zr,g as $r,I as It,C as bn,h as zo,l as Fr,T as bt,P as kn,m as lt,n as Os,L as $o}from"./index-CI-pkP5c.js";import{C as re,a as ce,b as fe,c as ie}from"./card-CiPNYABD.js";import{c as Ms,R as Fo,I as Lo,T as Ps,a as Rs,b as ut,d as dt}from"./tabs-DYp0GoTE.js";import{L as Jt,C as qo,M as Uo}from"./message-square-CuYsUwIy.js";import{B as lr,C as Ho}from"./circle-check-PuNvWTWr.js";import{C as ve,E as Bo}from"./checkbox-Dw27fIP4.js";import{A as Is,a as Ds,b as zs,c as $s,d as Fs,e as Ls,f as qs,g as Us,C as Hs}from"./alert-dialog-D4lA7qiP.js";import{S as qt,a as Ut,b as Ht,c as Bt,d as pe,u as Go,C as Vo}from"./select-CZs2jYK9.js";import{M as Wo,r as Ko,F as Bs,a as Yo,b as di}from"./index-QGuEc4XB.js";import{L as Jo}from"./loader-circle-BbJBQ08j.js";import{S as Xo,R as fi}from"./send-DTXdpRmT.js";import{i as Qo,f as Zo}from"./format-D7m0hUtg.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],tl=kt("arrow-right",el);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],rl=kt("brain-circuit",nl);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],hi=kt("calendar-days",il);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Lr=kt("database",sl);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],ol=kt("file",al);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ll=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],cl=kt("image",ll);function ul(){const[e,n]=P.useState(""),[r,i]=P.useState(null),[s,a]=P.useState("auto"),[o,c]=P.useState([]),d=gt(),{toast:f}=Mr(),{data:h=[]}=Q({queryKey:["sessions"],queryFn:V.sessions.getAll}),u=h.slice().sort((b,v)=>{const g=b.date||b.createdAt||"";return(v.date||v.createdAt||"").localeCompare(g)}).slice(0,20),m=de({mutationFn:()=>V.planner.generate(),onSuccess:b=>{f({title:"Planner tasks generated",description:`${b.tasks_created} review tasks created`}),d.invalidateQueries({queryKey:["planner","queue"]})},onError:b=>{f({title:"Failed to generate tasks",description:b.message,variant:"destructive"})}}),p=de({mutationFn:async()=>{if(!r)throw new Error("Select a session first");let b;try{b=JSON.parse(e)}catch{throw new Error("Invalid JSON — check syntax")}let v=s;if(v==="auto"){const S=Object.keys(b),w=["source_lock","plan_of_attack","frameworks_used","buckets","confusables_interleaved","anki_cards","glossary","exit_ticket_blurt","exit_ticket_muddiest","exit_ticket_next_action","retrospective_status","spaced_reviews","next_session","errors_by_type","errors_by_severity","error_patterns","spacing_algorithm","rsr_adaptive_adjustment","adaptive_multipliers"];v=S.some(_=>w.includes(_))?"enhanced":"tracker"}const g=v==="tracker"?b:void 0,N=v==="enhanced"?b:void 0;return V.brain.ingestSessionJson(r,g,N)},onSuccess:b=>{f({title:"JSON ingested",description:`${b.fields_updated} fields updated on session #${b.session_id}`}),d.invalidateQueries({queryKey:["sessions"]}),d.invalidateQueries({queryKey:["brain","metrics"]}),f({title:"Next step: Generate planner tasks?",description:"Create review tasks from weak anchors",duration:1e4,action:l.jsx(te,{size:"sm",onClick:()=>m.mutate(),disabled:m.isPending,className:"bg-primary text-black hover:bg-primary/80",children:m.isPending?"Generating...":"Generate Now"})}),n(""),c([])},onError:b=>{f({title:"Ingestion failed",description:b.message,variant:"destructive"})}});function y(){const b=[];if(r||b.push("Select a session"),!e.trim())b.push("Paste JSON first");else try{const v=JSON.parse(e);(typeof v!="object"||Array.isArray(v))&&b.push("JSON must be an object, not array"),v.schema_version&&v.schema_version!=="9.4"&&b.push(`Expected schema_version 9.4, got ${v.schema_version}`)}catch{b.push("Invalid JSON syntax")}return c(b),b.length===0}return l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ce,{className:"border-b border-primary/50 p-4",children:l.jsxs(fe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-primary inline-block"}),"SESSION_JSON_INGEST"]})}),l.jsxs(ie,{className:"p-4 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"TARGET SESSION"}),l.jsxs("select",{value:r??"",onChange:b=>i(b.target.value?Number(b.target.value):null),className:"w-full bg-black border border-primary/50 text-white font-terminal text-xs p-2 rounded-none focus:border-primary outline-none",children:[l.jsx("option",{value:"",children:"-- select session --"}),u.map(b=>l.jsxs("option",{value:b.id,children:["#",b.id," | ",b.date?.slice(0,10)||"?"," | ",b.topic||b.mainTopic||"Untitled"," | ",b.mode||"?"]},b.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"JSON TYPE"}),l.jsx("div",{className:"flex gap-2",children:["auto","tracker","enhanced"].map(b=>l.jsx("button",{onClick:()=>a(b),className:`px-3 py-1 font-arcade text-xs rounded-none border ${s===b?"bg-primary text-black border-primary":"border-primary/30 text-muted-foreground hover:text-white"}`,children:b.toUpperCase()},b))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"PASTE TRACKER OR ENHANCED JSON"}),l.jsx("textarea",{value:e,onChange:b=>n(b.target.value),placeholder:'{"schema_version": "9.4", "topic": "...", "mode": "Core", ...}',rows:10,className:"w-full bg-black border border-primary/50 text-green-400 font-terminal text-xs p-2 rounded-none focus:border-primary outline-none resize-y"})]}),o.length>0&&l.jsx("div",{className:"border border-red-500/50 bg-red-500/10 p-2 font-terminal text-xs text-red-400 space-y-1",children:o.map((b,v)=>l.jsxs("div",{children:["- ",b]},v))}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>{y()&&p.mutate()},disabled:p.isPending,className:"px-4 py-2 bg-primary text-black font-arcade text-xs rounded-none hover:bg-primary/80 disabled:opacity-50",children:p.isPending?"INGESTING...":"INGEST"}),l.jsx("button",{onClick:y,className:"px-4 py-2 border border-primary/50 text-primary font-arcade text-xs rounded-none hover:bg-primary/10",children:"VALIDATE"}),l.jsx("button",{onClick:()=>{n(""),c([])},className:"px-4 py-2 border border-primary/30 text-muted-foreground font-arcade text-xs rounded-none hover:text-white",children:"CLEAR"})]})]})]})}const dl=`You are extracting a course schedule for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "name": "Course Name (e.g. Anatomy & Physiology II)",
  "term": {
    "startDate": "2026-01-05",
    "endDate": "2026-04-24",
    "timezone": "America/Chicago"
  },
  "events": [
    {
      "type": "class" | "lecture" | "reading" | "topic" | "assignment" | "quiz" | "exam" | "assessment",
      "title": "string",
      "date": "YYYY-MM-DD",
      "dueDate": "YYYY-MM-DD | null",
      "startTime": "HH:MM | null",
      "endTime": "HH:MM | null",
      "daysOfWeek": ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
      "delivery": "in_person" | "virtual_sync" | "virtual_async" | "hybrid",
      "assessmentType": "EA | null",
      "moduleName": "Module 1: ... | null",
      "notes": "string | null"
    }
  ]
}

Rules:
1. Include ALL schedule items: class meetings, assignments, quizzes, exams, readings, virtual activities, and learning assessments (EA).
2. For repeating class meetings, set daysOfWeek + startTime/endTime, and include term start/end.
3. For one-off items, set date or dueDate.
4. Do NOT include a "modules" array — schedule only.
5. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,fl=`You are extracting course module structure for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "modules": [
    {
      "name": "Module 1: Topic Name",
      "orderIndex": 1,
      "topics": ["Topic A", "Topic B"],
      "readings": ["Chapter 1", "Article X"],
      "assessments": ["Quiz 1", "Exam 1"]
    }
  ]
}

Rules:
1. Include ALL modules/units with their topics, readings, and assessments.
2. orderIndex should be sequential starting at 1.
3. Do NOT include dates or events — structure only.
4. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,hl=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,pl=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function ml(){const e=gt(),[n,r]=P.useState(null),[i,s]=P.useState(null),[a,o]=P.useState("schedule"),[c,d]=P.useState(""),[f,h]=P.useState(""),[u,m]=P.useState(""),[p,y]=P.useState(""),[b,v]=P.useState(null),[g,N]=P.useState(null),[S,w]=P.useState(null),[_,E]=P.useState(null),[O,x]=P.useState(null),[A,j]=P.useState(null),{data:M=[]}=Q({queryKey:["courses"],queryFn:()=>V.courses.getActive()}),{data:R=[]}=Q({queryKey:["modules",n],queryFn:()=>n?V.modules.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:F=[]}=Q({queryKey:["learningObjectives",n],queryFn:()=>n?V.learningObjectives.getByCourse(n):Promise.resolve([]),enabled:!!n}),T=$=>{const B=$.trim();if(!B)return"";const X=B.match(/```json\s*([\s\S]*?)```/i)||B.match(/```\s*([\s\S]*?)```/i),J=X?X[1].trim():B,le=J.indexOf("["),xe=J.lastIndexOf("]"),ke=J.indexOf("{"),St=J.lastIndexOf("}");return le!==-1&&xe!==-1&&xe>le&&(ke===-1||le<ke)?J.slice(le,xe+1).trim():ke!==-1&&St!==-1&&St>ke?J.slice(ke,St+1).trim():J},D=$=>{navigator.clipboard.writeText($)},k=de({mutationFn:async $=>{if(!n)throw new Error("Select a course first");const X={...JSON.parse(T($)),modules:[]};return V.syllabus.importBulk(n,X)},onSuccess:$=>{e.invalidateQueries({queryKey:["scheduleEvents"]}),d(""),x(null),w({type:"success",message:`Imported: ${$.eventsCreated} events (${$.classMeetingsExpanded} class meetings expanded)`}),v(null)},onError:$=>{w({type:"error",message:$.message||"Failed to import schedule"})}}),I=de({mutationFn:async $=>{if(!n)throw new Error("Select a course first");const B=JSON.parse(T($)),X=B.modules||B;return V.modules.createBulk(n,X)},onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]}),h(""),j(null),E({type:"success",message:"Modules imported successfully"}),v(null)},onError:$=>{E({type:"error",message:$.message||"Failed to import modules"})}}),z=de({mutationFn:async $=>{if(!n)throw new Error("Select a course first");const B=JSON.parse(T($));return V.learningObjectives.createBulk(n,i,B)},onSuccess:()=>{e.invalidateQueries({queryKey:["learningObjectives"]}),m(""),v(null)},onError:$=>{v($.message||"Failed to import LOs")}}),L=$=>{const B=[];try{const X=T($);if(!X){x({isValid:!1,errors:["No JSON found"]});return}const J=JSON.parse(X);(!J||typeof J!="object")&&B.push("JSON must be an object"),(!J.name||typeof J.name!="string")&&B.push("Missing 'name' field"),!J.term||typeof J.term!="object"?B.push("Missing 'term' object"):(J.term.startDate||B.push("term.startDate is required"),J.term.endDate||B.push("term.endDate is required")),Array.isArray(J.events)||B.push("Missing 'events' array"),B.length===0?x({isValid:!0,errors:[],preview:{courseName:J.name,eventCount:J.events.length,startDate:J.term?.startDate,endDate:J.term?.endDate}}):x({isValid:!1,errors:B})}catch(X){x({isValid:!1,errors:[`Invalid JSON: ${X.message}`]})}},H=$=>{const B=[];try{const X=T($);if(!X){j({isValid:!1,errors:["No JSON found"]});return}const J=JSON.parse(X),le=J.modules||(Array.isArray(J)?J:null);Array.isArray(le)?le.length===0&&B.push("modules array is empty"):B.push("Missing 'modules' array"),B.length===0?j({isValid:!0,errors:[],preview:{moduleCount:le.length}}):j({isValid:!1,errors:B})}catch(X){j({isValid:!1,errors:[`Invalid JSON: ${X.message}`]})}},K=async()=>{try{N(null);const $=await V.brain.ingest(p,"pasted_wrap.md");$.sessionSaved?(N({type:"success",message:`Session saved! ID: ${$.sessionId}, Cards: ${$.cardsCreated||0}`}),y("")):N({type:"error",message:$.errors?.join(", ")||$.message})}catch($){N({type:"error",message:$.message||"Failed to ingest"})}},Y=[{key:"schedule",label:"SCHEDULE",icon:l.jsx(hi,{className:"w-3.5 h-3.5"})},{key:"modules",label:"MODULES",icon:l.jsx(Jt,{className:"w-3.5 h-3.5"})},{key:"objectives",label:"OBJECTIVES",icon:l.jsx(lr,{className:"w-3.5 h-3.5"})}];return l.jsxs("div",{className:"space-y-6 p-4",children:[l.jsx(ul,{}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),l.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:n||"",onChange:$=>{r($.target.value?parseInt($.target.value):null),s(null)},children:[l.jsx("option",{value:"",children:"-- Select Course --"}),M.map($=>l.jsx("option",{value:$.id,children:$.name},$.id))]})]}),!n&&l.jsx("p",{className:"text-center text-muted-foreground font-terminal text-sm py-8",children:"Select a course above to begin ingestion."}),n&&l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none mb-6",children:[l.jsx(ce,{className:"border-b border-primary/50 p-4",children:l.jsxs(fe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(Lr,{className:"w-4 h-4"}),"WRAP SESSION INGESTION"]})}),l.jsxs(ie,{className:"p-4",children:[g&&l.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${g.type==="success"?"bg-green-900/30 border border-green-500 text-green-400":"bg-red-900/30 border border-red-500 text-red-400"}`,children:g.message}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("button",{onClick:()=>D(pl),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),l.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),l.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:p,onChange:$=>{y($.target.value),N(null)}})]}),l.jsx("button",{onClick:K,disabled:!p,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]})]}),n&&b&&l.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:b}),n&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex border-b border-primary/50",children:Y.map($=>l.jsxs("button",{onClick:()=>o($.key),className:`flex items-center gap-1.5 px-4 py-2 font-arcade text-xs border-b-2 transition-colors ${a===$.key?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-primary/70"}`,type:"button",children:[$.icon,$.label]},$.key))}),a==="schedule"&&l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ce,{className:"border-b border-primary/50 p-4",children:l.jsxs(fe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(hi,{className:"w-4 h-4"}),"SCHEDULE IMPORT"]})}),l.jsxs(ie,{className:"p-4 space-y-4",children:[l.jsx("button",{onClick:()=>D(dl),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),l.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (schedule JSON) below:"}),l.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"name":"...","term":{...},"events":[...]}',value:c,onChange:$=>{d($.target.value),w(null),$.target.value.trim()?L($.target.value):x(null)}}),O&&!O.isValid&&l.jsxs("div",{className:"p-2 border border-red-500 bg-red-900/30 rounded-none font-terminal text-xs text-red-400",children:[l.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),O.errors.map(($,B)=>l.jsxs("div",{children:["• ",$]},B))]}),O?.isValid&&O.preview&&l.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[l.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Course:"})," ",O.preview.courseName]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Events:"})," ",O.preview.eventCount]}),O.preview.startDate&&l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Start:"})," ",O.preview.startDate]}),O.preview.endDate&&l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"End:"})," ",O.preview.endDate]})]})]}),l.jsx("button",{onClick:()=>k.mutate(c),disabled:!O?.isValid||k.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:k.isPending?"Importing...":"Import Schedule"}),S&&l.jsx("div",{className:`p-2 border font-terminal text-xs ${S.type==="success"?"border-green-500 text-green-400":"border-red-500 text-red-400"}`,children:S.message})]})]}),a==="modules"&&l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ce,{className:"border-b border-primary/50 p-4",children:l.jsxs(fe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(Jt,{className:"w-4 h-4"}),"MODULES IMPORT"]})}),l.jsxs(ie,{className:"p-4 space-y-4",children:[l.jsx("button",{onClick:()=>D(fl),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),l.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (modules JSON) below:"}),l.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"modules":[{"name":"Module 1: ...","orderIndex":1,"topics":[...],"readings":[...],"assessments":[...]}]}',value:f,onChange:$=>{h($.target.value),E(null),$.target.value.trim()?H($.target.value):j(null)}}),A&&!A.isValid&&l.jsxs("div",{className:"p-2 border border-red-500 bg-red-900/30 rounded-none font-terminal text-xs text-red-400",children:[l.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),A.errors.map(($,B)=>l.jsxs("div",{children:["• ",$]},B))]}),A?.isValid&&A.preview&&l.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[l.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Modules:"})," ",A.preview.moduleCount]})]}),l.jsx("button",{onClick:()=>I.mutate(f),disabled:!A?.isValid||I.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:I.isPending?"Importing...":"Import Modules"}),_&&l.jsx("div",{className:`p-2 border font-terminal text-xs ${_.type==="success"?"border-green-500 text-green-400":"border-red-500 text-red-400"}`,children:_.message})]})]}),a==="objectives"&&l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ce,{className:"border-b border-primary/50 p-4",children:l.jsxs(fe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(lr,{className:"w-4 h-4"}),"LEARNING OBJECTIVES IMPORT"]})}),l.jsxs(ie,{className:"p-4 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),l.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:i||"",onChange:$=>s($.target.value?parseInt($.target.value):null),children:[l.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),R.map($=>l.jsx("option",{value:$.id,children:$.name},$.id))]})]}),l.jsx("button",{onClick:()=>D(hl),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),l.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),l.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:u,onChange:$=>m($.target.value)}),l.jsx("button",{onClick:()=>z.mutate(u),disabled:!u||z.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:z.isPending?"Importing...":"Import LOs"}),F.length>0&&l.jsxs("div",{children:[l.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",F.length,")"]}),l.jsx("div",{className:"max-h-48 overflow-y-auto",children:F.map($=>l.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[l.jsx("span",{className:"text-primary",children:$.loCode}),": ",$.title,l.jsx("span",{className:`ml-2 text-[10px] px-1 rounded ${$.status==="solid"?"bg-green-600":$.status==="in_progress"?"bg-yellow-600":$.status==="need_review"?"bg-orange-600":"bg-gray-600"}`,children:$.status})]},$.id))})]})]})]})]})]})}function gl(){const e=gt(),[n,r]=P.useState(null),[i,s]=P.useState({}),[a,o]=P.useState({}),[c,d]=P.useState(new Set),[f,h]=P.useState(new Set),[u,m]=P.useState(null),p=P.useRef(null),{data:y=[]}=Q({queryKey:["courses"],queryFn:()=>V.courses.getActive()}),{data:b=[]}=Q({queryKey:["modules",n],queryFn:()=>n?V.modules.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:v=[]}=Q({queryKey:["scheduleEvents",n],queryFn:()=>n?V.scheduleEvents.getByCourse(n):Promise.resolve([]),enabled:!!n}),g=de({mutationFn:({id:x,data:A})=>V.modules.update(x,A),onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]})}}),N=de({mutationFn:x=>V.modules.delete(x),onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]})}}),S=de({mutationFn:x=>V.modules.deleteMany(x),onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]}),d(new Set)}}),w=de({mutationFn:({id:x,data:A})=>V.scheduleEvents.update(x,A),onSuccess:()=>{e.invalidateQueries({queryKey:["scheduleEvents"]})}}),_=de({mutationFn:x=>V.scheduleEvents.delete(x),onSuccess:()=>{e.invalidateQueries({queryKey:["scheduleEvents"]})}}),E=de({mutationFn:x=>V.scheduleEvents.deleteMany(x),onSuccess:()=>{e.invalidateQueries({queryKey:["scheduleEvents"]}),h(new Set)}}),O=(x,A,j)=>{if(!A.length)return;const M={type:x,ids:A,label:j};p.current=M,m(M)};return l.jsxs("div",{className:"space-y-6 p-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),l.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:n||"",onChange:x=>{r(x.target.value?parseInt(x.target.value):null)},children:[l.jsx("option",{value:"",children:"-- Select Course --"}),y.map(x=>l.jsx("option",{value:x.id,children:x.name},x.id))]})]}),n&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ce,{className:"border-b border-primary/50 p-3",children:l.jsxs(fe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(Lr,{className:"w-4 h-4"}),"MODULES (",b.length,")"]})}),l.jsx(ie,{className:"p-0",children:b.length===0?l.jsx("p",{className:"text-xs text-muted-foreground font-terminal p-4",children:"No modules yet. Import a syllabus to add modules."}):l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const x=new Set;c.size!==b.length&&b.forEach(A=>x.add(A.id)),d(x)},children:c.size===b.length?"Uncheck All":"Check All"}),l.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:c.size===0,onClick:()=>{O("modules",Array.from(c),`Delete ${c.size} module(s)? This cannot be undone.`)},children:"Delete"}),l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:c.size===0,onClick:()=>{c.forEach(x=>{const A=i[x];A&&g.mutate({id:x,data:A})}),s(x=>{const A={...x};return c.forEach(j=>{delete A[j]}),A})},children:"Save"})]}),l.jsx(Ie,{className:"h-[280px]",children:l.jsxs("table",{className:"w-full text-sm font-terminal",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-secondary/50",children:[l.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),l.jsx("th",{className:"text-left p-2",children:"Module"}),l.jsx("th",{className:"text-center p-2",children:"Order"}),l.jsx("th",{className:"text-center p-2",children:"Files"}),l.jsx("th",{className:"text-center p-2",children:"NotebookLM"}),l.jsx("th",{className:"text-center p-2",children:"Status"}),l.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),l.jsx("tbody",{children:b.map(x=>l.jsxs("tr",{className:"border-b border-secondary/30",children:[l.jsx("td",{className:"text-center p-2",children:l.jsx(ve,{checked:c.has(x.id),onCheckedChange:A=>d(j=>{const M=new Set(j);return A?M.add(x.id):M.delete(x.id),M}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),l.jsx("td",{className:"p-2",children:l.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:i[x.id]?.name??x.name,onChange:A=>s(j=>({...j,[x.id]:{...j[x.id],name:A.target.value}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx("input",{type:"number",className:"w-16 bg-black border border-secondary rounded-none p-1 text-xs font-terminal text-center",value:i[x.id]?.orderIndex??x.orderIndex??0,onChange:A=>s(j=>({...j,[x.id]:{...j[x.id],orderIndex:parseInt(A.target.value||"0",10)}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx(ve,{checked:x.filesDownloaded,onCheckedChange:A=>g.mutate({id:x.id,data:{filesDownloaded:!!A}}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),l.jsx("td",{className:"text-center p-2",children:l.jsx(ve,{checked:x.notebooklmLoaded,onCheckedChange:A=>g.mutate({id:x.id,data:{notebooklmLoaded:!!A}}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),l.jsx("td",{className:"text-center p-2",children:x.filesDownloaded&&x.notebooklmLoaded?l.jsx("span",{className:"text-green-400",children:"Ready"}):l.jsx("span",{className:"text-yellow-400",children:"Pending"})}),l.jsxs("td",{className:"text-center p-2 space-x-2",children:[l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!i[x.id],onClick:()=>{const A=i[x.id];A&&(g.mutate({id:x.id,data:A}),s(j=>{const M={...j};return delete M[x.id],M}))},children:"Save"}),l.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>N.mutate(x.id),children:"Delete"})]})]},x.id))})]})})]})})]}),l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ce,{className:"border-b border-primary/50 p-3",children:l.jsxs(fe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(Jt,{className:"w-4 h-4"}),"SCHEDULE ITEMS (",v.length,")"]})}),l.jsx(ie,{className:"p-0",children:v.length===0?l.jsx("p",{className:"text-xs text-muted-foreground font-terminal p-4",children:"No schedule items yet. Import a syllabus to add events."}):l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const x=new Set;f.size!==v.length&&v.forEach(A=>x.add(A.id)),h(x)},children:f.size===v.length?"Uncheck All":"Check All"}),l.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:f.size===0,onClick:()=>{O("schedule",Array.from(f),`Delete ${f.size} schedule item(s)? This cannot be undone.`)},children:"Delete"}),l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:f.size===0,onClick:()=>{f.forEach(x=>{const A=a[x];A&&w.mutate({id:x,data:A})}),o(x=>{const A={...x};return f.forEach(j=>{delete A[j]}),A})},children:"Save"})]}),l.jsx(Ie,{className:"h-[280px]",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-xs font-terminal",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-secondary/50",children:[l.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),l.jsx("th",{className:"text-left p-2",children:"Type"}),l.jsx("th",{className:"text-left p-2",children:"Title"}),l.jsx("th",{className:"text-center p-2",children:"Date"}),l.jsx("th",{className:"text-center p-2",children:"Start"}),l.jsx("th",{className:"text-center p-2",children:"End"}),l.jsx("th",{className:"text-center p-2",children:"Due"}),l.jsx("th",{className:"text-left p-2",children:"Notes"}),l.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),l.jsx("tbody",{children:v.map(x=>{const A=a[x.id]||{},j=A.type??x.type??"",M=A.title??x.title??"",R=A.date??x.date??"",F=A.startTime??x.startTime??"",T=A.endTime??x.endTime??"",D=A.dueDate??x.dueDate??"",k=A.notes??x.notes??"",I=!!a[x.id];return l.jsxs("tr",{className:"border-b border-secondary/30 align-top",children:[l.jsx("td",{className:"text-center p-2",children:l.jsx(ve,{checked:f.has(x.id),onCheckedChange:z=>h(L=>{const H=new Set(L);return z?H.add(x.id):H.delete(x.id),H}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),l.jsx("td",{className:"p-2",children:l.jsx("select",{className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:j,onChange:z=>o(L=>({...L,[x.id]:{...L[x.id],type:z.target.value}})),children:["class","lecture","reading","topic","assignment","quiz","exam","assessment","other"].map(z=>l.jsx("option",{value:z,children:z},z))})}),l.jsx("td",{className:"p-2",children:l.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:M,onChange:z=>o(L=>({...L,[x.id]:{...L[x.id],title:z.target.value}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:R||"",onChange:z=>o(L=>({...L,[x.id]:{...L[x.id],date:z.target.value}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:F||"",onChange:z=>o(L=>({...L,[x.id]:{...L[x.id],startTime:z.target.value}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:T||"",onChange:z=>o(L=>({...L,[x.id]:{...L[x.id],endTime:z.target.value}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:D||"",onChange:z=>o(L=>({...L,[x.id]:{...L[x.id],dueDate:z.target.value}}))})}),l.jsx("td",{className:"p-2",children:l.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:k||"",onChange:z=>o(L=>({...L,[x.id]:{...L[x.id],notes:z.target.value}}))})}),l.jsxs("td",{className:"text-center p-2 space-x-2",children:[l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!I,onClick:()=>{w.mutate({id:x.id,data:{type:j,title:M,date:R,startTime:F,endTime:T,dueDate:D,notes:k}}),o(z=>{const L={...z};return delete L[x.id],L})},children:"Save"}),l.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>_.mutate(x.id),children:"Delete"})]})]},x.id)})})]})})})]})})]})]}),l.jsx(Is,{open:!!u,onOpenChange:x=>!x&&m(null),children:l.jsxs(Ds,{className:"bg-black border-2 border-primary rounded-none font-terminal text-primary shadow-none max-w-md translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[l.jsxs(zs,{className:"text-left",children:[l.jsx($s,{className:"font-arcade text-destructive",children:"CONFIRM_DELETE"}),l.jsx(Fs,{className:"font-terminal text-muted-foreground",children:u?.label})]}),l.jsxs(Ls,{className:"gap-2 sm:justify-end",children:[l.jsx(qs,{className:"rounded-none border-secondary font-terminal text-xs hover:bg-secondary/20",onClick:()=>{p.current=null,m(null)},children:"CANCEL"}),l.jsx(Us,{className:"rounded-none bg-destructive text-destructive-foreground font-arcade text-xs hover:bg-destructive/80",type:"button",onClick:()=>{const x=p.current;x&&(x.type==="modules"?S.mutate(x.ids):E.mutate(x.ids),p.current=null,m(null))},children:"DELETE"})]})]})})]})}function xl(){const[e,n]=P.useState(null),{data:r=[]}=Q({queryKey:["courses"],queryFn:async()=>{const u=await fetch("/api/courses");if(!u.ok)throw new Error("Failed to fetch courses");return u.json()}}),{data:i=[],isLoading:s}=Q({queryKey:["modules",e],queryFn:()=>e?V.modules.getByCourse(e):Promise.resolve([]),enabled:!!e}),{data:a=[]}=Q({queryKey:["learningObjectives",e],queryFn:()=>e?V.learningObjectives.getByCourse(e):Promise.resolve([]),enabled:!!e}),{data:o=[]}=Q({queryKey:["scheduleEvents",e],queryFn:()=>e?V.scheduleEvents.getByCourse(e):Promise.resolve([]),enabled:!!e}),c=i.reduce((u,m)=>{const p=m.orderIndex||0;return u[p]||(u[p]=[]),u[p].push(m),u},{}),d=a.reduce((u,m)=>{const p=m.moduleId||0;return u[p]||(u[p]=[]),u[p].push(m),u},{}),f=o.reduce((u,m)=>{const p=m.linkedModuleId||0;return u[p]||(u[p]=[]),u[p].push(m),u},{}),h=i.length>0||a.length>0||o.length>0;return l.jsxs("div",{className:"space-y-4 p-4",children:[l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ce,{className:"border-b border-primary/50 p-3",children:l.jsx(fe,{className:"font-arcade text-sm",children:"SELECT COURSE"})}),l.jsx(ie,{className:"p-3",children:l.jsxs(qt,{value:e?.toString()||"",onValueChange:u=>n(u?parseInt(u):null),children:[l.jsx(Ut,{className:"rounded-none border-primary",children:l.jsx(Ht,{placeholder:"Choose a course..."})}),l.jsx(Bt,{children:r.map(u=>l.jsx(pe,{value:u.id.toString(),children:u.name},u.id))})]})})]}),e?s?l.jsx(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:l.jsx(ie,{className:"p-8 text-center",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Loading syllabus..."})})}):h?l.jsx(Ie,{className:"h-[600px]",children:l.jsx("div",{className:"space-y-4 pr-4",children:Object.entries(c).sort(([u],[m])=>parseInt(u)-parseInt(m)).map(([u,m])=>l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ce,{className:"border-b border-primary/50 p-3",children:l.jsxs(fe,{className:"font-arcade text-sm",children:["WEEK ",u]})}),l.jsx(ie,{className:"p-3 space-y-3",children:m.map(p=>l.jsxs("div",{className:"space-y-2 border-l-2 border-secondary/40 pl-3",children:[l.jsx("div",{className:"font-arcade text-xs text-primary",children:p.name}),d[p.id]&&d[p.id].length>0&&l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground uppercase",children:"Objectives"}),l.jsx("div",{className:"space-y-1",children:d[p.id].map(y=>l.jsxs("div",{className:"font-terminal text-xs text-secondary",children:["• ",y.loCode,": ",y.title]},y.id))})]}),f[p.id]&&f[p.id].length>0&&l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground uppercase",children:"Events"}),l.jsx("div",{className:"space-y-1",children:f[p.id].map(y=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Yt,{variant:"outline",className:`text-[10px] font-terminal ${y.type==="quiz"?"border-yellow-500/50 text-yellow-400":y.type==="exam"?"border-red-500/50 text-red-400":"border-blue-500/50 text-blue-400"}`,children:y.type?.toUpperCase()}),l.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:y.title}),y.dueDate&&l.jsx("span",{className:"font-terminal text-[10px] text-secondary ml-auto",children:new Date(y.dueDate).toLocaleDateString()})]},y.id))})]})]},p.id))})]},u))})}):l.jsx(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:l.jsx(ie,{className:"p-8 text-center",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"No syllabus imported"})})}):l.jsx(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:l.jsx(ie,{className:"p-8 text-center",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Select a course to view syllabus"})})})]})}function cr(e,n,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),r===!1||!s.defaultPrevented)return n?.(s)}}var yl=To[" useInsertionEffect ".trim().toString()]||Eo;function bl({prop:e,defaultProp:n,onChange:r=()=>{},caller:i}){const[s,a,o]=vl({defaultProp:n,onChange:r}),c=e!==void 0,d=c?e:s;{const h=P.useRef(e!==void 0);P.useEffect(()=>{const u=h.current;u!==c&&console.warn(`${i} is changing from ${u?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=c},[c,i])}const f=P.useCallback(h=>{if(c){const u=_l(h)?h(e):h;u!==e&&o.current?.(u)}else a(h)},[c,e,a,o]);return[d,f]}function vl({defaultProp:e,onChange:n}){const[r,i]=P.useState(e),s=P.useRef(r),a=P.useRef(n);return yl(()=>{a.current=n},[n]),P.useEffect(()=>{s.current!==r&&(a.current?.(r),s.current=r)},[r,s]),[r,i,a]}function _l(e){return typeof e=="function"}var qr="Radio",[wl,Gs]=Es(qr),[Nl,jl]=wl(qr),Vs=P.forwardRef((e,n)=>{const{__scopeRadio:r,name:i,checked:s=!1,required:a,disabled:o,value:c="on",onCheck:d,form:f,...h}=e,[u,m]=P.useState(null),p=Pr(n,v=>m(v)),y=P.useRef(!1),b=u?f||!!u.closest("form"):!0;return l.jsxs(Nl,{scope:r,checked:s,disabled:o,children:[l.jsx($n.button,{type:"button",role:"radio","aria-checked":s,"data-state":Js(s),"data-disabled":o?"":void 0,disabled:o,value:c,...h,ref:p,onClick:cr(e.onClick,v=>{s||d?.(),b&&(y.current=v.isPropagationStopped(),y.current||v.stopPropagation())})}),b&&l.jsx(Ys,{control:u,bubbles:!y.current,name:i,value:c,checked:s,required:a,disabled:o,form:f,style:{transform:"translateX(-100%)"}})]})});Vs.displayName=qr;var Ws="RadioIndicator",Ks=P.forwardRef((e,n)=>{const{__scopeRadio:r,forceMount:i,...s}=e,a=jl(Ws,r);return l.jsx(Oo,{present:i||a.checked,children:l.jsx($n.span,{"data-state":Js(a.checked),"data-disabled":a.disabled?"":void 0,...s,ref:n})})});Ks.displayName=Ws;var kl="RadioBubbleInput",Ys=P.forwardRef(({__scopeRadio:e,control:n,checked:r,bubbles:i=!0,...s},a)=>{const o=P.useRef(null),c=Pr(o,a),d=Go(r),f=Mo(n);return P.useEffect(()=>{const h=o.current;if(!h)return;const u=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(u,"checked").set;if(d!==r&&p){const y=new Event("click",{bubbles:i});p.call(h,r),h.dispatchEvent(y)}},[d,r,i]),l.jsx($n.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:c,style:{...s.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Ys.displayName=kl;function Js(e){return e?"checked":"unchecked"}var Sl=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Fn="RadioGroup",[Cl]=Es(Fn,[Ms,Gs]),Xs=Ms(),Qs=Gs(),[Al,Tl]=Cl(Fn),Zs=P.forwardRef((e,n)=>{const{__scopeRadioGroup:r,name:i,defaultValue:s,value:a,required:o=!1,disabled:c=!1,orientation:d,dir:f,loop:h=!0,onValueChange:u,...m}=e,p=Xs(r),y=Io(f),[b,v]=bl({prop:a,defaultProp:s??null,onChange:u,caller:Fn});return l.jsx(Al,{scope:r,name:i,required:o,disabled:c,value:b,onValueChange:v,children:l.jsx(Fo,{asChild:!0,...p,orientation:d,dir:y,loop:h,children:l.jsx($n.div,{role:"radiogroup","aria-required":o,"aria-orientation":d,"data-disabled":c?"":void 0,dir:y,...m,ref:n})})})});Zs.displayName=Fn;var ea="RadioGroupItem",ta=P.forwardRef((e,n)=>{const{__scopeRadioGroup:r,disabled:i,...s}=e,a=Tl(ea,r),o=a.disabled||i,c=Xs(r),d=Qs(r),f=P.useRef(null),h=Pr(n,f),u=a.value===s.value,m=P.useRef(!1);return P.useEffect(()=>{const p=b=>{Sl.includes(b.key)&&(m.current=!0)},y=()=>m.current=!1;return document.addEventListener("keydown",p),document.addEventListener("keyup",y),()=>{document.removeEventListener("keydown",p),document.removeEventListener("keyup",y)}},[]),l.jsx(Lo,{asChild:!0,...c,focusable:!o,active:u,children:l.jsx(Vs,{disabled:o,required:a.required,checked:u,...d,...s,name:a.name,ref:h,onCheck:()=>a.onValueChange(s.value),onKeyDown:cr(p=>{p.key==="Enter"&&p.preventDefault()}),onFocus:cr(s.onFocus,()=>{m.current&&f.current?.click()})})})});ta.displayName=ea;var El="RadioGroupIndicator",na=P.forwardRef((e,n)=>{const{__scopeRadioGroup:r,...i}=e,s=Qs(r);return l.jsx(Ks,{...s,...i,ref:n})});na.displayName=El;var ra=Zs,ia=ta,Ol=na;const sa=P.forwardRef(({className:e,...n},r)=>l.jsx(ra,{className:Ue("grid gap-2",e),...n,ref:r}));sa.displayName=ra.displayName;const aa=P.forwardRef(({className:e,...n},r)=>l.jsx(ia,{ref:r,className:Ue("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...n,children:l.jsx(Ol,{className:"flex items-center justify-center",children:l.jsx(Hs,{className:"h-3.5 w-3.5 fill-primary"})})}));aa.displayName=ia.displayName;const Ml=/(\[\[.*?\]\])/g,Pl=/!\[\[(.*?)\]\]/g,Rl=[".png",".jpg",".jpeg",".gif",".svg",".webp",".bmp"],Il=/^\[!([\w-]+)\]\s*(.*)?$/,pi={note:"border-blue-500/50 bg-blue-500/10",tip:"border-green-500/50 bg-green-500/10",important:"border-purple-500/50 bg-purple-500/10",warning:"border-yellow-500/50 bg-yellow-500/10",caution:"border-red-500/50 bg-red-500/10",info:"border-blue-400/50 bg-blue-400/10",abstract:"border-cyan-500/50 bg-cyan-500/10",summary:"border-cyan-500/50 bg-cyan-500/10",todo:"border-blue-500/50 bg-blue-500/10",success:"border-green-500/50 bg-green-500/10",question:"border-yellow-400/50 bg-yellow-400/10",example:"border-purple-400/50 bg-purple-400/10",quote:"border-gray-400/50 bg-gray-400/10",bug:"border-red-400/50 bg-red-400/10",danger:"border-red-500/50 bg-red-500/10",fail:"border-red-500/50 bg-red-500/10",failure:"border-red-500/50 bg-red-500/10"};function Yn(e,n){return e.split(Ml).map((r,i)=>{const s=r.match(/^\[\[(.*?)\]\]$/);if(s){const a=s[1].includes("|")?s[1].split("|")[1]:s[1],o=s[1].includes("|")?s[1].split("|")[0]:s[1];return l.jsx("span",{className:"text-blue-400 hover:text-blue-300 cursor-pointer underline decoration-dotted",onClick:c=>n?.(o,c.shiftKey),title:`${o} (Shift+click for Obsidian app)`,children:a},i)}return l.jsx("span",{children:r},i)})}function Dl(e){return e.replace(Pl,(n,r)=>{const i=r.toLowerCase();return Rl.some(a=>i.endsWith(a))?`![${r}](/api/obsidian/vault-file/${encodeURIComponent(r)})`:`[[${r}]]`})}function zl(e){const n=e.split(`
`),r=[];let i=!1,s="",a="",o=[];const c=()=>{if(!i)return;const d=pi[s.toLowerCase()]||pi.note,f=a||s.charAt(0).toUpperCase()+s.slice(1);r.push(`<div class="callout ${d} border-l-4 rounded px-3 py-2 my-2">`),r.push(`<div class="font-bold text-xs uppercase tracking-wider mb-1">${f}</div>`),r.push(""),r.push(o.join(`
`)),r.push(""),r.push("</div>"),i=!1,o=[]};for(const d of n){if(d.startsWith("> ")){const f=d.slice(2),h=f.match(Il);if(h&&!i){i=!0,s=h[1],a=h[2]||"";continue}if(i){o.push(f);continue}}else if(d===">"&&i){o.push("");continue}else c();r.push(d)}return c(),r.join(`
`)}function oa({content:e,onWikilinkClick:n}){const r=zl(Dl(e)),i={h1:({children:s})=>l.jsx("h1",{className:"text-xl font-bold text-primary border-b border-primary/30 pb-1 mb-3 mt-4",children:s}),h2:({children:s})=>l.jsx("h2",{className:"text-lg font-bold text-primary/90 border-b border-primary/20 pb-1 mb-2 mt-3",children:s}),h3:({children:s})=>l.jsx("h3",{className:"text-base font-semibold text-primary/80 mb-2 mt-3",children:s}),h4:({children:s})=>l.jsx("h4",{className:"text-sm font-semibold text-primary/70 mb-1 mt-2",children:s}),p:({children:s})=>typeof s=="string"?l.jsx("p",{className:"mb-2 leading-relaxed",children:Yn(s,n)}):l.jsx("p",{className:"mb-2 leading-relaxed",children:s}),strong:({children:s})=>l.jsx("strong",{className:"font-bold text-foreground",children:s}),em:({children:s})=>l.jsx("em",{className:"italic text-foreground/90",children:s}),ul:({children:s})=>l.jsx("ul",{className:"list-disc list-inside mb-2 space-y-0.5 ml-2",children:s}),ol:({children:s})=>l.jsx("ol",{className:"list-decimal list-inside mb-2 space-y-0.5 ml-2",children:s}),li:({children:s})=>typeof s=="string"?l.jsx("li",{className:"leading-relaxed",children:Yn(s,n)}):l.jsx("li",{className:"leading-relaxed",children:s}),blockquote:({children:s})=>l.jsx("blockquote",{className:"border-l-4 border-primary/30 pl-3 my-2 text-muted-foreground italic",children:s}),code:({children:s,className:a})=>a?.startsWith("language-")?l.jsx("code",{className:"block bg-black/80 border border-secondary/40 rounded p-3 my-2 text-xs font-mono overflow-x-auto whitespace-pre",children:s}):l.jsx("code",{className:"bg-secondary/40 px-1.5 py-0.5 rounded text-xs font-mono text-primary",children:s}),pre:({children:s})=>l.jsx("pre",{className:"my-2",children:s}),hr:()=>l.jsx("hr",{className:"border-primary/20 my-4"}),a:({href:s,children:a})=>l.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:a}),table:({children:s})=>l.jsx("div",{className:"overflow-x-auto my-2",children:l.jsx("table",{className:"w-full text-xs border-collapse border border-secondary/40",children:s})}),th:({children:s})=>l.jsx("th",{className:"border border-secondary/40 bg-secondary/20 px-2 py-1 text-left font-semibold",children:s}),td:({children:s})=>typeof s=="string"?l.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:Yn(s,n)}):l.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:s}),img:({src:s,alt:a})=>l.jsx("img",{src:s,alt:a||"",className:"max-w-full rounded border border-secondary/40 my-2",loading:"lazy"}),del:({children:s})=>l.jsx("del",{className:"line-through text-muted-foreground",children:s}),input:({checked:s,...a})=>l.jsx("input",{type:"checkbox",checked:s,readOnly:!0,className:"mr-1.5 accent-primary",...a})};return l.jsx("div",{className:"obsidian-preview prose-invert max-w-none text-sm leading-relaxed",children:l.jsx(Wo,{remarkPlugins:[Ko],components:i,allowedElements:void 0,unwrapDisallowed:!1,children:r})})}function mi(e,n){if(n.length===0)return e;const r=[];for(const i of n)r.push({type:"image_url",image_url:{url:i}});return e.trim()&&r.push({type:"text",text:e}),r}const $l=`Generate Anki flashcards from the following study material. Output ONLY a numbered list in this exact format:

1. Front: [question]
Back: [answer]
Tags: [comma-separated tags like: Module1, Obj2, TopicName]

Rules:
- Front = the question only (no module/objective prefixes)
- Back = concise answer
- Tags = include Module#, Obj#, and topic keywords
- One card per concept
- No extra text before or after the list

Study material:
[PASTE YOUR NOTES HERE]`,Fl=(e,n)=>{const r=e.split(`
`),i=n.split(`
`),s=[];let a=0,o=0;for(;a<r.length||o<i.length;){const c=r[a],d=i[o];if(a<r.length&&o<i.length&&c===d){s.push(` ${c}`),a+=1,o+=1;continue}a<r.length&&(s.push(`-${c}`),a+=1),o<i.length&&(s.push(`+${d}`),o+=1)}return s};function Ll(){const[e,n]=P.useState(!1),[r,i]=P.useState("chat"),[s,a]=P.useState([]),[o,c]=P.useState(""),[d,f]=P.useState([]),[h,u]=P.useState(!1),[m,p]=P.useState("anki"),[y,b]=P.useState(!1),[v,g]=P.useState(!1),[N,S]=P.useState(!1),[w,_]=P.useState(null),[E,O]=P.useState(""),[x,A]=P.useState(null),[j,M]=P.useState(null),[R,F]=P.useState(""),[T,D]=P.useState(""),[k,I]=P.useState({}),[z,L]=P.useState([]),H=P.useRef(null),K=P.useRef(null),Y=gt(),$=P.useCallback(()=>{H.current&&(H.current.scrollTop=H.current.scrollHeight)},[]);P.useEffect(()=>{$()},[s,$]);const B=()=>{g(!1),S(!1),_(null),O(""),A(null),M(null),F(""),D(""),I({}),L([])},X=U=>{U?g(!0):B()},J=async U=>{S(!0),_(null),O(U);try{const W=await V.brain.organizePreview(U);if(!W.success||!W.organized||!W.destination)throw new Error(W.error||"Unable to organize notes.");A(W.organized),M(W.destination),F("recommended");const Z=W.organized.checklist??[],ue={};return Z.forEach(Ee=>{ue[Ee]=!1}),I(ue),L(Fl(U,W.organized.markdown||"")),g(!0),!0}catch(W){const Z=W instanceof Error?W.message:String(W);return _(Z),!1}finally{S(!1)}},le=U=>{I(W=>({...W,[U]:!W[U]}))},xe=Object.values(k).length===0?!0:Object.values(k).every(Boolean),ke=()=>j?R==="custom"?T.trim():j.options.find(W=>W.id===R)?.path||"":"",St=async()=>{if(!x)return;const U=ke();if(!U){_("Select a destination path.");return}_(null),S(!0),u(!0);try{await ai(E,{destinationPath:U,organizedMarkdown:x.markdown,organizedTitle:x.title,confirmWrite:!0}),B()}catch(W){const Z=W instanceof Error?W.message:String(W);_(Z)}finally{S(!1),u(!1)}},jo=(U,W)=>{const Z=U.startsWith("+"),ue=U.startsWith("-");return l.jsx("div",{className:`font-terminal text-[11px] px-2 ${Z?"bg-green-900/30 text-green-400":ue?"bg-red-900/30 text-red-400":"text-muted-foreground"}`,children:U},W)},si=U=>{const W=new FileReader;W.onload=()=>{typeof W.result=="string"&&f(Z=>[...Z,W.result])},W.readAsDataURL(U)},ko=U=>{const W=U.clipboardData?.items;if(W){for(const Z of Array.from(W))if(Z.type.startsWith("image/")){U.preventDefault();const ue=Z.getAsFile();ue&&si(ue)}}},So=U=>{const W=U.target.files;if(W){for(const Z of Array.from(W))Z.type.startsWith("image/")&&si(Z);U.target.value=""}},Co=async(U,W)=>{a(Oe=>[...Oe,{role:"assistant",content:""}]);const Z=s.map(Oe=>({role:Oe.role,content:Oe.images?.length?mi(Oe.content,Oe.images):Oe.content})).concat([{role:"user",content:mi(U,W)}]),Ee=(await fetch("/api/brain/quick-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:Z})})).body?.getReader(),he=new TextDecoder;if(!Ee)throw new Error("No response body");let at="";for(;;){const{done:Oe,value:nt}=await Ee.read();if(Oe)break;at+=he.decode(nt,{stream:!0});const cn=at.split(`
`);at=cn.pop()??"";for(const li of cn){if(!li.startsWith("data: "))continue;const ci=li.slice(6);if(ci==="[DONE]")break;try{const un=JSON.parse(ci);if(un.error){a(Kn=>{const Be=[...Kn];return Be[Be.length-1]={role:"assistant",content:`Error: ${un.error}`},Be});return}un.content&&a(Kn=>{const Be=[...Kn],ui=Be[Be.length-1];return Be[Be.length-1]={...ui,content:ui.content+un.content},Be})}catch{}}}},ai=async(U,W)=>{try{const Ee={message:U,syncToObsidian:m==="obsidian"||m==="both",mode:m==="both"?"all":m,destinationPath:W?.destinationPath,organizedMarkdown:W?.organizedMarkdown,organizedTitle:W?.organizedTitle,confirmWrite:W?.confirmWrite},he=await V.brain.chat(Ee);let at=he.response;const Oe={cardsCreated:he.cardsCreated,sessionSaved:he.sessionSaved,sessionId:he.sessionId},nt=[];he.sessionSaved&&nt.push(`Session saved (ID: ${he.sessionId})`),he.cardsCreated&&nt.push(`${he.cardsCreated} Anki cards created`),he.obsidianSynced&&nt.push("Synced to Obsidian"),he.obsidianError&&nt.push(`Obsidian error: ${he.obsidianError}`),nt.length>0&&(at=`${nt.join(" | ")}

${at}`),a(cn=>[...cn,{role:"assistant",content:at,meta:Oe}]),Y.invalidateQueries({queryKey:["anki","drafts"]}),Y.invalidateQueries({queryKey:["brain","metrics"]}),Y.invalidateQueries({queryKey:["sessions"]})}catch(Z){a(ue=>[...ue,{role:"assistant",content:`Error: ${Z}`}])}},oi=async()=>{const U=o.trim();if(!U&&d.length===0)return;const W={role:"user",content:U,images:[...d]};a(Z=>[...Z,W]),c(""),f([]),u(!0);try{r==="chat"?await Co(U,W.images??[]):m==="obsidian"||m==="both"?await J(U)||a(ue=>[...ue,{role:"assistant",content:"Error: Unable to prepare preview."}]):await ai(U)}catch(Z){a(ue=>{const Ee=ue[ue.length-1];if(Ee?.role==="assistant"&&!Ee.content){const he=[...ue];return he[he.length-1]={role:"assistant",content:`Error: ${Z}`},he}return[...ue,{role:"assistant",content:`Error: ${Z}`}]})}finally{u(!1)}},Ao=U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),oi())};return e?l.jsxs(l.Fragment,{children:[l.jsx(Rr,{open:v,onOpenChange:X,children:l.jsxs(Ir,{className:"max-w-6xl w-full h-[85vh] bg-black border-2 border-primary rounded-none p-4 overflow-hidden",children:[l.jsxs(Dr,{className:"space-y-1",children:[l.jsxs(zr,{className:"font-arcade text-sm text-primary flex items-center gap-2",children:[l.jsx(Bs,{className:"w-4 h-4"}),"ORGANIZE + REVIEW"]}),l.jsx($r,{className:"font-terminal text-[11px] text-muted-foreground",children:"Review the organized notes, compare to raw, then choose where to save."})]}),w&&l.jsx("div",{className:"border border-red-500/50 bg-red-900/20 text-red-200 font-terminal text-xs p-2 rounded-none",children:w}),l.jsxs("div",{className:"grid grid-cols-3 gap-4 h-[70vh]",children:[l.jsx("div",{className:"col-span-2 flex flex-col gap-3",children:l.jsxs(Ps,{defaultValue:"preview",className:"w-full",children:[l.jsxs(Rs,{className:"grid grid-cols-3 rounded-none",children:[l.jsx(ut,{value:"preview",className:"rounded-none text-xs",children:"Preview"}),l.jsx(ut,{value:"raw",className:"rounded-none text-xs",children:"Raw"}),l.jsx(ut,{value:"diff",className:"rounded-none text-xs",children:"Diff"})]}),l.jsx(dt,{value:"preview",className:"mt-2",children:l.jsx(Ie,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-3",children:l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"font-arcade text-xs text-primary",children:x?.title||"Untitled"}),l.jsx(oa,{content:x?.markdown||""})]})})}),l.jsx(dt,{value:"raw",className:"mt-2",children:l.jsx(Ie,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-3",children:l.jsx("pre",{className:"whitespace-pre-wrap font-terminal text-[11px] text-foreground",children:E})})}),l.jsx(dt,{value:"diff",className:"mt-2",children:l.jsx(Ie,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-0",children:l.jsx("div",{className:"p-2",children:z.length===0?l.jsx("div",{className:"text-muted-foreground font-terminal text-xs",children:"No diff available."}):z.map((U,W)=>jo(U,W))})})})]})}),l.jsxs("div",{className:"col-span-1 flex flex-col gap-3",children:[l.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[l.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"DESTINATION"}),l.jsx(sa,{value:R,onValueChange:F,className:"space-y-2",children:(j?.options||[]).map(U=>l.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[l.jsx(aa,{value:U.id,className:"mt-1"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"font-terminal text-[11px] text-foreground flex items-center gap-1",children:[U.label,U.exists&&l.jsx(Yt,{variant:"outline",className:"text-[9px]",children:"existing"})]}),l.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground break-all",children:U.path||"Custom path"})]})]},U.id))}),R==="custom"&&l.jsxs("div",{className:"mt-2 space-y-1",children:[l.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground",children:"Custom path"}),l.jsx(It,{value:T,onChange:U=>D(U.target.value),placeholder:"School/Theraputic Intervention/Module 01 - Title.md",className:"bg-black border-secondary/60 rounded-none text-xs font-terminal"})]})]}),l.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[l.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"REVIEW CHECKLIST"}),l.jsx("div",{className:"space-y-2",children:(x?.checklist||[]).map(U=>l.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[l.jsx(ve,{checked:!!k[U],onCheckedChange:()=>le(U)}),l.jsx("span",{className:"font-terminal text-[11px] text-foreground",children:U})]},U))})]}),(x?.suggested_links||[]).length>0&&l.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[l.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"SUGGESTED LINKS"}),l.jsx("div",{className:"space-y-1",children:x?.suggested_links.map(U=>l.jsxs("div",{className:"font-terminal text-[11px] text-muted-foreground",children:["[[",U,"]]"]},U))})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(te,{variant:"outline",className:"flex-1 rounded-none font-terminal text-xs",onClick:()=>B(),disabled:N,children:"Cancel"}),l.jsxs(te,{className:"flex-1 bg-primary hover:bg-primary/80 rounded-none font-terminal text-xs",onClick:St,disabled:!xe||N||!ke(),children:[l.jsx(qo,{className:"w-3 h-3 mr-1"}),N?"Saving...":"Confirm & Save"]})]})]})]})]})}),l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none mb-4",children:[l.jsxs(ce,{className:"py-2 px-4 flex flex-row items-center justify-between",children:[l.jsx(fe,{className:"text-xs",children:"BRAIN CHAT"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs("div",{className:"flex bg-secondary/40 border border-secondary/60 rounded overflow-hidden mr-2",children:[l.jsxs("button",{onClick:()=>i("chat"),className:`flex items-center gap-1 px-2 py-0.5 text-[10px] transition-colors ${r==="chat"?"bg-primary/30 text-primary":"text-muted-foreground hover:text-foreground"}`,children:[l.jsx(Uo,{className:"w-3 h-3"})," CHAT"]}),l.jsxs("button",{onClick:()=>i("ingest"),className:`flex items-center gap-1 px-2 py-0.5 text-[10px] transition-colors ${r==="ingest"?"bg-primary/30 text-primary":"text-muted-foreground hover:text-foreground"}`,children:[l.jsx(rl,{className:"w-3 h-3"})," INGEST"]})]}),r==="ingest"&&l.jsx("button",{type:"button",className:"bg-primary hover:bg-primary/80 px-2 py-0.5 rounded-none text-[10px] font-terminal",onClick:()=>{navigator.clipboard.writeText($l),b(!0),setTimeout(()=>b(!1),2e3)},children:y?"Copied!":"Copy Prompt for ChatGPT"}),l.jsx(te,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>n(!1),children:l.jsx(Vo,{className:"w-4 h-4"})})]})]}),l.jsxs(ie,{className:"p-0",children:[l.jsxs("div",{className:"px-4 py-1 border-b border-border flex items-center justify-between",children:[l.jsx("p",{className:"text-[10px] text-muted-foreground",children:r==="chat"?"General chat with Gemini Flash — ask anything, paste screenshots":"Study ingestion — paste notes to create Anki cards & save sessions"}),r==="ingest"&&l.jsx("div",{className:"flex bg-secondary/40 border border-secondary/60 rounded overflow-hidden",children:["anki","obsidian","both"].map(U=>l.jsxs("button",{onClick:()=>p(U),className:`flex items-center gap-1 px-2 py-0.5 text-[10px] transition-colors ${m===U?"bg-primary/30 text-primary":"text-muted-foreground hover:text-foreground"}`,children:[U==="anki"&&l.jsxs(l.Fragment,{children:[l.jsx(Jt,{className:"w-3 h-3"})," ANKI"]}),U==="obsidian"&&l.jsxs(l.Fragment,{children:[l.jsx(lr,{className:"w-3 h-3"})," OBSIDIAN"]}),U==="both"&&l.jsx(l.Fragment,{children:"BOTH"})]},U))})]}),l.jsxs("div",{ref:H,className:"h-80 overflow-y-auto px-4 py-2 space-y-3",children:[s.length===0&&l.jsx("p",{className:"text-muted-foreground text-xs text-center py-8",children:r==="chat"?"Ask anything. Paste screenshots with Ctrl+V.":"Paste your study notes to ingest into Brain."}),s.map((U,W)=>l.jsx("div",{className:`flex ${U.role==="user"?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`max-w-[80%] rounded px-3 py-2 text-base whitespace-pre-wrap ${U.role==="user"?"bg-primary/20 text-foreground border border-primary/30":"bg-secondary/40 text-foreground border border-secondary/60"}`,children:[U.images?.map((Z,ue)=>l.jsx("img",{src:Z,alt:"attached",className:"max-h-32 rounded mb-1"},ue)),U.content]})},W)),h&&l.jsx("div",{className:"flex justify-start",children:l.jsx("div",{className:"bg-secondary/40 border border-secondary/60 rounded px-3 py-2",children:l.jsx(Jo,{className:"w-4 h-4 animate-spin text-primary"})})})]}),d.length>0&&l.jsx("div",{className:"px-4 py-1 flex gap-2 flex-wrap",children:d.map((U,W)=>l.jsxs("div",{className:"relative",children:[l.jsx("img",{src:U,alt:"pending",className:"h-12 rounded border border-primary/30"}),l.jsx("button",{onClick:()=>f(Z=>Z.filter((ue,Ee)=>Ee!==W)),className:"absolute -top-1 -right-1 bg-destructive rounded-full p-0.5",children:l.jsx(Kt,{className:"w-3 h-3"})})]},W))}),l.jsxs("div",{className:"flex items-end gap-2 px-4 py-2 border-t border-border",children:[l.jsx("input",{ref:K,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:So}),r==="chat"&&l.jsx(te,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:()=>K.current?.click(),children:l.jsx(cl,{className:"w-4 h-4 text-primary"})}),l.jsx("textarea",{value:o,onChange:U=>c(U.target.value),onKeyDown:Ao,onPaste:ko,placeholder:r==="chat"?"Ask anything... (Ctrl+V to paste images)":"Paste study notes to ingest...",rows:r==="ingest"?3:1,className:"flex-1 bg-transparent border border-input rounded px-3 py-1.5 text-base resize-none focus:outline-none focus:ring-1 focus:ring-ring"}),l.jsx(te,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:oi,disabled:h,children:l.jsx(Xo,{className:"w-4 h-4 text-primary"})})]})]})]})]}):l.jsxs("button",{onClick:()=>n(!0),className:"w-full flex items-center justify-between bg-black/40 border-2 border-primary rounded-none px-4 py-2 mb-4 text-sm text-primary hover:bg-primary/10 transition-colors",children:[l.jsxs("span",{className:"font-arcade text-xs tracking-widest uppercase flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 bg-primary inline-block"}),"BRAIN CHAT"]}),l.jsx(Do,{className:"w-4 h-4"})]})}function ql(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,s,a,o,c=[],d=!0,f=!1;try{if(a=(r=r.call(e)).next,n===0){if(Object(r)!==r)return;d=!1}else for(;!(d=(i=a.call(r)).done)&&(c.push(i.value),c.length!==n);d=!0);}catch(h){f=!0,s=h}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(f)throw s}}return c}}function Ul(e,n,r){return n=Jl(n),n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function gi(e,n){return Gl(e)||ql(e,n)||la(e,n)||Kl()}function Hl(e){return Bl(e)||Vl(e)||la(e)||Wl()}function Bl(e){if(Array.isArray(e))return ur(e)}function Gl(e){if(Array.isArray(e))return e}function Vl(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function la(e,n){if(e){if(typeof e=="string")return ur(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ur(e,n)}}function ur(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=new Array(n);r<n;r++)i[r]=e[r];return i}function Wl(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kl(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yl(e,n){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Jl(e){var n=Yl(e,"string");return typeof n=="symbol"?n:String(n)}var Xl=function(n,r){var i=new Set(r);return Object.assign.apply(Object,[{}].concat(Hl(Object.entries(n).filter(function(s){var a=gi(s,1),o=a[0];return!i.has(o)}).map(function(s){var a=gi(s,2),o=a[0],c=a[1];return Ul({},o,c)}))))};function dr(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function Ql(e){if(Array.isArray(e))return e}function Zl(e){if(Array.isArray(e))return dr(e)}function ec(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tc(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,s,a,o,c=[],d=!0,f=!1;try{if(a=(r=r.call(e)).next,n!==0)for(;!(d=(i=a.call(r)).done)&&(c.push(i.value),c.length!==n);d=!0);}catch(h){f=!0,s=h}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(f)throw s}}return c}}function nc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ic(e,n){return Ql(e)||tc(e,n)||ca(e,n)||nc()}function xi(e){return Zl(e)||ec(e)||ca(e)||rc()}function ca(e,n){if(e){if(typeof e=="string")return dr(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dr(e,n):void 0}}function sc(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.wrapperElementType,i=r===void 0?"div":r,s=n.nodeMapper,a=s===void 0?function(h){return h}:s,o=n.methodNames,c=o===void 0?[]:o,d=n.initPropNames,f=d===void 0?[]:d;return P.forwardRef(function(h,u){var m=P.useRef(),p=P.useMemo(function(){var v=Object.fromEntries(f.filter(function(g){return h.hasOwnProperty(g)}).map(function(g){return[g,h[g]]}));return e(v)},[]);yi(function(){p(a(m.current))},P.useLayoutEffect),yi(function(){return p._destructor instanceof Function?p._destructor:void 0});var y=P.useCallback(function(v){for(var g=arguments.length,N=new Array(g>1?g-1:0),S=1;S<g;S++)N[S-1]=arguments[S];return p[v]instanceof Function?p[v].apply(p,N):void 0},[p]),b=P.useRef({});return Object.keys(Xl(h,[].concat(xi(c),xi(f)))).filter(function(v){return b.current[v]!==h[v]}).forEach(function(v){return y(v,h[v])}),b.current=h,P.useImperativeHandle(u,function(){return Object.fromEntries(c.map(function(v){return[v,function(){for(var g=arguments.length,N=new Array(g),S=0;S<g;S++)N[S]=arguments[S];return y.apply(void 0,[v].concat(N))}]}))},[y]),Po.createElement(i,{ref:m})})}function yi(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:P.useEffect,r=P.useRef(),i=P.useRef(!1),s=P.useRef(!1),a=P.useState(0),o=ic(a,2);o[0];var c=o[1];i.current&&(s.current=!0),n(function(){return i.current||(r.current=e(),i.current=!0),c(function(d){return d+1}),function(){s.current&&r.current&&r.current()}},[])}var fr="http://www.w3.org/1999/xhtml";const bi={svg:"http://www.w3.org/2000/svg",xhtml:fr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ln(e){var n=e+="",r=n.indexOf(":");return r>=0&&(n=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),bi.hasOwnProperty(n)?{space:bi[n],local:e}:e}function ac(e){return function(){var n=this.ownerDocument,r=this.namespaceURI;return r===fr&&n.documentElement.namespaceURI===fr?n.createElement(e):n.createElementNS(r,e)}}function oc(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ua(e){var n=Ln(e);return(n.local?oc:ac)(n)}function lc(){}function Ur(e){return e==null?lc:function(){return this.querySelector(e)}}function cc(e){typeof e!="function"&&(e=Ur(e));for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s)for(var a=n[s],o=a.length,c=i[s]=new Array(o),d,f,h=0;h<o;++h)(d=a[h])&&(f=e.call(d,d.__data__,h,a))&&("__data__"in d&&(f.__data__=d.__data__),c[h]=f);return new je(i,this._parents)}function uc(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function dc(){return[]}function da(e){return e==null?dc:function(){return this.querySelectorAll(e)}}function fc(e){return function(){return uc(e.apply(this,arguments))}}function hc(e){typeof e=="function"?e=fc(e):e=da(e);for(var n=this._groups,r=n.length,i=[],s=[],a=0;a<r;++a)for(var o=n[a],c=o.length,d,f=0;f<c;++f)(d=o[f])&&(i.push(e.call(d,d.__data__,f,o)),s.push(d));return new je(i,s)}function fa(e){return function(){return this.matches(e)}}function ha(e){return function(n){return n.matches(e)}}var pc=Array.prototype.find;function mc(e){return function(){return pc.call(this.children,e)}}function gc(){return this.firstElementChild}function xc(e){return this.select(e==null?gc:mc(typeof e=="function"?e:ha(e)))}var yc=Array.prototype.filter;function bc(){return Array.from(this.children)}function vc(e){return function(){return yc.call(this.children,e)}}function _c(e){return this.selectAll(e==null?bc:vc(typeof e=="function"?e:ha(e)))}function wc(e){typeof e!="function"&&(e=fa(e));for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s)for(var a=n[s],o=a.length,c=i[s]=[],d,f=0;f<o;++f)(d=a[f])&&e.call(d,d.__data__,f,a)&&c.push(d);return new je(i,this._parents)}function pa(e){return new Array(e.length)}function Nc(){return new je(this._enter||this._groups.map(pa),this._parents)}function Sn(e,n){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=n}Sn.prototype={constructor:Sn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,n){return this._parent.insertBefore(e,n)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function jc(e){return function(){return e}}function kc(e,n,r,i,s,a){for(var o=0,c,d=n.length,f=a.length;o<f;++o)(c=n[o])?(c.__data__=a[o],i[o]=c):r[o]=new Sn(e,a[o]);for(;o<d;++o)(c=n[o])&&(s[o]=c)}function Sc(e,n,r,i,s,a,o){var c,d,f=new Map,h=n.length,u=a.length,m=new Array(h),p;for(c=0;c<h;++c)(d=n[c])&&(m[c]=p=o.call(d,d.__data__,c,n)+"",f.has(p)?s[c]=d:f.set(p,d));for(c=0;c<u;++c)p=o.call(e,a[c],c,a)+"",(d=f.get(p))?(i[c]=d,d.__data__=a[c],f.delete(p)):r[c]=new Sn(e,a[c]);for(c=0;c<h;++c)(d=n[c])&&f.get(m[c])===d&&(s[c]=d)}function Cc(e){return e.__data__}function Ac(e,n){if(!arguments.length)return Array.from(this,Cc);var r=n?Sc:kc,i=this._parents,s=this._groups;typeof e!="function"&&(e=jc(e));for(var a=s.length,o=new Array(a),c=new Array(a),d=new Array(a),f=0;f<a;++f){var h=i[f],u=s[f],m=u.length,p=Tc(e.call(h,h&&h.__data__,f,i)),y=p.length,b=c[f]=new Array(y),v=o[f]=new Array(y),g=d[f]=new Array(m);r(h,u,b,v,g,p,n);for(var N=0,S=0,w,_;N<y;++N)if(w=b[N]){for(N>=S&&(S=N+1);!(_=v[S])&&++S<y;);w._next=_||null}}return o=new je(o,i),o._enter=c,o._exit=d,o}function Tc(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ec(){return new je(this._exit||this._groups.map(pa),this._parents)}function Oc(e,n,r){var i=this.enter(),s=this,a=this.exit();return typeof e=="function"?(i=e(i),i&&(i=i.selection())):i=i.append(e+""),n!=null&&(s=n(s),s&&(s=s.selection())),r==null?a.remove():r(a),i&&s?i.merge(s).order():s}function Mc(e){for(var n=e.selection?e.selection():e,r=this._groups,i=n._groups,s=r.length,a=i.length,o=Math.min(s,a),c=new Array(s),d=0;d<o;++d)for(var f=r[d],h=i[d],u=f.length,m=c[d]=new Array(u),p,y=0;y<u;++y)(p=f[y]||h[y])&&(m[y]=p);for(;d<s;++d)c[d]=r[d];return new je(c,this._parents)}function Pc(){for(var e=this._groups,n=-1,r=e.length;++n<r;)for(var i=e[n],s=i.length-1,a=i[s],o;--s>=0;)(o=i[s])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function Rc(e){e||(e=Ic);function n(u,m){return u&&m?e(u.__data__,m.__data__):!u-!m}for(var r=this._groups,i=r.length,s=new Array(i),a=0;a<i;++a){for(var o=r[a],c=o.length,d=s[a]=new Array(c),f,h=0;h<c;++h)(f=o[h])&&(d[h]=f);d.sort(n)}return new je(s,this._parents).order()}function Ic(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}function Dc(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function zc(){return Array.from(this)}function $c(){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,a=i.length;s<a;++s){var o=i[s];if(o)return o}return null}function Fc(){let e=0;for(const n of this)++e;return e}function Lc(){return!this.node()}function qc(e){for(var n=this._groups,r=0,i=n.length;r<i;++r)for(var s=n[r],a=0,o=s.length,c;a<o;++a)(c=s[a])&&e.call(c,c.__data__,a,s);return this}function Uc(e){return function(){this.removeAttribute(e)}}function Hc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Bc(e,n){return function(){this.setAttribute(e,n)}}function Gc(e,n){return function(){this.setAttributeNS(e.space,e.local,n)}}function Vc(e,n){return function(){var r=n.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Wc(e,n){return function(){var r=n.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function Kc(e,n){var r=Ln(e);if(arguments.length<2){var i=this.node();return r.local?i.getAttributeNS(r.space,r.local):i.getAttribute(r)}return this.each((n==null?r.local?Hc:Uc:typeof n=="function"?r.local?Wc:Vc:r.local?Gc:Bc)(r,n))}function ma(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Yc(e){return function(){this.style.removeProperty(e)}}function Jc(e,n,r){return function(){this.style.setProperty(e,n,r)}}function Xc(e,n,r){return function(){var i=n.apply(this,arguments);i==null?this.style.removeProperty(e):this.style.setProperty(e,i,r)}}function Qc(e,n,r){return arguments.length>1?this.each((n==null?Yc:typeof n=="function"?Xc:Jc)(e,n,r??"")):wt(this.node(),e)}function wt(e,n){return e.style.getPropertyValue(n)||ma(e).getComputedStyle(e,null).getPropertyValue(n)}function Zc(e){return function(){delete this[e]}}function eu(e,n){return function(){this[e]=n}}function tu(e,n){return function(){var r=n.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function nu(e,n){return arguments.length>1?this.each((n==null?Zc:typeof n=="function"?tu:eu)(e,n)):this.node()[e]}function ga(e){return e.trim().split(/^|\s+/)}function Hr(e){return e.classList||new xa(e)}function xa(e){this._node=e,this._names=ga(e.getAttribute("class")||"")}xa.prototype={add:function(e){var n=this._names.indexOf(e);n<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var n=this._names.indexOf(e);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ya(e,n){for(var r=Hr(e),i=-1,s=n.length;++i<s;)r.add(n[i])}function ba(e,n){for(var r=Hr(e),i=-1,s=n.length;++i<s;)r.remove(n[i])}function ru(e){return function(){ya(this,e)}}function iu(e){return function(){ba(this,e)}}function su(e,n){return function(){(n.apply(this,arguments)?ya:ba)(this,e)}}function au(e,n){var r=ga(e+"");if(arguments.length<2){for(var i=Hr(this.node()),s=-1,a=r.length;++s<a;)if(!i.contains(r[s]))return!1;return!0}return this.each((typeof n=="function"?su:n?ru:iu)(r,n))}function ou(){this.textContent=""}function lu(e){return function(){this.textContent=e}}function cu(e){return function(){var n=e.apply(this,arguments);this.textContent=n??""}}function uu(e){return arguments.length?this.each(e==null?ou:(typeof e=="function"?cu:lu)(e)):this.node().textContent}function du(){this.innerHTML=""}function fu(e){return function(){this.innerHTML=e}}function hu(e){return function(){var n=e.apply(this,arguments);this.innerHTML=n??""}}function pu(e){return arguments.length?this.each(e==null?du:(typeof e=="function"?hu:fu)(e)):this.node().innerHTML}function mu(){this.nextSibling&&this.parentNode.appendChild(this)}function gu(){return this.each(mu)}function xu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function yu(){return this.each(xu)}function bu(e){var n=typeof e=="function"?e:ua(e);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function vu(){return null}function _u(e,n){var r=typeof e=="function"?e:ua(e),i=n==null?vu:typeof n=="function"?n:Ur(n);return this.select(function(){return this.insertBefore(r.apply(this,arguments),i.apply(this,arguments)||null)})}function wu(){var e=this.parentNode;e&&e.removeChild(this)}function Nu(){return this.each(wu)}function ju(){var e=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function ku(){var e=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function Su(e){return this.select(e?ku:ju)}function Cu(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Au(e){return function(n){e.call(this,n,this.__data__)}}function Tu(e){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");return i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),{type:n,name:r}})}function Eu(e){return function(){var n=this.__on;if(n){for(var r=0,i=-1,s=n.length,a;r<s;++r)a=n[r],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):n[++i]=a;++i?n.length=i:delete this.__on}}}function Ou(e,n,r){return function(){var i=this.__on,s,a=Au(n);if(i){for(var o=0,c=i.length;o<c;++o)if((s=i[o]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=a,s.options=r),s.value=n;return}}this.addEventListener(e.type,a,r),s={type:e.type,name:e.name,value:n,listener:a,options:r},i?i.push(s):this.__on=[s]}}function Mu(e,n,r){var i=Tu(e+""),s,a=i.length,o;if(arguments.length<2){var c=this.node().__on;if(c){for(var d=0,f=c.length,h;d<f;++d)for(s=0,h=c[d];s<a;++s)if((o=i[s]).type===h.type&&o.name===h.name)return h.value}return}for(c=n?Ou:Eu,s=0;s<a;++s)this.each(c(i[s],n,r));return this}function va(e,n,r){var i=ma(e),s=i.CustomEvent;typeof s=="function"?s=new s(n,r):(s=i.document.createEvent("Event"),r?(s.initEvent(n,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(n,!1,!1)),e.dispatchEvent(s)}function Pu(e,n){return function(){return va(this,e,n)}}function Ru(e,n){return function(){return va(this,e,n.apply(this,arguments))}}function Iu(e,n){return this.each((typeof n=="function"?Ru:Pu)(e,n))}function*Du(){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,a=i.length,o;s<a;++s)(o=i[s])&&(yield o)}var _a=[null];function je(e,n){this._groups=e,this._parents=n}function sn(){return new je([[document.documentElement]],_a)}function zu(){return this}je.prototype=sn.prototype={constructor:je,select:cc,selectAll:hc,selectChild:xc,selectChildren:_c,filter:wc,data:Ac,enter:Nc,exit:Ec,join:Oc,merge:Mc,selection:zu,order:Pc,sort:Rc,call:Dc,nodes:zc,node:$c,size:Fc,empty:Lc,each:qc,attr:Kc,style:Qc,property:nu,classed:au,text:uu,html:pu,raise:gu,lower:yu,append:bu,insert:_u,remove:Nu,clone:Su,datum:Cu,on:Mu,dispatch:Iu,[Symbol.iterator]:Du};function Ae(e){return typeof e=="string"?new je([[document.querySelector(e)]],[document.documentElement]):new je([[e]],_a)}function $u(e){let n;for(;n=e.sourceEvent;)e=n;return e}function $e(e,n){if(e=$u(e),n===void 0&&(n=e.currentTarget),n){var r=n.ownerSVGElement||n;if(r.createSVGPoint){var i=r.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(n.getScreenCTM().inverse()),[i.x,i.y]}if(n.getBoundingClientRect){var s=n.getBoundingClientRect();return[e.clientX-s.left-n.clientLeft,e.clientY-s.top-n.clientTop]}}return[e.pageX,e.pageY]}var Fu={value:()=>{}};function an(){for(var e=0,n=arguments.length,r={},i;e<n;++e){if(!(i=arguments[e]+"")||i in r||/[\s.]/.test(i))throw new Error("illegal type: "+i);r[i]=[]}return new vn(r)}function vn(e){this._=e}function Lu(e,n){return e.trim().split(/^|\s+/).map(function(r){var i="",s=r.indexOf(".");if(s>=0&&(i=r.slice(s+1),r=r.slice(0,s)),r&&!n.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:i}})}vn.prototype=an.prototype={constructor:vn,on:function(e,n){var r=this._,i=Lu(e+"",r),s,a=-1,o=i.length;if(arguments.length<2){for(;++a<o;)if((s=(e=i[a]).type)&&(s=qu(r[s],e.name)))return s;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++a<o;)if(s=(e=i[a]).type)r[s]=vi(r[s],e.name,n);else if(n==null)for(s in r)r[s]=vi(r[s],e.name,null);return this},copy:function(){var e={},n=this._;for(var r in n)e[r]=n[r].slice();return new vn(e)},call:function(e,n){if((s=arguments.length-2)>0)for(var r=new Array(s),i=0,s,a;i<s;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],i=0,s=a.length;i<s;++i)a[i].value.apply(n,r)},apply:function(e,n,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],s=0,a=i.length;s<a;++s)i[s].value.apply(n,r)}};function qu(e,n){for(var r=0,i=e.length,s;r<i;++r)if((s=e[r]).name===n)return s.value}function vi(e,n,r){for(var i=0,s=e.length;i<s;++i)if(e[i].name===n){e[i]=Fu,e=e.slice(0,i).concat(e.slice(i+1));break}return r!=null&&e.push({name:n,value:r}),e}const Uu={passive:!1},Xt={capture:!0,passive:!1};function Jn(e){e.stopImmediatePropagation()}function vt(e){e.preventDefault(),e.stopImmediatePropagation()}function wa(e){var n=e.document.documentElement,r=Ae(e).on("dragstart.drag",vt,Xt);"onselectstart"in n?r.on("selectstart.drag",vt,Xt):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function Na(e,n){var r=e.document.documentElement,i=Ae(e).on("dragstart.drag",null);n&&(i.on("click.drag",vt,Xt),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in r?i.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const dn=e=>()=>e;function hr(e,{sourceEvent:n,subject:r,target:i,identifier:s,active:a,x:o,y:c,dx:d,dy:f,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:h}})}hr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Hu(e){return!e.ctrlKey&&!e.button}function Bu(){return this.parentNode}function Gu(e,n){return n??{x:e.x,y:e.y}}function Vu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Wu(){var e=Hu,n=Bu,r=Gu,i=Vu,s={},a=an("start","drag","end"),o=0,c,d,f,h,u=0;function m(w){w.on("mousedown.drag",p).filter(i).on("touchstart.drag",v).on("touchmove.drag",g,Uu).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(w,_){if(!(h||!e.call(this,w,_))){var E=S(this,n.call(this,w,_),w,_,"mouse");E&&(Ae(w.view).on("mousemove.drag",y,Xt).on("mouseup.drag",b,Xt),wa(w.view),Jn(w),f=!1,c=w.clientX,d=w.clientY,E("start",w))}}function y(w){if(vt(w),!f){var _=w.clientX-c,E=w.clientY-d;f=_*_+E*E>u}s.mouse("drag",w)}function b(w){Ae(w.view).on("mousemove.drag mouseup.drag",null),Na(w.view,f),vt(w),s.mouse("end",w)}function v(w,_){if(e.call(this,w,_)){var E=w.changedTouches,O=n.call(this,w,_),x=E.length,A,j;for(A=0;A<x;++A)(j=S(this,O,w,_,E[A].identifier,E[A]))&&(Jn(w),j("start",w,E[A]))}}function g(w){var _=w.changedTouches,E=_.length,O,x;for(O=0;O<E;++O)(x=s[_[O].identifier])&&(vt(w),x("drag",w,_[O]))}function N(w){var _=w.changedTouches,E=_.length,O,x;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),O=0;O<E;++O)(x=s[_[O].identifier])&&(Jn(w),x("end",w,_[O]))}function S(w,_,E,O,x,A){var j=a.copy(),M=$e(A||E,_),R,F,T;if((T=r.call(w,new hr("beforestart",{sourceEvent:E,target:m,identifier:x,active:o,x:M[0],y:M[1],dx:0,dy:0,dispatch:j}),O))!=null)return R=T.x-M[0]||0,F=T.y-M[1]||0,function D(k,I,z){var L=M,H;switch(k){case"start":s[x]=D,H=o++;break;case"end":delete s[x],--o;case"drag":M=$e(z||I,_),H=o;break}j.call(k,w,new hr(k,{sourceEvent:I,subject:T,target:m,identifier:x,active:H,x:M[0]+R,y:M[1]+F,dx:M[0]-L[0],dy:M[1]-L[1],dispatch:j}),O)}}return m.filter=function(w){return arguments.length?(e=typeof w=="function"?w:dn(!!w),m):e},m.container=function(w){return arguments.length?(n=typeof w=="function"?w:dn(w),m):n},m.subject=function(w){return arguments.length?(r=typeof w=="function"?w:dn(w),m):r},m.touchable=function(w){return arguments.length?(i=typeof w=="function"?w:dn(!!w),m):i},m.on=function(){var w=a.on.apply(a,arguments);return w===a?m:w},m.clickDistance=function(w){return arguments.length?(u=(w=+w)*w,m):Math.sqrt(u)},m}function Br(e,n,r){e.prototype=n.prototype=r,r.constructor=e}function ja(e,n){var r=Object.create(e.prototype);for(var i in n)r[i]=n[i];return r}function on(){}var Qt=.7,Cn=1/Qt,_t="\\s*([+-]?\\d+)\\s*",Zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Le="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ku=/^#([0-9a-f]{3,8})$/,Yu=new RegExp(`^rgb\\(${_t},${_t},${_t}\\)$`),Ju=new RegExp(`^rgb\\(${Le},${Le},${Le}\\)$`),Xu=new RegExp(`^rgba\\(${_t},${_t},${_t},${Zt}\\)$`),Qu=new RegExp(`^rgba\\(${Le},${Le},${Le},${Zt}\\)$`),Zu=new RegExp(`^hsl\\(${Zt},${Le},${Le}\\)$`),ed=new RegExp(`^hsla\\(${Zt},${Le},${Le},${Zt}\\)$`),_i={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Br(on,en,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:wi,formatHex:wi,formatHex8:td,formatHsl:nd,formatRgb:Ni,toString:Ni});function wi(){return this.rgb().formatHex()}function td(){return this.rgb().formatHex8()}function nd(){return ka(this).formatHsl()}function Ni(){return this.rgb().formatRgb()}function en(e){var n,r;return e=(e+"").trim().toLowerCase(),(n=Ku.exec(e))?(r=n[1].length,n=parseInt(n[1],16),r===6?ji(n):r===3?new _e(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):r===8?fn(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):r===4?fn(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=Yu.exec(e))?new _e(n[1],n[2],n[3],1):(n=Ju.exec(e))?new _e(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=Xu.exec(e))?fn(n[1],n[2],n[3],n[4]):(n=Qu.exec(e))?fn(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=Zu.exec(e))?Ci(n[1],n[2]/100,n[3]/100,1):(n=ed.exec(e))?Ci(n[1],n[2]/100,n[3]/100,n[4]):_i.hasOwnProperty(e)?ji(_i[e]):e==="transparent"?new _e(NaN,NaN,NaN,0):null}function ji(e){return new _e(e>>16&255,e>>8&255,e&255,1)}function fn(e,n,r,i){return i<=0&&(e=n=r=NaN),new _e(e,n,r,i)}function rd(e){return e instanceof on||(e=en(e)),e?(e=e.rgb(),new _e(e.r,e.g,e.b,e.opacity)):new _e}function pr(e,n,r,i){return arguments.length===1?rd(e):new _e(e,n,r,i??1)}function _e(e,n,r,i){this.r=+e,this.g=+n,this.b=+r,this.opacity=+i}Br(_e,pr,ja(on,{brighter(e){return e=e==null?Cn:Math.pow(Cn,e),new _e(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Qt:Math.pow(Qt,e),new _e(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new _e(ht(this.r),ht(this.g),ht(this.b),An(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ki,formatHex:ki,formatHex8:id,formatRgb:Si,toString:Si}));function ki(){return`#${ft(this.r)}${ft(this.g)}${ft(this.b)}`}function id(){return`#${ft(this.r)}${ft(this.g)}${ft(this.b)}${ft((isNaN(this.opacity)?1:this.opacity)*255)}`}function Si(){const e=An(this.opacity);return`${e===1?"rgb(":"rgba("}${ht(this.r)}, ${ht(this.g)}, ${ht(this.b)}${e===1?")":`, ${e})`}`}function An(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ht(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ft(e){return e=ht(e),(e<16?"0":"")+e.toString(16)}function Ci(e,n,r,i){return i<=0?e=n=r=NaN:r<=0||r>=1?e=n=NaN:n<=0&&(e=NaN),new Pe(e,n,r,i)}function ka(e){if(e instanceof Pe)return new Pe(e.h,e.s,e.l,e.opacity);if(e instanceof on||(e=en(e)),!e)return new Pe;if(e instanceof Pe)return e;e=e.rgb();var n=e.r/255,r=e.g/255,i=e.b/255,s=Math.min(n,r,i),a=Math.max(n,r,i),o=NaN,c=a-s,d=(a+s)/2;return c?(n===a?o=(r-i)/c+(r<i)*6:r===a?o=(i-n)/c+2:o=(n-r)/c+4,c/=d<.5?a+s:2-a-s,o*=60):c=d>0&&d<1?0:o,new Pe(o,c,d,e.opacity)}function sd(e,n,r,i){return arguments.length===1?ka(e):new Pe(e,n,r,i??1)}function Pe(e,n,r,i){this.h=+e,this.s=+n,this.l=+r,this.opacity=+i}Br(Pe,sd,ja(on,{brighter(e){return e=e==null?Cn:Math.pow(Cn,e),new Pe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Qt:Math.pow(Qt,e),new Pe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*n,s=2*r-i;return new _e(Xn(e>=240?e-240:e+120,s,i),Xn(e,s,i),Xn(e<120?e+240:e-120,s,i),this.opacity)},clamp(){return new Pe(Ai(this.h),hn(this.s),hn(this.l),An(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=An(this.opacity);return`${e===1?"hsl(":"hsla("}${Ai(this.h)}, ${hn(this.s)*100}%, ${hn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Ai(e){return e=(e||0)%360,e<0?e+360:e}function hn(e){return Math.max(0,Math.min(1,e||0))}function Xn(e,n,r){return(e<60?n+(r-n)*e/60:e<180?r:e<240?n+(r-n)*(240-e)/60:n)*255}const Sa=e=>()=>e;function ad(e,n){return function(r){return e+r*n}}function od(e,n,r){return e=Math.pow(e,r),n=Math.pow(n,r)-e,r=1/r,function(i){return Math.pow(e+i*n,r)}}function ld(e){return(e=+e)==1?Ca:function(n,r){return r-n?od(n,r,e):Sa(isNaN(n)?r:n)}}function Ca(e,n){var r=n-e;return r?ad(e,r):Sa(isNaN(e)?n:e)}const Ti=(function e(n){var r=ld(n);function i(s,a){var o=r((s=pr(s)).r,(a=pr(a)).r),c=r(s.g,a.g),d=r(s.b,a.b),f=Ca(s.opacity,a.opacity);return function(h){return s.r=o(h),s.g=c(h),s.b=d(h),s.opacity=f(h),s+""}}return i.gamma=e,i})(1);function st(e,n){return e=+e,n=+n,function(r){return e*(1-r)+n*r}}var mr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Qn=new RegExp(mr.source,"g");function cd(e){return function(){return e}}function ud(e){return function(n){return e(n)+""}}function dd(e,n){var r=mr.lastIndex=Qn.lastIndex=0,i,s,a,o=-1,c=[],d=[];for(e=e+"",n=n+"";(i=mr.exec(e))&&(s=Qn.exec(n));)(a=s.index)>r&&(a=n.slice(r,a),c[o]?c[o]+=a:c[++o]=a),(i=i[0])===(s=s[0])?c[o]?c[o]+=s:c[++o]=s:(c[++o]=null,d.push({i:o,x:st(i,s)})),r=Qn.lastIndex;return r<n.length&&(a=n.slice(r),c[o]?c[o]+=a:c[++o]=a),c.length<2?d[0]?ud(d[0].x):cd(n):(n=d.length,function(f){for(var h=0,u;h<n;++h)c[(u=d[h]).i]=u.x(f);return c.join("")})}var Ei=180/Math.PI,gr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Aa(e,n,r,i,s,a){var o,c,d;return(o=Math.sqrt(e*e+n*n))&&(e/=o,n/=o),(d=e*r+n*i)&&(r-=e*d,i-=n*d),(c=Math.sqrt(r*r+i*i))&&(r/=c,i/=c,d/=c),e*i<n*r&&(e=-e,n=-n,d=-d,o=-o),{translateX:s,translateY:a,rotate:Math.atan2(n,e)*Ei,skewX:Math.atan(d)*Ei,scaleX:o,scaleY:c}}var pn;function fd(e){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return n.isIdentity?gr:Aa(n.a,n.b,n.c,n.d,n.e,n.f)}function hd(e){return e==null||(pn||(pn=document.createElementNS("http://www.w3.org/2000/svg","g")),pn.setAttribute("transform",e),!(e=pn.transform.baseVal.consolidate()))?gr:(e=e.matrix,Aa(e.a,e.b,e.c,e.d,e.e,e.f))}function Ta(e,n,r,i){function s(f){return f.length?f.pop()+" ":""}function a(f,h,u,m,p,y){if(f!==u||h!==m){var b=p.push("translate(",null,n,null,r);y.push({i:b-4,x:st(f,u)},{i:b-2,x:st(h,m)})}else(u||m)&&p.push("translate("+u+n+m+r)}function o(f,h,u,m){f!==h?(f-h>180?h+=360:h-f>180&&(f+=360),m.push({i:u.push(s(u)+"rotate(",null,i)-2,x:st(f,h)})):h&&u.push(s(u)+"rotate("+h+i)}function c(f,h,u,m){f!==h?m.push({i:u.push(s(u)+"skewX(",null,i)-2,x:st(f,h)}):h&&u.push(s(u)+"skewX("+h+i)}function d(f,h,u,m,p,y){if(f!==u||h!==m){var b=p.push(s(p)+"scale(",null,",",null,")");y.push({i:b-4,x:st(f,u)},{i:b-2,x:st(h,m)})}else(u!==1||m!==1)&&p.push(s(p)+"scale("+u+","+m+")")}return function(f,h){var u=[],m=[];return f=e(f),h=e(h),a(f.translateX,f.translateY,h.translateX,h.translateY,u,m),o(f.rotate,h.rotate,u,m),c(f.skewX,h.skewX,u,m),d(f.scaleX,f.scaleY,h.scaleX,h.scaleY,u,m),f=h=null,function(p){for(var y=-1,b=m.length,v;++y<b;)u[(v=m[y]).i]=v.x(p);return u.join("")}}}var pd=Ta(fd,"px, ","px)","deg)"),md=Ta(hd,", ",")",")"),gd=1e-12;function Oi(e){return((e=Math.exp(e))+1/e)/2}function xd(e){return((e=Math.exp(e))-1/e)/2}function yd(e){return((e=Math.exp(2*e))-1)/(e+1)}const bd=(function e(n,r,i){function s(a,o){var c=a[0],d=a[1],f=a[2],h=o[0],u=o[1],m=o[2],p=h-c,y=u-d,b=p*p+y*y,v,g;if(b<gd)g=Math.log(m/f)/n,v=function(O){return[c+O*p,d+O*y,f*Math.exp(n*O*g)]};else{var N=Math.sqrt(b),S=(m*m-f*f+i*b)/(2*f*r*N),w=(m*m-f*f-i*b)/(2*m*r*N),_=Math.log(Math.sqrt(S*S+1)-S),E=Math.log(Math.sqrt(w*w+1)-w);g=(E-_)/n,v=function(O){var x=O*g,A=Oi(_),j=f/(r*N)*(A*yd(n*x+_)-xd(_));return[c+j*p,d+j*y,f*A/Oi(n*x+_)]}}return v.duration=g*1e3*n/Math.SQRT2,v}return s.rho=function(a){var o=Math.max(.001,+a),c=o*o,d=c*c;return e(o,c,d)},s})(Math.SQRT2,2,4);var Nt=0,Dt=0,Ct=0,Ea=1e3,Tn,zt,En=0,mt=0,qn=0,tn=typeof performance=="object"&&performance.now?performance:Date,Oa=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Gr(){return mt||(Oa(vd),mt=tn.now()+qn)}function vd(){mt=0}function On(){this._call=this._time=this._next=null}On.prototype=Vr.prototype={constructor:On,restart:function(e,n,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Gr():+r)+(n==null?0:+n),!this._next&&zt!==this&&(zt?zt._next=this:Tn=this,zt=this),this._call=e,this._time=r,xr()},stop:function(){this._call&&(this._call=null,this._time=1/0,xr())}};function Vr(e,n,r){var i=new On;return i.restart(e,n,r),i}function _d(){Gr(),++Nt;for(var e=Tn,n;e;)(n=mt-e._time)>=0&&e._call.call(void 0,n),e=e._next;--Nt}function Mi(){mt=(En=tn.now())+qn,Nt=Dt=0;try{_d()}finally{Nt=0,Nd(),mt=0}}function wd(){var e=tn.now(),n=e-En;n>Ea&&(qn-=n,En=e)}function Nd(){for(var e,n=Tn,r,i=1/0;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(r=n._next,n._next=null,n=e?e._next=r:Tn=r);zt=e,xr(i)}function xr(e){if(!Nt){Dt&&(Dt=clearTimeout(Dt));var n=e-mt;n>24?(e<1/0&&(Dt=setTimeout(Mi,e-tn.now()-qn)),Ct&&(Ct=clearInterval(Ct))):(Ct||(En=tn.now(),Ct=setInterval(wd,Ea)),Nt=1,Oa(Mi))}}function Pi(e,n,r){var i=new On;return n=n==null?0:+n,i.restart(s=>{i.stop(),e(s+n)},n,r),i}var jd=an("start","end","cancel","interrupt"),kd=[],Ma=0,Ri=1,yr=2,_n=3,Ii=4,br=5,wn=6;function Un(e,n,r,i,s,a){var o=e.__transition;if(!o)e.__transition={};else if(r in o)return;Sd(e,r,{name:n,index:i,group:s,on:jd,tween:kd,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Ma})}function Wr(e,n){var r=De(e,n);if(r.state>Ma)throw new Error("too late; already scheduled");return r}function He(e,n){var r=De(e,n);if(r.state>_n)throw new Error("too late; already running");return r}function De(e,n){var r=e.__transition;if(!r||!(r=r[n]))throw new Error("transition not found");return r}function Sd(e,n,r){var i=e.__transition,s;i[n]=r,r.timer=Vr(a,0,r.time);function a(f){r.state=Ri,r.timer.restart(o,r.delay,r.time),r.delay<=f&&o(f-r.delay)}function o(f){var h,u,m,p;if(r.state!==Ri)return d();for(h in i)if(p=i[h],p.name===r.name){if(p.state===_n)return Pi(o);p.state===Ii?(p.state=wn,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete i[h]):+h<n&&(p.state=wn,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete i[h])}if(Pi(function(){r.state===_n&&(r.state=Ii,r.timer.restart(c,r.delay,r.time),c(f))}),r.state=yr,r.on.call("start",e,e.__data__,r.index,r.group),r.state===yr){for(r.state=_n,s=new Array(m=r.tween.length),h=0,u=-1;h<m;++h)(p=r.tween[h].value.call(e,e.__data__,r.index,r.group))&&(s[++u]=p);s.length=u+1}}function c(f){for(var h=f<r.duration?r.ease.call(null,f/r.duration):(r.timer.restart(d),r.state=br,1),u=-1,m=s.length;++u<m;)s[u].call(e,h);r.state===br&&(r.on.call("end",e,e.__data__,r.index,r.group),d())}function d(){r.state=wn,r.timer.stop(),delete i[n];for(var f in i)return;delete e.__transition}}function Nn(e,n){var r=e.__transition,i,s,a=!0,o;if(r){n=n==null?null:n+"";for(o in r){if((i=r[o]).name!==n){a=!1;continue}s=i.state>yr&&i.state<br,i.state=wn,i.timer.stop(),i.on.call(s?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete r[o]}a&&delete e.__transition}}function Cd(e){return this.each(function(){Nn(this,e)})}function Ad(e,n){var r,i;return function(){var s=He(this,e),a=s.tween;if(a!==r){i=r=a;for(var o=0,c=i.length;o<c;++o)if(i[o].name===n){i=i.slice(),i.splice(o,1);break}}s.tween=i}}function Td(e,n,r){var i,s;if(typeof r!="function")throw new Error;return function(){var a=He(this,e),o=a.tween;if(o!==i){s=(i=o).slice();for(var c={name:n,value:r},d=0,f=s.length;d<f;++d)if(s[d].name===n){s[d]=c;break}d===f&&s.push(c)}a.tween=s}}function Ed(e,n){var r=this._id;if(e+="",arguments.length<2){for(var i=De(this.node(),r).tween,s=0,a=i.length,o;s<a;++s)if((o=i[s]).name===e)return o.value;return null}return this.each((n==null?Ad:Td)(r,e,n))}function Kr(e,n,r){var i=e._id;return e.each(function(){var s=He(this,i);(s.value||(s.value={}))[n]=r.apply(this,arguments)}),function(s){return De(s,i).value[n]}}function Pa(e,n){var r;return(typeof n=="number"?st:n instanceof en?Ti:(r=en(n))?(n=r,Ti):dd)(e,n)}function Od(e){return function(){this.removeAttribute(e)}}function Md(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Pd(e,n,r){var i,s=r+"",a;return function(){var o=this.getAttribute(e);return o===s?null:o===i?a:a=n(i=o,r)}}function Rd(e,n,r){var i,s=r+"",a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===s?null:o===i?a:a=n(i=o,r)}}function Id(e,n,r){var i,s,a;return function(){var o,c=r(this),d;return c==null?void this.removeAttribute(e):(o=this.getAttribute(e),d=c+"",o===d?null:o===i&&d===s?a:(s=d,a=n(i=o,c)))}}function Dd(e,n,r){var i,s,a;return function(){var o,c=r(this),d;return c==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),d=c+"",o===d?null:o===i&&d===s?a:(s=d,a=n(i=o,c)))}}function zd(e,n){var r=Ln(e),i=r==="transform"?md:Pa;return this.attrTween(e,typeof n=="function"?(r.local?Dd:Id)(r,i,Kr(this,"attr."+e,n)):n==null?(r.local?Md:Od)(r):(r.local?Rd:Pd)(r,i,n))}function $d(e,n){return function(r){this.setAttribute(e,n.call(this,r))}}function Fd(e,n){return function(r){this.setAttributeNS(e.space,e.local,n.call(this,r))}}function Ld(e,n){var r,i;function s(){var a=n.apply(this,arguments);return a!==i&&(r=(i=a)&&Fd(e,a)),r}return s._value=n,s}function qd(e,n){var r,i;function s(){var a=n.apply(this,arguments);return a!==i&&(r=(i=a)&&$d(e,a)),r}return s._value=n,s}function Ud(e,n){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;var i=Ln(e);return this.tween(r,(i.local?Ld:qd)(i,n))}function Hd(e,n){return function(){Wr(this,e).delay=+n.apply(this,arguments)}}function Bd(e,n){return n=+n,function(){Wr(this,e).delay=n}}function Gd(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?Hd:Bd)(n,e)):De(this.node(),n).delay}function Vd(e,n){return function(){He(this,e).duration=+n.apply(this,arguments)}}function Wd(e,n){return n=+n,function(){He(this,e).duration=n}}function Kd(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?Vd:Wd)(n,e)):De(this.node(),n).duration}function Yd(e,n){if(typeof n!="function")throw new Error;return function(){He(this,e).ease=n}}function Jd(e){var n=this._id;return arguments.length?this.each(Yd(n,e)):De(this.node(),n).ease}function Xd(e,n){return function(){var r=n.apply(this,arguments);if(typeof r!="function")throw new Error;He(this,e).ease=r}}function Qd(e){if(typeof e!="function")throw new Error;return this.each(Xd(this._id,e))}function Zd(e){typeof e!="function"&&(e=fa(e));for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s)for(var a=n[s],o=a.length,c=i[s]=[],d,f=0;f<o;++f)(d=a[f])&&e.call(d,d.__data__,f,a)&&c.push(d);return new tt(i,this._parents,this._name,this._id)}function ef(e){if(e._id!==this._id)throw new Error;for(var n=this._groups,r=e._groups,i=n.length,s=r.length,a=Math.min(i,s),o=new Array(i),c=0;c<a;++c)for(var d=n[c],f=r[c],h=d.length,u=o[c]=new Array(h),m,p=0;p<h;++p)(m=d[p]||f[p])&&(u[p]=m);for(;c<i;++c)o[c]=n[c];return new tt(o,this._parents,this._name,this._id)}function tf(e){return(e+"").trim().split(/^|\s+/).every(function(n){var r=n.indexOf(".");return r>=0&&(n=n.slice(0,r)),!n||n==="start"})}function nf(e,n,r){var i,s,a=tf(n)?Wr:He;return function(){var o=a(this,e),c=o.on;c!==i&&(s=(i=c).copy()).on(n,r),o.on=s}}function rf(e,n){var r=this._id;return arguments.length<2?De(this.node(),r).on.on(e):this.each(nf(r,e,n))}function sf(e){return function(){var n=this.parentNode;for(var r in this.__transition)if(+r!==e)return;n&&n.removeChild(this)}}function af(){return this.on("end.remove",sf(this._id))}function of(e){var n=this._name,r=this._id;typeof e!="function"&&(e=Ur(e));for(var i=this._groups,s=i.length,a=new Array(s),o=0;o<s;++o)for(var c=i[o],d=c.length,f=a[o]=new Array(d),h,u,m=0;m<d;++m)(h=c[m])&&(u=e.call(h,h.__data__,m,c))&&("__data__"in h&&(u.__data__=h.__data__),f[m]=u,Un(f[m],n,r,m,f,De(h,r)));return new tt(a,this._parents,n,r)}function lf(e){var n=this._name,r=this._id;typeof e!="function"&&(e=da(e));for(var i=this._groups,s=i.length,a=[],o=[],c=0;c<s;++c)for(var d=i[c],f=d.length,h,u=0;u<f;++u)if(h=d[u]){for(var m=e.call(h,h.__data__,u,d),p,y=De(h,r),b=0,v=m.length;b<v;++b)(p=m[b])&&Un(p,n,r,b,m,y);a.push(m),o.push(h)}return new tt(a,o,n,r)}var cf=sn.prototype.constructor;function uf(){return new cf(this._groups,this._parents)}function df(e,n){var r,i,s;return function(){var a=wt(this,e),o=(this.style.removeProperty(e),wt(this,e));return a===o?null:a===r&&o===i?s:s=n(r=a,i=o)}}function Ra(e){return function(){this.style.removeProperty(e)}}function ff(e,n,r){var i,s=r+"",a;return function(){var o=wt(this,e);return o===s?null:o===i?a:a=n(i=o,r)}}function hf(e,n,r){var i,s,a;return function(){var o=wt(this,e),c=r(this),d=c+"";return c==null&&(d=c=(this.style.removeProperty(e),wt(this,e))),o===d?null:o===i&&d===s?a:(s=d,a=n(i=o,c))}}function pf(e,n){var r,i,s,a="style."+n,o="end."+a,c;return function(){var d=He(this,e),f=d.on,h=d.value[a]==null?c||(c=Ra(n)):void 0;(f!==r||s!==h)&&(i=(r=f).copy()).on(o,s=h),d.on=i}}function mf(e,n,r){var i=(e+="")=="transform"?pd:Pa;return n==null?this.styleTween(e,df(e,i)).on("end.style."+e,Ra(e)):typeof n=="function"?this.styleTween(e,hf(e,i,Kr(this,"style."+e,n))).each(pf(this._id,e)):this.styleTween(e,ff(e,i,n),r).on("end.style."+e,null)}function gf(e,n,r){return function(i){this.style.setProperty(e,n.call(this,i),r)}}function xf(e,n,r){var i,s;function a(){var o=n.apply(this,arguments);return o!==s&&(i=(s=o)&&gf(e,o,r)),i}return a._value=n,a}function yf(e,n,r){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(n==null)return this.tween(i,null);if(typeof n!="function")throw new Error;return this.tween(i,xf(e,n,r??""))}function bf(e){return function(){this.textContent=e}}function vf(e){return function(){var n=e(this);this.textContent=n??""}}function _f(e){return this.tween("text",typeof e=="function"?vf(Kr(this,"text",e)):bf(e==null?"":e+""))}function wf(e){return function(n){this.textContent=e.call(this,n)}}function Nf(e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&wf(s)),n}return i._value=e,i}function jf(e){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,Nf(e))}function kf(){for(var e=this._name,n=this._id,r=Ia(),i=this._groups,s=i.length,a=0;a<s;++a)for(var o=i[a],c=o.length,d,f=0;f<c;++f)if(d=o[f]){var h=De(d,n);Un(d,e,r,f,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new tt(i,this._parents,e,r)}function Sf(){var e,n,r=this,i=r._id,s=r.size();return new Promise(function(a,o){var c={value:o},d={value:function(){--s===0&&a()}};r.each(function(){var f=He(this,i),h=f.on;h!==e&&(n=(e=h).copy(),n._.cancel.push(c),n._.interrupt.push(c),n._.end.push(d)),f.on=n}),s===0&&a()})}var Cf=0;function tt(e,n,r,i){this._groups=e,this._parents=n,this._name=r,this._id=i}function Ia(){return++Cf}var Ge=sn.prototype;tt.prototype={constructor:tt,select:of,selectAll:lf,selectChild:Ge.selectChild,selectChildren:Ge.selectChildren,filter:Zd,merge:ef,selection:uf,transition:kf,call:Ge.call,nodes:Ge.nodes,node:Ge.node,size:Ge.size,empty:Ge.empty,each:Ge.each,on:rf,attr:zd,attrTween:Ud,style:mf,styleTween:yf,text:_f,textTween:jf,remove:af,tween:Ed,delay:Gd,duration:Kd,ease:Jd,easeVarying:Qd,end:Sf,[Symbol.iterator]:Ge[Symbol.iterator]};function Af(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Tf={time:null,delay:0,duration:250,ease:Af};function Ef(e,n){for(var r;!(r=e.__transition)||!(r=r[n]);)if(!(e=e.parentNode))throw new Error(`transition ${n} not found`);return r}function Of(e){var n,r;e instanceof tt?(n=e._id,e=e._name):(n=Ia(),(r=Tf).time=Gr(),e=e==null?null:e+"");for(var i=this._groups,s=i.length,a=0;a<s;++a)for(var o=i[a],c=o.length,d,f=0;f<c;++f)(d=o[f])&&Un(d,e,n,f,o,r||Ef(d,n));return new tt(i,this._parents,e,n)}sn.prototype.interrupt=Cd;sn.prototype.transition=Of;const mn=e=>()=>e;function Mf(e,{sourceEvent:n,target:r,transform:i,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:s}})}function Qe(e,n,r){this.k=e,this.x=n,this.y=r}Qe.prototype={constructor:Qe,scale:function(e){return e===1?this:new Qe(this.k*e,this.x,this.y)},translate:function(e,n){return e===0&n===0?this:new Qe(this.k,this.x+this.k*e,this.y+this.k*n)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Yr=new Qe(1,0,0);ze.prototype=Qe.prototype;function ze(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Yr;return e.__zoom}function Zn(e){e.stopImmediatePropagation()}function At(e){e.preventDefault(),e.stopImmediatePropagation()}function Pf(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Rf(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Di(){return this.__zoom||Yr}function If(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Df(){return navigator.maxTouchPoints||"ontouchstart"in this}function zf(e,n,r){var i=e.invertX(n[0][0])-r[0][0],s=e.invertX(n[1][0])-r[1][0],a=e.invertY(n[0][1])-r[0][1],o=e.invertY(n[1][1])-r[1][1];return e.translate(s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function $f(){var e=Pf,n=Rf,r=zf,i=If,s=Df,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],c=250,d=bd,f=an("start","zoom","end"),h,u,m,p=500,y=150,b=0,v=10;function g(T){T.property("__zoom",Di).on("wheel.zoom",x,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",j).filter(s).on("touchstart.zoom",M).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",F).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(T,D,k,I){var z=T.selection?T.selection():T;z.property("__zoom",Di),T!==z?_(T,D,k,I):z.interrupt().each(function(){E(this,arguments).event(I).start().zoom(null,typeof D=="function"?D.apply(this,arguments):D).end()})},g.scaleBy=function(T,D,k,I){g.scaleTo(T,function(){var z=this.__zoom.k,L=typeof D=="function"?D.apply(this,arguments):D;return z*L},k,I)},g.scaleTo=function(T,D,k,I){g.transform(T,function(){var z=n.apply(this,arguments),L=this.__zoom,H=k==null?w(z):typeof k=="function"?k.apply(this,arguments):k,K=L.invert(H),Y=typeof D=="function"?D.apply(this,arguments):D;return r(S(N(L,Y),H,K),z,o)},k,I)},g.translateBy=function(T,D,k,I){g.transform(T,function(){return r(this.__zoom.translate(typeof D=="function"?D.apply(this,arguments):D,typeof k=="function"?k.apply(this,arguments):k),n.apply(this,arguments),o)},null,I)},g.translateTo=function(T,D,k,I,z){g.transform(T,function(){var L=n.apply(this,arguments),H=this.__zoom,K=I==null?w(L):typeof I=="function"?I.apply(this,arguments):I;return r(Yr.translate(K[0],K[1]).scale(H.k).translate(typeof D=="function"?-D.apply(this,arguments):-D,typeof k=="function"?-k.apply(this,arguments):-k),L,o)},I,z)};function N(T,D){return D=Math.max(a[0],Math.min(a[1],D)),D===T.k?T:new Qe(D,T.x,T.y)}function S(T,D,k){var I=D[0]-k[0]*T.k,z=D[1]-k[1]*T.k;return I===T.x&&z===T.y?T:new Qe(T.k,I,z)}function w(T){return[(+T[0][0]+ +T[1][0])/2,(+T[0][1]+ +T[1][1])/2]}function _(T,D,k,I){T.on("start.zoom",function(){E(this,arguments).event(I).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(I).end()}).tween("zoom",function(){var z=this,L=arguments,H=E(z,L).event(I),K=n.apply(z,L),Y=k==null?w(K):typeof k=="function"?k.apply(z,L):k,$=Math.max(K[1][0]-K[0][0],K[1][1]-K[0][1]),B=z.__zoom,X=typeof D=="function"?D.apply(z,L):D,J=d(B.invert(Y).concat($/B.k),X.invert(Y).concat($/X.k));return function(le){if(le===1)le=X;else{var xe=J(le),ke=$/xe[2];le=new Qe(ke,Y[0]-xe[0]*ke,Y[1]-xe[1]*ke)}H.zoom(null,le)}})}function E(T,D,k){return!k&&T.__zooming||new O(T,D)}function O(T,D){this.that=T,this.args=D,this.active=0,this.sourceEvent=null,this.extent=n.apply(T,D),this.taps=0}O.prototype={event:function(T){return T&&(this.sourceEvent=T),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(T,D){return this.mouse&&T!=="mouse"&&(this.mouse[1]=D.invert(this.mouse[0])),this.touch0&&T!=="touch"&&(this.touch0[1]=D.invert(this.touch0[0])),this.touch1&&T!=="touch"&&(this.touch1[1]=D.invert(this.touch1[0])),this.that.__zoom=D,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(T){var D=Ae(this.that).datum();f.call(T,this.that,new Mf(T,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:f}),D)}};function x(T,...D){if(!e.apply(this,arguments))return;var k=E(this,D).event(T),I=this.__zoom,z=Math.max(a[0],Math.min(a[1],I.k*Math.pow(2,i.apply(this,arguments)))),L=$e(T);if(k.wheel)(k.mouse[0][0]!==L[0]||k.mouse[0][1]!==L[1])&&(k.mouse[1]=I.invert(k.mouse[0]=L)),clearTimeout(k.wheel);else{if(I.k===z)return;k.mouse=[L,I.invert(L)],Nn(this),k.start()}At(T),k.wheel=setTimeout(H,y),k.zoom("mouse",r(S(N(I,z),k.mouse[0],k.mouse[1]),k.extent,o));function H(){k.wheel=null,k.end()}}function A(T,...D){if(m||!e.apply(this,arguments))return;var k=T.currentTarget,I=E(this,D,!0).event(T),z=Ae(T.view).on("mousemove.zoom",Y,!0).on("mouseup.zoom",$,!0),L=$e(T,k),H=T.clientX,K=T.clientY;wa(T.view),Zn(T),I.mouse=[L,this.__zoom.invert(L)],Nn(this),I.start();function Y(B){if(At(B),!I.moved){var X=B.clientX-H,J=B.clientY-K;I.moved=X*X+J*J>b}I.event(B).zoom("mouse",r(S(I.that.__zoom,I.mouse[0]=$e(B,k),I.mouse[1]),I.extent,o))}function $(B){z.on("mousemove.zoom mouseup.zoom",null),Na(B.view,I.moved),At(B),I.event(B).end()}}function j(T,...D){if(e.apply(this,arguments)){var k=this.__zoom,I=$e(T.changedTouches?T.changedTouches[0]:T,this),z=k.invert(I),L=k.k*(T.shiftKey?.5:2),H=r(S(N(k,L),I,z),n.apply(this,D),o);At(T),c>0?Ae(this).transition().duration(c).call(_,H,I,T):Ae(this).call(g.transform,H,I,T)}}function M(T,...D){if(e.apply(this,arguments)){var k=T.touches,I=k.length,z=E(this,D,T.changedTouches.length===I).event(T),L,H,K,Y;for(Zn(T),H=0;H<I;++H)K=k[H],Y=$e(K,this),Y=[Y,this.__zoom.invert(Y),K.identifier],z.touch0?!z.touch1&&z.touch0[2]!==Y[2]&&(z.touch1=Y,z.taps=0):(z.touch0=Y,L=!0,z.taps=1+!!h);h&&(h=clearTimeout(h)),L&&(z.taps<2&&(u=Y[0],h=setTimeout(function(){h=null},p)),Nn(this),z.start())}}function R(T,...D){if(this.__zooming){var k=E(this,D).event(T),I=T.changedTouches,z=I.length,L,H,K,Y;for(At(T),L=0;L<z;++L)H=I[L],K=$e(H,this),k.touch0&&k.touch0[2]===H.identifier?k.touch0[0]=K:k.touch1&&k.touch1[2]===H.identifier&&(k.touch1[0]=K);if(H=k.that.__zoom,k.touch1){var $=k.touch0[0],B=k.touch0[1],X=k.touch1[0],J=k.touch1[1],le=(le=X[0]-$[0])*le+(le=X[1]-$[1])*le,xe=(xe=J[0]-B[0])*xe+(xe=J[1]-B[1])*xe;H=N(H,Math.sqrt(le/xe)),K=[($[0]+X[0])/2,($[1]+X[1])/2],Y=[(B[0]+J[0])/2,(B[1]+J[1])/2]}else if(k.touch0)K=k.touch0[0],Y=k.touch0[1];else return;k.zoom("touch",r(S(H,K,Y),k.extent,o))}}function F(T,...D){if(this.__zooming){var k=E(this,D).event(T),I=T.changedTouches,z=I.length,L,H;for(Zn(T),m&&clearTimeout(m),m=setTimeout(function(){m=null},p),L=0;L<z;++L)H=I[L],k.touch0&&k.touch0[2]===H.identifier?delete k.touch0:k.touch1&&k.touch1[2]===H.identifier&&delete k.touch1;if(k.touch1&&!k.touch0&&(k.touch0=k.touch1,delete k.touch1),k.touch0)k.touch0[1]=this.__zoom.invert(k.touch0[0]);else if(k.end(),k.taps===2&&(H=$e(H,this),Math.hypot(u[0]-H[0],u[1]-H[1])<v)){var K=Ae(this).on("dblclick.zoom");K&&K.apply(this,arguments)}}}return g.wheelDelta=function(T){return arguments.length?(i=typeof T=="function"?T:mn(+T),g):i},g.filter=function(T){return arguments.length?(e=typeof T=="function"?T:mn(!!T),g):e},g.touchable=function(T){return arguments.length?(s=typeof T=="function"?T:mn(!!T),g):s},g.extent=function(T){return arguments.length?(n=typeof T=="function"?T:mn([[+T[0][0],+T[0][1]],[+T[1][0],+T[1][1]]]),g):n},g.scaleExtent=function(T){return arguments.length?(a[0]=+T[0],a[1]=+T[1],g):[a[0],a[1]]},g.translateExtent=function(T){return arguments.length?(o[0][0]=+T[0][0],o[1][0]=+T[1][0],o[0][1]=+T[0][1],o[1][1]=+T[1][1],g):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},g.constrain=function(T){return arguments.length?(r=T,g):r},g.duration=function(T){return arguments.length?(c=+T,g):c},g.interpolate=function(T){return arguments.length?(d=T,g):d},g.on=function(){var T=f.on.apply(f,arguments);return T===f?g:T},g.clickDistance=function(T){return arguments.length?(b=(T=+T)*T,g):Math.sqrt(b)},g.tapDistance=function(T){return arguments.length?(v=+T,g):v},g}class zi extends Map{constructor(n,r=qf){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),n!=null)for(const[i,s]of n)this.set(i,s)}get(n){return super.get($i(this,n))}has(n){return super.has($i(this,n))}set(n,r){return super.set(Ff(this,n),r)}delete(n){return super.delete(Lf(this,n))}}function $i({_intern:e,_key:n},r){const i=n(r);return e.has(i)?e.get(i):r}function Ff({_intern:e,_key:n},r){const i=n(r);return e.has(i)?e.get(i):(e.set(i,r),r)}function Lf({_intern:e,_key:n},r){const i=n(r);return e.has(i)&&(r=e.get(i),e.delete(i)),r}function qf(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Fi(e,n){let r;if(n===void 0)for(const i of e)i!=null&&(r<i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let s of e)(s=n(s,++i,e))!=null&&(r<s||r===void 0&&s>=s)&&(r=s)}return r}function Li(e,n){let r;if(n===void 0)for(const i of e)i!=null&&(r>i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let s of e)(s=n(s,++i,e))!=null&&(r>s||r===void 0&&s>=s)&&(r=s)}return r}function Uf(e,n){let r=0;for(let i of e)(i=+i)&&(r+=i);return r}var Hf=typeof global=="object"&&global&&global.Object===Object&&global,Bf=typeof self=="object"&&self&&self.Object===Object&&self,Da=Hf||Bf||Function("return this")(),Mn=Da.Symbol,za=Object.prototype,Gf=za.hasOwnProperty,Vf=za.toString,Tt=Mn?Mn.toStringTag:void 0;function Wf(e){var n=Gf.call(e,Tt),r=e[Tt];try{e[Tt]=void 0;var i=!0}catch{}var s=Vf.call(e);return i&&(n?e[Tt]=r:delete e[Tt]),s}var Kf=Object.prototype,Yf=Kf.toString;function Jf(e){return Yf.call(e)}var Xf="[object Null]",Qf="[object Undefined]",qi=Mn?Mn.toStringTag:void 0;function Zf(e){return e==null?e===void 0?Qf:Xf:qi&&qi in Object(e)?Wf(e):Jf(e)}function eh(e){return e!=null&&typeof e=="object"}var th="[object Symbol]";function nh(e){return typeof e=="symbol"||eh(e)&&Zf(e)==th}var rh=/\s/;function ih(e){for(var n=e.length;n--&&rh.test(e.charAt(n)););return n}var sh=/^\s+/;function ah(e){return e&&e.slice(0,ih(e)+1).replace(sh,"")}function Pn(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}var Ui=NaN,oh=/^[-+]0x[0-9a-f]+$/i,lh=/^0b[01]+$/i,ch=/^0o[0-7]+$/i,uh=parseInt;function Hi(e){if(typeof e=="number")return e;if(nh(e))return Ui;if(Pn(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=Pn(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=ah(e);var r=lh.test(e);return r||ch.test(e)?uh(e.slice(2),r?2:8):oh.test(e)?Ui:+e}var er=function(){return Da.Date.now()},dh="Expected a function",fh=Math.max,hh=Math.min;function $a(e,n,r){var i,s,a,o,c,d,f=0,h=!1,u=!1,m=!0;if(typeof e!="function")throw new TypeError(dh);n=Hi(n)||0,Pn(r)&&(h=!!r.leading,u="maxWait"in r,a=u?fh(Hi(r.maxWait)||0,n):a,m="trailing"in r?!!r.trailing:m);function p(E){var O=i,x=s;return i=s=void 0,f=E,o=e.apply(x,O),o}function y(E){return f=E,c=setTimeout(g,n),h?p(E):o}function b(E){var O=E-d,x=E-f,A=n-O;return u?hh(A,a-x):A}function v(E){var O=E-d,x=E-f;return d===void 0||O>=n||O<0||u&&x>=a}function g(){var E=er();if(v(E))return N(E);c=setTimeout(g,b(E))}function N(E){return c=void 0,m&&i?p(E):(i=s=void 0,o)}function S(){c!==void 0&&clearTimeout(c),f=0,i=d=s=c=void 0}function w(){return c===void 0?o:N(er())}function _(){var E=er(),O=v(E);if(i=arguments,s=this,d=E,O){if(c===void 0)return y(d);if(u)return clearTimeout(c),c=setTimeout(g,n),p(d)}return c===void 0&&(c=setTimeout(g,n)),o}return _.cancel=S,_.flush=w,_}var ph="Expected a function";function mh(e,n,r){var i=!0,s=!0;if(typeof e!="function")throw new TypeError(ph);return Pn(r)&&(i="leading"in r?!!r.leading:i,s="trailing"in r?!!r.trailing:s),$a(e,n,{leading:i,maxWait:n,trailing:s})}var pt=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return e},Out:function(e){return e},InOut:function(e){return e}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return .5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return e===0?0:e===1?1:-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){return e===0?0:e===1?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(e){var n=1.70158;return e===1?1:e*e*((n+1)*e-n)},Out:function(e){var n=1.70158;return e===0?0:--e*e*((n+1)*e+n)+1},InOut:function(e){var n=2.5949095;return(e*=2)<1?.5*(e*e*((n+1)*e-n)):.5*((e-=2)*e*((n+1)*e+n)+2)}}),Bounce:Object.freeze({In:function(e){return 1-pt.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?pt.Bounce.In(e*2)*.5:pt.Bounce.Out(e*2-1)*.5+.5}}),generatePow:function(e){return e===void 0&&(e=4),e=e<Number.EPSILON?Number.EPSILON:e,e=e>1e4?1e4:e,{In:function(n){return Math.pow(n,e)},Out:function(n){return 1-Math.pow(1-n,e)},InOut:function(n){return n<.5?Math.pow(n*2,e)/2:(1-Math.pow(2-n*2,e))/2+.5}}}}),$t=function(){return performance.now()},Fa=(function(){function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,n)}return e.prototype.getAll=function(){var n=this;return Object.keys(this._tweens).map(function(r){return n._tweens[r]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];for(var s=0,a=r;s<a.length;s++){var o=a[s];(n=o._group)===null||n===void 0||n.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},e.prototype.remove=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var i=0,s=n;i<s.length;i++){var a=s[i];a._group=void 0,delete this._tweens[a.getId()],delete this._tweensAddedDuringUpdate[a.getId()]}},e.prototype.allStopped=function(){return this.getAll().every(function(n){return!n.isPlaying()})},e.prototype.update=function(n,r){n===void 0&&(n=$t()),r===void 0&&(r=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<i.length;s++){var a=this._tweens[i[s]],o=!r;a&&a.update(n,o)===!1&&!r&&this.remove(a)}i=Object.keys(this._tweensAddedDuringUpdate)}},e})(),vr={Linear:function(e,n){var r=e.length-1,i=r*n,s=Math.floor(i),a=vr.Utils.Linear;return n<0?a(e[0],e[1],i):n>1?a(e[r],e[r-1],r-i):a(e[s],e[s+1>r?r:s+1],i-s)},Utils:{Linear:function(e,n,r){return(n-e)*r+e}}},La=(function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e})(),_r=new Fa,Bi=(function(){function e(n,r){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=pt.Linear.None,this._interpolationFunction=vr.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=La.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=n,typeof r=="object"?(this._group=r,r.add(this)):r===!0&&(this._group=_r,_r.add(this))}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(n,r){if(r===void 0&&(r=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=n,this._propertiesAreSetUp=!1,this._duration=r<0?0:r,this},e.prototype.duration=function(n){return n===void 0&&(n=1e3),this._duration=n<0?0:n,this},e.prototype.dynamic=function(n){return n===void 0&&(n=!1),this._isDynamic=n,this},e.prototype.start=function(n,r){if(n===void 0&&(n=$t()),r===void 0&&(r=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=n,this._startTime+=this._delayTime,!this._propertiesAreSetUp||r){if(this._propertiesAreSetUp=!0,!this._isDynamic){var s={};for(var a in this._valuesEnd)s[a]=this._valuesEnd[a];this._valuesEnd=s}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,r)}return this},e.prototype.startFromCurrentValues=function(n){return this.start(n,!0)},e.prototype._setupProperties=function(n,r,i,s,a){for(var o in i){var c=n[o],d=Array.isArray(c),f=d?"array":typeof c,h=!d&&Array.isArray(i[o]);if(!(f==="undefined"||f==="function")){if(h){var u=i[o];if(u.length===0)continue;for(var m=[c],p=0,y=u.length;p<y;p+=1){var b=this._handleRelativeValue(c,u[p]);if(isNaN(b)){h=!1,console.warn("Found invalid interpolation list. Skipping.");break}m.push(b)}h&&(i[o]=m)}if((f==="object"||d)&&c&&!h){r[o]=d?[]:{};var v=c;for(var g in v)r[o][g]=v[g];s[o]=d?[]:{};var u=i[o];if(!this._isDynamic){var N={};for(var g in u)N[g]=u[g];i[o]=u=N}this._setupProperties(v,r[o],u,s[o],a)}else(typeof r[o]>"u"||a)&&(r[o]=c),d||(r[o]*=1),h?s[o]=i[o].slice().reverse():s[o]=r[o]||0}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},e.prototype.pause=function(n){return n===void 0&&(n=$t()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=n,this)},e.prototype.resume=function(n){return n===void 0&&(n=$t()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=n-this._pauseStart,this._pauseStart=0,this)},e.prototype.stopChainedTweens=function(){for(var n=0,r=this._chainedTweens.length;n<r;n++)this._chainedTweens[n].stop();return this},e.prototype.group=function(n){return n?(n.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},e.prototype.remove=function(){var n;return(n=this._group)===null||n===void 0||n.remove(this),this},e.prototype.delay=function(n){return n===void 0&&(n=0),this._delayTime=n,this},e.prototype.repeat=function(n){return n===void 0&&(n=0),this._initialRepeat=n,this._repeat=n,this},e.prototype.repeatDelay=function(n){return this._repeatDelayTime=n,this},e.prototype.yoyo=function(n){return n===void 0&&(n=!1),this._yoyo=n,this},e.prototype.easing=function(n){return n===void 0&&(n=pt.Linear.None),this._easingFunction=n,this},e.prototype.interpolation=function(n){return n===void 0&&(n=vr.Linear),this._interpolationFunction=n,this},e.prototype.chain=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return this._chainedTweens=n,this},e.prototype.onStart=function(n){return this._onStartCallback=n,this},e.prototype.onEveryStart=function(n){return this._onEveryStartCallback=n,this},e.prototype.onUpdate=function(n){return this._onUpdateCallback=n,this},e.prototype.onRepeat=function(n){return this._onRepeatCallback=n,this},e.prototype.onComplete=function(n){return this._onCompleteCallback=n,this},e.prototype.onStop=function(n){return this._onStopCallback=n,this},e.prototype.update=function(n,r){var i=this,s;if(n===void 0&&(n=$t()),r===void 0&&(r=e.autoStartOnUpdate),this._isPaused)return!0;var a;if(!this._goToEnd&&!this._isPlaying)if(r)this.start(n,!0);else return!1;if(this._goToEnd=!1,n<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=n-this._startTime,c=this._duration+((s=this._repeatDelayTime)!==null&&s!==void 0?s:this._delayTime),d=this._duration+this._repeat*c,f=function(){if(i._duration===0||o>d)return 1;var b=Math.trunc(o/c),v=o-b*c,g=Math.min(v/i._duration,1);return g===0&&o===i._duration?1:g},h=f(),u=this._easingFunction(h);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,u),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),this._duration===0||o>=this._duration)if(this._repeat>0){var m=Math.min(Math.trunc((o-this._duration)/c)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=m);for(a in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[a]=="string"&&(this._valuesStartRepeat[a]=this._valuesStartRepeat[a]+parseFloat(this._valuesEnd[a])),this._yoyo&&this._swapEndStartRepeatValues(a),this._valuesStart[a]=this._valuesStartRepeat[a];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=c*m,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var p=0,y=this._chainedTweens.length;p<y;p++)this._chainedTweens[p].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(n,r,i,s){for(var a in i)if(r[a]!==void 0){var o=r[a]||0,c=i[a],d=Array.isArray(n[a]),f=Array.isArray(c),h=!d&&f;h?n[a]=this._interpolationFunction(c,s):typeof c=="object"&&c?this._updateProperties(n[a],o,c,s):(c=this._handleRelativeValue(o,c),typeof c=="number"&&(n[a]=o+(c-o)*s))}},e.prototype._handleRelativeValue=function(n,r){return typeof r!="string"?r:r.charAt(0)==="+"||r.charAt(0)==="-"?n+parseFloat(r):parseFloat(r)},e.prototype._swapEndStartRepeatValues=function(n){var r=this._valuesStartRepeat[n],i=this._valuesEnd[n];typeof i=="string"?this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(i):this._valuesStartRepeat[n]=this._valuesEnd[n],this._valuesEnd[n]=r},e.autoStartOnUpdate=!1,e})();La.nextId;var qe=_r;qe.getAll.bind(qe);qe.removeAll.bind(qe);qe.add.bind(qe);qe.remove.bind(qe);qe.update.bind(qe);function Gi(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function gh(e){if(Array.isArray(e))return e}function xh(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function yh(e,n,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}function bh(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,s,a,o,c=[],d=!0,f=!1;try{if(a=(r=r.call(e)).next,n!==0)for(;!(d=(i=a.call(r)).done)&&(c.push(i.value),c.length!==n);d=!0);}catch(h){f=!0,s=h}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(f)throw s}}return c}}function vh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _h(e,n){return gh(e)||bh(e,n)||wh(e,n)||vh()}function wh(e,n){if(e){if(typeof e=="string")return Gi(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gi(e,n):void 0}}var Nh=yh(function e(n,r){var i=r.default,s=i===void 0?null:i,a=r.triggerUpdate,o=a===void 0?!0:a,c=r.onChange,d=c===void 0?function(f,h){}:c;xh(this,e),this.name=n,this.defaultVal=s,this.triggerUpdate=o,this.onChange=d});function Jr(e){var n=e.stateInit,r=n===void 0?function(){return{}}:n,i=e.props,s=i===void 0?{}:i,a=e.methods,o=a===void 0?{}:a,c=e.aliases,d=c===void 0?{}:c,f=e.init,h=f===void 0?function(){}:f,u=e.update,m=u===void 0?function(){}:u,p=Object.keys(s).map(function(y){return new Nh(y,s[y])});return function y(){for(var b=arguments.length,v=new Array(b),g=0;g<b;g++)v[g]=arguments[g];var N=!!(this instanceof y&&this.constructor),S=N?v.shift():void 0,w=v[0],_=w===void 0?{}:w,E=Object.assign({},r instanceof Function?r(_):r,{initialised:!1}),O={};function x(M){return A(M,_),j(),x}var A=function(R,F){h.call(x,R,E,F),E.initialised=!0},j=$a(function(){E.initialised&&(m.call(x,E,O),O={})},1);return p.forEach(function(M){x[M.name]=R(M);function R(F){var T=F.name,D=F.triggerUpdate,k=D===void 0?!1:D,I=F.onChange,z=I===void 0?function(K,Y){}:I,L=F.defaultVal,H=L===void 0?null:L;return function(K){var Y=E[T];if(!arguments.length)return Y;var $=K===void 0?H:K;return E[T]=$,z.call(x,$,E,Y),!O.hasOwnProperty(T)&&(O[T]=Y),k&&j(),x}}}),Object.keys(o).forEach(function(M){x[M]=function(){for(var R,F=arguments.length,T=new Array(F),D=0;D<F;D++)T[D]=arguments[D];return(R=o[M]).call.apply(R,[x,E].concat(T))}}),Object.entries(d).forEach(function(M){var R=_h(M,2),F=R[0],T=R[1];return x[F]=x[T]}),x.resetProps=function(){return p.forEach(function(M){x[M.name](M.defaultVal)}),x},x.resetProps(),E._rerender=j,N&&S&&x(S),x}}var ee=(function(e){return typeof e=="function"?e:typeof e=="string"?function(n){return n[e]}:function(n){return e}});function Rn(e){"@babel/helpers - typeof";return Rn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Rn(e)}var jh=/^\s+/,kh=/\s+$/;function G(e,n){if(e=e||"",n=n||{},e instanceof G)return e;if(!(this instanceof G))return new G(e,n);var r=Sh(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=n.format||r.format,this._gradientType=n.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}G.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},getLuminance:function(){var n=this.toRgb(),r,i,s,a,o,c;return r=n.r/255,i=n.g/255,s=n.b/255,r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),s<=.03928?c=s/12.92:c=Math.pow((s+.055)/1.055,2.4),.2126*a+.7152*o+.0722*c},setAlpha:function(n){return this._a=qa(n),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var n=Wi(this._r,this._g,this._b);return{h:n.h*360,s:n.s,v:n.v,a:this._a}},toHsvString:function(){var n=Wi(this._r,this._g,this._b),r=Math.round(n.h*360),i=Math.round(n.s*100),s=Math.round(n.v*100);return this._a==1?"hsv("+r+", "+i+"%, "+s+"%)":"hsva("+r+", "+i+"%, "+s+"%, "+this._roundA+")"},toHsl:function(){var n=Vi(this._r,this._g,this._b);return{h:n.h*360,s:n.s,l:n.l,a:this._a}},toHslString:function(){var n=Vi(this._r,this._g,this._b),r=Math.round(n.h*360),i=Math.round(n.s*100),s=Math.round(n.l*100);return this._a==1?"hsl("+r+", "+i+"%, "+s+"%)":"hsla("+r+", "+i+"%, "+s+"%, "+this._roundA+")"},toHex:function(n){return Ki(this._r,this._g,this._b,n)},toHexString:function(n){return"#"+this.toHex(n)},toHex8:function(n){return Eh(this._r,this._g,this._b,this._a,n)},toHex8String:function(n){return"#"+this.toHex8(n)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ae(this._r,255)*100)+"%",g:Math.round(ae(this._g,255)*100)+"%",b:Math.round(ae(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ae(this._r,255)*100)+"%, "+Math.round(ae(this._g,255)*100)+"%, "+Math.round(ae(this._b,255)*100)+"%)":"rgba("+Math.round(ae(this._r,255)*100)+"%, "+Math.round(ae(this._g,255)*100)+"%, "+Math.round(ae(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:Uh[Ki(this._r,this._g,this._b,!0)]||!1},toFilter:function(n){var r="#"+Yi(this._r,this._g,this._b,this._a),i=r,s=this._gradientType?"GradientType = 1, ":"";if(n){var a=G(n);i="#"+Yi(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+s+"startColorstr="+r+",endColorstr="+i+")"},toString:function(n){var r=!!n;n=n||this._format;var i=!1,s=this._a<1&&this._a>=0,a=!r&&s&&(n==="hex"||n==="hex6"||n==="hex3"||n==="hex4"||n==="hex8"||n==="name");return a?n==="name"&&this._a===0?this.toName():this.toRgbString():(n==="rgb"&&(i=this.toRgbString()),n==="prgb"&&(i=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(i=this.toHexString()),n==="hex3"&&(i=this.toHexString(!0)),n==="hex4"&&(i=this.toHex8String(!0)),n==="hex8"&&(i=this.toHex8String()),n==="name"&&(i=this.toName()),n==="hsl"&&(i=this.toHslString()),n==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return G(this.toString())},_applyModification:function(n,r){var i=n.apply(null,[this].concat([].slice.call(r)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(Rh,arguments)},brighten:function(){return this._applyModification(Ih,arguments)},darken:function(){return this._applyModification(Dh,arguments)},desaturate:function(){return this._applyModification(Oh,arguments)},saturate:function(){return this._applyModification(Mh,arguments)},greyscale:function(){return this._applyModification(Ph,arguments)},spin:function(){return this._applyModification(zh,arguments)},_applyCombination:function(n,r){return n.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(Lh,arguments)},complement:function(){return this._applyCombination($h,arguments)},monochromatic:function(){return this._applyCombination(qh,arguments)},splitcomplement:function(){return this._applyCombination(Fh,arguments)},triad:function(){return this._applyCombination(Ji,[3])},tetrad:function(){return this._applyCombination(Ji,[4])}};G.fromRatio=function(e,n){if(Rn(e)=="object"){var r={};for(var i in e)e.hasOwnProperty(i)&&(i==="a"?r[i]=e[i]:r[i]=Ft(e[i]));e=r}return G(e,n)};function Sh(e){var n={r:0,g:0,b:0},r=1,i=null,s=null,a=null,o=!1,c=!1;return typeof e=="string"&&(e=Vh(e)),Rn(e)=="object"&&(Ve(e.r)&&Ve(e.g)&&Ve(e.b)?(n=Ch(e.r,e.g,e.b),o=!0,c=String(e.r).substr(-1)==="%"?"prgb":"rgb"):Ve(e.h)&&Ve(e.s)&&Ve(e.v)?(i=Ft(e.s),s=Ft(e.v),n=Th(e.h,i,s),o=!0,c="hsv"):Ve(e.h)&&Ve(e.s)&&Ve(e.l)&&(i=Ft(e.s),a=Ft(e.l),n=Ah(e.h,i,a),o=!0,c="hsl"),e.hasOwnProperty("a")&&(r=e.a)),r=qa(r),{ok:o,format:e.format||c,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:r}}function Ch(e,n,r){return{r:ae(e,255)*255,g:ae(n,255)*255,b:ae(r,255)*255}}function Vi(e,n,r){e=ae(e,255),n=ae(n,255),r=ae(r,255);var i=Math.max(e,n,r),s=Math.min(e,n,r),a,o,c=(i+s)/2;if(i==s)a=o=0;else{var d=i-s;switch(o=c>.5?d/(2-i-s):d/(i+s),i){case e:a=(n-r)/d+(n<r?6:0);break;case n:a=(r-e)/d+2;break;case r:a=(e-n)/d+4;break}a/=6}return{h:a,s:o,l:c}}function Ah(e,n,r){var i,s,a;e=ae(e,360),n=ae(n,100),r=ae(r,100);function o(f,h,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?f+(h-f)*6*u:u<1/2?h:u<2/3?f+(h-f)*(2/3-u)*6:f}if(n===0)i=s=a=r;else{var c=r<.5?r*(1+n):r+n-r*n,d=2*r-c;i=o(d,c,e+1/3),s=o(d,c,e),a=o(d,c,e-1/3)}return{r:i*255,g:s*255,b:a*255}}function Wi(e,n,r){e=ae(e,255),n=ae(n,255),r=ae(r,255);var i=Math.max(e,n,r),s=Math.min(e,n,r),a,o,c=i,d=i-s;if(o=i===0?0:d/i,i==s)a=0;else{switch(i){case e:a=(n-r)/d+(n<r?6:0);break;case n:a=(r-e)/d+2;break;case r:a=(e-n)/d+4;break}a/=6}return{h:a,s:o,v:c}}function Th(e,n,r){e=ae(e,360)*6,n=ae(n,100),r=ae(r,100);var i=Math.floor(e),s=e-i,a=r*(1-n),o=r*(1-s*n),c=r*(1-(1-s)*n),d=i%6,f=[r,o,a,a,c,r][d],h=[c,r,r,o,a,a][d],u=[a,a,c,r,r,o][d];return{r:f*255,g:h*255,b:u*255}}function Ki(e,n,r,i){var s=[Re(Math.round(e).toString(16)),Re(Math.round(n).toString(16)),Re(Math.round(r).toString(16))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function Eh(e,n,r,i,s){var a=[Re(Math.round(e).toString(16)),Re(Math.round(n).toString(16)),Re(Math.round(r).toString(16)),Re(Ua(i))];return s&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function Yi(e,n,r,i){var s=[Re(Ua(i)),Re(Math.round(e).toString(16)),Re(Math.round(n).toString(16)),Re(Math.round(r).toString(16))];return s.join("")}G.equals=function(e,n){return!e||!n?!1:G(e).toRgbString()==G(n).toRgbString()};G.random=function(){return G.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function Oh(e,n){n=n===0?0:n||10;var r=G(e).toHsl();return r.s-=n/100,r.s=Hn(r.s),G(r)}function Mh(e,n){n=n===0?0:n||10;var r=G(e).toHsl();return r.s+=n/100,r.s=Hn(r.s),G(r)}function Ph(e){return G(e).desaturate(100)}function Rh(e,n){n=n===0?0:n||10;var r=G(e).toHsl();return r.l+=n/100,r.l=Hn(r.l),G(r)}function Ih(e,n){n=n===0?0:n||10;var r=G(e).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(n/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(n/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(n/100)))),G(r)}function Dh(e,n){n=n===0?0:n||10;var r=G(e).toHsl();return r.l-=n/100,r.l=Hn(r.l),G(r)}function zh(e,n){var r=G(e).toHsl(),i=(r.h+n)%360;return r.h=i<0?360+i:i,G(r)}function $h(e){var n=G(e).toHsl();return n.h=(n.h+180)%360,G(n)}function Ji(e,n){if(isNaN(n)||n<=0)throw new Error("Argument to polyad must be a positive number");for(var r=G(e).toHsl(),i=[G(e)],s=360/n,a=1;a<n;a++)i.push(G({h:(r.h+a*s)%360,s:r.s,l:r.l}));return i}function Fh(e){var n=G(e).toHsl(),r=n.h;return[G(e),G({h:(r+72)%360,s:n.s,l:n.l}),G({h:(r+216)%360,s:n.s,l:n.l})]}function Lh(e,n,r){n=n||6,r=r||30;var i=G(e).toHsl(),s=360/r,a=[G(e)];for(i.h=(i.h-(s*n>>1)+720)%360;--n;)i.h=(i.h+s)%360,a.push(G(i));return a}function qh(e,n){n=n||6;for(var r=G(e).toHsv(),i=r.h,s=r.s,a=r.v,o=[],c=1/n;n--;)o.push(G({h:i,s,v:a})),a=(a+c)%1;return o}G.mix=function(e,n,r){r=r===0?0:r||50;var i=G(e).toRgb(),s=G(n).toRgb(),a=r/100,o={r:(s.r-i.r)*a+i.r,g:(s.g-i.g)*a+i.g,b:(s.b-i.b)*a+i.b,a:(s.a-i.a)*a+i.a};return G(o)};G.readability=function(e,n){var r=G(e),i=G(n);return(Math.max(r.getLuminance(),i.getLuminance())+.05)/(Math.min(r.getLuminance(),i.getLuminance())+.05)};G.isReadable=function(e,n,r){var i=G.readability(e,n),s,a;switch(a=!1,s=Wh(r),s.level+s.size){case"AAsmall":case"AAAlarge":a=i>=4.5;break;case"AAlarge":a=i>=3;break;case"AAAsmall":a=i>=7;break}return a};G.mostReadable=function(e,n,r){var i=null,s=0,a,o,c,d;r=r||{},o=r.includeFallbackColors,c=r.level,d=r.size;for(var f=0;f<n.length;f++)a=G.readability(e,n[f]),a>s&&(s=a,i=G(n[f]));return G.isReadable(e,i,{level:c,size:d})||!o?i:(r.includeFallbackColors=!1,G.mostReadable(e,["#fff","#000"],r))};var wr=G.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Uh=G.hexNames=Hh(wr);function Hh(e){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[e[r]]=r);return n}function qa(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function ae(e,n){Bh(e)&&(e="100%");var r=Gh(e);return e=Math.min(n,Math.max(0,parseFloat(e))),r&&(e=parseInt(e*n,10)/100),Math.abs(e-n)<1e-6?1:e%n/parseFloat(n)}function Hn(e){return Math.min(1,Math.max(0,e))}function Ne(e){return parseInt(e,16)}function Bh(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function Gh(e){return typeof e=="string"&&e.indexOf("%")!=-1}function Re(e){return e.length==1?"0"+e:""+e}function Ft(e){return e<=1&&(e=e*100+"%"),e}function Ua(e){return Math.round(parseFloat(e)*255).toString(16)}function Xi(e){return Ne(e)/255}var Me=(function(){var e="[-\\+]?\\d+%?",n="[-\\+]?\\d*\\.\\d+%?",r="(?:"+n+")|(?:"+e+")",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",s="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+s),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+s),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+s),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function Ve(e){return!!Me.CSS_UNIT.exec(e)}function Vh(e){e=e.replace(jh,"").replace(kh,"").toLowerCase();var n=!1;if(wr[e])e=wr[e],n=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=Me.rgb.exec(e))?{r:r[1],g:r[2],b:r[3]}:(r=Me.rgba.exec(e))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=Me.hsl.exec(e))?{h:r[1],s:r[2],l:r[3]}:(r=Me.hsla.exec(e))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=Me.hsv.exec(e))?{h:r[1],s:r[2],v:r[3]}:(r=Me.hsva.exec(e))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=Me.hex8.exec(e))?{r:Ne(r[1]),g:Ne(r[2]),b:Ne(r[3]),a:Xi(r[4]),format:n?"name":"hex8"}:(r=Me.hex6.exec(e))?{r:Ne(r[1]),g:Ne(r[2]),b:Ne(r[3]),format:n?"name":"hex"}:(r=Me.hex4.exec(e))?{r:Ne(r[1]+""+r[1]),g:Ne(r[2]+""+r[2]),b:Ne(r[3]+""+r[3]),a:Xi(r[4]+""+r[4]),format:n?"name":"hex8"}:(r=Me.hex3.exec(e))?{r:Ne(r[1]+""+r[1]),g:Ne(r[2]+""+r[2]),b:Ne(r[3]+""+r[3]),format:n?"name":"hex"}:!1}function Wh(e){var n,r;return e=e||{level:"AA",size:"small"},n=(e.level||"AA").toUpperCase(),r=(e.size||"small").toLowerCase(),n!=="AA"&&n!=="AAA"&&(n="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:n,size:r}}function Nr(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function Kh(e){if(Array.isArray(e))return Nr(e)}function Ha(e,n,r){if(typeof e=="function"?e===n:e.has(n))return arguments.length<3?n:r;throw new TypeError("Private element is not present on this object")}function Yh(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jh(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function Se(e,n){return e.get(Ha(e,n))}function Qi(e,n,r){Yh(e,n),n.set(e,r)}function Zi(e,n,r){return e.set(Ha(e,n),r),r}function Xh(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,rp(i.key),i)}}function Qh(e,n,r){return n&&Xh(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zh(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ep(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tp(e){return Kh(e)||Zh(e)||ip(e)||ep()}function np(e,n){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function rp(e){var n=np(e,"string");return typeof n=="symbol"?n:n+""}function ip(e,n){if(e){if(typeof e=="string")return Nr(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Nr(e,n):void 0}}var sp=123,ap=function(n){return"#".concat(Math.min(n,Math.pow(2,24)).toString(16).padStart(6,"0"))},Ba=function(n,r,i){return(n<<16)+(r<<8)+i},op=function(n){var r=G(n).toRgb(),i=r.r,s=r.g,a=r.b;return Ba(i,s,a)},es=function(n,r){return n*sp%Math.pow(2,r)},ot=new WeakMap,We=new WeakMap,lp=(function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;Jh(this,e),Qi(this,ot,void 0),Qi(this,We,void 0),Zi(We,this,n),this.reset()}return Qh(e,[{key:"reset",value:function(){Zi(ot,this,["__reserved for background__"])}},{key:"register",value:function(r){if(Se(ot,this).length>=Math.pow(2,24-Se(We,this)))return null;var i=Se(ot,this).length,s=es(i,Se(We,this)),a=ap(i+(s<<24-Se(We,this)));return Se(ot,this).push(r),a}},{key:"lookup",value:function(r){if(!r)return null;var i=typeof r=="string"?op(r):Ba.apply(void 0,tp(r));if(!i)return null;var s=i&Math.pow(2,24-Se(We,this))-1,a=i>>24-Se(We,this)&Math.pow(2,Se(We,this))-1;return es(s,Se(We,this))!==a||s>=Se(ot,this).length?null:Se(ot,this)[s]}}])})(),ln,oe,Ga,Va,ct,ts,Wa,Ka,Ya,Xr,jr,kr,nn={},Ja=[],cp=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Bn=Array.isArray;function Fe(e,n){for(var r in n)e[r]=n[r];return e}function Qr(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function up(e,n,r){var i,s,a,o={};for(a in n)a=="key"?i=n[a]:a=="ref"?s=n[a]:o[a]=n[a];if(arguments.length>2&&(o.children=arguments.length>3?ln.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)o[a]===void 0&&(o[a]=e.defaultProps[a]);return Gt(e,o,i,s,null)}function Gt(e,n,r,i,s){var a={type:e,props:n,key:r,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++Ga,__i:-1,__u:0};return s==null&&oe.vnode!=null&&oe.vnode(a),a}function Gn(e){return e.children}function jn(e,n){this.props=e,this.context=n}function jt(e,n){if(n==null)return e.__?jt(e.__,e.__i+1):null;for(var r;n<e.__k.length;n++)if((r=e.__k[n])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?jt(e):null}function Xa(e){var n,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,n=0;n<e.__k.length;n++)if((r=e.__k[n])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return Xa(e)}}function ns(e){(!e.__d&&(e.__d=!0)&&ct.push(e)&&!In.__r++||ts!=oe.debounceRendering)&&((ts=oe.debounceRendering)||Wa)(In)}function In(){for(var e,n,r,i,s,a,o,c=1;ct.length;)ct.length>c&&ct.sort(Ka),e=ct.shift(),c=ct.length,e.__d&&(r=void 0,i=void 0,s=(i=(n=e).__v).__e,a=[],o=[],n.__P&&((r=Fe({},i)).__v=i.__v+1,oe.vnode&&oe.vnode(r),Zr(n.__P,r,i,n.__n,n.__P.namespaceURI,32&i.__u?[s]:null,a,s??jt(i),!!(32&i.__u),o),r.__v=i.__v,r.__.__k[r.__i]=r,eo(a,r,o),i.__e=i.__=null,r.__e!=s&&Xa(r)));In.__r=0}function Qa(e,n,r,i,s,a,o,c,d,f,h){var u,m,p,y,b,v,g,N=i&&i.__k||Ja,S=n.length;for(d=dp(r,n,N,d,S),u=0;u<S;u++)(p=r.__k[u])!=null&&(m=p.__i==-1?nn:N[p.__i]||nn,p.__i=u,v=Zr(e,p,m,s,a,o,c,d,f,h),y=p.__e,p.ref&&m.ref!=p.ref&&(m.ref&&ei(m.ref,null,p),h.push(p.ref,p.__c||y,p)),b==null&&y!=null&&(b=y),(g=!!(4&p.__u))||m.__k===p.__k?d=Za(p,d,e,g):typeof p.type=="function"&&v!==void 0?d=v:y&&(d=y.nextSibling),p.__u&=-7);return r.__e=b,d}function dp(e,n,r,i,s){var a,o,c,d,f,h=r.length,u=h,m=0;for(e.__k=new Array(s),a=0;a<s;a++)(o=n[a])!=null&&typeof o!="boolean"&&typeof o!="function"?(typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?o=e.__k[a]=Gt(null,o,null,null,null):Bn(o)?o=e.__k[a]=Gt(Gn,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?o=e.__k[a]=Gt(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):e.__k[a]=o,d=a+m,o.__=e,o.__b=e.__b+1,c=null,(f=o.__i=fp(o,r,d,u))!=-1&&(u--,(c=r[f])&&(c.__u|=2)),c==null||c.__v==null?(f==-1&&(s>h?m--:s<h&&m++),typeof o.type!="function"&&(o.__u|=4)):f!=d&&(f==d-1?m--:f==d+1?m++:(f>d?m--:m++,o.__u|=4))):e.__k[a]=null;if(u)for(a=0;a<h;a++)(c=r[a])!=null&&(2&c.__u)==0&&(c.__e==i&&(i=jt(c)),no(c,c));return i}function Za(e,n,r,i){var s,a;if(typeof e.type=="function"){for(s=e.__k,a=0;s&&a<s.length;a++)s[a]&&(s[a].__=e,n=Za(s[a],n,r,i));return n}e.__e!=n&&(i&&(n&&e.type&&!n.parentNode&&(n=jt(e)),r.insertBefore(e.__e,n||null)),n=e.__e);do n=n&&n.nextSibling;while(n!=null&&n.nodeType==8);return n}function fp(e,n,r,i){var s,a,o,c=e.key,d=e.type,f=n[r],h=f!=null&&(2&f.__u)==0;if(f===null&&c==null||h&&c==f.key&&d==f.type)return r;if(i>(h?1:0)){for(s=r-1,a=r+1;s>=0||a<n.length;)if((f=n[o=s>=0?s--:a++])!=null&&(2&f.__u)==0&&c==f.key&&d==f.type)return o}return-1}function rs(e,n,r){n[0]=="-"?e.setProperty(n,r??""):e[n]=r==null?"":typeof r!="number"||cp.test(n)?r:r+"px"}function gn(e,n,r,i,s){var a,o;e:if(n=="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(n in i)r&&n in r||rs(e.style,n,"");if(r)for(n in r)i&&r[n]==i[n]||rs(e.style,n,r[n])}else if(n[0]=="o"&&n[1]=="n")a=n!=(n=n.replace(Ya,"$1")),o=n.toLowerCase(),n=o in e||n=="onFocusOut"||n=="onFocusIn"?o.slice(2):n.slice(2),e.l||(e.l={}),e.l[n+a]=r,r?i?r.u=i.u:(r.u=Xr,e.addEventListener(n,a?kr:jr,a)):e.removeEventListener(n,a?kr:jr,a);else{if(s=="http://www.w3.org/2000/svg")n=n.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(n!="width"&&n!="height"&&n!="href"&&n!="list"&&n!="form"&&n!="tabIndex"&&n!="download"&&n!="rowSpan"&&n!="colSpan"&&n!="role"&&n!="popover"&&n in e)try{e[n]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&n[4]!="-"?e.removeAttribute(n):e.setAttribute(n,n=="popover"&&r==1?"":r))}}function is(e){return function(n){if(this.l){var r=this.l[n.type+e];if(n.t==null)n.t=Xr++;else if(n.t<r.u)return;return r(oe.event?oe.event(n):n)}}}function Zr(e,n,r,i,s,a,o,c,d,f){var h,u,m,p,y,b,v,g,N,S,w,_,E,O,x,A,j,M=n.type;if(n.constructor!==void 0)return null;128&r.__u&&(d=!!(32&r.__u),a=[c=n.__e=r.__e]),(h=oe.__b)&&h(n);e:if(typeof M=="function")try{if(g=n.props,N="prototype"in M&&M.prototype.render,S=(h=M.contextType)&&i[h.__c],w=h?S?S.props.value:h.__:i,r.__c?v=(u=n.__c=r.__c).__=u.__E:(N?n.__c=u=new M(g,w):(n.__c=u=new jn(g,w),u.constructor=M,u.render=pp),S&&S.sub(u),u.state||(u.state={}),u.__n=i,m=u.__d=!0,u.__h=[],u._sb=[]),N&&u.__s==null&&(u.__s=u.state),N&&M.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Fe({},u.__s)),Fe(u.__s,M.getDerivedStateFromProps(g,u.__s))),p=u.props,y=u.state,u.__v=n,m)N&&M.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),N&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(N&&M.getDerivedStateFromProps==null&&g!==p&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(g,w),n.__v==r.__v||!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(g,u.__s,w)===!1){for(n.__v!=r.__v&&(u.props=g,u.state=u.__s,u.__d=!1),n.__e=r.__e,n.__k=r.__k,n.__k.some(function(R){R&&(R.__=n)}),_=0;_<u._sb.length;_++)u.__h.push(u._sb[_]);u._sb=[],u.__h.length&&o.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(g,u.__s,w),N&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(p,y,b)})}if(u.context=w,u.props=g,u.__P=e,u.__e=!1,E=oe.__r,O=0,N){for(u.state=u.__s,u.__d=!1,E&&E(n),h=u.render(u.props,u.state,u.context),x=0;x<u._sb.length;x++)u.__h.push(u._sb[x]);u._sb=[]}else do u.__d=!1,E&&E(n),h=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++O<25);u.state=u.__s,u.getChildContext!=null&&(i=Fe(Fe({},i),u.getChildContext())),N&&!m&&u.getSnapshotBeforeUpdate!=null&&(b=u.getSnapshotBeforeUpdate(p,y)),A=h,h!=null&&h.type===Gn&&h.key==null&&(A=to(h.props.children)),c=Qa(e,Bn(A)?A:[A],n,r,i,s,a,o,c,d,f),u.base=n.__e,n.__u&=-161,u.__h.length&&o.push(u),v&&(u.__E=u.__=null)}catch(R){if(n.__v=null,d||a!=null)if(R.then){for(n.__u|=d?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;a[a.indexOf(c)]=null,n.__e=c}else{for(j=a.length;j--;)Qr(a[j]);Sr(n)}else n.__e=r.__e,n.__k=r.__k,R.then||Sr(n);oe.__e(R,n,r)}else a==null&&n.__v==r.__v?(n.__k=r.__k,n.__e=r.__e):c=n.__e=hp(r.__e,n,r,i,s,a,o,d,f);return(h=oe.diffed)&&h(n),128&n.__u?void 0:c}function Sr(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Sr)}function eo(e,n,r){for(var i=0;i<r.length;i++)ei(r[i],r[++i],r[++i]);oe.__c&&oe.__c(n,e),e.some(function(s){try{e=s.__h,s.__h=[],e.some(function(a){a.call(s)})}catch(a){oe.__e(a,s.__v)}})}function to(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Bn(e)?e.map(to):Fe({},e)}function hp(e,n,r,i,s,a,o,c,d){var f,h,u,m,p,y,b,v=r.props||nn,g=n.props,N=n.type;if(N=="svg"?s="http://www.w3.org/2000/svg":N=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),a!=null){for(f=0;f<a.length;f++)if((p=a[f])&&"setAttribute"in p==!!N&&(N?p.localName==N:p.nodeType==3)){e=p,a[f]=null;break}}if(e==null){if(N==null)return document.createTextNode(g);e=document.createElementNS(s,N,g.is&&g),c&&(oe.__m&&oe.__m(n,a),c=!1),a=null}if(N==null)v===g||c&&e.data==g||(e.data=g);else{if(a=a&&ln.call(e.childNodes),!c&&a!=null)for(v={},f=0;f<e.attributes.length;f++)v[(p=e.attributes[f]).name]=p.value;for(f in v)if(p=v[f],f!="children"){if(f=="dangerouslySetInnerHTML")u=p;else if(!(f in g)){if(f=="value"&&"defaultValue"in g||f=="checked"&&"defaultChecked"in g)continue;gn(e,f,null,p,s)}}for(f in g)p=g[f],f=="children"?m=p:f=="dangerouslySetInnerHTML"?h=p:f=="value"?y=p:f=="checked"?b=p:c&&typeof p!="function"||v[f]===p||gn(e,f,p,v[f],s);if(h)c||u&&(h.__html==u.__html||h.__html==e.innerHTML)||(e.innerHTML=h.__html),n.__k=[];else if(u&&(e.innerHTML=""),Qa(n.type=="template"?e.content:e,Bn(m)?m:[m],n,r,i,N=="foreignObject"?"http://www.w3.org/1999/xhtml":s,a,o,a?a[0]:r.__k&&jt(r,0),c,d),a!=null)for(f=a.length;f--;)Qr(a[f]);c||(f="value",N=="progress"&&y==null?e.removeAttribute("value"):y!=null&&(y!==e[f]||N=="progress"&&!y||N=="option"&&y!=v[f])&&gn(e,f,y,v[f],s),f="checked",b!=null&&b!=e[f]&&gn(e,f,b,v[f],s))}return e}function ei(e,n,r){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&n==null||(e.__u=e(n))}else e.current=n}catch(s){oe.__e(s,r)}}function no(e,n,r){var i,s;if(oe.unmount&&oe.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||ei(i,null,n)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(a){oe.__e(a,n)}i.base=i.__P=null}if(i=e.__k)for(s=0;s<i.length;s++)i[s]&&no(i[s],n,r||typeof e.type!="function");r||Qr(e.__e),e.__c=e.__=e.__e=void 0}function pp(e,n,r){return this.constructor(e,r)}function mp(e,n,r){var i,s,a,o;n==document&&(n=document.documentElement),oe.__&&oe.__(e,n),s=(i=!1)?null:n.__k,a=[],o=[],Zr(n,e=n.__k=up(Gn,null,[e]),s||nn,nn,n.namespaceURI,s?null:n.firstChild?ln.call(n.childNodes):null,a,s?s.__e:n.firstChild,i,o),eo(a,e,o)}function ro(e,n,r){var i,s,a,o,c=Fe({},e.props);for(a in e.type&&e.type.defaultProps&&(o=e.type.defaultProps),n)a=="key"?i=n[a]:a=="ref"?s=n[a]:c[a]=n[a]===void 0&&o!=null?o[a]:n[a];return arguments.length>2&&(c.children=arguments.length>3?ln.call(arguments,2):r),Gt(e.type,c,i||e.key,s||e.ref,null)}ln=Ja.slice,oe={__e:function(e,n,r,i){for(var s,a,o;n=n.__;)if((s=n.__c)&&!s.__)try{if((a=s.constructor)&&a.getDerivedStateFromError!=null&&(s.setState(a.getDerivedStateFromError(e)),o=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(e,i||{}),o=s.__d),o)return s.__E=s}catch(c){e=c}throw e}},Ga=0,Va=function(e){return e!=null&&e.constructor===void 0},jn.prototype.setState=function(e,n){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Fe({},this.state),typeof e=="function"&&(e=e(Fe({},r),this.props)),e&&Fe(r,e),e!=null&&this.__v&&(n&&this._sb.push(n),ns(this))},jn.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ns(this))},jn.prototype.render=Gn,ct=[],Wa=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ka=function(e,n){return e.__v.__b-n.__v.__b},In.__r=0,Ya=/(PointerCapture)$|Capture$/i,Xr=0,jr=is(!1),kr=is(!0);function ss(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function gp(e){if(Array.isArray(e))return e}function xp(e,n,r){return(n=Np(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function yp(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,s,a,o,c=[],d=!0,f=!1;try{if(a=(r=r.call(e)).next,n!==0)for(;!(d=(i=a.call(r)).done)&&(c.push(i.value),c.length!==n);d=!0);}catch(h){f=!0,s=h}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(f)throw s}}return c}}function bp(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function as(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,i)}return r}function vp(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?as(Object(r),!0).forEach(function(i){xp(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):as(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function _p(e,n){return gp(e)||yp(e,n)||jp(e,n)||bp()}function wp(e,n){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Np(e){var n=wp(e,"string");return typeof n=="symbol"?n:n+""}function Dn(e){"@babel/helpers - typeof";return Dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Dn(e)}function jp(e,n){if(e){if(typeof e=="string")return ss(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ss(e,n):void 0}}var Cr=function(n){if(Dn(n)!=="object")return n;var r=ro(n);if(r.props){var i;r.props=vp({},r.props),r!=null&&(i=r.props)!==null&&i!==void 0&&i.children&&(r.props.children=Array.isArray(r.props.children)?r.props.children.map(Cr):Cr(r.props.children))}return r},kp=function(n){return Va(ro(n))},Sp=function(n,r){delete r.__k,mp(Cr(n),r)};function Cp(e,n){n===void 0&&(n={});var r=n.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var Ap=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;Cp(Ap);var Tp=Jr({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(n,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=i.style,a=s===void 0?{}:s,o=!!n&&Dn(n)==="object"&&!!n.node&&typeof n.node=="function",c=Ae(o?n.node():n);c.style("position")==="static"&&c.style("position","relative"),r.tooltipEl=c.append("div").attr("class","float-tooltip-kap"),Object.entries(a).forEach(function(f){var h=_p(f,2),u=h[0],m=h[1];return r.tooltipEl.style(u,m)}),r.tooltipEl.style("left","-10000px").style("display","none");var d="tooltip-".concat(Math.round(Math.random()*1e12));r.mouseInside=!1,c.on("mousemove.".concat(d),function(f){r.mouseInside=!0;var h=$e(f),u=c.node(),m=u.offsetWidth,p=u.offsetHeight,y=[r.offsetX===null||r.offsetX===void 0?"-".concat(h[0]/m*100,"%"):typeof r.offsetX=="number"?"calc(-50% + ".concat(r.offsetX,"px)"):r.offsetX,r.offsetY===null||r.offsetY===void 0?p>130&&p-h[1]<100?"calc(-100% - 6px)":"21px":typeof r.offsetY=="number"?r.offsetY<0?"calc(-100% - ".concat(Math.abs(r.offsetY),"px)"):"".concat(r.offsetY,"px"):r.offsetY];r.tooltipEl.style("left",h[0]+"px").style("top",h[1]+"px").style("transform","translate(".concat(y.join(","),")")),r.content&&r.tooltipEl.style("display","inline")}),c.on("mouseover.".concat(d),function(){r.mouseInside=!0,r.content&&r.tooltipEl.style("display","inline")}),c.on("mouseout.".concat(d),function(){r.mouseInside=!1,r.tooltipEl.style("display","none")})},update:function(n){n.tooltipEl.style("display",n.content&&n.mouseInside?"inline":"none"),n.content?n.content instanceof HTMLElement?(n.tooltipEl.text(""),n.tooltipEl.append(function(){return n.content})):typeof n.content=="string"?n.tooltipEl.html(n.content):kp(n.content)?(n.tooltipEl.text(""),Sp(n.content,n.tooltipEl.node())):(n.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",n.content,n.content.toString())):n.tooltipEl.text("")}});function Ep(e,n,r){var i,s=1;e==null&&(e=0),n==null&&(n=0),r==null&&(r=0);function a(){var o,c=i.length,d,f=0,h=0,u=0;for(o=0;o<c;++o)d=i[o],f+=d.x||0,h+=d.y||0,u+=d.z||0;for(f=(f/c-e)*s,h=(h/c-n)*s,u=(u/c-r)*s,o=0;o<c;++o)d=i[o],f&&(d.x-=f),h&&(d.y-=h),u&&(d.z-=u)}return a.initialize=function(o){i=o},a.x=function(o){return arguments.length?(e=+o,a):e},a.y=function(o){return arguments.length?(n=+o,a):n},a.z=function(o){return arguments.length?(r=+o,a):r},a.strength=function(o){return arguments.length?(s=+o,a):s},a}function Op(e){const n=+this._x.call(null,e);return io(this.cover(n),n,e)}function io(e,n,r){if(isNaN(n))return e;var i,s=e._root,a={data:r},o=e._x0,c=e._x1,d,f,h,u,m;if(!s)return e._root=a,e;for(;s.length;)if((h=n>=(d=(o+c)/2))?o=d:c=d,i=s,!(s=s[u=+h]))return i[u]=a,e;if(f=+e._x.call(null,s.data),n===f)return a.next=s,i?i[u]=a:e._root=a,e;do i=i?i[u]=new Array(2):e._root=new Array(2),(h=n>=(d=(o+c)/2))?o=d:c=d;while((u=+h)==(m=+(f>=d)));return i[m]=s,i[u]=a,e}function Mp(e){Array.isArray(e)||(e=Array.from(e));const n=e.length,r=new Float64Array(n);let i=1/0,s=-1/0;for(let a=0,o;a<n;++a)isNaN(o=+this._x.call(null,e[a]))||(r[a]=o,o<i&&(i=o),o>s&&(s=o));if(i>s)return this;this.cover(i).cover(s);for(let a=0;a<n;++a)io(this,r[a],e[a]);return this}function Pp(e){if(isNaN(e=+e))return this;var n=this._x0,r=this._x1;if(isNaN(n))r=(n=Math.floor(e))+1;else{for(var i=r-n||1,s=this._root,a,o;n>e||e>=r;)switch(o=+(e<n),a=new Array(2),a[o]=s,s=a,i*=2,o){case 0:r=n+i;break;case 1:n=r-i;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._x1=r,this}function Rp(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function Ip(e){return arguments.length?this.cover(+e[0][0]).cover(+e[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function et(e,n,r){this.node=e,this.x0=n,this.x1=r}function Dp(e,n){var r,i=this._x0,s,a,o=this._x1,c=[],d=this._root,f,h;for(d&&c.push(new et(d,i,o)),n==null?n=1/0:(i=e-n,o=e+n);f=c.pop();)if(!(!(d=f.node)||(s=f.x0)>o||(a=f.x1)<i))if(d.length){var u=(s+a)/2;c.push(new et(d[1],u,a),new et(d[0],s,u)),(h=+(e>=u))&&(f=c[c.length-1],c[c.length-1]=c[c.length-1-h],c[c.length-1-h]=f)}else{var m=Math.abs(e-+this._x.call(null,d.data));m<n&&(n=m,i=e-m,o=e+m,r=d.data)}return r}function zp(e){if(isNaN(d=+this._x.call(null,e)))return this;var n,r=this._root,i,s,a,o=this._x0,c=this._x1,d,f,h,u,m;if(!r)return this;if(r.length)for(;;){if((h=d>=(f=(o+c)/2))?o=f:c=f,n=r,!(r=r[u=+h]))return this;if(!r.length)break;n[u+1&1]&&(i=n,m=u)}for(;r.data!==e;)if(s=r,!(r=r.next))return this;return(a=r.next)&&delete r.next,s?(a?s.next=a:delete s.next,this):n?(a?n[u]=a:delete n[u],(r=n[0]||n[1])&&r===(n[1]||n[0])&&!r.length&&(i?i[m]=r:this._root=r),this):(this._root=a,this)}function $p(e){for(var n=0,r=e.length;n<r;++n)this.remove(e[n]);return this}function Fp(){return this._root}function Lp(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function qp(e){var n=[],r,i=this._root,s,a,o;for(i&&n.push(new et(i,this._x0,this._x1));r=n.pop();)if(!e(i=r.node,a=r.x0,o=r.x1)&&i.length){var c=(a+o)/2;(s=i[1])&&n.push(new et(s,c,o)),(s=i[0])&&n.push(new et(s,a,c))}return this}function Up(e){var n=[],r=[],i;for(this._root&&n.push(new et(this._root,this._x0,this._x1));i=n.pop();){var s=i.node;if(s.length){var a,o=i.x0,c=i.x1,d=(o+c)/2;(a=s[0])&&n.push(new et(a,o,d)),(a=s[1])&&n.push(new et(a,d,c))}r.push(i)}for(;i=r.pop();)e(i.node,i.x0,i.x1);return this}function Hp(e){return e[0]}function Bp(e){return arguments.length?(this._x=e,this):this._x}function so(e,n){var r=new ti(n??Hp,NaN,NaN);return e==null?r:r.addAll(e)}function ti(e,n,r){this._x=e,this._x0=n,this._x1=r,this._root=void 0}function os(e){for(var n={data:e.data},r=n;e=e.next;)r=r.next={data:e.data};return n}var we=so.prototype=ti.prototype;we.copy=function(){var e=new ti(this._x,this._x0,this._x1),n=this._root,r,i;if(!n)return e;if(!n.length)return e._root=os(n),e;for(r=[{source:n,target:e._root=new Array(2)}];n=r.pop();)for(var s=0;s<2;++s)(i=n.source[s])&&(i.length?r.push({source:i,target:n.target[s]=new Array(2)}):n.target[s]=os(i));return e};we.add=Op;we.addAll=Mp;we.cover=Pp;we.data=Rp;we.extent=Ip;we.find=Dp;we.remove=zp;we.removeAll=$p;we.root=Fp;we.size=Lp;we.visit=qp;we.visitAfter=Up;we.x=Bp;function Gp(e){const n=+this._x.call(null,e),r=+this._y.call(null,e);return ao(this.cover(n,r),n,r,e)}function ao(e,n,r,i){if(isNaN(n)||isNaN(r))return e;var s,a=e._root,o={data:i},c=e._x0,d=e._y0,f=e._x1,h=e._y1,u,m,p,y,b,v,g,N;if(!a)return e._root=o,e;for(;a.length;)if((b=n>=(u=(c+f)/2))?c=u:f=u,(v=r>=(m=(d+h)/2))?d=m:h=m,s=a,!(a=a[g=v<<1|b]))return s[g]=o,e;if(p=+e._x.call(null,a.data),y=+e._y.call(null,a.data),n===p&&r===y)return o.next=a,s?s[g]=o:e._root=o,e;do s=s?s[g]=new Array(4):e._root=new Array(4),(b=n>=(u=(c+f)/2))?c=u:f=u,(v=r>=(m=(d+h)/2))?d=m:h=m;while((g=v<<1|b)===(N=(y>=m)<<1|p>=u));return s[N]=a,s[g]=o,e}function Vp(e){var n,r,i=e.length,s,a,o=new Array(i),c=new Array(i),d=1/0,f=1/0,h=-1/0,u=-1/0;for(r=0;r<i;++r)isNaN(s=+this._x.call(null,n=e[r]))||isNaN(a=+this._y.call(null,n))||(o[r]=s,c[r]=a,s<d&&(d=s),s>h&&(h=s),a<f&&(f=a),a>u&&(u=a));if(d>h||f>u)return this;for(this.cover(d,f).cover(h,u),r=0;r<i;++r)ao(this,o[r],c[r],e[r]);return this}function Wp(e,n){if(isNaN(e=+e)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,s=this._x1,a=this._y1;if(isNaN(r))s=(r=Math.floor(e))+1,a=(i=Math.floor(n))+1;else{for(var o=s-r||1,c=this._root,d,f;r>e||e>=s||i>n||n>=a;)switch(f=(n<i)<<1|e<r,d=new Array(4),d[f]=c,c=d,o*=2,f){case 0:s=r+o,a=i+o;break;case 1:r=s-o,a=i+o;break;case 2:s=r+o,i=a-o;break;case 3:r=s-o,i=a-o;break}this._root&&this._root.length&&(this._root=c)}return this._x0=r,this._y0=i,this._x1=s,this._y1=a,this}function Kp(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function Yp(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ye(e,n,r,i,s){this.node=e,this.x0=n,this.y0=r,this.x1=i,this.y1=s}function Jp(e,n,r){var i,s=this._x0,a=this._y0,o,c,d,f,h=this._x1,u=this._y1,m=[],p=this._root,y,b;for(p&&m.push(new ye(p,s,a,h,u)),r==null?r=1/0:(s=e-r,a=n-r,h=e+r,u=n+r,r*=r);y=m.pop();)if(!(!(p=y.node)||(o=y.x0)>h||(c=y.y0)>u||(d=y.x1)<s||(f=y.y1)<a))if(p.length){var v=(o+d)/2,g=(c+f)/2;m.push(new ye(p[3],v,g,d,f),new ye(p[2],o,g,v,f),new ye(p[1],v,c,d,g),new ye(p[0],o,c,v,g)),(b=(n>=g)<<1|e>=v)&&(y=m[m.length-1],m[m.length-1]=m[m.length-1-b],m[m.length-1-b]=y)}else{var N=e-+this._x.call(null,p.data),S=n-+this._y.call(null,p.data),w=N*N+S*S;if(w<r){var _=Math.sqrt(r=w);s=e-_,a=n-_,h=e+_,u=n+_,i=p.data}}return i}function Xp(e){if(isNaN(h=+this._x.call(null,e))||isNaN(u=+this._y.call(null,e)))return this;var n,r=this._root,i,s,a,o=this._x0,c=this._y0,d=this._x1,f=this._y1,h,u,m,p,y,b,v,g;if(!r)return this;if(r.length)for(;;){if((y=h>=(m=(o+d)/2))?o=m:d=m,(b=u>=(p=(c+f)/2))?c=p:f=p,n=r,!(r=r[v=b<<1|y]))return this;if(!r.length)break;(n[v+1&3]||n[v+2&3]||n[v+3&3])&&(i=n,g=v)}for(;r.data!==e;)if(s=r,!(r=r.next))return this;return(a=r.next)&&delete r.next,s?(a?s.next=a:delete s.next,this):n?(a?n[v]=a:delete n[v],(r=n[0]||n[1]||n[2]||n[3])&&r===(n[3]||n[2]||n[1]||n[0])&&!r.length&&(i?i[g]=r:this._root=r),this):(this._root=a,this)}function Qp(e){for(var n=0,r=e.length;n<r;++n)this.remove(e[n]);return this}function Zp(){return this._root}function em(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function tm(e){var n=[],r,i=this._root,s,a,o,c,d;for(i&&n.push(new ye(i,this._x0,this._y0,this._x1,this._y1));r=n.pop();)if(!e(i=r.node,a=r.x0,o=r.y0,c=r.x1,d=r.y1)&&i.length){var f=(a+c)/2,h=(o+d)/2;(s=i[3])&&n.push(new ye(s,f,h,c,d)),(s=i[2])&&n.push(new ye(s,a,h,f,d)),(s=i[1])&&n.push(new ye(s,f,o,c,h)),(s=i[0])&&n.push(new ye(s,a,o,f,h))}return this}function nm(e){var n=[],r=[],i;for(this._root&&n.push(new ye(this._root,this._x0,this._y0,this._x1,this._y1));i=n.pop();){var s=i.node;if(s.length){var a,o=i.x0,c=i.y0,d=i.x1,f=i.y1,h=(o+d)/2,u=(c+f)/2;(a=s[0])&&n.push(new ye(a,o,c,h,u)),(a=s[1])&&n.push(new ye(a,h,c,d,u)),(a=s[2])&&n.push(new ye(a,o,u,h,f)),(a=s[3])&&n.push(new ye(a,h,u,d,f))}r.push(i)}for(;i=r.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function rm(e){return e[0]}function im(e){return arguments.length?(this._x=e,this):this._x}function sm(e){return e[1]}function am(e){return arguments.length?(this._y=e,this):this._y}function oo(e,n,r){var i=new ni(n??rm,r??sm,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function ni(e,n,r,i,s,a){this._x=e,this._y=n,this._x0=r,this._y0=i,this._x1=s,this._y1=a,this._root=void 0}function ls(e){for(var n={data:e.data},r=n;e=e.next;)r=r.next={data:e.data};return n}var be=oo.prototype=ni.prototype;be.copy=function(){var e=new ni(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,r,i;if(!n)return e;if(!n.length)return e._root=ls(n),e;for(r=[{source:n,target:e._root=new Array(4)}];n=r.pop();)for(var s=0;s<4;++s)(i=n.source[s])&&(i.length?r.push({source:i,target:n.target[s]=new Array(4)}):n.target[s]=ls(i));return e};be.add=Gp;be.addAll=Vp;be.cover=Wp;be.data=Kp;be.extent=Yp;be.find=Jp;be.remove=Xp;be.removeAll=Qp;be.root=Zp;be.size=em;be.visit=tm;be.visitAfter=nm;be.x=im;be.y=am;function om(e){const n=+this._x.call(null,e),r=+this._y.call(null,e),i=+this._z.call(null,e);return lo(this.cover(n,r,i),n,r,i,e)}function lo(e,n,r,i,s){if(isNaN(n)||isNaN(r)||isNaN(i))return e;var a,o=e._root,c={data:s},d=e._x0,f=e._y0,h=e._z0,u=e._x1,m=e._y1,p=e._z1,y,b,v,g,N,S,w,_,E,O,x;if(!o)return e._root=c,e;for(;o.length;)if((w=n>=(y=(d+u)/2))?d=y:u=y,(_=r>=(b=(f+m)/2))?f=b:m=b,(E=i>=(v=(h+p)/2))?h=v:p=v,a=o,!(o=o[O=E<<2|_<<1|w]))return a[O]=c,e;if(g=+e._x.call(null,o.data),N=+e._y.call(null,o.data),S=+e._z.call(null,o.data),n===g&&r===N&&i===S)return c.next=o,a?a[O]=c:e._root=c,e;do a=a?a[O]=new Array(8):e._root=new Array(8),(w=n>=(y=(d+u)/2))?d=y:u=y,(_=r>=(b=(f+m)/2))?f=b:m=b,(E=i>=(v=(h+p)/2))?h=v:p=v;while((O=E<<2|_<<1|w)===(x=(S>=v)<<2|(N>=b)<<1|g>=y));return a[x]=o,a[O]=c,e}function lm(e){Array.isArray(e)||(e=Array.from(e));const n=e.length,r=new Float64Array(n),i=new Float64Array(n),s=new Float64Array(n);let a=1/0,o=1/0,c=1/0,d=-1/0,f=-1/0,h=-1/0;for(let u=0,m,p,y,b;u<n;++u)isNaN(p=+this._x.call(null,m=e[u]))||isNaN(y=+this._y.call(null,m))||isNaN(b=+this._z.call(null,m))||(r[u]=p,i[u]=y,s[u]=b,p<a&&(a=p),p>d&&(d=p),y<o&&(o=y),y>f&&(f=y),b<c&&(c=b),b>h&&(h=b));if(a>d||o>f||c>h)return this;this.cover(a,o,c).cover(d,f,h);for(let u=0;u<n;++u)lo(this,r[u],i[u],s[u],e[u]);return this}function cm(e,n,r){if(isNaN(e=+e)||isNaN(n=+n)||isNaN(r=+r))return this;var i=this._x0,s=this._y0,a=this._z0,o=this._x1,c=this._y1,d=this._z1;if(isNaN(i))o=(i=Math.floor(e))+1,c=(s=Math.floor(n))+1,d=(a=Math.floor(r))+1;else{for(var f=o-i||1,h=this._root,u,m;i>e||e>=o||s>n||n>=c||a>r||r>=d;)switch(m=(r<a)<<2|(n<s)<<1|e<i,u=new Array(8),u[m]=h,h=u,f*=2,m){case 0:o=i+f,c=s+f,d=a+f;break;case 1:i=o-f,c=s+f,d=a+f;break;case 2:o=i+f,s=c-f,d=a+f;break;case 3:i=o-f,s=c-f,d=a+f;break;case 4:o=i+f,c=s+f,a=d-f;break;case 5:i=o-f,c=s+f,a=d-f;break;case 6:o=i+f,s=c-f,a=d-f;break;case 7:i=o-f,s=c-f,a=d-f;break}this._root&&this._root.length&&(this._root=h)}return this._x0=i,this._y0=s,this._z0=a,this._x1=o,this._y1=c,this._z1=d,this}function um(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function dm(e){return arguments.length?this.cover(+e[0][0],+e[0][1],+e[0][2]).cover(+e[1][0],+e[1][1],+e[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function ne(e,n,r,i,s,a,o){this.node=e,this.x0=n,this.y0=r,this.z0=i,this.x1=s,this.y1=a,this.z1=o}function fm(e,n,r,i){var s,a=this._x0,o=this._y0,c=this._z0,d,f,h,u,m,p,y=this._x1,b=this._y1,v=this._z1,g=[],N=this._root,S,w;for(N&&g.push(new ne(N,a,o,c,y,b,v)),i==null?i=1/0:(a=e-i,o=n-i,c=r-i,y=e+i,b=n+i,v=r+i,i*=i);S=g.pop();)if(!(!(N=S.node)||(d=S.x0)>y||(f=S.y0)>b||(h=S.z0)>v||(u=S.x1)<a||(m=S.y1)<o||(p=S.z1)<c))if(N.length){var _=(d+u)/2,E=(f+m)/2,O=(h+p)/2;g.push(new ne(N[7],_,E,O,u,m,p),new ne(N[6],d,E,O,_,m,p),new ne(N[5],_,f,O,u,E,p),new ne(N[4],d,f,O,_,E,p),new ne(N[3],_,E,h,u,m,O),new ne(N[2],d,E,h,_,m,O),new ne(N[1],_,f,h,u,E,O),new ne(N[0],d,f,h,_,E,O)),(w=(r>=O)<<2|(n>=E)<<1|e>=_)&&(S=g[g.length-1],g[g.length-1]=g[g.length-1-w],g[g.length-1-w]=S)}else{var x=e-+this._x.call(null,N.data),A=n-+this._y.call(null,N.data),j=r-+this._z.call(null,N.data),M=x*x+A*A+j*j;if(M<i){var R=Math.sqrt(i=M);a=e-R,o=n-R,c=r-R,y=e+R,b=n+R,v=r+R,s=N.data}}return s}const hm=(e,n,r,i,s,a)=>Math.sqrt((e-i)**2+(n-s)**2+(r-a)**2);function pm(e,n,r,i){const s=[],a=e-i,o=n-i,c=r-i,d=e+i,f=n+i,h=r+i;return this.visit((u,m,p,y,b,v,g)=>{if(!u.length)do{const N=u.data;hm(e,n,r,this._x(N),this._y(N),this._z(N))<=i&&s.push(N)}while(u=u.next);return m>d||p>f||y>h||b<a||v<o||g<c}),s}function mm(e){if(isNaN(m=+this._x.call(null,e))||isNaN(p=+this._y.call(null,e))||isNaN(y=+this._z.call(null,e)))return this;var n,r=this._root,i,s,a,o=this._x0,c=this._y0,d=this._z0,f=this._x1,h=this._y1,u=this._z1,m,p,y,b,v,g,N,S,w,_,E;if(!r)return this;if(r.length)for(;;){if((N=m>=(b=(o+f)/2))?o=b:f=b,(S=p>=(v=(c+h)/2))?c=v:h=v,(w=y>=(g=(d+u)/2))?d=g:u=g,n=r,!(r=r[_=w<<2|S<<1|N]))return this;if(!r.length)break;(n[_+1&7]||n[_+2&7]||n[_+3&7]||n[_+4&7]||n[_+5&7]||n[_+6&7]||n[_+7&7])&&(i=n,E=_)}for(;r.data!==e;)if(s=r,!(r=r.next))return this;return(a=r.next)&&delete r.next,s?(a?s.next=a:delete s.next,this):n?(a?n[_]=a:delete n[_],(r=n[0]||n[1]||n[2]||n[3]||n[4]||n[5]||n[6]||n[7])&&r===(n[7]||n[6]||n[5]||n[4]||n[3]||n[2]||n[1]||n[0])&&!r.length&&(i?i[E]=r:this._root=r),this):(this._root=a,this)}function gm(e){for(var n=0,r=e.length;n<r;++n)this.remove(e[n]);return this}function xm(){return this._root}function ym(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function bm(e){var n=[],r,i=this._root,s,a,o,c,d,f,h;for(i&&n.push(new ne(i,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=n.pop();)if(!e(i=r.node,a=r.x0,o=r.y0,c=r.z0,d=r.x1,f=r.y1,h=r.z1)&&i.length){var u=(a+d)/2,m=(o+f)/2,p=(c+h)/2;(s=i[7])&&n.push(new ne(s,u,m,p,d,f,h)),(s=i[6])&&n.push(new ne(s,a,m,p,u,f,h)),(s=i[5])&&n.push(new ne(s,u,o,p,d,m,h)),(s=i[4])&&n.push(new ne(s,a,o,p,u,m,h)),(s=i[3])&&n.push(new ne(s,u,m,c,d,f,p)),(s=i[2])&&n.push(new ne(s,a,m,c,u,f,p)),(s=i[1])&&n.push(new ne(s,u,o,c,d,m,p)),(s=i[0])&&n.push(new ne(s,a,o,c,u,m,p))}return this}function vm(e){var n=[],r=[],i;for(this._root&&n.push(new ne(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=n.pop();){var s=i.node;if(s.length){var a,o=i.x0,c=i.y0,d=i.z0,f=i.x1,h=i.y1,u=i.z1,m=(o+f)/2,p=(c+h)/2,y=(d+u)/2;(a=s[0])&&n.push(new ne(a,o,c,d,m,p,y)),(a=s[1])&&n.push(new ne(a,m,c,d,f,p,y)),(a=s[2])&&n.push(new ne(a,o,p,d,m,h,y)),(a=s[3])&&n.push(new ne(a,m,p,d,f,h,y)),(a=s[4])&&n.push(new ne(a,o,c,y,m,p,u)),(a=s[5])&&n.push(new ne(a,m,c,y,f,p,u)),(a=s[6])&&n.push(new ne(a,o,p,y,m,h,u)),(a=s[7])&&n.push(new ne(a,m,p,y,f,h,u))}r.push(i)}for(;i=r.pop();)e(i.node,i.x0,i.y0,i.z0,i.x1,i.y1,i.z1);return this}function _m(e){return e[0]}function wm(e){return arguments.length?(this._x=e,this):this._x}function Nm(e){return e[1]}function jm(e){return arguments.length?(this._y=e,this):this._y}function km(e){return e[2]}function Sm(e){return arguments.length?(this._z=e,this):this._z}function co(e,n,r,i){var s=new ri(n??_m,r??Nm,i??km,NaN,NaN,NaN,NaN,NaN,NaN);return e==null?s:s.addAll(e)}function ri(e,n,r,i,s,a,o,c,d){this._x=e,this._y=n,this._z=r,this._x0=i,this._y0=s,this._z0=a,this._x1=o,this._y1=c,this._z1=d,this._root=void 0}function cs(e){for(var n={data:e.data},r=n;e=e.next;)r=r.next={data:e.data};return n}var me=co.prototype=ri.prototype;me.copy=function(){var e=new ri(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root,r,i;if(!n)return e;if(!n.length)return e._root=cs(n),e;for(r=[{source:n,target:e._root=new Array(8)}];n=r.pop();)for(var s=0;s<8;++s)(i=n.source[s])&&(i.length?r.push({source:i,target:n.target[s]=new Array(8)}):n.target[s]=cs(i));return e};me.add=om;me.addAll=lm;me.cover=cm;me.data=um;me.extent=dm;me.find=fm;me.findAllWithinRadius=pm;me.remove=mm;me.removeAll=gm;me.root=xm;me.size=ym;me.visit=bm;me.visitAfter=vm;me.x=wm;me.y=jm;me.z=Sm;function Ze(e){return function(){return e}}function Xe(e){return(e()-.5)*1e-6}function Cm(e){return e.index}function us(e,n){var r=e.get(n);if(!r)throw new Error("node not found: "+n);return r}function Am(e){var n=Cm,r=m,i,s=Ze(30),a,o,c,d,f,h,u=1;e==null&&(e=[]);function m(g){return 1/Math.min(d[g.source.index],d[g.target.index])}function p(g){for(var N=0,S=e.length;N<u;++N)for(var w=0,_,E,O,x=0,A=0,j=0,M,R;w<S;++w)_=e[w],E=_.source,O=_.target,x=O.x+O.vx-E.x-E.vx||Xe(h),c>1&&(A=O.y+O.vy-E.y-E.vy||Xe(h)),c>2&&(j=O.z+O.vz-E.z-E.vz||Xe(h)),M=Math.sqrt(x*x+A*A+j*j),M=(M-a[w])/M*g*i[w],x*=M,A*=M,j*=M,O.vx-=x*(R=f[w]),c>1&&(O.vy-=A*R),c>2&&(O.vz-=j*R),E.vx+=x*(R=1-R),c>1&&(E.vy+=A*R),c>2&&(E.vz+=j*R)}function y(){if(o){var g,N=o.length,S=e.length,w=new Map(o.map((E,O)=>[n(E,O,o),E])),_;for(g=0,d=new Array(N);g<S;++g)_=e[g],_.index=g,typeof _.source!="object"&&(_.source=us(w,_.source)),typeof _.target!="object"&&(_.target=us(w,_.target)),d[_.source.index]=(d[_.source.index]||0)+1,d[_.target.index]=(d[_.target.index]||0)+1;for(g=0,f=new Array(S);g<S;++g)_=e[g],f[g]=d[_.source.index]/(d[_.source.index]+d[_.target.index]);i=new Array(S),b(),a=new Array(S),v()}}function b(){if(o)for(var g=0,N=e.length;g<N;++g)i[g]=+r(e[g],g,e)}function v(){if(o)for(var g=0,N=e.length;g<N;++g)a[g]=+s(e[g],g,e)}return p.initialize=function(g,...N){o=g,h=N.find(S=>typeof S=="function")||Math.random,c=N.find(S=>[1,2,3].includes(S))||2,y()},p.links=function(g){return arguments.length?(e=g,y(),p):e},p.id=function(g){return arguments.length?(n=g,p):n},p.iterations=function(g){return arguments.length?(u=+g,p):u},p.strength=function(g){return arguments.length?(r=typeof g=="function"?g:Ze(+g),b(),p):r},p.distance=function(g){return arguments.length?(s=typeof g=="function"?g:Ze(+g),v(),p):s},p}const Tm=1664525,Em=1013904223,ds=4294967296;function Om(){let e=1;return()=>(e=(Tm*e+Em)%ds)/ds}var fs=3;function tr(e){return e.x}function hs(e){return e.y}function Mm(e){return e.z}var Pm=10,Rm=Math.PI*(3-Math.sqrt(5)),Im=Math.PI*20/(9+Math.sqrt(221));function Dm(e,n){n=n||2;var r=Math.min(fs,Math.max(1,Math.round(n))),i,s=1,a=.001,o=1-Math.pow(a,1/300),c=0,d=.6,f=new Map,h=Vr(p),u=an("tick","end"),m=Om();e==null&&(e=[]);function p(){y(),u.call("tick",i),s<a&&(h.stop(),u.call("end",i))}function y(g){var N,S=e.length,w;g===void 0&&(g=1);for(var _=0;_<g;++_)for(s+=(c-s)*o,f.forEach(function(E){E(s)}),N=0;N<S;++N)w=e[N],w.fx==null?w.x+=w.vx*=d:(w.x=w.fx,w.vx=0),r>1&&(w.fy==null?w.y+=w.vy*=d:(w.y=w.fy,w.vy=0)),r>2&&(w.fz==null?w.z+=w.vz*=d:(w.z=w.fz,w.vz=0));return i}function b(){for(var g=0,N=e.length,S;g<N;++g){if(S=e[g],S.index=g,S.fx!=null&&(S.x=S.fx),S.fy!=null&&(S.y=S.fy),S.fz!=null&&(S.z=S.fz),isNaN(S.x)||r>1&&isNaN(S.y)||r>2&&isNaN(S.z)){var w=Pm*(r>2?Math.cbrt(.5+g):r>1?Math.sqrt(.5+g):g),_=g*Rm,E=g*Im;r===1?S.x=w:r===2?(S.x=w*Math.cos(_),S.y=w*Math.sin(_)):(S.x=w*Math.sin(_)*Math.cos(E),S.y=w*Math.cos(_),S.z=w*Math.sin(_)*Math.sin(E))}(isNaN(S.vx)||r>1&&isNaN(S.vy)||r>2&&isNaN(S.vz))&&(S.vx=0,r>1&&(S.vy=0),r>2&&(S.vz=0))}}function v(g){return g.initialize&&g.initialize(e,m,r),g}return b(),i={tick:y,restart:function(){return h.restart(p),i},stop:function(){return h.stop(),i},numDimensions:function(g){return arguments.length?(r=Math.min(fs,Math.max(1,Math.round(g))),f.forEach(v),i):r},nodes:function(g){return arguments.length?(e=g,b(),f.forEach(v),i):e},alpha:function(g){return arguments.length?(s=+g,i):s},alphaMin:function(g){return arguments.length?(a=+g,i):a},alphaDecay:function(g){return arguments.length?(o=+g,i):+o},alphaTarget:function(g){return arguments.length?(c=+g,i):c},velocityDecay:function(g){return arguments.length?(d=1-g,i):1-d},randomSource:function(g){return arguments.length?(m=g,f.forEach(v),i):m},force:function(g,N){return arguments.length>1?(N==null?f.delete(g):f.set(g,v(N)),i):f.get(g)},find:function(){var g=Array.prototype.slice.call(arguments),N=g.shift()||0,S=(r>1?g.shift():null)||0,w=(r>2?g.shift():null)||0,_=g.shift()||1/0,E=0,O=e.length,x,A,j,M,R,F;for(_*=_,E=0;E<O;++E)R=e[E],x=N-R.x,A=S-(R.y||0),j=w-(R.z||0),M=x*x+A*A+j*j,M<_&&(F=R,_=M);return F},on:function(g,N){return arguments.length>1?(u.on(g,N),i):u.on(g)}}}function zm(){var e,n,r,i,s,a=Ze(-30),o,c=1,d=1/0,f=.81;function h(y){var b,v=e.length,g=(n===1?so(e,tr):n===2?oo(e,tr,hs):n===3?co(e,tr,hs,Mm):null).visitAfter(m);for(s=y,b=0;b<v;++b)r=e[b],g.visit(p)}function u(){if(e){var y,b=e.length,v;for(o=new Array(b),y=0;y<b;++y)v=e[y],o[v.index]=+a(v,y,e)}}function m(y){var b=0,v,g,N=0,S,w,_,E,O=y.length;if(O){for(S=w=_=E=0;E<O;++E)(v=y[E])&&(g=Math.abs(v.value))&&(b+=v.value,N+=g,S+=g*(v.x||0),w+=g*(v.y||0),_+=g*(v.z||0));b*=Math.sqrt(4/O),y.x=S/N,n>1&&(y.y=w/N),n>2&&(y.z=_/N)}else{v=y,v.x=v.data.x,n>1&&(v.y=v.data.y),n>2&&(v.z=v.data.z);do b+=o[v.data.index];while(v=v.next)}y.value=b}function p(y,b,v,g,N){if(!y.value)return!0;var S=[v,g,N][n-1],w=y.x-r.x,_=n>1?y.y-r.y:0,E=n>2?y.z-r.z:0,O=S-b,x=w*w+_*_+E*E;if(O*O/f<x)return x<d&&(w===0&&(w=Xe(i),x+=w*w),n>1&&_===0&&(_=Xe(i),x+=_*_),n>2&&E===0&&(E=Xe(i),x+=E*E),x<c&&(x=Math.sqrt(c*x)),r.vx+=w*y.value*s/x,n>1&&(r.vy+=_*y.value*s/x),n>2&&(r.vz+=E*y.value*s/x)),!0;if(y.length||x>=d)return;(y.data!==r||y.next)&&(w===0&&(w=Xe(i),x+=w*w),n>1&&_===0&&(_=Xe(i),x+=_*_),n>2&&E===0&&(E=Xe(i),x+=E*E),x<c&&(x=Math.sqrt(c*x)));do y.data!==r&&(O=o[y.data.index]*s/x,r.vx+=w*O,n>1&&(r.vy+=_*O),n>2&&(r.vz+=E*O));while(y=y.next)}return h.initialize=function(y,...b){e=y,i=b.find(v=>typeof v=="function")||Math.random,n=b.find(v=>[1,2,3].includes(v))||2,u()},h.strength=function(y){return arguments.length?(a=typeof y=="function"?y:Ze(+y),u(),h):a},h.distanceMin=function(y){return arguments.length?(c=y*y,h):Math.sqrt(c)},h.distanceMax=function(y){return arguments.length?(d=y*y,h):Math.sqrt(d)},h.theta=function(y){return arguments.length?(f=y*y,h):Math.sqrt(f)},h}function $m(e,n,r,i){var s,a,o=Ze(.1),c,d;typeof e!="function"&&(e=Ze(+e)),n==null&&(n=0),r==null&&(r=0),i==null&&(i=0);function f(u){for(var m=0,p=s.length;m<p;++m){var y=s[m],b=y.x-n||1e-6,v=(y.y||0)-r||1e-6,g=(y.z||0)-i||1e-6,N=Math.sqrt(b*b+v*v+g*g),S=(d[m]-N)*c[m]*u/N;y.vx+=b*S,a>1&&(y.vy+=v*S),a>2&&(y.vz+=g*S)}}function h(){if(s){var u,m=s.length;for(c=new Array(m),d=new Array(m),u=0;u<m;++u)d[u]=+e(s[u],u,s),c[u]=isNaN(d[u])?0:+o(s[u],u,s)}}return f.initialize=function(u,...m){s=u,a=m.find(p=>[1,2,3].includes(p))||2,h()},f.strength=function(u){return arguments.length?(o=typeof u=="function"?u:Ze(+u),h(),f):o},f.radius=function(u){return arguments.length?(e=typeof u=="function"?u:Ze(+u),h(),f):e},f.x=function(u){return arguments.length?(n=+u,f):n},f.y=function(u){return arguments.length?(r=+u,f):r},f.z=function(u){return arguments.length?(i=+u,f):i},f}const{abs:Et,cos:Ke,sin:xt,acos:Fm,atan2:Ot,sqrt:rt,pow:Ce}=Math;function Mt(e){return e<0?-Ce(-e,1/3):Ce(e,1/3)}const uo=Math.PI,xn=2*uo,it=uo/2,Lm=1e-6,nr=Number.MAX_SAFE_INTEGER||9007199254740991,rr=Number.MIN_SAFE_INTEGER||-9007199254740991,qm={x:0,y:0,z:0},q={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,n){const r=n(e);let i=r.x*r.x+r.y*r.y;return typeof r.z<"u"&&(i+=r.z*r.z),rt(i)},compute:function(e,n,r){if(e===0)return n[0].t=0,n[0];const i=n.length-1;if(e===1)return n[i].t=1,n[i];const s=1-e;let a=n;if(i===0)return n[0].t=e,n[0];if(i===1){const c={x:s*a[0].x+e*a[1].x,y:s*a[0].y+e*a[1].y,t:e};return r&&(c.z=s*a[0].z+e*a[1].z),c}if(i<4){let c=s*s,d=e*e,f,h,u,m=0;i===2?(a=[a[0],a[1],a[2],qm],f=c,h=s*e*2,u=d):i===3&&(f=c*s,h=c*e*3,u=s*d*3,m=e*d);const p={x:f*a[0].x+h*a[1].x+u*a[2].x+m*a[3].x,y:f*a[0].y+h*a[1].y+u*a[2].y+m*a[3].y,t:e};return r&&(p.z=f*a[0].z+h*a[1].z+u*a[2].z+m*a[3].z),p}const o=JSON.parse(JSON.stringify(n));for(;o.length>1;){for(let c=0;c<o.length-1;c++)o[c]={x:o[c].x+(o[c+1].x-o[c].x)*e,y:o[c].y+(o[c+1].y-o[c].y)*e},typeof o[c].z<"u"&&(o[c].z=o[c].z+(o[c+1].z-o[c].z)*e);o.splice(o.length-1,1)}return o[0].t=e,o[0]},computeWithRatios:function(e,n,r,i){const s=1-e,a=r,o=n;let c=a[0],d=a[1],f=a[2],h=a[3],u;if(c*=s,d*=e,o.length===2)return u=c+d,{x:(c*o[0].x+d*o[1].x)/u,y:(c*o[0].y+d*o[1].y)/u,z:i?(c*o[0].z+d*o[1].z)/u:!1,t:e};if(c*=s,d*=2*s,f*=e*e,o.length===3)return u=c+d+f,{x:(c*o[0].x+d*o[1].x+f*o[2].x)/u,y:(c*o[0].y+d*o[1].y+f*o[2].y)/u,z:i?(c*o[0].z+d*o[1].z+f*o[2].z)/u:!1,t:e};if(c*=s,d*=1.5*s,f*=3*s,h*=e*e*e,o.length===4)return u=c+d+f+h,{x:(c*o[0].x+d*o[1].x+f*o[2].x+h*o[3].x)/u,y:(c*o[0].y+d*o[1].y+f*o[2].y+h*o[3].y)/u,z:i?(c*o[0].z+d*o[1].z+f*o[2].z+h*o[3].z)/u:!1,t:e}},derive:function(e,n){const r=[];for(let i=e,s=i.length,a=s-1;s>1;s--,a--){const o=[];for(let c=0,d;c<a;c++)d={x:a*(i[c+1].x-i[c].x),y:a*(i[c+1].y-i[c].y)},n&&(d.z=a*(i[c+1].z-i[c].z)),o.push(d);r.push(o),i=o}return r},between:function(e,n,r){return n<=e&&e<=r||q.approximately(e,n)||q.approximately(e,r)},approximately:function(e,n,r){return Et(e-n)<=(r||Lm)},length:function(e){const r=q.Tvalues.length;let i=0;for(let s=0,a;s<r;s++)a=.5*q.Tvalues[s]+.5,i+=q.Cvalues[s]*q.arcfn(a,e);return .5*i},map:function(e,n,r,i,s){const a=r-n,o=s-i,c=e-n,d=c/a;return i+o*d},lerp:function(e,n,r){const i={x:n.x+e*(r.x-n.x),y:n.y+e*(r.y-n.y)};return n.z!==void 0&&r.z!==void 0&&(i.z=n.z+e*(r.z-n.z)),i},pointToString:function(e){let n=e.x+"/"+e.y;return typeof e.z<"u"&&(n+="/"+e.z),n},pointsToString:function(e){return"["+e.map(q.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,n,r){const i=n.x-e.x,s=n.y-e.y,a=r.x-e.x,o=r.y-e.y,c=i*o-s*a,d=i*a+s*o;return Ot(c,d)},round:function(e,n){const r=""+e,i=r.indexOf(".");return parseFloat(r.substring(0,i+1+n))},dist:function(e,n){const r=e.x-n.x,i=e.y-n.y;return rt(r*r+i*i)},closest:function(e,n){let r=Ce(2,63),i,s;return e.forEach(function(a,o){s=q.dist(n,a),s<r&&(r=s,i=o)}),{mdist:r,mpos:i}},abcratio:function(e,n){if(n!==2&&n!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const r=Ce(e,n)+Ce(1-e,n),i=r-1;return Et(i/r)},projectionratio:function(e,n){if(n!==2&&n!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const r=Ce(1-e,n),i=Ce(e,n)+r;return r/i},lli8:function(e,n,r,i,s,a,o,c){const d=(e*i-n*r)*(s-o)-(e-r)*(s*c-a*o),f=(e*i-n*r)*(a-c)-(n-i)*(s*c-a*o),h=(e-r)*(a-c)-(n-i)*(s-o);return h==0?!1:{x:d/h,y:f/h}},lli4:function(e,n,r,i){const s=e.x,a=e.y,o=n.x,c=n.y,d=r.x,f=r.y,h=i.x,u=i.y;return q.lli8(s,a,o,c,d,f,h,u)},lli:function(e,n){return q.lli4(e,e.c,n,n.c)},makeline:function(e,n){return new se(e.x,e.y,(e.x+n.x)/2,(e.y+n.y)/2,n.x,n.y)},findbbox:function(e){let n=nr,r=nr,i=rr,s=rr;return e.forEach(function(a){const o=a.bbox();n>o.x.min&&(n=o.x.min),r>o.y.min&&(r=o.y.min),i<o.x.max&&(i=o.x.max),s<o.y.max&&(s=o.y.max)}),{x:{min:n,mid:(n+i)/2,max:i,size:i-n},y:{min:r,mid:(r+s)/2,max:s,size:s-r}}},shapeintersections:function(e,n,r,i,s){if(!q.bboxoverlap(n,i))return[];const a=[],o=[e.startcap,e.forward,e.back,e.endcap],c=[r.startcap,r.forward,r.back,r.endcap];return o.forEach(function(d){d.virtual||c.forEach(function(f){if(f.virtual)return;const h=d.intersects(f,s);h.length>0&&(h.c1=d,h.c2=f,h.s1=e,h.s2=r,a.push(h))})}),a},makeshape:function(e,n,r){const i=n.points.length,s=e.points.length,a=q.makeline(n.points[i-1],e.points[0]),o=q.makeline(e.points[s-1],n.points[0]),c={startcap:a,forward:e,back:n,endcap:o,bbox:q.findbbox([a,e,n,o])};return c.intersections=function(d){return q.shapeintersections(c,c.bbox,d,d.bbox,r)},c},getminmax:function(e,n,r){if(!r)return{min:0,max:0};let i=nr,s=rr,a,o;r.indexOf(0)===-1&&(r=[0].concat(r)),r.indexOf(1)===-1&&r.push(1);for(let c=0,d=r.length;c<d;c++)a=r[c],o=e.get(a),o[n]<i&&(i=o[n]),o[n]>s&&(s=o[n]);return{min:i,mid:(i+s)/2,max:s,size:s-i}},align:function(e,n){const r=n.p1.x,i=n.p1.y,s=-Ot(n.p2.y-i,n.p2.x-r),a=function(o){return{x:(o.x-r)*Ke(s)-(o.y-i)*xt(s),y:(o.x-r)*xt(s)+(o.y-i)*Ke(s)}};return e.map(a)},roots:function(e,n){n=n||{p1:{x:0,y:0},p2:{x:1,y:0}};const r=e.length-1,i=q.align(e,n),s=function(O){return 0<=O&&O<=1};if(r===2){const O=i[0].y,x=i[1].y,A=i[2].y,j=O-2*x+A;if(j!==0){const M=-rt(x*x-O*A),R=-O+x,F=-(M+R)/j,T=-(-M+R)/j;return[F,T].filter(s)}else if(x!==A&&j===0)return[(2*x-A)/(2*x-2*A)].filter(s);return[]}const a=i[0].y,o=i[1].y,c=i[2].y,d=i[3].y;let f=-a+3*o-3*c+d,h=3*a-6*o+3*c,u=-3*a+3*o,m=a;if(q.approximately(f,0)){if(q.approximately(h,0))return q.approximately(u,0)?[]:[-m/u].filter(s);const O=rt(u*u-4*h*m),x=2*h;return[(O-u)/x,(-u-O)/x].filter(s)}h/=f,u/=f,m/=f;const p=(3*u-h*h)/3,y=p/3,b=(2*h*h*h-9*h*u+27*m)/27,v=b/2,g=v*v+y*y*y;let N,S,w,_,E;if(g<0){const O=-p/3,x=O*O*O,A=rt(x),j=-b/(2*A),M=j<-1?-1:j>1?1:j,R=Fm(M),F=Mt(A),T=2*F;return w=T*Ke(R/3)-h/3,_=T*Ke((R+xn)/3)-h/3,E=T*Ke((R+2*xn)/3)-h/3,[w,_,E].filter(s)}else{if(g===0)return N=v<0?Mt(-v):-Mt(v),w=2*N-h/3,_=-N-h/3,[w,_].filter(s);{const O=rt(g);return N=Mt(-v+O),S=Mt(v+O),[N-S-h/3].filter(s)}}},droots:function(e){if(e.length===3){const n=e[0],r=e[1],i=e[2],s=n-2*r+i;if(s!==0){const a=-rt(r*r-n*i),o=-n+r,c=-(a+o)/s,d=-(-a+o)/s;return[c,d]}else if(r!==i&&s===0)return[(2*r-i)/(2*(r-i))];return[]}if(e.length===2){const n=e[0],r=e[1];return n!==r?[n/(n-r)]:[]}return[]},curvature:function(e,n,r,i,s){let a,o,c,d,f=0,h=0;const u=q.compute(e,n),m=q.compute(e,r),p=u.x*u.x+u.y*u.y;if(i?(a=rt(Ce(u.y*m.z-m.y*u.z,2)+Ce(u.z*m.x-m.z*u.x,2)+Ce(u.x*m.y-m.x*u.y,2)),o=Ce(p+u.z*u.z,3/2)):(a=u.x*m.y-u.y*m.x,o=Ce(p,3/2)),a===0||o===0)return{k:0,r:0};if(f=a/o,h=o/a,!s){const y=q.curvature(e-.001,n,r,i,!0).k,b=q.curvature(e+.001,n,r,i,!0).k;d=(b-f+(f-y))/2,c=(Et(b-f)+Et(f-y))/2}return{k:f,r:h,dk:d,adk:c}},inflections:function(e){if(e.length<4)return[];const n=q.align(e,{p1:e[0],p2:e.slice(-1)[0]}),r=n[2].x*n[1].y,i=n[3].x*n[1].y,s=n[1].x*n[2].y,a=n[3].x*n[2].y,o=18*(-3*r+2*i+3*s-a),c=18*(3*r-i-3*s),d=18*(s-r);if(q.approximately(o,0)){if(!q.approximately(c,0)){let m=-d/c;if(0<=m&&m<=1)return[m]}return[]}const f=2*o;if(q.approximately(f,0))return[];const h=c*c-4*o*d;if(h<0)return[];const u=Math.sqrt(h);return[(u-c)/f,-(c+u)/f].filter(function(m){return 0<=m&&m<=1})},bboxoverlap:function(e,n){const r=["x","y"],i=r.length;for(let s=0,a,o,c,d;s<i;s++)if(a=r[s],o=e[a].mid,c=n[a].mid,d=(e[a].size+n[a].size)/2,Et(o-c)>=d)return!1;return!0},expandbox:function(e,n){n.x.min<e.x.min&&(e.x.min=n.x.min),n.y.min<e.y.min&&(e.y.min=n.y.min),n.z&&n.z.min<e.z.min&&(e.z.min=n.z.min),n.x.max>e.x.max&&(e.x.max=n.x.max),n.y.max>e.y.max&&(e.y.max=n.y.max),n.z&&n.z.max>e.z.max&&(e.z.max=n.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,n,r){const i=e.bbox(),s=n.bbox(),a=1e5,o=r||.5;if(i.x.size+i.y.size<o&&s.x.size+s.y.size<o)return[(a*(e._t1+e._t2)/2|0)/a+"/"+(a*(n._t1+n._t2)/2|0)/a];let c=e.split(.5),d=n.split(.5),f=[{left:c.left,right:d.left},{left:c.left,right:d.right},{left:c.right,right:d.right},{left:c.right,right:d.left}];f=f.filter(function(u){return q.bboxoverlap(u.left.bbox(),u.right.bbox())});let h=[];return f.length===0||(f.forEach(function(u){h=h.concat(q.pairiteration(u.left,u.right,o))}),h=h.filter(function(u,m){return h.indexOf(u)===m})),h},getccenter:function(e,n,r){const i=n.x-e.x,s=n.y-e.y,a=r.x-n.x,o=r.y-n.y,c=i*Ke(it)-s*xt(it),d=i*xt(it)+s*Ke(it),f=a*Ke(it)-o*xt(it),h=a*xt(it)+o*Ke(it),u=(e.x+n.x)/2,m=(e.y+n.y)/2,p=(n.x+r.x)/2,y=(n.y+r.y)/2,b=u+c,v=m+d,g=p+f,N=y+h,S=q.lli8(u,m,b,v,p,y,g,N),w=q.dist(S,e);let _=Ot(e.y-S.y,e.x-S.x),E=Ot(n.y-S.y,n.x-S.x),O=Ot(r.y-S.y,r.x-S.x),x;return _<O?((_>E||E>O)&&(_+=xn),_>O&&(x=O,O=_,_=x)):O<E&&E<_?(x=O,O=_,_=x):O+=xn,S.s=_,S.e=O,S.r=w,S},numberSort:function(e,n){return e-n}};class Vt{constructor(n){this.curves=[],this._3d=!1,n&&(this.curves=n,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(n){return q.pointsToString(n.points)}).join(", ")+"]"}addCurve(n){this.curves.push(n),this._3d=this._3d||n._3d}length(){return this.curves.map(function(n){return n.length()}).reduce(function(n,r){return n+r})}curve(n){return this.curves[n]}bbox(){const n=this.curves;for(var r=n[0].bbox(),i=1;i<n.length;i++)q.expandbox(r,n[i].bbox());return r}offset(n){const r=[];return this.curves.forEach(function(i){r.push(...i.offset(n))}),new Vt(r)}}const{abs:Pt,min:ps,max:ms,cos:Um,sin:Hm,acos:Bm,sqrt:Rt}=Math,Gm=Math.PI;class se{constructor(n){let r=n&&n.forEach?n:Array.from(arguments).slice(),i=!1;if(typeof r[0]=="object"){i=r.length;const p=[];r.forEach(function(y){["x","y","z"].forEach(function(b){typeof y[b]<"u"&&p.push(y[b])})}),r=p}let s=!1;const a=r.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(a!==6&&a!==8&&a!==9&&a!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!s&&(a===9||a===12)||n&&n[0]&&typeof n[0].z<"u",c=this.points=[];for(let p=0,y=o?3:2;p<a;p+=y){var d={x:r[p],y:r[p+1]};o&&(d.z=r[p+2]),c.push(d)}const f=this.order=c.length-1,h=this.dims=["x","y"];o&&h.push("z"),this.dimlen=h.length;const u=q.align(c,{p1:c[0],p2:c[f]}),m=q.dist(c[0],c[f]);this._linear=u.reduce((p,y)=>p+Pt(y.y),0)<m/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(n,r,i,s){if(typeof s>"u"&&(s=.5),s===0)return new se(r,r,i);if(s===1)return new se(n,r,r);const a=se.getABC(2,n,r,i,s);return new se(n,a.A,i)}static cubicFromPoints(n,r,i,s,a){typeof s>"u"&&(s=.5);const o=se.getABC(3,n,r,i,s);typeof a>"u"&&(a=q.dist(r,o.C));const c=a*(1-s)/s,d=q.dist(n,i),f=(i.x-n.x)/d,h=(i.y-n.y)/d,u=a*f,m=a*h,p=c*f,y=c*h,b={x:r.x-u,y:r.y-m},v={x:r.x+p,y:r.y+y},g=o.A,N={x:g.x+(b.x-g.x)/(1-s),y:g.y+(b.y-g.y)/(1-s)},S={x:g.x+(v.x-g.x)/s,y:g.y+(v.y-g.y)/s},w={x:n.x+(N.x-n.x)/s,y:n.y+(N.y-n.y)/s},_={x:i.x+(S.x-i.x)/(1-s),y:i.y+(S.y-i.y)/(1-s)};return new se(n,w,_,i)}static getUtils(){return q}getUtils(){return se.getUtils()}static get PolyBezier(){return Vt}valueOf(){return this.toString()}toString(){return q.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const n=this.points,r=n[0].x,i=n[0].y,s=["M",r,i,this.order===2?"Q":"C"];for(let a=1,o=n.length;a<o;a++)s.push(n[a].x),s.push(n[a].y);return s.join(" ")}setRatios(n){if(n.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=n,this._lut=[]}verify(){const n=this.coordDigest();n!==this._print&&(this._print=n,this.update())}coordDigest(){return this.points.map(function(n,r){return""+r+n.x+n.y+(n.z?n.z:0)}).join("")}update(){this._lut=[],this.dpoints=q.derive(this.points,this._3d),this.computedirection()}computedirection(){const n=this.points,r=q.angle(n[0],n[this.order],n[1]);this.clockwise=r>0}length(){return q.length(this.derivative.bind(this))}static getABC(n=2,r,i,s,a=.5){const o=q.projectionratio(a,n),c=1-o,d={x:o*r.x+c*s.x,y:o*r.y+c*s.y},f=q.abcratio(a,n);return{A:{x:i.x+(i.x-d.x)/f,y:i.y+(i.y-d.y)/f},B:i,C:d,S:r,E:s}}getABC(n,r){r=r||this.get(n);let i=this.points[0],s=this.points[this.order];return se.getABC(this.order,i,r,s,n)}getLUT(n){if(this.verify(),n=n||100,this._lut.length===n+1)return this._lut;this._lut=[],n++,this._lut=[];for(let r=0,i,s;r<n;r++)s=r/(n-1),i=this.compute(s),i.t=s,this._lut.push(i);return this._lut}on(n,r){r=r||5;const i=this.getLUT(),s=[];for(let a=0,o,c=0;a<i.length;a++)o=i[a],q.dist(o,n)<r&&(s.push(o),c+=a/i.length);return s.length?t/=s.length:!1}project(n){const r=this.getLUT(),i=r.length-1,s=q.closest(r,n),a=s.mpos,o=(a-1)/i,c=(a+1)/i,d=.1/i;let f=s.mdist,h=o,u=h,m;f+=1;for(let p;h<c+d;h+=d)m=this.compute(h),p=q.dist(n,m),p<f&&(f=p,u=h);return u=u<0?0:u>1?1:u,m=this.compute(u),m.t=u,m.d=f,m}get(n){return this.compute(n)}point(n){return this.points[n]}compute(n){return this.ratios?q.computeWithRatios(n,this.points,this.ratios,this._3d):q.compute(n,this.points,this._3d,this.ratios)}raise(){const n=this.points,r=[n[0]],i=n.length;for(let s=1,a,o;s<i;s++)a=n[s],o=n[s-1],r[s]={x:(i-s)/i*a.x+s/i*o.x,y:(i-s)/i*a.y+s/i*o.y};return r[i]=n[i-1],new se(r)}derivative(n){return q.compute(n,this.dpoints[0],this._3d)}dderivative(n){return q.compute(n,this.dpoints[1],this._3d)}align(){let n=this.points;return new se(q.align(n,{p1:n[0],p2:n[n.length-1]}))}curvature(n){return q.curvature(n,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return q.inflections(this.points)}normal(n){return this._3d?this.__normal3(n):this.__normal2(n)}__normal2(n){const r=this.derivative(n),i=Rt(r.x*r.x+r.y*r.y);return{t:n,x:-r.y/i,y:r.x/i}}__normal3(n){const r=this.derivative(n),i=this.derivative(n+.01),s=Rt(r.x*r.x+r.y*r.y+r.z*r.z),a=Rt(i.x*i.x+i.y*i.y+i.z*i.z);r.x/=s,r.y/=s,r.z/=s,i.x/=a,i.y/=a,i.z/=a;const o={x:i.y*r.z-i.z*r.y,y:i.z*r.x-i.x*r.z,z:i.x*r.y-i.y*r.x},c=Rt(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=c,o.y/=c,o.z/=c;const d=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{t:n,x:d[0]*r.x+d[1]*r.y+d[2]*r.z,y:d[3]*r.x+d[4]*r.y+d[5]*r.z,z:d[6]*r.x+d[7]*r.y+d[8]*r.z}}hull(n){let r=this.points,i=[],s=[],a=0;for(s[a++]=r[0],s[a++]=r[1],s[a++]=r[2],this.order===3&&(s[a++]=r[3]);r.length>1;){i=[];for(let o=0,c,d=r.length-1;o<d;o++)c=q.lerp(n,r[o],r[o+1]),s[a++]=c,i.push(c);r=i}return s}split(n,r){if(n===0&&r)return this.split(r).left;if(r===1)return this.split(n).right;const i=this.hull(n),s={left:this.order===2?new se([i[0],i[3],i[5]]):new se([i[0],i[4],i[7],i[9]]),right:this.order===2?new se([i[5],i[4],i[2]]):new se([i[9],i[8],i[6],i[3]]),span:i};return s.left._t1=q.map(0,0,1,this._t1,this._t2),s.left._t2=q.map(n,0,1,this._t1,this._t2),s.right._t1=q.map(n,0,1,this._t1,this._t2),s.right._t2=q.map(1,0,1,this._t1,this._t2),r?(r=q.map(r,n,1,0,1),s.right.split(r).left):s}extrema(){const n={};let r=[];return this.dims.forEach((function(i){let s=function(o){return o[i]},a=this.dpoints[0].map(s);n[i]=q.droots(a),this.order===3&&(a=this.dpoints[1].map(s),n[i]=n[i].concat(q.droots(a))),n[i]=n[i].filter(function(o){return o>=0&&o<=1}),r=r.concat(n[i].sort(q.numberSort))}).bind(this)),n.values=r.sort(q.numberSort).filter(function(i,s){return r.indexOf(i)===s}),n}bbox(){const n=this.extrema(),r={};return this.dims.forEach((function(i){r[i]=q.getminmax(this,i,n[i])}).bind(this)),r}overlaps(n){const r=this.bbox(),i=n.bbox();return q.bboxoverlap(r,i)}offset(n,r){if(typeof r<"u"){const i=this.get(n),s=this.normal(n),a={c:i,n:s,x:i.x+s.x*r,y:i.y+s.y*r};return this._3d&&(a.z=i.z+s.z*r),a}if(this._linear){const i=this.normal(0),s=this.points.map(function(a){const o={x:a.x+n*i.x,y:a.y+n*i.y};return a.z&&i.z&&(o.z=a.z+n*i.z),o});return[new se(s)]}return this.reduce().map(function(i){return i._linear?i.offset(n)[0]:i.scale(n)})}simple(){if(this.order===3){const s=q.angle(this.points[0],this.points[3],this.points[1]),a=q.angle(this.points[0],this.points[3],this.points[2]);if(s>0&&a<0||s<0&&a>0)return!1}const n=this.normal(0),r=this.normal(1);let i=n.x*r.x+n.y*r.y;return this._3d&&(i+=n.z*r.z),Pt(Bm(i))<Gm/3}reduce(){let n,r=0,i=0,s=.01,a,o=[],c=[],d=this.extrema().values;for(d.indexOf(0)===-1&&(d=[0].concat(d)),d.indexOf(1)===-1&&d.push(1),r=d[0],n=1;n<d.length;n++)i=d[n],a=this.split(r,i),a._t1=r,a._t2=i,o.push(a),r=i;return o.forEach(function(f){for(r=0,i=0;i<=1;)for(i=r+s;i<=1+s;i+=s)if(a=f.split(r,i),!a.simple()){if(i-=s,Pt(r-i)<s)return[];a=f.split(r,i),a._t1=q.map(r,0,1,f._t1,f._t2),a._t2=q.map(i,0,1,f._t1,f._t2),c.push(a),r=i;break}r<1&&(a=f.split(r,1),a._t1=q.map(r,0,1,f._t1,f._t2),a._t2=f._t2,c.push(a))}),c}translate(n,r,i){i=typeof i=="number"?i:r;const s=this.order;let a=this.points.map((o,c)=>(1-c/s)*r+c/s*i);return new se(this.points.map((o,c)=>({x:o.x+n.x*a[c],y:o.y+n.y*a[c]})))}scale(n){const r=this.order;let i=!1;if(typeof n=="function"&&(i=n),i&&r===2)return this.raise().scale(i);const s=this.clockwise,a=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):n,i?i(1):n);const o=i?i(0):n,c=i?i(1):n,d=[this.offset(0,10),this.offset(1,10)],f=[],h=q.lli4(d[0],d[0].c,d[1],d[1].c);if(!h)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(u){const m=f[u*r]=q.copy(a[u*r]);m.x+=(u?c:o)*d[u].n.x,m.y+=(u?c:o)*d[u].n.y}),i?([0,1].forEach(function(u){if(!(r===2&&u)){var m=a[u+1],p={x:m.x-h.x,y:m.y-h.y},y=i?i((u+1)/r):n;i&&!s&&(y=-y);var b=Rt(p.x*p.x+p.y*p.y);p.x/=b,p.y/=b,f[u+1]={x:m.x+y*p.x,y:m.y+y*p.y}}}),new se(f)):([0,1].forEach(u=>{if(r===2&&u)return;const m=f[u*r],p=this.derivative(u),y={x:m.x+p.x,y:m.y+p.y};f[u+1]=q.lli4(m,y,h,a[u+1])}),new se(f))}outline(n,r,i,s){if(r=r===void 0?n:r,this._linear){const _=this.normal(0),E=this.points[0],O=this.points[this.points.length-1];let x,A,j;i===void 0&&(i=n,s=r),x={x:E.x+_.x*n,y:E.y+_.y*n},j={x:O.x+_.x*i,y:O.y+_.y*i},A={x:(x.x+j.x)/2,y:(x.y+j.y)/2};const M=[x,A,j];x={x:E.x-_.x*r,y:E.y-_.y*r},j={x:O.x-_.x*s,y:O.y-_.y*s},A={x:(x.x+j.x)/2,y:(x.y+j.y)/2};const R=[j,A,x],F=q.makeline(R[2],M[0]),T=q.makeline(M[2],R[0]),D=[F,new se(M),T,new se(R)];return new Vt(D)}const a=this.reduce(),o=a.length,c=[];let d=[],f,h=0,u=this.length();const m=typeof i<"u"&&typeof s<"u";function p(_,E,O,x,A){return function(j){const M=x/O,R=(x+A)/O,F=E-_;return q.map(j,0,1,_+M*F,_+R*F)}}a.forEach(function(_){const E=_.length();m?(c.push(_.scale(p(n,i,u,h,E))),d.push(_.scale(p(-r,-s,u,h,E)))):(c.push(_.scale(n)),d.push(_.scale(-r))),h+=E}),d=d.map(function(_){return f=_.points,f[3]?_.points=[f[3],f[2],f[1],f[0]]:_.points=[f[2],f[1],f[0]],_}).reverse();const y=c[0].points[0],b=c[o-1].points[c[o-1].points.length-1],v=d[o-1].points[d[o-1].points.length-1],g=d[0].points[0],N=q.makeline(v,y),S=q.makeline(b,g),w=[N].concat(c).concat([S]).concat(d);return new Vt(w)}outlineshapes(n,r,i){r=r||n;const s=this.outline(n,r).curves,a=[];for(let o=1,c=s.length;o<c/2;o++){const d=q.makeshape(s[o],s[c-o],i);d.startcap.virtual=o>1,d.endcap.virtual=o<c/2-1,a.push(d)}return a}intersects(n,r){return n?n.p1&&n.p2?this.lineIntersects(n):(n instanceof se&&(n=n.reduce()),this.curveintersects(this.reduce(),n,r)):this.selfintersects(r)}lineIntersects(n){const r=ps(n.p1.x,n.p2.x),i=ps(n.p1.y,n.p2.y),s=ms(n.p1.x,n.p2.x),a=ms(n.p1.y,n.p2.y);return q.roots(this.points,n).filter(o=>{var c=this.get(o);return q.between(c.x,r,s)&&q.between(c.y,i,a)})}selfintersects(n){const r=this.reduce(),i=r.length-2,s=[];for(let a=0,o,c,d;a<i;a++)c=r.slice(a,a+1),d=r.slice(a+2),o=this.curveintersects(c,d,n),s.push(...o);return s}curveintersects(n,r,i){const s=[];n.forEach(function(o){r.forEach(function(c){o.overlaps(c)&&s.push({left:o,right:c})})});let a=[];return s.forEach(function(o){const c=q.pairiteration(o.left,o.right,i);c.length>0&&(a=a.concat(c))}),a}arcs(n){return n=n||.5,this._iterate(n,[])}_error(n,r,i,s){const a=(s-i)/4,o=this.get(i+a),c=this.get(s-a),d=q.dist(n,r),f=q.dist(n,o),h=q.dist(n,c);return Pt(f-d)+Pt(h-d)}_iterate(n,r){let i=0,s=1,a;do{a=0,s=1;let o=this.get(i),c,d,f,h,u=!1,m=!1,p,y=s,b=1;do if(m=u,h=f,y=(i+s)/2,c=this.get(y),d=this.get(s),f=q.getccenter(o,c,d),f.interval={start:i,end:s},u=this._error(f,o,i,s)<=n,p=m&&!u,p||(b=s),u){if(s>=1){if(f.interval.end=b=1,h=f,s>1){let g={x:f.x+f.r*Um(f.e),y:f.y+f.r*Hm(f.e)};f.e+=q.angle({x:f.x,y:f.y},g,this.get(1))}break}s=s+(s-i)/2}else s=y;while(!p&&a++<100);if(a>=100)break;h=h||f,r.push(h),i=b}while(s<1);return r}}function Ar(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function Vm(e){if(Array.isArray(e))return e}function Wm(e){if(Array.isArray(e))return Ar(e)}function Km(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ym(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,s,a,o,c=[],d=!0,f=!1;try{if(a=(r=r.call(e)).next,n!==0)for(;!(d=(i=a.call(r)).done)&&(c.push(i.value),c.length!==n);d=!0);}catch(h){f=!0,s=h}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(f)throw s}}return c}}function Jm(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xm(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qm(e,n){if(e==null)return{};var r,i,s=Zm(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],n.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Zm(e,n){if(e==null)return{};var r={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(n.includes(i))continue;r[i]=e[i]}return r}function eg(e,n){return Vm(e)||Ym(e,n)||fo(e,n)||Jm()}function tg(e){return Wm(e)||Km(e)||fo(e)||Xm()}function ng(e,n){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function rg(e){var n=ng(e,"string");return typeof n=="symbol"?n:n+""}function fo(e,n){if(e){if(typeof e=="string")return Ar(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ar(e,n):void 0}}var ig=(function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=(n instanceof Array?n.length?n:[void 0]:[n]).map(function(c){return{keyAccessor:c,isProp:!(c instanceof Function)}}),a=e.reduce(function(c,d){var f=c,h=d;return s.forEach(function(u,m){var p=u.keyAccessor,y=u.isProp,b;if(y){var v=h,g=v[p],N=Qm(v,[p].map(rg));b=g,h=N}else b=p(h,m);m+1<s.length?(f.hasOwnProperty(b)||(f[b]={}),f=f[b]):r?(f.hasOwnProperty(b)||(f[b]=[]),f[b].push(h)):f[b]=h}),c},{});r instanceof Function&&(function c(d){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;f===s.length?Object.keys(d).forEach(function(h){return d[h]=r(d[h])}):Object.values(d).forEach(function(h){return c(h,f+1)})})(a);var o=a;return i&&(o=[],(function c(d){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];f.length===s.length?o.push({keys:f,vals:d}):Object.entries(d).forEach(function(h){var u=eg(h,2),m=u[0],p=u[1];return c(p,[].concat(tg(f),[m]))})})(a),n instanceof Array&&n.length===0&&o.length===1&&(o[0].keys=[])),o});function sg(e,n){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(n).domain(e);break}return this}const gs=Symbol("implicit");function ho(){var e=new zi,n=[],r=[],i=gs;function s(a){let o=e.get(a);if(o===void 0){if(i!==gs)return i;e.set(a,o=n.push(a)-1)}return r[o%r.length]}return s.domain=function(a){if(!arguments.length)return n.slice();n=[],e=new zi;for(const o of a)e.has(o)||e.set(o,n.push(o)-1);return s},s.range=function(a){return arguments.length?(r=Array.from(a),s):r.slice()},s.unknown=function(a){return arguments.length?(i=a,s):i},s.copy=function(){return ho(n,r).unknown(i)},sg.apply(s,arguments),s}function ag(e){for(var n=e.length/6|0,r=new Array(n),i=0;i<n;)r[i]="#"+e.slice(i*6,++i*6);return r}const og=ag("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function lg(e,n){n===void 0&&(n={});var r=n.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var cg=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;lg(cg);function Tr(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function ug(e){if(Array.isArray(e))return e}function dg(e){if(Array.isArray(e))return Tr(e)}function xs(e,n,r){if(po())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,n);var s=new(e.bind.apply(e,i));return s}function rn(e,n,r){return(n=xg(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function po(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(po=function(){return!!e})()}function fg(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hg(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,s,a,o,c=[],d=!0,f=!1;try{if(a=(r=r.call(e)).next,n!==0)for(;!(d=(i=a.call(r)).done)&&(c.push(i.value),c.length!==n);d=!0);}catch(h){f=!0,s=h}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(f)throw s}}return c}}function pg(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mg(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ys(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,i)}return r}function yt(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?ys(Object(r),!0).forEach(function(i){rn(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ys(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Wt(e,n){return ug(e)||hg(e,n)||mo(e,n)||pg()}function Te(e){return dg(e)||fg(e)||mo(e)||mg()}function gg(e,n){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function xg(e){var n=gg(e,"string");return typeof n=="symbol"?n:n+""}function Er(e){"@babel/helpers - typeof";return Er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Er(e)}function mo(e,n){if(e){if(typeof e=="string")return Tr(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tr(e,n):void 0}}var yg=ho(og);function bs(e,n,r){!n||typeof r!="string"||e.filter(function(i){return!i[r]}).forEach(function(i){i[r]=yg(n(i))})}function bg(e,n){var r=e.nodes,i=e.links,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=s.nodeFilter,o=a===void 0?function(){return!0}:a,c=s.onLoopError,d=c===void 0?function(p){throw"Invalid DAG structure! Found cycle in node path: ".concat(p.join(" -> "),".")}:c,f={};r.forEach(function(p){return f[n(p)]={data:p,out:[],depth:-1,skip:!o(p)}}),i.forEach(function(p){var y=p.source,b=p.target,v=w(y),g=w(b);if(!f.hasOwnProperty(v))throw"Missing source node with id: ".concat(v);if(!f.hasOwnProperty(g))throw"Missing target node with id: ".concat(g);var N=f[v],S=f[g];N.out.push(S);function w(_){return Er(_)==="object"?n(_):_}});var h=[];m(Object.values(f));var u=Object.assign.apply(Object,[{}].concat(Te(Object.entries(f).filter(function(p){var y=Wt(p,2),b=y[1];return!b.skip}).map(function(p){var y=Wt(p,2),b=y[0],v=y[1];return rn({},b,v.depth)}))));return u;function m(p){for(var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,v=function(){var w=p[g];if(y.indexOf(w)!==-1){var _=[].concat(Te(y.slice(y.indexOf(w))),[w]).map(function(E){return n(E.data)});return h.some(function(E){return E.length===_.length&&E.every(function(O,x){return O===_[x]})})||(h.push(_),d(_)),1}b>w.depth&&(w.depth=b,m(w.out,[].concat(Te(y),[w]),b+(w.skip?0:1)))},g=0,N=p.length;g<N;g++)v()}}var vg=2,ge=function(n,r){return r.onNeedsRedraw&&r.onNeedsRedraw()},vs=function(n,r){if(!r.isShadow){var i=ee(r.linkDirectionalParticles);r.graphData.links.forEach(function(s){var a=Math.round(Math.abs(i(s)));a?s.__photons=Te(Array(a)).map(function(){return{}}):delete s.__photons})}},zn=Jr({props:{graphData:{default:{nodes:[],links:[]},onChange:function(n,r){r.engineRunning=!1,vs(n,r)}},dagMode:{onChange:function(n,r){!n&&(r.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(n){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:ge},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:ge},nodeColor:{default:"color",triggerUpdate:!1,onChange:ge},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:ge},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:ge},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:ge},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:ge},linkColor:{default:"color",triggerUpdate:!1,onChange:ge},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:ge},linkWidth:{default:1,triggerUpdate:!1,onChange:ge},linkCurvature:{default:0,triggerUpdate:!1,onChange:ge},linkCanvasObject:{triggerUpdate:!1,onChange:ge},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:ge},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:ge},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:ge},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:ge},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:vs},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleOffset:{default:0,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},linkDirectionalParticleCanvasObject:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(n,r){r.forceLayout.alphaDecay(n)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(n,r){r.forceLayout.alphaTarget(n)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(n,r){r.forceLayout.velocityDecay(n)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(n,r,i){return i===void 0?n.forceLayout.force(r):(n.forceLayout.force(r,i),this)},d3ReheatSimulation:function(n){return n.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(n){return n.cntTicks=0,n.startTickTime=new Date,n.engineRunning=!0,this},isEngineRunning:function(n){return!!n.engineRunning},tickFrame:function(n){return!n.isShadow&&r(),s(),!n.isShadow&&a(),!n.isShadow&&o(),i(),this;function r(){n.engineRunning&&(++n.cntTicks>n.cooldownTicks||new Date-n.startTickTime>n.cooldownTime||n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin?(n.engineRunning=!1,n.onEngineStop()):(n.forceLayout.tick(),n.onEngineTick()))}function i(){var c=ee(n.nodeVisibility),d=ee(n.nodeVal),f=ee(n.nodeColor),h=ee(n.nodeCanvasObjectMode),u=n.ctx,m=n.isShadow/n.globalScale,p=n.graphData.nodes.filter(c);u.save(),p.forEach(function(y){var b=h(y);if(n.nodeCanvasObject&&(b==="before"||b==="replace")&&(n.nodeCanvasObject(y,u,n.globalScale),b==="replace")){u.restore();return}var v=Math.sqrt(Math.max(0,d(y)||1))*n.nodeRelSize+m;u.beginPath(),u.arc(y.x,y.y,v,0,2*Math.PI,!1),u.fillStyle=f(y)||"rgba(31, 120, 180, 0.92)",u.fill(),n.nodeCanvasObject&&b==="after"&&n.nodeCanvasObject(y,n.ctx,n.globalScale)}),u.restore()}function s(){var c=ee(n.linkVisibility),d=ee(n.linkColor),f=ee(n.linkWidth),h=ee(n.linkLineDash),u=ee(n.linkCurvature),m=ee(n.linkCanvasObjectMode),p=n.ctx,y=n.isShadow*2,b=n.graphData.links.filter(c);b.forEach(E);var v=[],g=[],N=b;if(n.linkCanvasObject){var S=[],w=[];b.forEach(function(O){return({before:v,after:g,replace:S}[m(O)]||w).push(O)}),N=[].concat(Te(v),g,w),v=v.concat(S)}p.save(),v.forEach(function(O){return n.linkCanvasObject(O,p,n.globalScale)}),p.restore();var _=ig(N,[d,f,h]);p.save(),Object.entries(_).forEach(function(O){var x=Wt(O,2),A=x[0],j=x[1],M=!A||A==="undefined"?"rgba(0,0,0,0.15)":A;Object.entries(j).forEach(function(R){var F=Wt(R,2),T=F[0],D=F[1],k=(T||1)/n.globalScale+y;Object.entries(D).forEach(function(I){var z=Wt(I,2);z[0];var L=z[1],H=h(L[0]);p.beginPath(),L.forEach(function(K){var Y=K.source,$=K.target;if(!(!Y||!$||!Y.hasOwnProperty("x")||!$.hasOwnProperty("x"))){p.moveTo(Y.x,Y.y);var B=K.__controlPoints;B?p[B.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(p,Te(B).concat([$.x,$.y])):p.lineTo($.x,$.y)}}),p.strokeStyle=M,p.lineWidth=k,p.setLineDash(H||[]),p.stroke()})})}),p.restore(),p.save(),g.forEach(function(O){return n.linkCanvasObject(O,p,n.globalScale)}),p.restore();function E(O){var x=u(O);if(!x){O.__controlPoints=null;return}var A=O.source,j=O.target;if(!(!A||!j||!A.hasOwnProperty("x")||!j.hasOwnProperty("x"))){var M=Math.sqrt(Math.pow(j.x-A.x,2)+Math.pow(j.y-A.y,2));if(M>0){var R=Math.atan2(j.y-A.y,j.x-A.x),F=M*x,T={x:(A.x+j.x)/2+F*Math.cos(R-Math.PI/2),y:(A.y+j.y)/2+F*Math.sin(R-Math.PI/2)};O.__controlPoints=[T.x,T.y]}else{var D=x*70;O.__controlPoints=[j.x,j.y-D,j.x+D,j.y]}}}}function a(){var c=1.6,d=.2,f=ee(n.linkDirectionalArrowLength),h=ee(n.linkDirectionalArrowRelPos),u=ee(n.linkVisibility),m=ee(n.linkDirectionalArrowColor||n.linkColor),p=ee(n.nodeVal),y=n.ctx;y.save(),n.graphData.links.filter(u).forEach(function(b){var v=f(b);if(!(!v||v<0)){var g=b.source,N=b.target;if(!(!g||!N||!g.hasOwnProperty("x")||!N.hasOwnProperty("x"))){var S=Math.sqrt(Math.max(0,p(g)||1))*n.nodeRelSize,w=Math.sqrt(Math.max(0,p(N)||1))*n.nodeRelSize,_=Math.min(1,Math.max(0,h(b))),E=m(b)||"rgba(0,0,0,0.28)",O=v/c/2,x=b.__controlPoints&&xs(se,[g.x,g.y].concat(Te(b.__controlPoints),[N.x,N.y])),A=x?function(k){return x.get(k)}:function(k){return{x:g.x+(N.x-g.x)*k||0,y:g.y+(N.y-g.y)*k||0}},j=x?x.length():Math.sqrt(Math.pow(N.x-g.x,2)+Math.pow(N.y-g.y,2)),M=S+v+(j-S-w-v)*_,R=A(M/j),F=A((M-v)/j),T=A((M-v*(1-d))/j),D=Math.atan2(R.y-F.y,R.x-F.x)-Math.PI/2;y.beginPath(),y.moveTo(R.x,R.y),y.lineTo(F.x+O*Math.cos(D),F.y+O*Math.sin(D)),y.lineTo(T.x,T.y),y.lineTo(F.x-O*Math.cos(D),F.y-O*Math.sin(D)),y.fillStyle=E,y.fill()}}}),y.restore()}function o(){var c=ee(n.linkDirectionalParticles),d=ee(n.linkDirectionalParticleSpeed),f=ee(n.linkDirectionalParticleOffset),h=ee(n.linkDirectionalParticleWidth),u=ee(n.linkVisibility),m=ee(n.linkDirectionalParticleColor||n.linkColor),p=n.ctx;p.save(),n.graphData.links.filter(u).forEach(function(y){var b=c(y);if(!(!y.hasOwnProperty("__photons")||!y.__photons.length)){var v=y.source,g=y.target;if(!(!v||!g||!v.hasOwnProperty("x")||!g.hasOwnProperty("x"))){var N=d(y),S=Math.abs(f(y)),w=y.__photons||[],_=Math.max(0,h(y)/2)/Math.sqrt(n.globalScale),E=m(y)||"rgba(0,0,0,0.28)";p.fillStyle=E;var O=y.__controlPoints?xs(se,[v.x,v.y].concat(Te(y.__controlPoints),[g.x,g.y])):null,x=0,A=!1;w.forEach(function(j){var M=!!j.__singleHop;if(j.hasOwnProperty("__progressRatio")||(j.__progressRatio=M?0:(x+S)/b),!M&&x++,j.__progressRatio+=N,j.__progressRatio>=1)if(!M)j.__progressRatio=j.__progressRatio%1;else{A=!0;return}var R=j.__progressRatio,F=O?O.get(R):{x:v.x+(g.x-v.x)*R||0,y:v.y+(g.y-v.y)*R||0};n.linkDirectionalParticleCanvasObject?n.linkDirectionalParticleCanvasObject(F.x,F.y,y,p,n.globalScale):(p.beginPath(),p.arc(F.x,F.y,_,0,2*Math.PI,!1),p.fill())}),A&&(y.__photons=y.__photons.filter(function(j){return!j.__singleHop||j.__progressRatio<=1}))}}}),p.restore()}},emitParticle:function(n,r){return r&&(!r.__photons&&(r.__photons=[]),r.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:Dm().force("link",Am()).force("charge",zm()).force("center",Ep()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(n,r){r.ctx=n},update:function(n,r){n.engineRunning=!1,n.onUpdate(),n.nodeAutoColorBy!==null&&bs(n.graphData.nodes,ee(n.nodeAutoColorBy),n.nodeColor),n.linkAutoColorBy!==null&&bs(n.graphData.links,ee(n.linkAutoColorBy),n.linkColor),n.graphData.links.forEach(function(m){m.source=m[n.linkSource],m.target=m[n.linkTarget]}),n.forceLayout.stop().alpha(1).nodes(n.graphData.nodes);var i=n.forceLayout.force("link");i&&i.id(function(m){return m[n.nodeId]}).links(n.graphData.links);var s=n.dagMode&&bg(n.graphData,function(m){return m[n.nodeId]},{nodeFilter:n.dagNodeFilter,onLoopError:n.onDagError||void 0}),a=Math.max.apply(Math,Te(Object.values(s||[]))),o=n.dagLevelDistance||n.graphData.nodes.length/(a||1)*vg*(["radialin","radialout"].indexOf(n.dagMode)!==-1?.7:1);if(["lr","rl","td","bu"].includes(r.dagMode)){var c=["lr","rl"].includes(r.dagMode)?"fx":"fy";n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(m){return delete m[c]})}if(["lr","rl","td","bu"].includes(n.dagMode)){var d=["rl","bu"].includes(n.dagMode),f=function(p){return(s[p[n.nodeId]]-a/2)*o*(d?-1:1)},h=["lr","rl"].includes(n.dagMode)?"fx":"fy";n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(m){return m[h]=f(m)})}n.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(n.dagMode)!==-1?$m(function(m){var p=s[m[n.nodeId]]||-1;return(n.dagMode==="radialin"?a-p:p)*o}).strength(function(m){return n.dagNodeFilter(m)?1:0}):null);for(var u=0;u<n.warmupTicks&&!(n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin);u++)n.forceLayout.tick();this.resetCountdown(),n.onFinishUpdate()}});function go(e,n){var r=e instanceof Array?e:[e],i=new n;return i._destructor&&i._destructor(),{linkProp:function(a){return{default:i[a](),onChange:function(c,d){r.forEach(function(f){return d[f][a](c)})},triggerUpdate:!1}},linkMethod:function(a){return function(o){for(var c=arguments.length,d=new Array(c>1?c-1:0),f=1;f<c;f++)d[f-1]=arguments[f];var h=[];return r.forEach(function(u){var m=o[u],p=m[a].apply(m,d);p!==m&&h.push(p)}),h.length?h[0]:this}}}}var _g=800,wg=4,Ng=5,xo=go("forceGraph",zn),jg=go(["forceGraph","shadowGraph"],zn),kg=Object.assign.apply(Object,Te(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleOffset","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleCanvasObject","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(e){return rn({},e,xo.linkProp(e))})).concat(Te(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(e){return rn({},e,jg.linkProp(e))})))),Sg=Object.assign.apply(Object,Te(["d3Force","d3ReheatSimulation","emitParticle"].map(function(e){return rn({},e,xo.linkMethod(e))})));function ir(e){if(e.canvas){var n=e.canvas.width,r=e.canvas.height;n===300&&r===150&&(n=r=0);var i=window.devicePixelRatio;n/=i,r/=i,[e.canvas,e.shadowCanvas].forEach(function(a){a.style.width="".concat(e.width,"px"),a.style.height="".concat(e.height,"px"),a.width=e.width*i,a.height=e.height*i,!n&&!r&&a.getContext("2d").scale(i,i)});var s=ze(e.canvas).k;e.zoom.translateBy(e.zoom.__baseElem,(e.width-n)/2/s,(e.height-r)/2/s),e.needsRedraw=!0}}function yo(e){var n=window.devicePixelRatio;e.setTransform(n,0,0,n,0,0)}function _s(e,n,r){e.save(),yo(e),e.clearRect(0,0,n,r),e.restore()}var Cg=Jr({props:yt({width:{default:window.innerWidth,onChange:function(n,r){return ir(r)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(n,r){return ir(r)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(n,r){[n.nodes,n.links].every(function(s){return(s||[]).every(function(a){return!a.hasOwnProperty("__indexColor")})})&&r.colorTracker.reset(),[{type:"Node",objs:n.nodes},{type:"Link",objs:n.links}].forEach(i),r.forceGraph.graphData(n),r.shadowGraph.graphData(n);function i(s){var a=s.type,o=s.objs;o.filter(function(c){if(!c.hasOwnProperty("__indexColor"))return!0;var d=r.colorTracker.lookup(c.__indexColor);return!d||!d.hasOwnProperty("d")||d.d!==c}).forEach(function(c){c.__indexColor=r.colorTracker.register({type:a,d:c})})}},triggerUpdate:!1},backgroundColor:{onChange:function(n,r){r.canvas&&n&&(r.canvas.style.background=n)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(n,r){r.shadowGraph.nodeCanvasObject(n?function(i,s,a){return n(i,i.__indexColor,s,a)}:null),r.flushShadowCanvas&&r.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(n,r){r.shadowGraph.linkCanvasObject(n?function(i,s,a){return n(i,i.__indexColor,s,a)}:null),r.flushShadowCanvas&&r.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(n,r){r.zoom.scaleExtent([n,r.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(n,r){r.zoom.scaleExtent([r.zoom.scaleExtent()[0],n])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(n,r){r.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},showPointerCursor:{default:!0,triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},kg),aliases:{stopAnimation:"pauseAnimation"},methods:yt({graph2ScreenCoords:function(n,r,i){var s=ze(n.canvas);return{x:r*s.k+s.x,y:i*s.k+s.y}},screen2GraphCoords:function(n,r,i){var s=ze(n.canvas);return{x:(r-s.x)/s.k,y:(i-s.y)/s.k}},centerAt:function(n,r,i,s){if(!n.canvas)return null;if(r!==void 0||i!==void 0){var a=Object.assign({},r!==void 0?{x:r}:{},i!==void 0?{y:i}:{});return s?n.tweenGroup.add(new Bi(o()).to(a,s).easing(pt.Quadratic.Out).onUpdate(c).start()):c(a),this}return o();function o(){var d=ze(n.canvas);return{x:(n.width/2-d.x)/d.k,y:(n.height/2-d.y)/d.k}}function c(d){var f=d.x,h=d.y;n.zoom.translateTo(n.zoom.__baseElem,f===void 0?o().x:f,h===void 0?o().y:h),n.needsRedraw=!0}},zoom:function(n,r,i){if(!n.canvas)return null;if(r!==void 0)return i?n.tweenGroup.add(new Bi({k:s()}).to({k:r},i).easing(pt.Quadratic.Out).onUpdate(function(o){var c=o.k;return a(c)}).start()):a(r),this;return s();function s(){return ze(n.canvas).k}function a(o){n.zoom.scaleTo(n.zoom.__baseElem,o),n.needsRedraw=!0}},zoomToFit:function(n){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,s=arguments.length,a=new Array(s>3?s-3:0),o=3;o<s;o++)a[o-3]=arguments[o];var c=this.getGraphBbox.apply(this,a);if(c){var d={x:(c.x[0]+c.x[1])/2,y:(c.y[0]+c.y[1])/2},f=Math.max(1e-12,Math.min(1e12,(n.width-i*2)/(c.x[1]-c.x[0]),(n.height-i*2)/(c.y[1]-c.y[0])));this.centerAt(d.x,d.y,r),this.zoom(f,r)}return this},getGraphBbox:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=ee(n.nodeVal),s=function(c){return Math.sqrt(Math.max(0,i(c)||1))*n.nodeRelSize},a=n.graphData.nodes.filter(r).map(function(o){return{x:o.x,y:o.y,r:s(o)}});return a.length?{x:[Li(a,function(o){return o.x-o.r}),Fi(a,function(o){return o.x+o.r})],y:[Li(a,function(o){return o.y-o.r}),Fi(a,function(o){return o.y+o.r})]}:null},pauseAnimation:function(n){return n.animationFrameRequestId&&(cancelAnimationFrame(n.animationFrameRequestId),n.animationFrameRequestId=null),this},resumeAnimation:function(n){return n.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},Sg),stateInit:function(){return{lastSetZoom:1,zoom:$f(),forceGraph:new zn,shadowGraph:new zn().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new lp,tweenGroup:new Fa}},init:function(n,r){var i=this;n.innerHTML="";var s=document.createElement("div");s.classList.add("force-graph-container"),s.style.position="relative",n.appendChild(s),r.canvas=document.createElement("canvas"),r.backgroundColor&&(r.canvas.style.background=r.backgroundColor),s.appendChild(r.canvas),r.shadowCanvas=document.createElement("canvas");var a=r.canvas.getContext("2d"),o=r.shadowCanvas.getContext("2d",{willReadFrequently:!0}),c={x:-1e12,y:-1e12},d=function(){var u=null,m=window.devicePixelRatio,p=c.x>0&&c.y>0?o.getImageData(c.x*m,c.y*m,1,1):null;return p&&(u=r.colorTracker.lookup(p.data)),u};Ae(r.canvas).call(Wu().subject(function(){if(!r.enableNodeDrag)return null;var h=d();return h&&h.type==="Node"?h.d:null}).on("start",function(h){var u=h.subject;u.__initialDragPos={x:u.x,y:u.y,fx:u.fx,fy:u.fy},h.active||(u.fx=u.x,u.fy=u.y),r.canvas.classList.add("grabbable")}).on("drag",function(h){var u=h.subject,m=u.__initialDragPos,p=h,y=ze(r.canvas).k,b={x:m.x+(p.x-m.x)/y-u.x,y:m.y+(p.y-m.y)/y-u.y};["x","y"].forEach(function(v){return u["f".concat(v)]=u[v]=m[v]+(p[v]-m[v])/y}),!(!u.__dragged&&Ng>=Math.sqrt(Uf(["x","y"].map(function(v){return Math.pow(h[v]-m[v],2)}))))&&(r.forceGraph.d3AlphaTarget(.3).resetCountdown(),r.isPointerDragging=!0,u.__dragged=!0,r.onNodeDrag(u,b))}).on("end",function(h){var u=h.subject,m=u.__initialDragPos,p={x:u.x-m.x,y:u.y-m.y};m.fx===void 0&&(u.fx=void 0),m.fy===void 0&&(u.fy=void 0),delete u.__initialDragPos,r.forceGraph.d3AlphaTarget()&&r.forceGraph.d3AlphaTarget(0).resetCountdown(),r.canvas.classList.remove("grabbable"),r.isPointerDragging=!1,u.__dragged&&(delete u.__dragged,r.onNodeDragEnd(u,p))})),r.zoom(r.zoom.__baseElem=Ae(r.canvas)),r.zoom.__baseElem.on("dblclick.zoom",null),r.zoom.filter(function(h){return!h.button&&r.enableZoomPanInteraction&&(h.type!=="wheel"||ee(r.enableZoomInteraction)(h))&&(h.type==="wheel"||ee(r.enablePanInteraction)(h))}).on("zoom",function(h){var u=h.transform;[a,o].forEach(function(m){yo(m),m.translate(u.x,u.y),m.scale(u.k,u.k)}),r.isPointerDragging=!0,r.onZoom&&r.onZoom(yt(yt({},u),i.centerAt())),r.needsRedraw=!0}).on("end",function(h){r.isPointerDragging=!1,r.onZoomEnd&&r.onZoomEnd(yt(yt({},h.transform),i.centerAt()))}),ir(r),r.forceGraph.onNeedsRedraw(function(){return r.needsRedraw=!0}).onFinishUpdate(function(){ze(r.canvas).k===r.lastSetZoom&&r.graphData.nodes.length&&(r.zoom.scaleTo(r.zoom.__baseElem,r.lastSetZoom=wg/Math.cbrt(r.graphData.nodes.length)),r.needsRedraw=!0)}),r.tooltip=new Tp(s),["pointermove","pointerdown"].forEach(function(h){return s.addEventListener(h,function(u){h==="pointerdown"&&(r.isPointerPressed=!0,r.pointerDownEvent=u),!r.isPointerDragging&&u.type==="pointermove"&&r.onBackgroundClick&&(u.pressure>0||r.isPointerPressed)&&(u.pointerType==="mouse"||u.movementX===void 0||[u.movementX,u.movementY].some(function(y){return Math.abs(y)>1}))&&(r.isPointerDragging=!0);var m=p(s);c.x=u.pageX-m.left,c.y=u.pageY-m.top;function p(y){var b=y.getBoundingClientRect(),v=window.pageXOffset||document.documentElement.scrollLeft,g=window.pageYOffset||document.documentElement.scrollTop;return{top:b.top+g,left:b.left+v}}},{passive:!0})}),s.addEventListener("pointerup",function(h){if(r.isPointerPressed){if(r.isPointerPressed=!1,r.isPointerDragging){r.isPointerDragging=!1;return}var u=[h,r.pointerDownEvent];requestAnimationFrame(function(){if(h.button===0)if(r.hoverObj){var m=r["on".concat(r.hoverObj.type,"Click")];m&&m.apply(void 0,[r.hoverObj.d].concat(u))}else r.onBackgroundClick&&r.onBackgroundClick.apply(r,u);if(h.button===2)if(r.hoverObj){var p=r["on".concat(r.hoverObj.type,"RightClick")];p&&p.apply(void 0,[r.hoverObj.d].concat(u))}else r.onBackgroundRightClick&&r.onBackgroundRightClick.apply(r,u)})}},{passive:!0}),s.addEventListener("contextmenu",function(h){return!r.onBackgroundRightClick&&!r.onNodeRightClick&&!r.onLinkRightClick?!0:(h.preventDefault(),!1)}),r.forceGraph(a),r.shadowGraph(o);var f=mh(function(){_s(o,r.width,r.height),r.shadowGraph.linkWidth(function(u){return ee(r.linkWidth)(u)+r.linkHoverPrecision});var h=ze(r.canvas);r.shadowGraph.globalScale(h.k).tickFrame()},_g);r.flushShadowCanvas=f.flush,(this._animationCycle=function h(){var u=!r.autoPauseRedraw||!!r.needsRedraw||r.forceGraph.isEngineRunning()||r.graphData.links.some(function(S){return S.__photons&&S.__photons.length});if(r.needsRedraw=!1,r.enablePointerInteraction){var m=r.isPointerDragging?null:d();if(m!==r.hoverObj){var p=r.hoverObj,y=p?p.type:null,b=m?m.type:null;if(y&&y!==b){var v=r["on".concat(y,"Hover")];v&&v(null,p.d)}if(b){var g=r["on".concat(b,"Hover")];g&&g(m.d,y===b?p.d:null)}r.tooltip.content(m&&ee(r["".concat(m.type.toLowerCase(),"Label")])(m.d)||null),r.canvas.classList[(m&&r["on".concat(b,"Click")]||!m&&r.onBackgroundClick)&&ee(r.showPointerCursor)(m?.d)?"add":"remove"]("clickable"),r.hoverObj=m}u&&f()}if(u){_s(a,r.width,r.height);var N=ze(r.canvas).k;r.onRenderFramePre&&r.onRenderFramePre(a,N),r.forceGraph.globalScale(N).tickFrame(),r.onRenderFramePost&&r.onRenderFramePost(a,N)}r.tweenGroup.update(),r.animationFrameRequestId=requestAnimationFrame(h)})()},update:function(n){}}),sr={exports:{}},ar,ws;function Ag(){if(ws)return ar;ws=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ar=e,ar}var or,Ns;function Tg(){if(Ns)return or;Ns=1;var e=Ag();function n(){}function r(){}return r.resetWarningCache=n,or=function(){function i(o,c,d,f,h,u){if(u!==e){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}i.isRequired=i;function s(){return i}var a={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:s,element:i,elementType:i,instanceOf:s,node:i,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:n};return a.PropTypes=a,a},or}var js;function Eg(){return js||(js=1,sr.exports=Tg()()),sr.exports}var Og=Eg();const C=Ro(Og),Vn={width:C.number,height:C.number,graphData:C.shape({nodes:C.arrayOf(C.object).isRequired,links:C.arrayOf(C.object).isRequired}),backgroundColor:C.string,nodeRelSize:C.number,nodeId:C.string,nodeLabel:C.oneOfType([C.string,C.func]),nodeVal:C.oneOfType([C.number,C.string,C.func]),nodeVisibility:C.oneOfType([C.bool,C.string,C.func]),nodeColor:C.oneOfType([C.string,C.func]),nodeAutoColorBy:C.oneOfType([C.string,C.func]),onNodeHover:C.func,onNodeClick:C.func,linkSource:C.string,linkTarget:C.string,linkLabel:C.oneOfType([C.string,C.func]),linkVisibility:C.oneOfType([C.bool,C.string,C.func]),linkColor:C.oneOfType([C.string,C.func]),linkAutoColorBy:C.oneOfType([C.string,C.func]),linkWidth:C.oneOfType([C.number,C.string,C.func]),linkCurvature:C.oneOfType([C.number,C.string,C.func]),linkDirectionalArrowLength:C.oneOfType([C.number,C.string,C.func]),linkDirectionalArrowColor:C.oneOfType([C.string,C.func]),linkDirectionalArrowRelPos:C.oneOfType([C.number,C.string,C.func]),linkDirectionalParticles:C.oneOfType([C.number,C.string,C.func]),linkDirectionalParticleSpeed:C.oneOfType([C.number,C.string,C.func]),linkDirectionalParticleOffset:C.oneOfType([C.number,C.string,C.func]),linkDirectionalParticleWidth:C.oneOfType([C.number,C.string,C.func]),linkDirectionalParticleColor:C.oneOfType([C.string,C.func]),onLinkHover:C.func,onLinkClick:C.func,dagMode:C.oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:C.number,dagNodeFilter:C.func,onDagError:C.func,d3AlphaMin:C.number,d3AlphaDecay:C.number,d3VelocityDecay:C.number,warmupTicks:C.number,cooldownTicks:C.number,cooldownTime:C.number,onEngineTick:C.func,onEngineStop:C.func,getGraphBbox:C.func},bo={zoomToFit:C.func,onNodeRightClick:C.func,onNodeDrag:C.func,onNodeDragEnd:C.func,onLinkRightClick:C.func,linkHoverPrecision:C.number,onBackgroundClick:C.func,onBackgroundRightClick:C.func,showPointerCursor:C.oneOfType([C.bool,C.func]),enablePointerInteraction:C.bool,enableNodeDrag:C.bool},ii={showNavInfo:C.bool,nodeOpacity:C.number,nodeResolution:C.number,nodeThreeObject:C.oneOfType([C.object,C.string,C.func]),nodeThreeObjectExtend:C.oneOfType([C.bool,C.string,C.func]),nodePositionUpdate:C.func,linkOpacity:C.number,linkResolution:C.number,linkCurveRotation:C.oneOfType([C.number,C.string,C.func]),linkMaterial:C.oneOfType([C.object,C.string,C.func]),linkThreeObject:C.oneOfType([C.object,C.string,C.func]),linkThreeObjectExtend:C.oneOfType([C.bool,C.string,C.func]),linkPositionUpdate:C.func,linkDirectionalArrowResolution:C.number,linkDirectionalParticleResolution:C.number,linkDirectionalParticleThreeObject:C.oneOfType([C.object,C.string,C.func]),forceEngine:C.oneOf(["d3","ngraph"]),ngraphPhysics:C.object,numDimensions:C.oneOf([1,2,3])},Mg=Object.assign({},Vn,bo,{linkLineDash:C.oneOfType([C.arrayOf(C.number),C.string,C.func]),nodeCanvasObjectMode:C.oneOfType([C.string,C.func]),nodeCanvasObject:C.func,nodePointerAreaPaint:C.func,linkCanvasObjectMode:C.oneOfType([C.string,C.func]),linkCanvasObject:C.func,linkPointerAreaPaint:C.func,linkDirectionalParticleCanvasObject:C.func,autoPauseRedraw:C.bool,minZoom:C.number,maxZoom:C.number,enableZoomInteraction:C.oneOfType([C.bool,C.func]),enablePanInteraction:C.oneOfType([C.bool,C.func]),onZoom:C.func,onZoomEnd:C.func,onRenderFramePre:C.func,onRenderFramePost:C.func});Object.assign({},Vn,bo,ii,{enableNavigationControls:C.bool,controlType:C.oneOf(["trackball","orbit","fly"]),rendererConfig:C.object,extraRenderers:C.arrayOf(C.shape({render:C.func.isRequired}))});Object.assign({},Vn,ii,{nodeDesc:C.oneOfType([C.string,C.func]),linkDesc:C.oneOfType([C.string,C.func])});Object.assign({},Vn,ii,{markerAttrs:C.object,yOffset:C.number,glScale:C.number});const Wn=sc(Cg,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"]});Wn.displayName="ForceGraph2D";Wn.propTypes=Mg;const vo={"":"#6366f1",School:"#22d3ee",Clinical:"#f472b6",Research:"#a78bfa",Personal:"#34d399"};function ks(e){const n=e.split("/")[0];return vo[n]||"#6366f1"}function Pg({onNodeClick:e}){const n=P.useRef(null),r=P.useRef(),[i,s]=P.useState({nodes:[],links:[]}),[a,o]=P.useState(!0),[c,d]=P.useState(null),[f,h]=P.useState(null),[u,m]=P.useState(null),[p,y]=P.useState(1),[b,v]=P.useState(new Set),[g,N]=P.useState(!1);P.useEffect(()=>{const j=n.current;if(!j)return;const M=()=>{const F=j.getBoundingClientRect();h({width:Math.max(1,Math.floor(F.width)-2),height:Math.max(1,Math.floor(F.height)-2)})};M();const R=new ResizeObserver(M);return R.observe(j),()=>R.disconnect()},[]),P.useEffect(()=>{let j=!1;return o(!0),V.obsidian.getGraph().then(M=>{j||(M.success?s({nodes:M.nodes,links:M.links}):d("Failed to load graph data"),o(!1))}).catch(()=>{j||(d("Network error loading graph"),o(!1))}),()=>{j=!0}},[]);const S=P.useMemo(()=>{const j=new Set;for(const M of i.nodes){const R=M.folder?.split("/")[0]||"(root)";j.add(R)}return Array.from(j).sort()},[i.nodes]);P.useEffect(()=>{S.length>0&&!g&&(N(!0),v(new Set(S)))},[S,g]);const w=P.useMemo(()=>{if(b.size===0||b.size===S.length)return i;const j=new Set,M=i.nodes.filter(F=>{const T=F.folder?.split("/")[0]||"(root)",D=b.has(T);return D&&j.add(F.id),D}),R=i.links.filter(F=>{const T=typeof F.source=="string"?F.source:F.source.id,D=typeof F.target=="string"?F.target:F.target.id;return j.has(T)&&j.has(D)});return{nodes:M,links:R}},[i,b,S.length]),_=j=>{v(M=>{const R=new Set(M);return R.has(j)?R.delete(j):R.add(j),R})},E=P.useCallback(j=>{e?.(j.name)},[e]),O=P.useCallback(j=>{const M=Math.max(.1,Math.min(10,j));y(M);const R=r.current;R?.zoom&&R.zoom(M,200)},[]),x=P.useCallback((j,M,R)=>{const F=j.name,T=Math.max(10/R,2),D=Math.max(4,3+w.links.filter(z=>(typeof z.source=="string"?z.source:z.source.id)===j.id||(typeof z.target=="string"?z.target:z.target.id)===j.id).length*.5),k=ks(j.folder),I=u?.id===j.id;M.beginPath(),M.arc(j.x||0,j.y||0,D,0,2*Math.PI),M.fillStyle=I?"#ffffff":k,M.fill(),(I||R>1.5)&&(M.font=`${T}px monospace`,M.textAlign="center",M.textBaseline="top",M.fillStyle="rgba(255,255,255,0.9)",M.fillText(F,j.x||0,(j.y||0)+D+2))},[w.links,u]),A=!a&&!c&&f;return l.jsxs("div",{className:"flex h-full",children:[l.jsx("div",{className:"w-[180px] shrink-0 border-r border-secondary/30 bg-black/60",children:l.jsx(Ie,{className:"h-full",children:l.jsxs("div",{className:"p-3 space-y-3",children:[l.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"FOLDERS"}),l.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer",children:[l.jsx(ve,{checked:b.size===S.length,onCheckedChange:j=>{v(j?new Set(S):new Set)},className:"border-primary data-[state=checked]:bg-primary"}),l.jsx("span",{className:"font-terminal text-xs text-primary",children:"All Folders"})]}),S.map(j=>l.jsxs("label",{className:"flex items-center gap-2 py-0.5 cursor-pointer",children:[l.jsx(ve,{checked:b.has(j),onCheckedChange:()=>_(j),className:"border-primary data-[state=checked]:bg-primary"}),l.jsx("span",{className:"font-terminal text-xs truncate",style:{color:ks(j==="(root)"?"":j)},children:j})]},j)),l.jsxs("div",{className:"pt-2 border-t border-secondary/30 space-y-1",children:[l.jsx("div",{className:"font-arcade text-[10px] text-muted-foreground mb-1",children:"COLORS"}),Object.entries(vo).filter(([j])=>j).map(([j,M])=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:M}}),l.jsx("span",{className:"font-terminal text-[10px]",style:{color:M},children:j})]},j))]}),l.jsxs("div",{className:"pt-2 border-t border-secondary/30 font-terminal text-[10px] text-muted-foreground",children:[l.jsxs("div",{children:["Notes: ",w.nodes.length]}),l.jsxs("div",{children:["Links: ",w.links.length]})]})]})})}),l.jsxs("div",{ref:n,className:"flex-1 relative bg-black/80 rounded border border-primary/30 overflow-hidden",children:[a&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-primary font-terminal z-10",children:l.jsx("div",{className:"animate-pulse",children:"SCANNING VAULT CONNECTIONS..."})}),c&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-red-400 font-terminal z-10",children:c}),A&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"absolute top-2 left-2 right-2 z-10 flex items-center justify-between pointer-events-none",children:[l.jsx("div",{className:"flex items-center gap-2 pointer-events-auto",children:l.jsx("button",{onClick:()=>{r.current?.zoomToFit?.(400,40),setTimeout(()=>{const j=r.current;j?.zoom&&y(j.zoom())},450)},className:"px-2 py-0.5 text-xs font-terminal bg-primary/20 border border-primary/40 text-primary hover:bg-primary/30 rounded-none",children:"CENTER"})}),l.jsxs("div",{className:"flex items-center gap-1.5 pointer-events-auto bg-black/70 border border-primary/30 rounded-none px-2 py-1",children:[l.jsx("button",{onClick:()=>O(p/1.3),className:"text-primary hover:text-white font-mono text-sm w-5 h-5 flex items-center justify-center",children:"-"}),l.jsx("input",{type:"range",min:-2.3,max:2.3,step:.01,value:Math.log(p),onChange:j=>O(Math.exp(parseFloat(j.target.value))),className:"w-24 h-1 accent-primary cursor-pointer"}),l.jsx("button",{onClick:()=>O(p*1.3),className:"text-primary hover:text-white font-mono text-sm w-5 h-5 flex items-center justify-center",children:"+"}),l.jsxs("span",{className:"text-[10px] font-terminal text-primary/50 w-8 text-right",children:[Math.round(p*100),"%"]})]})]}),l.jsx(Wn,{ref:r,graphData:w,width:f.width,height:f.height,nodeCanvasObject:x,nodePointerAreaPaint:(j,M,R)=>{R.beginPath(),R.arc(j.x||0,j.y||0,6,0,2*Math.PI),R.fillStyle=M,R.fill()},onNodeClick:E,onNodeHover:j=>m(j),onZoom:({k:j})=>y(j),linkColor:()=>"rgba(99, 102, 241, 0.15)",linkWidth:.5,backgroundColor:"transparent",cooldownTicks:100,d3AlphaDecay:.02,d3VelocityDecay:.3})]})]})]})}const Rg={course:"#22d3ee",module:"#facc15",lo:"#4ade80"},Ig={course:"rgba(34,211,238,0.15)",module:"rgba(250,204,21,0.12)",lo:"rgba(74,222,128,0.08)"};function Dg(){const e=P.useRef(null),n=P.useRef(null),r=P.useRef(!1),[i,s]=P.useState(null),[a,o]=P.useState(new Set),[c,d]=P.useState(new Set),[f,h]=P.useState(!0),[u,m]=P.useState(null),{data:p=[]}=Q({queryKey:["courses"],queryFn:()=>V.courses.getActive()}),y=p.map(x=>x.id).sort(),{data:b=[]}=Q({queryKey:["modules","all",y],queryFn:async()=>(await Promise.all(p.map(A=>V.modules.getByCourse(A.id)))).flat(),enabled:p.length>0}),{data:v=[]}=Q({queryKey:["learningObjectives","all",y,f],queryFn:async()=>(await Promise.all(p.map(A=>V.learningObjectives.getByCourse(A.id)))).flat(),enabled:p.length>0&&f});P.useEffect(()=>{const x=e.current;if(!x)return;const A=()=>{const M=x.getBoundingClientRect();s({width:Math.max(1,Math.floor(M.width)-2),height:Math.max(1,Math.floor(M.height)-2)})};A();const j=new ResizeObserver(A);return j.observe(x),()=>j.disconnect()},[]),P.useEffect(()=>{p.length>0&&!r.current&&(r.current=!0,o(new Set(p.map(x=>x.id))))},[p]);const g=P.useMemo(()=>{const x=[],A=[],j=new Map;for(const R of b){const F=j.get(R.courseId)??[];F.push(R),j.set(R.courseId,F)}const M=new Map;for(const R of v){const F=M.get(R.moduleId)??[];F.push(R),M.set(R.moduleId,F)}for(const R of p){if(!a.has(R.id))continue;const F=`course-${R.id}`;x.push({id:F,name:R.name,type:"course"});const T=j.get(R.id)??[];for(const D of T){if(c.size>0&&!c.has(D.id))continue;const k=`module-${D.id}`;if(x.push({id:k,name:D.name,type:"module"}),A.push({source:F,target:k}),f){const I=M.get(D.id)??[];for(const z of I){const L=`lo-${z.id}`;x.push({id:L,name:`${z.loCode}: ${z.title}`,type:"lo"}),A.push({source:k,target:L})}}}}return{nodes:x,links:A}},[p,b,v,a,c,f]),N=x=>{o(A=>{const j=new Set(A);return j.has(x)?j.delete(x):j.add(x),j})},S=x=>{d(A=>{const j=new Set(A);return j.has(x)?j.delete(x):j.add(x),j})},w=P.useCallback((x,A,j)=>{const M=Rg[x.type]||"#6366f1",R=Ig[x.type]||"rgba(99,102,241,0.1)",F=u===x.id,T=x.x||0,D=x.y||0,k=x.type==="course"?14:x.type==="module"?11:9,I=Math.max(k/j,2);A.font=`${x.type==="course"?"bold ":""}${I}px monospace`;const z=x.type==="lo"?50:35,L=x.name.length>z?x.name.slice(0,z)+"...":x.name,H=A.measureText(L).width,K=8/j,Y=5/j,$=H+K*2,B=I+Y*2,X=4/j;A.beginPath(),A.roundRect(T-$/2,D-B/2,$,B,X),A.fillStyle=F?M:R,A.fill(),A.strokeStyle=F?"#ffffff":M,A.lineWidth=(x.type==="course"?2:1)/j,A.stroke(),A.textAlign="center",A.textBaseline="middle",A.fillStyle=F?"#000000":M,A.fillText(L,T,D)},[u]),_=P.useCallback((x,A,j,M)=>{const R=x.x||0,F=x.y||0,D=(x.type==="course"?60:x.type==="module"?45:30)/M;j.fillStyle=A,j.fillRect(R-D/2,F-D/2,D,D)},[]),E=P.useCallback((x,A,j)=>{const M=x.source,R=x.target;if(!M||!R)return;const F=M.x||0,T=M.y||0,D=R.x||0,k=R.y||0,I=(F+D)/2,z=(T+k)/2,L=D-F,H=k-T,K=I-H*.15,Y=z+L*.15;A.beginPath(),A.moveTo(F,T),A.quadraticCurveTo(K,Y,D,k),A.strokeStyle="rgba(148, 163, 184, 0.25)",A.lineWidth=Math.max(1.5/j,.3),A.stroke()},[]),O=b.filter(x=>a.has(x.courseId));return l.jsxs("div",{className:"flex h-full",children:[l.jsx("div",{className:"w-[220px] shrink-0 border-r border-secondary/30 bg-black/60",children:l.jsx(Ie,{className:"h-full",children:l.jsxs("div",{className:"p-3 space-y-4",children:[l.jsxs("div",{children:[l.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"COURSES"}),p.map(x=>l.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer",children:[l.jsx(ve,{checked:a.has(x.id),onCheckedChange:()=>N(x.id),className:"border-cyan-500 data-[state=checked]:bg-cyan-500"}),l.jsx("span",{className:"font-terminal text-xs text-cyan-300",children:x.name})]},x.id))]}),O.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"font-arcade text-[10px] text-yellow-400 mb-2",children:"MODULES"}),l.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer mb-1",children:[l.jsx(ve,{checked:c.size===0,onCheckedChange:()=>d(new Set),className:"border-yellow-500 data-[state=checked]:bg-yellow-500"}),l.jsx("span",{className:"font-terminal text-xs text-yellow-200",children:"All Modules"})]}),O.map(x=>l.jsxs("label",{className:"flex items-center gap-2 py-0.5 cursor-pointer",children:[l.jsx(ve,{checked:c.size===0||c.has(x.id),onCheckedChange:()=>S(x.id),className:"border-yellow-500 data-[state=checked]:bg-yellow-500"}),l.jsx("span",{className:"font-terminal text-[10px] text-yellow-100 truncate",children:x.name})]},x.id))]}),l.jsx("div",{children:l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx(ve,{checked:f,onCheckedChange:x=>h(!!x),className:"border-green-500 data-[state=checked]:bg-green-500"}),l.jsx("span",{className:"font-terminal text-xs text-green-300",children:"Show Learning Objectives"})]})}),l.jsxs("div",{className:"pt-2 border-t border-secondary/30 space-y-1",children:[l.jsx("div",{className:"font-arcade text-[10px] text-muted-foreground mb-1",children:"LEGEND"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-sm border-2 border-cyan-400 bg-cyan-400/15"}),l.jsx("span",{className:"font-terminal text-[10px] text-cyan-300",children:"Course"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-sm border border-yellow-400 bg-yellow-400/12"}),l.jsx("span",{className:"font-terminal text-[10px] text-yellow-300",children:"Module"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-sm border border-green-400 bg-green-400/8"}),l.jsx("span",{className:"font-terminal text-[10px] text-green-300",children:"Learning Objective"})]})]}),l.jsxs("div",{className:"pt-2 border-t border-secondary/30 font-terminal text-[10px] text-muted-foreground",children:[l.jsxs("div",{children:["Nodes: ",g.nodes.length]}),l.jsxs("div",{children:["Links: ",g.links.length]})]})]})})}),l.jsxs("div",{ref:e,className:"flex-1 relative bg-black/80 overflow-hidden",children:[i&&g.nodes.length>0&&l.jsx(Wn,{ref:n,graphData:g,width:i.width,height:i.height,dagMode:"lr",dagLevelDistance:120,nodeCanvasObject:w,nodePointerAreaPaint:_,linkCanvasObject:E,onNodeHover:x=>m(x?.id??null),linkColor:()=>"transparent",linkWidth:0,backgroundColor:"transparent",cooldownTicks:100,d3AlphaDecay:.025,d3VelocityDecay:.35}),g.nodes.length===0&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center font-terminal text-xs text-muted-foreground",children:"Select courses to build mind map"})]})]})}const Ss=[{name:"EBP",path:"School/Evidence Based Practice"},{name:"ExPhys",path:"School/Exercise Physiology"},{name:"MS1",path:"School/Movement Science 1"},{name:"Neuro",path:"School/Neuroscience"},{name:"TI",path:"School/Theraputic Intervention"}];function zg({onWikilinkClick:e}){const[n,r]=P.useState("School"),[i,s]=P.useState(null),[a,o]=P.useState(""),[c,d]=P.useState(!1),[f,h]=P.useState(!1),[u,m]=P.useState(!1),[p,y]=P.useState(!1),{data:b}=Q({queryKey:["obsidian","status"],queryFn:V.obsidian.getStatus,refetchInterval:3e4}),{data:v}=Q({queryKey:["obsidian","config"],queryFn:V.obsidian.getConfig}),{data:g}=Q({queryKey:["obsidian","vault-index"],queryFn:()=>V.obsidian.getVaultIndex(),enabled:b?.connected===!0}),{data:N}=Q({queryKey:["obsidian","files",n],queryFn:()=>V.obsidian.getFiles(n),enabled:b?.connected===!0}),S=async x=>{try{const A=await V.obsidian.getFile(x);A.success&&A.content!==void 0&&(s(x),o(A.content),h(!1))}catch(A){console.error("Failed to load file:",A)}},w=async()=>{if(i){d(!0);try{(await V.obsidian.saveFile(i,a)).success&&h(!1)}catch(x){console.error("Failed to save file:",x)}finally{d(!1)}}},_=x=>{r(x),s(null),o("")},E=()=>{const x=new Date().toISOString().split("T")[0],A=n?`${n}/Session-${x}.md`:`Session-${x}.md`,j=`# Study Session - ${x}

## Summary


## Concepts Covered
- 

## Strengths
- 

## Areas to Review
- 

## Notes

`;s(A),o(j),h(!0)},O=async(x,A)=>{if(A){const M=v?.vaultName||"PT School Semester 2";window.open(`obsidian://open?vault=${encodeURIComponent(M)}&file=${encodeURIComponent(x)}`,"_blank");return}const j=g?.paths?.[x];if(j){await S(j),m(!0);return}for(const M of Ss)try{await S(`${M.path}/${x}.md`),m(!0);return}catch{}console.warn(`Note not found: ${x}`),e?.(x,A)};return l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsxs(ce,{className:"border-b border-primary/50 p-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs(fe,{className:"font-arcade text-sm flex items-center gap-3",children:[l.jsx(Yo,{className:"w-4 h-4"}),"OBSIDIAN VAULT",b?.connected?l.jsx(bn,{className:"w-3 h-3 text-green-500"}):l.jsx(Kt,{className:"w-3 h-3 text-red-500"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(te,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:E,disabled:!b?.connected,children:[l.jsx(Bs,{className:"w-3 h-3 mr-1"}),"New Note"]}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:p,onChange:x=>y(x.target.checked),disabled:!b?.connected,className:"w-4 h-4 accent-primary"}),l.jsx("span",{className:"font-terminal text-xs",children:"Auto-Sync"})]})]})]}),l.jsx("div",{className:"flex items-center gap-1 mt-2 flex-wrap",children:Ss.map(x=>l.jsx(te,{size:"sm",variant:n===x.path?"default":"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:()=>_(x.path),children:x.name},x.path))}),n&&l.jsxs("div",{className:"flex items-center gap-1 mt-2 font-terminal text-xs text-muted-foreground",children:[l.jsx("button",{onClick:()=>_(""),className:"hover:text-primary",children:"vault"}),n.split("/").map((x,A,j)=>l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(zo,{className:"w-3 h-3"}),l.jsx("button",{onClick:()=>_(j.slice(0,A+1).join("/")),className:"hover:text-primary",children:x})]},A))]})]}),l.jsx(ie,{className:"p-0",children:b?.connected?l.jsxs("div",{className:"grid md:grid-cols-[200px_1fr] h-[400px] md:h-[500px]",children:[l.jsx("div",{className:"border-r border-secondary/30",children:l.jsx(Ie,{className:"h-[400px] md:h-[500px]",children:l.jsxs("div",{className:"p-2 space-y-1",children:[n&&l.jsxs("button",{onClick:()=>{const x=n.split("/");x.pop(),_(x.join("/"))},className:"w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs text-muted-foreground",children:[l.jsx(di,{className:"w-3 h-3"}),".."]}),N?.files?.map(x=>{const A=typeof x=="string"?x:x.path,j=A.endsWith("/"),M=A.replace(/\/$/,"").split("/").pop()||A;return l.jsxs("button",{onClick:()=>{if(j){const R=M.replace(/\/$/,"");_(n?`${n}/${R}`:R)}else{const R=n?`${n}/${M}`:M;S(R)}},className:`w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs ${i?.endsWith(M)?"bg-primary/20 text-primary":""}`,children:[j?l.jsx(di,{className:"w-3 h-3 text-yellow-500"}):l.jsx(ol,{className:"w-3 h-3 text-blue-400"}),M]},A)})]})})}),l.jsx("div",{className:"flex flex-col h-[400px] md:h-[500px]",children:i?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-secondary/30",children:[l.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[l.jsxs("span",{className:"font-terminal text-xs text-primary truncate",children:[i.split("/").pop(),f&&l.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),l.jsx("button",{onClick:()=>{const x=v?.vaultName||"PT School Semester 2",A=i.replace(/\.md$/,"");window.open(`obsidian://open?vault=${encodeURIComponent(x)}&file=${encodeURIComponent(A)}`,"_blank")},className:"text-muted-foreground hover:text-primary shrink-0",title:"Open in Obsidian app",children:l.jsx(Bo,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(te,{size:"sm",variant:"ghost",className:"h-6 px-2 text-[10px]",onClick:()=>m(!u),children:u?"Edit":"Preview"}),l.jsxs(te,{size:"sm",variant:"ghost",onClick:w,disabled:!f||c,className:"h-6 px-2",children:[l.jsx(Fr,{className:"w-3 h-3 mr-1"}),c?"Saving...":"Save"]})]})]}),u?l.jsx("div",{className:"flex-1 w-full p-3 bg-black/60 font-terminal overflow-y-auto",children:l.jsx(oa,{content:a,onWikilinkClick:O})}):l.jsx("textarea",{value:a,onChange:x=>{o(x.target.value),h(!0)},className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary overflow-y-auto",placeholder:"File content..."})]}):l.jsx("div",{className:"flex-1 flex items-center justify-center font-terminal text-xs text-muted-foreground",children:"Select a file to edit"})})]}):l.jsxs("div",{className:"p-8 text-center",children:[l.jsx("p",{className:"font-terminal text-xs text-red-400 mb-2",children:"Obsidian Offline"}),l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Obsidian with Local REST API plugin enabled"})]})})]})}function $g({totalCards:e}){const[n,r]=P.useState(new Set),[i,s]=P.useState(null),[a,o]=P.useState({front:"",back:"",deckName:""}),c=gt(),{data:d,isLoading:f,refetch:h}=Q({queryKey:["anki","status"],queryFn:V.anki.getStatus,refetchInterval:3e4}),{data:u}=Q({queryKey:["anki","due"],queryFn:V.anki.getDue,enabled:d?.connected===!0}),{data:m=[],refetch:p}=Q({queryKey:["anki","drafts"],queryFn:V.anki.getDrafts}),y=m.filter(_=>_.status==="pending"),b=de({mutationFn:V.anki.sync,onSuccess:()=>{c.invalidateQueries({queryKey:["anki"]}),p()}}),v=de({mutationFn:_=>V.anki.approveDraft(_),onSuccess:()=>p()}),g=de({mutationFn:_=>V.anki.deleteDraft(_),onSuccess:()=>p()}),N=de({mutationFn:({id:_,data:E})=>V.anki.updateDraft(_,E),onSuccess:()=>{p(),s(null)}}),S=_=>{s(_.id),o({front:_.front,back:_.back,deckName:_.deckName})},w=()=>{i!==null&&N.mutate({id:i,data:a})};return l.jsxs(l.Fragment,{children:[l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ce,{className:"border-b border-primary/50 p-4",children:l.jsxs(fe,{className:"font-arcade text-sm flex items-center gap-3",children:[l.jsx(Jt,{className:"w-4 h-4"}),"ANKI INTEGRATION",d?.connected?l.jsx(bn,{className:"w-3 h-3 text-green-500 ml-auto"}):l.jsx(Kt,{className:"w-3 h-3 text-red-500 ml-auto"})]})}),l.jsx(ie,{className:"p-4 space-y-3",children:f?l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):d?.connected?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex flex-wrap items-center gap-4 font-terminal text-xs",children:[l.jsx(Yt,{variant:"outline",className:"bg-green-500/20 text-green-400 border-green-500",children:"Connected"}),l.jsxs("span",{className:"text-muted-foreground",children:["Cards: ",l.jsx("span",{className:"text-primary font-arcade",children:e})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Due: ",l.jsx("span",{className:"text-secondary font-arcade",children:u?.dueCount||0})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Reviewed: ",l.jsx("span",{className:"font-arcade",children:d.reviewedToday||0})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Decks: ",l.jsx("span",{className:"font-arcade",children:d.decks?.length||0})]})]}),l.jsxs("div",{className:"pt-2 flex gap-2",children:[l.jsxs(te,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>h(),children:[l.jsx(fi,{className:"w-3 h-3 mr-1"}),"Refresh"]}),l.jsx(te,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>b.mutate(),disabled:b.isPending,children:b.isPending?"Syncing...":"Sync Cards"})]}),y.length>0&&l.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("span",{className:"font-arcade text-[10px] text-yellow-400",children:["PENDING CARDS (",y.length,")"]}),l.jsx("div",{className:"flex gap-1",children:l.jsx(te,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{n.size===y.length?r(new Set):r(new Set(y.map(_=>_.id)))},children:n.size===y.length?"None":"All"})})]}),n.size>0&&l.jsxs("div",{className:"flex gap-1 mb-2",children:[l.jsxs(te,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-green-600 hover:bg-green-700",onClick:()=>{n.forEach(_=>v.mutate(_)),r(new Set)},children:[l.jsx(bn,{className:"w-3 h-3 mr-1"}),"Approve (",n.size,")"]}),l.jsxs(te,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{n.forEach(_=>g.mutate(_)),r(new Set)},children:[l.jsx(bt,{className:"w-3 h-3 mr-1"}),"Delete (",n.size,")"]})]}),l.jsx(Ie,{className:"h-[140px]",children:l.jsx("div",{className:"space-y-2",children:y.map(_=>l.jsx("div",{className:`p-2 bg-black/40 border text-xs ${n.has(_.id)?"border-primary":"border-secondary/30"}`,children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(ve,{checked:n.has(_.id),onCheckedChange:E=>{const O=new Set(n);E?O.add(_.id):O.delete(_.id),r(O)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),l.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[l.jsx("div",{className:"font-terminal text-primary truncate",children:_.front}),l.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:_.back}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx(Yt,{variant:"outline",className:"text-[9px] border-blue-500/50 text-blue-400 shrink-0",children:_.deckName}),l.jsx(te,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>S(_),title:"Edit card",children:l.jsx(kn,{className:"w-3 h-3"})}),l.jsx(te,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-green-500/50 text-green-400 hover:bg-green-500/20",onClick:()=>v.mutate(_.id),title:"Approve card",children:l.jsx(bn,{className:"w-3 h-3"})}),l.jsx(te,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>g.mutate(_.id),title:"Delete card",children:l.jsx(bt,{className:"w-3 h-3"})})]})]})]})},_.id))})})]})]}):l.jsxs("div",{className:"text-center space-y-2",children:[l.jsx("p",{className:"font-terminal text-xs text-red-400",children:d?.error||"Anki not connected"}),l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),l.jsxs(te,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>h(),children:[l.jsx(fi,{className:"w-3 h-3 mr-1"}),"Retry"]})]})})]}),l.jsx(Rr,{open:i!==null,onOpenChange:_=>{_||s(null)},children:l.jsxs(Ir,{"data-modal":"brain-edit-draft",className:"bg-black border-2 border-primary rounded-none max-w-lg translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[l.jsxs(Dr,{children:[l.jsxs(zr,{className:"font-arcade text-primary flex items-center gap-2",children:[l.jsx(kn,{className:"w-5 h-5"}),"EDIT CARD"]}),l.jsx($r,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),l.jsxs("div",{className:"space-y-4 font-terminal",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),l.jsx(lt,{value:a.front,onChange:_=>o(E=>({...E,front:_.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),l.jsx(lt,{value:a.back,onChange:_=>o(E=>({...E,back:_.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),l.jsxs(qt,{value:a.deckName,onValueChange:_=>o(E=>({...E,deckName:_})),children:[l.jsx(Ut,{className:"rounded-none border-secondary",children:l.jsx(Ht,{placeholder:"Select deck"})}),l.jsxs(Bt,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[l.jsx(pe,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),l.jsx(pe,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),l.jsx(pe,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),l.jsx(pe,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),l.jsx(pe,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),l.jsx(pe,{value:"PT::General",children:"PT::General"}),d?.decks?.filter(_=>!_.startsWith("PT::")).map(_=>l.jsx(pe,{value:_,children:_},_))]})]}),l.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",l.jsx("span",{className:"text-blue-400",children:a.deckName})]})]})]}),l.jsxs(Os,{className:"gap-2",children:[l.jsxs(te,{variant:"outline",onClick:()=>s(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[l.jsx(Kt,{className:"w-4 h-4 mr-2"}),"Cancel"]}),l.jsxs(te,{onClick:w,disabled:N.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[l.jsx(Fr,{className:"w-4 h-4 mr-2"}),N.isPending?"Saving...":"Save"]})]})]})})]})}const _o=P.forwardRef(({className:e,...n},r)=>l.jsx("div",{className:"relative w-full overflow-auto",children:l.jsx("table",{ref:r,className:Ue("w-full caption-bottom text-sm",e),...n})}));_o.displayName="Table";const wo=P.forwardRef(({className:e,...n},r)=>l.jsx("thead",{ref:r,className:Ue("[&_tr]:border-b",e),...n}));wo.displayName="TableHeader";const No=P.forwardRef(({className:e,...n},r)=>l.jsx("tbody",{ref:r,className:Ue("[&_tr:last-child]:border-0",e),...n}));No.displayName="TableBody";const Fg=P.forwardRef(({className:e,...n},r)=>l.jsx("tfoot",{ref:r,className:Ue("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...n}));Fg.displayName="TableFooter";const Or=P.forwardRef(({className:e,...n},r)=>l.jsx("tr",{ref:r,className:Ue("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...n}));Or.displayName="TableRow";const Ye=P.forwardRef(({className:e,...n},r)=>l.jsx("th",{ref:r,className:Ue("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...n}));Ye.displayName="TableHead";const Je=P.forwardRef(({className:e,...n},r)=>l.jsx("td",{ref:r,className:Ue("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...n}));Je.displayName="TableCell";const Lg=P.forwardRef(({className:e,...n},r)=>l.jsx("caption",{ref:r,className:Ue("mt-4 text-sm text-muted-foreground",e),...n}));Lg.displayName="TableCaption";const qg=(e,n="MM/dd")=>{if(!e)return"-";try{const r=e instanceof Date?e:new Date(e);return Qo(r)?Zo(r,n):"-"}catch{return"-"}},yn=e=>{if(Array.isArray(e))return e.filter(n=>typeof n=="string");if(typeof e=="string"){const n=e.trim();if(!n)return[];try{const r=JSON.parse(n);if(Array.isArray(r))return r.filter(i=>typeof i=="string")}catch{}return n.split(",").map(r=>r.trim()).filter(Boolean)}return[]};function Ug(){const[e,n]=P.useState(new Set),[r,i]=P.useState(null),[s,a]=P.useState(!1),[o,c]=P.useState([]),[d,f]=P.useState("all"),[h,u]=P.useState("all"),[m,p]=P.useState(""),[y,b]=P.useState(""),[v,g]=P.useState({mode:"",minutes:"",cards:"",confusions:"",weakAnchors:"",concepts:"",issues:"",notes:""});P.useEffect(()=>{const k=new URLSearchParams(window.location.search);f(k.get("semester")||"all"),p(k.get("start")||""),b(k.get("end")||"")},[]);const{data:N=[]}=Q({queryKey:["courses"],queryFn:()=>V.courses.getActive()}),{data:S=[],isLoading:w}=Q({queryKey:["sessions",d,m,y],queryFn:async()=>{const k=new URLSearchParams;d!=="all"&&k.append("semester",d),m&&k.append("start",m),y&&k.append("end",y);const I=k.toString(),z=I?`/sessions?${I}`:"/sessions",L=await fetch(`/api${z}`);if(!L.ok)throw new Error(`API Error: ${L.statusText}`);return L.json()}}),_=gt(),E=de({mutationFn:k=>V.sessions.deleteMany(k),onSuccess:()=>{_.invalidateQueries({queryKey:["sessions"]}),_.invalidateQueries({queryKey:["brain","metrics"]}),n(new Set)}}),O=de({mutationFn:({id:k,updates:I})=>V.sessions.update(k,I),onSuccess:()=>{_.invalidateQueries({queryKey:["sessions"]}),_.invalidateQueries({queryKey:["brain","metrics"]}),i(null)}}),x=k=>{n(I=>{const z=new Set(I);return z.has(k)?z.delete(k):z.add(k),z})},A=()=>{e.size===S.length?n(new Set):n(new Set(S.map(k=>k.id)))},j=()=>{e.size!==0&&(c(Array.from(e)),a(!0))},M=k=>{c([k]),a(!0)},R=()=>{E.mutate(o),a(!1),c([])};P.useEffect(()=>{if(r!==null){const k=S.find(I=>I.id===r);k&&g({mode:k.mode||"",minutes:k.minutes?.toString()||"",cards:k.cards?.toString()||"",confusions:yn(k.confusions).join(", "),weakAnchors:yn(k.weakAnchors).join(", "),concepts:yn(k.concepts).join(", "),issues:yn(k.issues).join(", "),notes:k.notes||""})}},[r,S]);const F=r!==null?S.find(k=>k.id===r):null,T=typeof window<"u"&&new URLSearchParams(window.location.search).has("debugModals");P.useEffect(()=>{r!==null&&!w&&!F&&(T&&console.warn("[ModalDebug][SessionEvidence] Missing session for edit; closing.",{editingSession:r,sessionsCount:S.length}),i(null))},[T,r,F,S.length,w]);const D=()=>{if(r===null)return;const k=z=>z?z.split(",").map(L=>L.trim()).filter(Boolean):[],I=z=>z.length?JSON.stringify(z):null;O.mutate({id:r,updates:{mode:v.mode||"study",minutes:parseInt(v.minutes)||0,cards:parseInt(v.cards)||0,confusions:I(k(v.confusions)),weakAnchors:I(k(v.weakAnchors)),concepts:I(k(v.concepts)),issues:I(k(v.issues)),notes:v.notes||null}})};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"mt-8",children:l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ce,{className:"border-b border-primary/50 p-4",children:l.jsxs(fe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(Lr,{className:"w-4 h-4"}),"SESSION_EVIDENCE"]})}),l.jsxs(ie,{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-5 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"Semester"}),l.jsxs(qt,{value:d,onValueChange:k=>{f(k);const I=new URLSearchParams(window.location.search);k==="all"?I.delete("semester"):I.set("semester",k),window.history.replaceState({},"",`?${I.toString()}`)},children:[l.jsx(Ut,{className:"rounded-none border-primary",children:l.jsx(Ht,{})}),l.jsxs(Bt,{className:"bg-black border-primary",children:[l.jsx(pe,{value:"all",children:"All"}),l.jsx(pe,{value:"1",children:"Semester 1 (Fall 2025)"}),l.jsx(pe,{value:"2",children:"Semester 2 (Spring 2026)"})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"Course"}),l.jsxs(qt,{value:h,onValueChange:k=>u(k),children:[l.jsx(Ut,{className:"rounded-none border-primary",children:l.jsx(Ht,{})}),l.jsxs(Bt,{className:"bg-black border-primary",children:[l.jsx(pe,{value:"all",children:"All"}),N.map(k=>l.jsx(pe,{value:String(k.id),children:k.name},k.id))]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"Start Date"}),l.jsx(It,{type:"date",value:m,onChange:k=>{p(k.target.value);const I=new URLSearchParams(window.location.search);k.target.value?I.set("start",k.target.value):I.delete("start"),window.history.replaceState({},"",`?${I.toString()}`)},className:"rounded-none border-primary"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"End Date"}),l.jsx(It,{type:"date",value:y,onChange:k=>{b(k.target.value);const I=new URLSearchParams(window.location.search);k.target.value?I.set("end",k.target.value):I.delete("end"),window.history.replaceState({},"",`?${I.toString()}`)},className:"rounded-none border-primary"})]}),l.jsx("div",{className:"flex items-end",children:l.jsx(te,{variant:"outline",onClick:()=>{f("all"),u("all"),p(""),b(""),window.history.replaceState({},"",window.location.pathname)},className:"rounded-none border-primary w-full",children:"Clear Filters"})})]}),w?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Loading sessions..."})}):S.length===0?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"No sessions found"})}):l.jsx(Ie,{className:"h-[400px]",children:l.jsxs(_o,{children:[l.jsx(wo,{children:l.jsxs(Or,{className:"border-secondary/30",children:[l.jsx(Ye,{className:"w-12",children:l.jsx(ve,{checked:e.size===S.length&&S.length>0,onCheckedChange:A,className:"border-secondary"})}),l.jsx(Ye,{className:"font-arcade text-xs text-primary",children:"Date"}),l.jsx(Ye,{className:"font-arcade text-xs text-primary",children:"Course"}),l.jsx(Ye,{className:"font-arcade text-xs text-primary",children:"Mode"}),l.jsx(Ye,{className:"font-arcade text-xs text-primary",children:"Minutes"}),l.jsx(Ye,{className:"font-arcade text-xs text-primary",children:"Cards"}),l.jsx(Ye,{className:"font-arcade text-xs text-primary",children:"Concepts"}),l.jsx(Ye,{className:"font-arcade text-xs text-primary",children:"Actions"})]})}),l.jsx(No,{children:S.filter(k=>h==="all"||String(k.courseId)===h).map(k=>l.jsxs(Or,{className:"border-secondary/30 hover:bg-secondary/10",children:[l.jsx(Je,{children:l.jsx(ve,{checked:e.has(k.id),onCheckedChange:()=>x(k.id),className:"border-secondary"})}),l.jsx(Je,{className:"font-terminal text-xs",children:qg(k.createdAt,"MMM dd, yyyy")}),l.jsx(Je,{className:"font-terminal text-xs text-muted-foreground",children:k.topic||"-"}),l.jsx(Je,{className:"font-terminal text-xs text-muted-foreground",children:k.mode||"-"}),l.jsx(Je,{className:"font-terminal text-xs text-muted-foreground",children:k.minutes||"-"}),l.jsx(Je,{className:"font-terminal text-xs text-muted-foreground",children:k.cards||"-"}),l.jsx(Je,{className:"font-terminal text-xs text-muted-foreground",children:Array.isArray(k.concepts)?k.concepts.length:0}),l.jsxs(Je,{className:"flex gap-1",children:[l.jsx(te,{size:"icon",variant:"outline",className:"h-6 w-6 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>i(k.id),children:l.jsx(kn,{className:"w-3 h-3"})}),l.jsx(te,{size:"icon",variant:"outline",className:"h-6 w-6 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>M(k.id),children:l.jsx(bt,{className:"w-3 h-3"})})]})]},k.id))})]})}),e.size>0&&l.jsx("div",{className:"flex gap-2 pt-4 border-t border-secondary/30",children:l.jsxs(te,{size:"sm",className:"flex-1 font-terminal text-xs bg-red-600 hover:bg-red-700",onClick:j,children:[l.jsx(bt,{className:"w-3 h-3 mr-1"}),"Delete Selected (",e.size,")"]})})]})]})}),l.jsx(Rr,{open:!!F,onOpenChange:k=>{k||i(null)},children:l.jsxs(Ir,{"data-modal":"brain-edit-session",className:"bg-black border-2 border-primary rounded-none max-w-2xl translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[l.jsxs(Dr,{children:[l.jsxs(zr,{className:"font-arcade text-primary flex items-center gap-2",children:[l.jsx(kn,{className:"w-5 h-5"}),"EDIT SESSION #",r]}),l.jsx($r,{className:"font-terminal text-muted-foreground",children:"Update WRAP methodology fields for this study session"})]}),l.jsxs("div",{className:"space-y-4 font-terminal",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Mode"}),l.jsxs(qt,{value:v.mode,onValueChange:k=>g(I=>({...I,mode:k})),children:[l.jsx(Ut,{className:"rounded-none border-secondary",children:l.jsx(Ht,{placeholder:"Select mode"})}),l.jsxs(Bt,{className:"rounded-none border-secondary bg-black",children:[l.jsx(pe,{value:"Core",children:"Core"}),l.jsx(pe,{value:"Sprint",children:"Sprint"}),l.jsx(pe,{value:"Drill",children:"Drill"}),l.jsx(pe,{value:"study",children:"Study"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Minutes"}),l.jsx(It,{type:"number",value:v.minutes,onChange:k=>g(I=>({...I,minutes:k.target.value})),className:"rounded-none border-secondary"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Cards"}),l.jsx(It,{type:"number",value:v.cards,onChange:k=>g(I=>({...I,cards:k.target.value})),className:"rounded-none border-secondary"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Confusions (comma-separated)"}),l.jsx(lt,{value:v.confusions,onChange:k=>g(I=>({...I,confusions:k.target.value})),placeholder:"e.g., muscle insertion points, nerve pathways",className:"rounded-none border-secondary min-h-[60px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Weak Anchors (comma-separated)"}),l.jsx(lt,{value:v.weakAnchors,onChange:k=>g(I=>({...I,weakAnchors:k.target.value})),placeholder:"e.g., brachial plexus diagram, ROM measurements",className:"rounded-none border-secondary min-h-[60px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Concepts (comma-separated)"}),l.jsx(lt,{value:v.concepts,onChange:k=>g(I=>({...I,concepts:k.target.value})),placeholder:"e.g., upper extremity anatomy, peripheral nerves",className:"rounded-none border-secondary min-h-[60px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Issues (comma-separated)"}),l.jsx(lt,{value:v.issues,onChange:k=>g(I=>({...I,issues:k.target.value})),placeholder:"e.g., interrupted by phone, lost focus after 30 min",className:"rounded-none border-secondary min-h-[60px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Notes"}),l.jsx(lt,{value:v.notes,onChange:k=>g(I=>({...I,notes:k.target.value})),placeholder:"Free-form observations about the session",className:"rounded-none border-secondary min-h-[80px]"})]})]}),l.jsxs(Os,{className:"gap-2",children:[l.jsxs(te,{variant:"outline",onClick:()=>i(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[l.jsx(Kt,{className:"w-4 h-4 mr-2"}),"Cancel"]}),l.jsxs(te,{onClick:D,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[l.jsx(Fr,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})}),l.jsx(Is,{open:s&&o.length>0,onOpenChange:a,children:l.jsxs(Ds,{"data-modal":"brain-delete-session",className:"bg-black border-2 border-destructive rounded-none translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[l.jsxs(zs,{children:[l.jsxs($s,{className:"font-arcade text-destructive flex items-center gap-2",children:[l.jsx(bt,{className:"w-5 h-5"}),"CONFIRM DELETE"]}),l.jsxs(Fs,{className:"font-terminal text-muted-foreground",children:["Are you sure you want to delete ",o.length," session",o.length!==1?"s":"","? This action cannot be undone."]})]}),l.jsxs(Ls,{className:"gap-2",children:[l.jsx(qs,{className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:"Cancel"}),l.jsxs(Us,{onClick:R,className:"font-terminal rounded-none bg-destructive hover:bg-destructive/80 text-destructive-foreground",children:[l.jsx(bt,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]})}function Cs({filter:e="all"}){const n=gt(),{toast:r}=Mr(),{data:i=[],isLoading:s}=Q({queryKey:["planner","queue"],queryFn:V.planner.getQueue}),{data:a}=Q({queryKey:["planner","settings"],queryFn:V.planner.getSettings}),o=de({mutationFn:V.planner.generate,onSuccess:p=>{r({title:"Tasks generated",description:`${p.tasks_created} review tasks created`}),n.invalidateQueries({queryKey:["planner","queue"]})},onError:p=>{r({title:"Generation failed",description:p.message,variant:"destructive"})}}),c=de({mutationFn:p=>V.planner.updateTask(p,{status:"completed"}),onSuccess:()=>{n.invalidateQueries({queryKey:["planner","queue"]})}}),d=de({mutationFn:p=>V.planner.updateTask(p,{status:"deferred"}),onSuccess:()=>{n.invalidateQueries({queryKey:["planner","queue"]})}}),f=de({mutationFn:p=>V.planner.updateSettings(p),onSuccess:()=>{n.invalidateQueries({queryKey:["planner","settings"]}),r({title:"Settings saved"})}}),h=new Date().toISOString().slice(0,10),u=i.filter(p=>p.scheduled_date&&p.scheduled_date<=h),m=i.filter(p=>!p.scheduled_date||p.scheduled_date>h);return l.jsxs(re,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ce,{className:"border-b border-primary/50 p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs(fe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-primary inline-block"}),"NEXT_ACTIONS"]}),e==="all"&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"font-terminal text-xs text-muted-foreground",children:["Source: ",a?.calendar_source==="google"?"Google":"Local"]}),l.jsx("button",{onClick:()=>f.mutate({calendar_source:a?.calendar_source==="google"?"local":"google"}),className:"px-2 py-1 border border-primary/30 text-xs font-arcade text-muted-foreground hover:text-white rounded-none",children:"TOGGLE"}),l.jsx("button",{onClick:()=>o.mutate(),disabled:o.isPending,className:"px-3 py-1 bg-primary text-black font-arcade text-xs rounded-none hover:bg-primary/80 disabled:opacity-50",children:o.isPending?"...":"GENERATE"})]})]})}),l.jsxs(ie,{className:"p-4 space-y-4",children:[s&&l.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"Loading queue..."}),!s&&i.length===0&&l.jsxs("div",{className:"font-terminal text-xs text-muted-foreground text-center py-4",children:["No pending tasks. ",e==="all"?"Click GENERATE to create review tasks from weak anchors.":""]}),!s&&e==="today"&&i.length>0&&u.length===0&&l.jsxs("div",{className:"font-terminal text-xs text-muted-foreground text-center py-4",children:["No tasks due today. ",m.length," upcoming."]}),u.length>0&&l.jsxs("div",{children:[l.jsxs("div",{className:"font-arcade text-xs text-primary mb-2",children:["TODAY (",u.length,")"]}),l.jsx("div",{className:"space-y-2",children:u.map(p=>l.jsx(As,{task:p,onComplete:()=>c.mutate(p.id),onDefer:()=>d.mutate(p.id)},p.id))})]}),e==="all"&&m.length>0&&l.jsxs("div",{children:[l.jsxs("div",{className:"font-arcade text-xs text-muted-foreground mb-2",children:["UPCOMING (",m.length,")"]}),l.jsx("div",{className:"space-y-2",children:m.slice(0,10).map(p=>l.jsx(As,{task:p,onComplete:()=>c.mutate(p.id),onDefer:()=>d.mutate(p.id)},p.id))})]})]})]})}function As({task:e,onComplete:n,onDefer:r}){return l.jsxs("div",{className:"flex items-center justify-between border border-primary/20 bg-black/30 p-2",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"font-terminal text-xs text-white truncate",children:[e.review_number?`R${e.review_number}`:""," ",e.anchor_text||e.notes||"Untitled"]}),l.jsxs("div",{className:"font-terminal text-xs text-muted-foreground flex gap-3",children:[e.course_name&&l.jsx("span",{children:e.course_name}),e.scheduled_date&&l.jsx("span",{children:e.scheduled_date}),e.planned_minutes&&l.jsxs("span",{children:[e.planned_minutes,"m"]})]})]}),l.jsxs("div",{className:"flex gap-1 ml-2",children:[l.jsx("button",{onClick:n,className:"px-2 py-1 text-xs font-arcade bg-green-900/50 text-green-400 border border-green-500/30 hover:bg-green-900 rounded-none",children:"DONE"}),l.jsx("button",{onClick:r,className:"px-2 py-1 text-xs font-arcade bg-yellow-900/50 text-yellow-400 border border-yellow-500/30 hover:bg-yellow-900 rounded-none",children:"DEFER"})]})]})}const Lt=5;function Hg(e,n,r,i,s){const a=Math.min(s,Lt),o=Array.from({length:a},(u,m)=>{const p=r.filter((b,v)=>v%a===m),y=p.length>0?p.map(b=>`  - ${b}`).join(`
`):"  - (assign LOs here)";return`### Cluster ${m+1}: (name this cluster)

**LOs:**
${y}

**Key Facts (with source anchors):**
- [ ] Fact 1 — (page/slide ref)
- [ ] Fact 2 — (page/slide ref)

**Interpretation:**
(plain-language explanation)

**Application:**
(clinical scenario or exam pattern)`}).join(`

`),c=Array.from({length:a},(u,m)=>`    C${m+1}["Cluster ${m+1}"]`).join(`
`),d=Array.from({length:a},(u,m)=>`    Topic --> C${m+1}`).join(`
`),f=Array.from({length:a},(u,m)=>`#### Cluster ${m+1}
1. (free-recall question)
2. (fill-in or label question)`).join(`

`),h=i.trim()?`## Source Excerpt

> ${i.trim().replace(/\n/g,`
> `)}
`:`## Source Excerpt

> (paste source material here)
`;return`# ${n}

**Course:** ${e||"(unspecified)"}
**Date:** ${new Date().toISOString().slice(0,10)}
**Status:** Draft — UNVERIFIED until source anchors are filled

---

## Learning Objectives

${r.length>0?r.map(u=>`- ${u}`).join(`
`):"- (add LOs here)"}

---

${h}

---

## Clusters (${a})

${o}

---

## Concept Map

\`\`\`mermaid
graph TD
    Topic["${n}"]
${c}
${d}
\`\`\`

---

## Retrieval Practice

${f}

### Transfer Question
(apply knowledge from multiple clusters to a new context)

---

## Next Micro-Task

> (<=15 words: what to study next and when)

---

*Generated by Six-Phase Topic Note Builder*
`}function Bg(){const{toast:e}=Mr(),[n,r]=P.useState(""),[i,s]=P.useState(""),[a,o]=P.useState(""),[c,d]=P.useState(""),[f,h]=P.useState(4),[u,m]=P.useState(""),p=()=>{if(!i.trim()){e({title:"Topic required",variant:"destructive"});return}const b=a.split(`
`).map(g=>g.trim()).filter(Boolean);if(b.length>0&&f>Lt){e({title:"Too many clusters",description:`Max ${Lt} clusters. Consider splitting into Part 1 / Part 2.`,variant:"destructive"});return}const v=Hg(n,i.trim(),b,c,f);m(v),e({title:"Note generated",description:"Copy to Obsidian when ready."})},y=async()=>{try{await navigator.clipboard.writeText(u),e({title:"Copied to clipboard"})}catch{e({title:"Copy failed",description:"Select and copy manually.",variant:"destructive"})}};return l.jsxs(re,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsxs(ce,{className:"p-3 border-b border-secondary/30",children:[l.jsx(fe,{className:"font-arcade text-xs",children:"SIX-PHASE TOPIC NOTE BUILDER"}),l.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground mt-1",children:"Generate an Obsidian-ready topic note following the Six-Phase SOP. No LLM required — template only."})]}),l.jsxs(ie,{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-[10px] text-muted-foreground block mb-1",children:"Course"}),l.jsx("input",{value:n,onChange:b=>r(b.target.value),placeholder:"e.g., Anatomy",className:"w-full bg-black border border-secondary/50 rounded-none px-2 py-1.5 font-terminal text-xs text-white placeholder:text-muted-foreground focus:border-primary outline-none"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-[10px] text-muted-foreground block mb-1",children:"Topic Title *"}),l.jsx("input",{value:i,onChange:b=>s(b.target.value),placeholder:"e.g., Brachial Plexus",className:"w-full bg-black border border-secondary/50 rounded-none px-2 py-1.5 font-terminal text-xs text-white placeholder:text-muted-foreground focus:border-primary outline-none"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-[10px] text-muted-foreground block mb-1",children:"Learning Objectives (1 per line)"}),l.jsx("textarea",{value:a,onChange:b=>o(b.target.value),placeholder:`Identify the roots of the brachial plexus
Describe the trunks and divisions
List terminal branches`,rows:4,className:"w-full bg-black border border-secondary/50 rounded-none px-2 py-1.5 font-terminal text-xs text-white placeholder:text-muted-foreground focus:border-primary outline-none resize-y"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-[10px] text-muted-foreground block mb-1",children:"Source Excerpt (optional — paste key content)"}),l.jsx("textarea",{value:c,onChange:b=>d(b.target.value),placeholder:"Paste relevant source material here...",rows:3,className:"w-full bg-black border border-secondary/50 rounded-none px-2 py-1.5 font-terminal text-xs text-white placeholder:text-muted-foreground focus:border-primary outline-none resize-y"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("label",{className:"font-terminal text-[10px] text-muted-foreground",children:"Clusters (3-5):"}),l.jsx("input",{type:"number",min:3,max:Lt,value:f,onChange:b=>h(Math.min(Lt,Math.max(3,parseInt(b.target.value)||3))),className:"w-16 bg-black border border-secondary/50 rounded-none px-2 py-1 font-terminal text-xs text-white text-center focus:border-primary outline-none"}),l.jsx("button",{onClick:p,className:"px-4 py-1.5 bg-primary text-black font-arcade text-xs rounded-none hover:bg-primary/80",children:"GENERATE NOTE"})]}),u&&l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"font-arcade text-[10px] text-primary",children:"OUTPUT"}),l.jsx("button",{onClick:y,className:"px-3 py-1 border border-primary/50 text-xs font-arcade text-primary hover:bg-primary/10 rounded-none",children:"COPY TO CLIPBOARD"})]}),l.jsx("pre",{className:"bg-black border border-secondary/30 p-3 font-terminal text-[10px] text-white overflow-auto max-h-96 whitespace-pre-wrap",children:u})]})]})]})}const Ts=[{id:"study",label:"Study (Tutor)",tab:null,section:null},{id:"wrap",label:"Lite Wrap Ledger",tab:null,section:null},{id:"generate",label:"Generate JSON",tab:"today",section:"section-ingestion"},{id:"attach",label:"Attach JSON",tab:"today",section:"section-ingestion"},{id:"planner",label:"Planner Queue",tab:"this_week",section:"section-planner"},{id:"actions",label:"Next Actions",tab:"today",section:"section-actions"}];function ix(){const[e,n]=P.useState("vault"),[r,i]=P.useState("today"),{data:s}=Q({queryKey:["obsidian","status"],queryFn:V.obsidian.getStatus,refetchInterval:3e4}),{data:a}=Q({queryKey:["anki","status"],queryFn:V.anki.getStatus,refetchInterval:3e4}),{data:o=[]}=Q({queryKey:["anki","drafts"],queryFn:V.anki.getDrafts}),{data:c}=Q({queryKey:["brain","metrics"],queryFn:V.brain.getMetrics}),{data:d=[]}=Q({queryKey:["sessions"],queryFn:V.sessions.getAll}),{data:f=[]}=Q({queryKey:["planner-queue"],queryFn:V.planner.getQueue}),h=o.filter(N=>N.status==="pending"),u=new Date,m=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}-${String(u.getDate()).padStart(2,"0")}`,p=d.some(N=>N.session_date===m),y=f.length>0,b=d.some(N=>N.session_date===m&&N.understanding_level!=null),v={study:p,wrap:p,generate:b,attach:b,planner:y,actions:y},g=P.useCallback(N=>{N.tab&&(i(N.tab),N.section&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{const S=document.getElementById(N.section);S&&(S.scrollIntoView({behavior:"smooth",block:"start"}),S.classList.add("ring-2","ring-primary/50"),setTimeout(()=>S.classList.remove("ring-2","ring-primary/50"),1500))})}))},[]);return l.jsx($o,{children:l.jsxs("div",{className:"space-y-4 min-w-0 overflow-hidden",children:[l.jsxs(re,{className:"bg-black/40 border-2 border-primary/50 rounded-none",children:[l.jsx(ce,{className:"p-3 border-b border-primary/30",children:l.jsx(fe,{className:"font-arcade text-[10px] text-primary",children:"STUDY FLOW"})}),l.jsx(ie,{className:"p-3",children:l.jsx("div",{className:"flex items-center gap-1 overflow-x-auto",children:Ts.map((N,S)=>{const w=v[N.id]??!1;return l.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[l.jsxs("button",{onClick:()=>g(N),className:`flex items-center gap-1 px-2 py-1 text-[9px] font-terminal border rounded-none transition-colors ${w?"border-green-500/50 text-green-400 bg-green-500/10":"border-secondary/30 text-muted-foreground hover:text-white hover:border-secondary"} ${N.tab?"cursor-pointer":"cursor-default"}`,children:[w?l.jsx(Ho,{className:"w-3 h-3"}):l.jsx(Hs,{className:"w-3 h-3"}),N.label]}),S<Ts.length-1&&l.jsx(tl,{className:"w-3 h-3 text-muted-foreground shrink-0"})]},N.id)})})})]}),l.jsx(Ll,{}),l.jsxs("div",{className:"flex flex-wrap items-center gap-4 font-terminal text-xs px-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:`w-2 h-2 rounded-full ${s?.connected?"bg-green-500":"bg-red-500"}`}),l.jsx("span",{className:"text-muted-foreground",children:"Obsidian"}),l.jsx("span",{className:"text-white",children:s?.connected?"Online":"Offline"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:`w-2 h-2 rounded-full ${a?.connected?"bg-green-500":"bg-red-500"}`}),l.jsx("span",{className:"text-muted-foreground",children:"Anki"}),l.jsx("span",{className:"text-white",children:a?.connected?"Connected":"Offline"})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Cards: ",l.jsx("span",{className:"text-white",children:c?.totalCards||0})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Drafts: ",l.jsx("span",{className:"text-white",children:h.length})]}),c?.averages&&l.jsxs(l.Fragment,{children:[l.jsxs("span",{className:"text-muted-foreground",children:["Avg Understanding: ",l.jsx("span",{className:"text-white",children:c.averages.understanding})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Avg Retention: ",l.jsx("span",{className:"text-white",children:c.averages.retention})]})]})]}),l.jsxs(Ps,{value:r,onValueChange:i,className:"w-full space-y-4",children:[l.jsxs(Rs,{className:"grid w-full grid-cols-4 rounded-none bg-black/40 border-2 border-primary p-0 h-auto",children:[l.jsx(ut,{value:"today",className:"font-arcade text-xs py-3 rounded-none data-[state=active]:bg-primary data-[state=active]:text-black data-[state=inactive]:text-muted-foreground border-r border-primary/30",children:"TODAY"}),l.jsx(ut,{value:"this_week",className:"font-arcade text-xs py-3 rounded-none data-[state=active]:bg-primary data-[state=active]:text-black data-[state=inactive]:text-muted-foreground border-r border-primary/30",children:"THIS WEEK"}),l.jsx(ut,{value:"tools",className:"font-arcade text-xs py-3 rounded-none data-[state=active]:bg-primary data-[state=active]:text-black data-[state=inactive]:text-muted-foreground border-r border-primary/30",children:"TOOLS"}),l.jsx(ut,{value:"data",className:"font-arcade text-xs py-3 rounded-none data-[state=active]:bg-primary data-[state=active]:text-black data-[state=inactive]:text-muted-foreground",children:"DATA"})]}),l.jsxs(dt,{value:"today",className:"space-y-6",children:[!p&&l.jsx(re,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:l.jsxs(ie,{className:"p-6 text-center",children:[l.jsx("p",{className:"font-arcade text-xs text-primary mb-2",children:"NO SESSIONS TODAY"}),l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Start a study session with the Tutor → complete a Lite Wrap → come back here to generate and attach JSON."})]})}),l.jsx("div",{id:"section-ingestion",className:"transition-all duration-300",children:l.jsxs(re,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsxs(ce,{className:"p-3 border-b border-secondary/30",children:[l.jsx(fe,{className:"font-arcade text-xs",children:"ATTACH JSON TO SESSION"}),l.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground mt-1",children:"Paste your Tracker or Enhanced JSON from Brain ingestion prompt. Auto-detects format."})]}),l.jsx(ie,{className:"p-4",children:l.jsx(ml,{})})]})}),l.jsx("div",{id:"section-actions",className:"transition-all duration-300",children:l.jsxs(re,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsx(ce,{className:"p-3 border-b border-secondary/30",children:l.jsx(fe,{className:"font-arcade text-xs",children:"TODAY'S ACTIONS"})}),l.jsx(ie,{className:"p-4",children:y?l.jsx(Cs,{filter:"today"}):l.jsx("div",{className:"text-center py-4",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"No planner tasks yet. Attach session JSON with weak_anchors to auto-generate review tasks."})})})]})}),l.jsx(Ug,{})]}),l.jsxs(dt,{value:"this_week",className:"space-y-6",children:[l.jsx("div",{id:"section-planner",className:"transition-all duration-300",children:l.jsxs(re,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsxs(ce,{className:"p-3 border-b border-secondary/30",children:[l.jsx(fe,{className:"font-arcade text-xs",children:"PLANNER QUEUE"}),l.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground mt-1",children:"Full planner queue with upcoming tasks. Use settings to adjust spacing strategy."})]}),l.jsx(ie,{className:"p-4",children:l.jsx(Cs,{filter:"all"})})]})}),c?.staleTopics&&c.staleTopics.length>0&&l.jsxs(re,{className:"bg-black/40 border-2 border-destructive/50 rounded-none",children:[l.jsx(ce,{className:"p-3 border-b border-destructive/30",children:l.jsx(fe,{className:"font-arcade text-xs text-destructive",children:"STALE TOPICS (14+ DAYS)"})}),l.jsx(ie,{className:"p-4",children:l.jsx("div",{className:"space-y-2",children:c.staleTopics.map((N,S)=>l.jsxs("div",{className:"flex justify-between font-terminal text-xs",children:[l.jsx("span",{children:N.topic}),l.jsxs(Yt,{variant:"outline",className:"rounded-none text-[9px] border-destructive/50 text-destructive",children:[N.daysSince,"d ago"]})]},S))})})]})]}),l.jsxs(dt,{value:"tools",className:"space-y-6",children:[l.jsx(Bg,{}),l.jsxs("div",{className:"space-y-6 min-w-0",children:[l.jsx(zg,{}),l.jsx($g,{totalCards:c?.totalCards||0})]}),l.jsx(xl,{}),l.jsxs(re,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsx(ce,{className:"p-0",children:l.jsxs("div",{className:"flex items-center gap-0 border-b border-secondary/40",children:[l.jsx("button",{onClick:()=>n("vault"),className:`px-4 py-2 font-arcade text-xs transition-colors ${e==="vault"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:"VAULT GRAPH"}),l.jsx("button",{onClick:()=>n("mindmap"),className:`px-4 py-2 font-arcade text-xs transition-colors ${e==="mindmap"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:"MIND MAP"})]})}),l.jsx(ie,{className:"p-0",children:l.jsx("div",{className:"h-[calc(100vh-200px)] flex flex-col min-w-0 overflow-hidden",children:e==="vault"?l.jsx(Pg,{}):l.jsx(Dg,{})})})]})]}),l.jsx(dt,{value:"data",className:"space-y-6",children:l.jsxs(re,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsx(ce,{className:"p-3 border-b border-secondary/30",children:l.jsx(fe,{className:"font-arcade text-xs",children:"SESSION DATA"})}),l.jsx(ie,{className:"p-0",children:l.jsx(gl,{})})]})})]})]})})}export{ix as default};
