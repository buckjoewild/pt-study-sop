import{c as Ae,r as i,R as Ts,d as Ps,e as M,j as e,f as Os,P as Qe,g as Rs,b as De,u as Ie,X as oe}from"./index-Ctf6DkJp.js";import{h as Ms,i as Fs,j as Ls,u as R,a as P,g,S as ie,L as qs,k as _s,C as le,B as E,f as zs,l as ye,T as ce,P as je,D as Fe,c as Le,d as qe,e as _e,m as ze,I as Be,n as V,o as Ke}from"./layout-Yq7TYLjp.js";import{C as te,a as ue,b as me,c as ne}from"./card-B-pSL4We.js";import{e as Bs,B as $e,S as We,a as Ye,b as He,c as Ue,d as $}from"./select-DvtvTgwx.js";import{T as Ks,a as $s,b as Ne,c as ve}from"./tabs-B_u2Juj4.js";import{c as Ve,R as Ws,T as Ys,C as Hs,a as se}from"./index-DvHxqFLz.js";import{A as Xe,a as Ze,b as es,c as ss,d as ts,e as ns,f as as,g as rs}from"./alert-dialog-Imhg7g-t.js";import{F as Us,a as Ge}from"./folder-CHvJ7y8x.js";import{F as Gs}from"./file-text-BZrOUYy5.js";import{R as Je}from"./refresh-cw-Cps4tT61.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Qs=Ae("database",Js);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Xs=Ae("file",Vs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],os=Ae("layers",Zs);function et(o,r,{checkForDefaultPrevented:a=!0}={}){return function(u){if(o?.(u),a===!1||!u.defaultPrevented)return r?.(u)}}var st=Ts[" useInsertionEffect ".trim().toString()]||Ps;function ls({prop:o,defaultProp:r,onChange:a=()=>{},caller:c}){const[u,d,m]=tt({defaultProp:r,onChange:a}),x=o!==void 0,S=x?o:u;{const h=i.useRef(o!==void 0);i.useEffect(()=>{const j=h.current;j!==x&&console.warn(`${c} is changing from ${j?"controlled":"uncontrolled"} to ${x?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=x},[x,c])}const C=i.useCallback(h=>{if(x){const j=nt(h)?h(o):h;j!==o&&m.current?.(j)}else d(h)},[x,o,d,m]);return[S,C]}function tt({defaultProp:o,onChange:r}){const[a,c]=i.useState(o),u=i.useRef(a),d=i.useRef(r);return st(()=>{d.current=r},[r]),i.useEffect(()=>{u.current!==a&&(d.current?.(a),u.current=a)},[a,u]),[a,c,d]}function nt(o){return typeof o=="function"}var W="Accordion",at=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Ee,rt,ot]=Bs(W),[he]=Os(W,[ot,Ve]),Te=Ve(),cs=M.forwardRef((o,r)=>{const{type:a,...c}=o,u=c,d=c;return e.jsx(Ee.Provider,{scope:o.__scopeAccordion,children:a==="multiple"?e.jsx(it,{...d,ref:r}):e.jsx(dt,{...u,ref:r})})});cs.displayName=W;var[ds,lt]=he(W),[is,ct]=he(W,{collapsible:!1}),dt=M.forwardRef((o,r)=>{const{value:a,defaultValue:c,onValueChange:u=()=>{},collapsible:d=!1,...m}=o,[x,S]=ls({prop:a,defaultProp:c??"",onChange:u,caller:W});return e.jsx(ds,{scope:o.__scopeAccordion,value:M.useMemo(()=>x?[x]:[],[x]),onItemOpen:S,onItemClose:M.useCallback(()=>d&&S(""),[d,S]),children:e.jsx(is,{scope:o.__scopeAccordion,collapsible:d,children:e.jsx(us,{...m,ref:r})})})}),it=M.forwardRef((o,r)=>{const{value:a,defaultValue:c,onValueChange:u=()=>{},...d}=o,[m,x]=ls({prop:a,defaultProp:c??[],onChange:u,caller:W}),S=M.useCallback(h=>x((j=[])=>[...j,h]),[x]),C=M.useCallback(h=>x((j=[])=>j.filter(D=>D!==h)),[x]);return e.jsx(ds,{scope:o.__scopeAccordion,value:m,onItemOpen:S,onItemClose:C,children:e.jsx(is,{scope:o.__scopeAccordion,collapsible:!0,children:e.jsx(us,{...d,ref:r})})})}),[ut,pe]=he(W),us=M.forwardRef((o,r)=>{const{__scopeAccordion:a,disabled:c,dir:u,orientation:d="vertical",...m}=o,x=M.useRef(null),S=Rs(x,r),C=rt(a),j=Fs(u)==="ltr",D=et(o.onKeyDown,w=>{if(!at.includes(w.key))return;const T=w.target,k=C().filter(t=>!t.ref.current?.disabled),f=k.findIndex(t=>t.ref.current===T),A=k.length;if(f===-1)return;w.preventDefault();let N=f;const z=0,I=A-1,O=()=>{N=f+1,N>I&&(N=z)},F=()=>{N=f-1,N<z&&(N=I)};switch(w.key){case"Home":N=z;break;case"End":N=I;break;case"ArrowRight":d==="horizontal"&&(j?O():F());break;case"ArrowDown":d==="vertical"&&O();break;case"ArrowLeft":d==="horizontal"&&(j?F():O());break;case"ArrowUp":d==="vertical"&&F();break}const L=N%A;k[L].ref.current?.focus()});return e.jsx(ut,{scope:a,disabled:c,direction:u,orientation:d,children:e.jsx(Ee.Slot,{scope:a,children:e.jsx(Qe.div,{...m,"data-orientation":d,ref:S,onKeyDown:c?void 0:D})})})}),xe="AccordionItem",[mt,Pe]=he(xe),ms=M.forwardRef((o,r)=>{const{__scopeAccordion:a,value:c,...u}=o,d=pe(xe,a),m=lt(xe,a),x=Te(a),S=Ms(),C=c&&m.value.includes(c)||!1,h=d.disabled||o.disabled;return e.jsx(mt,{scope:a,open:C,disabled:h,triggerId:S,children:e.jsx(Ws,{"data-orientation":d.orientation,"data-state":gs(C),...x,...u,ref:r,disabled:h,open:C,onOpenChange:j=>{j?m.onItemOpen(c):m.onItemClose(c)}})})});ms.displayName=xe;var xs="AccordionHeader",hs=M.forwardRef((o,r)=>{const{__scopeAccordion:a,...c}=o,u=pe(W,a),d=Pe(xs,a);return e.jsx(Qe.h3,{"data-orientation":u.orientation,"data-state":gs(d.open),"data-disabled":d.disabled?"":void 0,...c,ref:r})});hs.displayName=xs;var Ce="AccordionTrigger",ps=M.forwardRef((o,r)=>{const{__scopeAccordion:a,...c}=o,u=pe(W,a),d=Pe(Ce,a),m=ct(Ce,a),x=Te(a);return e.jsx(Ee.ItemSlot,{scope:a,children:e.jsx(Ys,{"aria-disabled":d.open&&!m.collapsible||void 0,"data-orientation":u.orientation,id:d.triggerId,...x,...c,ref:r})})});ps.displayName=Ce;var fs="AccordionContent",bs=M.forwardRef((o,r)=>{const{__scopeAccordion:a,...c}=o,u=pe(W,a),d=Pe(fs,a),m=Te(a);return e.jsx(Hs,{role:"region","aria-labelledby":d.triggerId,"data-orientation":u.orientation,...m,...c,ref:r,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...o.style}})});bs.displayName=fs;function gs(o){return o?"open":"closed"}var xt=cs,ht=ms,pt=hs,ys=ps,js=bs;const ft=xt,Se=i.forwardRef(({className:o,...r},a)=>e.jsx(ht,{ref:a,className:De("border-b",o),...r}));Se.displayName="AccordionItem";const we=i.forwardRef(({className:o,children:r,...a},c)=>e.jsx(pt,{className:"flex",children:e.jsxs(ys,{ref:c,className:De("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",o),...a,children:[r,e.jsx(Ls,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));we.displayName=ys.displayName;const ke=i.forwardRef(({className:o,children:r,...a},c)=>e.jsx(js,{ref:c,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:e.jsx("div",{className:De("pb-4 pt-0",o),children:r})}));ke.displayName=js.displayName;const bt=`You are extracting a full course syllabus for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Top-level structure:
{
  "term": {
    "startDate": "2026-01-05",
    "endDate": "2026-04-24",
    "timezone": "America/Chicago"
  },
  "modules": [
    {
      "name": "Module 1: ...",
      "orderIndex": 1,
      "topics": ["..."],
      "readings": ["..."],
      "assessments": ["..."]
    }
  ],
  "events": [
    {
      "type": "class" | "lecture" | "reading" | "topic" | "assignment" | "quiz" | "exam" | "assessment",
      "title": "string",
      "date": "YYYY-MM-DD",
      "dueDate": "YYYY-MM-DD | null",
      "startTime": "HH:MM | null",
      "endTime": "HH:MM | null",
      "daysOfWeek": ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
      "delivery": "in_person" | "virtual_sync" | "virtual_async" | "hybrid",
      "assessmentType": "EA | null",
      "moduleName": "Module 1: ... | null",
      "notes": "string | null"
    }
  ]
}

Rules:
1. Include ALL items: class meetings, assignments, quizzes, exams, topics, readings, virtual synchronous/asynchronous activities, and learning assessments (EA).
2. For repeating class meetings, set daysOfWeek + startTime/endTime, and include term start/end.
3. For one-off items, set date or dueDate.
4. Keep moduleName when items belong to a module.
5. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,gt=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,yt=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function jt(){const o=Ie(),[r,a]=i.useState(null),[c,u]=i.useState(null),[d,m]=i.useState(""),[x,S]=i.useState(""),[C,h]=i.useState(null),[j,D]=i.useState(""),[w,T]=i.useState(null),[k,f]=i.useState(null),{data:A=[]}=R({queryKey:["courses"],queryFn:()=>g.courses.getActive()}),{data:N=[]}=R({queryKey:["modules",r],queryFn:()=>r?g.modules.getByCourse(r):Promise.resolve([]),enabled:!!r}),{data:z=[]}=R({queryKey:["learningObjectives",r],queryFn:()=>r?g.learningObjectives.getByCourse(r):Promise.resolve([]),enabled:!!r}),I=P({mutationFn:async n=>{if(!r)throw new Error("Select a course first");const b=JSON.parse(L(n));return g.syllabus.importBulk(r,b)},onSuccess:n=>{o.invalidateQueries({queryKey:["scheduleEvents"]}),o.invalidateQueries({queryKey:["modules"]}),m(""),f({type:"success",message:`Imported: ${n.modulesCreated} modules, ${n.eventsCreated} events (${n.classMeetingsExpanded} class meetings expanded)`}),h(null)},onError:n=>{f({type:"error",message:n.message||"Failed to import syllabus"}),h(n.message||"Failed to import syllabus")}}),O=P({mutationFn:async n=>{if(!r)throw new Error("Select a course first");const b=JSON.parse(L(n));return g.learningObjectives.createBulk(r,c,b)},onSuccess:()=>{o.invalidateQueries({queryKey:["learningObjectives"]}),S(""),h(null)},onError:n=>{h(n.message||"Failed to import LOs")}}),F=n=>{navigator.clipboard.writeText(n)},L=n=>{const b=n.trim();if(!b)return"";const v=b.match(/```json\s*([\s\S]*?)```/i)||b.match(/```\s*([\s\S]*?)```/i),Y=v?v[1].trim():b,q=Y.indexOf("{"),B=Y.lastIndexOf("}");return q!==-1&&B!==-1&&B>q?Y.slice(q,B+1).trim():Y},t=async()=>{try{T(null);const n=j,v=await g.brain.ingest(n,"pasted_wrap.md");v.sessionSaved?(T({type:"success",message:`âœ“ Session saved! ID: ${v.sessionId}, Cards: ${v.cardsCreated||0}`}),D("")):T({type:"error",message:v.errors?.join(", ")||v.message})}catch(n){T({type:"error",message:n.message||"Failed to ingest"})}};return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"border border-secondary/40 rounded-none p-4 bg-primary/5",children:[e.jsx("h2",{className:"text-xl font-arcade text-primary mb-4",children:"WRAP SESSION INGESTION"}),w&&e.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${w.type==="success"?"bg-green-900/30 border border-green-500 text-green-400":"bg-red-900/30 border border-red-500 text-red-400"}`,children:w.message}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>F(yt),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:j,onChange:n=>{D(n.target.value),T(null)}})]}),e.jsx("button",{onClick:t,disabled:!j,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]}),e.jsx("h2",{className:"text-xl font-arcade text-primary",children:"MATERIAL INGESTION"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:r||"",onChange:n=>{a(n.target.value?parseInt(n.target.value):null),u(null)},children:[e.jsx("option",{value:"",children:"-- Select Course --"}),A.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),C&&e.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:C}),r&&e.jsxs(ft,{type:"multiple",className:"border border-secondary/40 rounded-none divide-y divide-secondary/40",children:[e.jsxs(Se,{value:"syllabus-import",className:"border-secondary/40",children:[e.jsx(we,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"SYLLABUS IMPORT (MODULES + SCHEDULE)"}),e.jsxs(ke,{className:"px-3",children:[e.jsx("button",{onClick:()=>F(bt),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (combined JSON object) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"term":{"startDate":"2026-01-15","endDate":"2026-05-01","timezone":"America/Chicago"},"modules":[...],"events":[...]}',value:d,onChange:n=>{m(n.target.value),f(null)}}),e.jsx("button",{onClick:()=>I.mutate(d),disabled:!d||I.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:I.isPending?"Importing...":"Import Syllabus"}),k&&e.jsx("div",{className:`mt-2 p-2 border font-terminal text-xs ${k.type==="success"?"border-green-500 text-green-400":"border-red-500 text-red-400"}`,children:k.message})]})]}),e.jsxs(Se,{value:"learning-objectives",className:"border-secondary/40",children:[e.jsx(we,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"LEARNING OBJECTIVES IMPORT"}),e.jsxs(ke,{className:"px-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:c||"",onChange:n=>u(n.target.value?parseInt(n.target.value):null),children:[e.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),N.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsx("button",{onClick:()=>F(gt),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:x,onChange:n=>S(n.target.value)}),e.jsx("button",{onClick:()=>O.mutate(x),disabled:!x||O.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:O.isPending?"Importing...":"Import LOs"}),z.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",z.length,")"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:z.map(n=>e.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[e.jsx("span",{className:"text-primary",children:n.loCode}),": ",n.title,e.jsx("span",{className:`ml-2 text-[10px] px-1 rounded ${n.status==="solid"?"bg-green-600":n.status==="in_progress"?"bg-yellow-600":n.status==="need_review"?"bg-orange-600":"bg-gray-600"}`,children:n.status})]},n.id))})]})]})]})]})]})}function Nt(){const o=Ie(),[r,a]=i.useState(null),[c,u]=i.useState({}),[d,m]=i.useState({}),[x,S]=i.useState(new Set),[C,h]=i.useState(new Set),[j,D]=i.useState(null),w=i.useRef(null),{data:T=[]}=R({queryKey:["courses"],queryFn:()=>g.courses.getActive()}),{data:k=[]}=R({queryKey:["modules",r],queryFn:()=>r?g.modules.getByCourse(r):Promise.resolve([]),enabled:!!r}),{data:f=[]}=R({queryKey:["scheduleEvents",r],queryFn:()=>r?g.scheduleEvents.getByCourse(r):Promise.resolve([]),enabled:!!r}),A=P({mutationFn:({id:t,data:n})=>g.modules.update(t,n),onSuccess:()=>{o.invalidateQueries({queryKey:["modules"]})}}),N=P({mutationFn:t=>g.modules.delete(t),onSuccess:()=>{o.invalidateQueries({queryKey:["modules"]})}}),z=P({mutationFn:t=>g.modules.deleteMany(t),onSuccess:()=>{o.invalidateQueries({queryKey:["modules"]}),S(new Set)}}),I=P({mutationFn:({id:t,data:n})=>g.scheduleEvents.update(t,n),onSuccess:()=>{o.invalidateQueries({queryKey:["scheduleEvents"]})}}),O=P({mutationFn:t=>g.scheduleEvents.delete(t),onSuccess:()=>{o.invalidateQueries({queryKey:["scheduleEvents"]})}}),F=P({mutationFn:t=>g.scheduleEvents.deleteMany(t),onSuccess:()=>{o.invalidateQueries({queryKey:["scheduleEvents"]}),h(new Set)}}),L=(t,n,b)=>{if(!n.length)return;const v={type:t,ids:n,label:b};w.current=v,D(v)};return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:r||"",onChange:t=>{a(t.target.value?parseInt(t.target.value):null)},children:[e.jsx("option",{value:"",children:"-- Select Course --"}),T.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),r&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(te,{className:"brain-card rounded-none",children:[e.jsx(ue,{className:"border-b border-secondary/50 p-3",children:e.jsxs(me,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(Qs,{className:"w-4 h-4"}),"MODULES (",k.length,")"]})}),e.jsx(ne,{className:"p-0",children:k.length===0?e.jsx("p",{className:"text-xs text-muted-foreground font-terminal p-4",children:"No modules yet. Import a syllabus to add modules."}):e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const t=new Set;x.size!==k.length&&k.forEach(n=>t.add(n.id)),S(t)},children:x.size===k.length?"Uncheck All":"Check All"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:x.size===0,onClick:()=>{L("modules",Array.from(x),`Delete ${x.size} module(s)? This cannot be undone.`)},children:"Delete"}),e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:x.size===0,onClick:()=>{x.forEach(t=>{const n=c[t];n&&A.mutate({id:t,data:n})}),u(t=>{const n={...t};return x.forEach(b=>{delete n[b]}),n})},children:"Save"})]}),e.jsx(ie,{className:"h-[280px]",children:e.jsxs("table",{className:"w-full text-sm font-terminal",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-secondary/50",children:[e.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),e.jsx("th",{className:"text-left p-2",children:"Module"}),e.jsx("th",{className:"text-center p-2",children:"Order"}),e.jsx("th",{className:"text-center p-2",children:"Files"}),e.jsx("th",{className:"text-center p-2",children:"NotebookLM"}),e.jsx("th",{className:"text-center p-2",children:"Status"}),e.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),e.jsx("tbody",{children:k.map(t=>e.jsxs("tr",{className:"border-b border-secondary/30",children:[e.jsx("td",{className:"text-center p-2",children:e.jsx(se,{checked:x.has(t.id),onCheckedChange:n=>S(b=>{const v=new Set(b);return n?v.add(t.id):v.delete(t.id),v}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:c[t.id]?.name??t.name,onChange:n=>u(b=>({...b,[t.id]:{...b[t.id],name:n.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"number",className:"w-16 bg-black border border-secondary rounded-none p-1 text-xs font-terminal text-center",value:c[t.id]?.orderIndex??t.orderIndex??0,onChange:n=>u(b=>({...b,[t.id]:{...b[t.id],orderIndex:parseInt(n.target.value||"0",10)}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx(se,{checked:t.filesDownloaded,onCheckedChange:n=>A.mutate({id:t.id,data:{filesDownloaded:!!n}}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"text-center p-2",children:e.jsx(se,{checked:t.notebooklmLoaded,onCheckedChange:n=>A.mutate({id:t.id,data:{notebooklmLoaded:!!n}}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"text-center p-2",children:t.filesDownloaded&&t.notebooklmLoaded?e.jsx("span",{className:"text-green-400",children:"Ready"}):e.jsx("span",{className:"text-yellow-400",children:"Pending"})}),e.jsxs("td",{className:"text-center p-2 space-x-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!c[t.id],onClick:()=>{const n=c[t.id];n&&(A.mutate({id:t.id,data:n}),u(b=>{const v={...b};return delete v[t.id],v}))},children:"Save"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>N.mutate(t.id),children:"Delete"})]})]},t.id))})]})})]})})]}),e.jsxs(te,{className:"brain-card rounded-none",children:[e.jsx(ue,{className:"border-b border-secondary/50 p-3",children:e.jsxs(me,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(os,{className:"w-4 h-4"}),"SCHEDULE ITEMS (",f.length,")"]})}),e.jsx(ne,{className:"p-0",children:f.length===0?e.jsx("p",{className:"text-xs text-muted-foreground font-terminal p-4",children:"No schedule items yet. Import a syllabus to add events."}):e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const t=new Set;C.size!==f.length&&f.forEach(n=>t.add(n.id)),h(t)},children:C.size===f.length?"Uncheck All":"Check All"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:C.size===0,onClick:()=>{L("schedule",Array.from(C),`Delete ${C.size} schedule item(s)? This cannot be undone.`)},children:"Delete"}),e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:C.size===0,onClick:()=>{C.forEach(t=>{const n=d[t];n&&I.mutate({id:t,data:n})}),m(t=>{const n={...t};return C.forEach(b=>{delete n[b]}),n})},children:"Save"})]}),e.jsx(ie,{className:"h-[280px]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs font-terminal",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-secondary/50",children:[e.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),e.jsx("th",{className:"text-left p-2",children:"Type"}),e.jsx("th",{className:"text-left p-2",children:"Delivery"}),e.jsx("th",{className:"text-left p-2",children:"Title"}),e.jsx("th",{className:"text-center p-2",children:"Date"}),e.jsx("th",{className:"text-center p-2",children:"Start"}),e.jsx("th",{className:"text-center p-2",children:"End"}),e.jsx("th",{className:"text-center p-2",children:"Due"}),e.jsx("th",{className:"text-left p-2",children:"Notes"}),e.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),e.jsx("tbody",{children:f.map(t=>{const n=d[t.id]||{},b=n.type??t.type??"",v=n.delivery??t.delivery??"",Y=n.title??t.title??"",q=n.date??t.date??"",B=n.startTime??t.startTime??"",Z=n.endTime??t.endTime??"",G=n.dueDate??t.dueDate??"",ae=n.notes??t.notes??"",fe=!!d[t.id];return e.jsxs("tr",{className:"border-b border-secondary/30 align-top",children:[e.jsx("td",{className:"text-center p-2",children:e.jsx(se,{checked:C.has(t.id),onCheckedChange:y=>h(p=>{const H=new Set(p);return y?H.add(t.id):H.delete(t.id),H}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"p-2",children:e.jsx("select",{className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:b,onChange:y=>m(p=>({...p,[t.id]:{...p[t.id],type:y.target.value}})),children:["class","lecture","reading","topic","assignment","quiz","exam","assessment","other"].map(y=>e.jsx("option",{value:y,children:y},y))})}),e.jsx("td",{className:"p-2",children:e.jsx("select",{className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:v,onChange:y=>m(p=>({...p,[t.id]:{...p[t.id],delivery:y.target.value}})),children:["","in_person","virtual_sync","virtual_async","online_module","hybrid"].map(y=>e.jsx("option",{value:y,children:y||"--"},y))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:Y,onChange:y=>m(p=>({...p,[t.id]:{...p[t.id],title:y.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:q||"",onChange:y=>m(p=>({...p,[t.id]:{...p[t.id],date:y.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:B||"",onChange:y=>m(p=>({...p,[t.id]:{...p[t.id],startTime:y.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:Z||"",onChange:y=>m(p=>({...p,[t.id]:{...p[t.id],endTime:y.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:G||"",onChange:y=>m(p=>({...p,[t.id]:{...p[t.id],dueDate:y.target.value}}))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:ae||"",onChange:y=>m(p=>({...p,[t.id]:{...p[t.id],notes:y.target.value}}))})}),e.jsxs("td",{className:"text-center p-2 space-x-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!fe,onClick:()=>{I.mutate({id:t.id,data:{type:b,title:Y,date:q,startTime:B,endTime:Z,dueDate:G,notes:ae,delivery:v}}),m(y=>{const p={...y};return delete p[t.id],p})},children:"Save"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>O.mutate(t.id),children:"Delete"})]})]},t.id)})})]})})})]})})]})]}),e.jsx(Xe,{open:!!j,onOpenChange:t=>!t&&D(null),children:e.jsxs(Ze,{className:"bg-black border-2 border-primary rounded-none font-terminal text-primary shadow-none max-w-md translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(es,{className:"text-left",children:[e.jsx(ss,{className:"font-arcade text-destructive",children:"CONFIRM_DELETE"}),e.jsx(ts,{className:"font-terminal text-muted-foreground",children:j?.label})]}),e.jsxs(ns,{className:"gap-2 sm:justify-end",children:[e.jsx(as,{className:"rounded-none border-secondary font-terminal text-xs hover:bg-secondary/20",onClick:()=>{w.current=null,D(null)},children:"CANCEL"}),e.jsx(rs,{className:"rounded-none bg-destructive text-destructive-foreground font-arcade text-xs hover:bg-destructive/80",type:"button",onClick:()=>{const t=w.current;t&&(t.type==="modules"?z.mutate(t.ids):F.mutate(t.ids),w.current=null,D(null))},children:"DELETE"})]})]})})]})}const de=o=>{if(Array.isArray(o))return o.filter(r=>typeof r=="string");if(typeof o=="string"){const r=o.trim();if(!r)return[];try{const a=JSON.parse(r);if(Array.isArray(a))return a.filter(c=>typeof c=="string")}catch{}return r.split(",").map(a=>a.trim()).filter(Boolean)}return[]};function Ot(){const[o,r]=i.useState(new Set),[a,c]=i.useState(null),[u,d]=i.useState(!1),[m,x]=i.useState([]),[S,C]=i.useState(!1),[h,j]=i.useState(new Set),[D,w]=i.useState(null),[T,k]=i.useState({front:"",back:"",deckName:""}),[f,A]=i.useState({mode:"",minutes:"",cards:"",confusions:"",weakAnchors:"",concepts:"",issues:"",notes:""}),[N,z]=i.useState("School"),[I,O]=i.useState(null),[F,L]=i.useState(""),[t,n]=i.useState(!1),[b,v]=i.useState(!1),Y=[{name:"EBP",path:"School/Evidence Based Practice"},{name:"ExPhys",path:"School/Exercise Physiology"},{name:"MS1",path:"School/Movement Science 1"},{name:"Neuro",path:"School/Neuroscience"},{name:"TI",path:"School/Theraputic Intervention"}],{data:q=[],isLoading:B}=R({queryKey:["sessions"],queryFn:g.sessions.getAll}),{data:Z}=R({queryKey:["brain","metrics"],queryFn:g.brain.getMetrics}),G=Ie(),ae=P({mutationFn:s=>g.sessions.deleteMany(s),onSuccess:()=>{G.invalidateQueries({queryKey:["sessions"]}),G.invalidateQueries({queryKey:["brain","metrics"]}),r(new Set)}}),fe=P({mutationFn:({id:s,updates:l})=>g.sessions.update(s,l),onSuccess:()=>{G.invalidateQueries({queryKey:["sessions"]}),G.invalidateQueries({queryKey:["brain","metrics"]}),c(null)}}),y=()=>{ae.mutate(m),d(!1),x([])};i.useEffect(()=>{if(a!==null){const s=q.find(l=>l.id===a);s&&A({mode:s.mode||"",minutes:s.minutes?.toString()||"",cards:s.cards?.toString()||"",confusions:de(s.confusions).join(", "),weakAnchors:de(s.weakAnchors).join(", "),concepts:de(s.concepts).join(", "),issues:de(s.issues).join(", "),notes:s.notes||""})}},[a,q]);const p=a!==null?q.find(s=>s.id===a):null,H=typeof window<"u"&&new URLSearchParams(window.location.search).has("debugModals");i.useEffect(()=>{a!==null&&!B&&!p&&(H&&console.warn("[ModalDebug][Brain] Missing session for edit; closing.",{editingSession:a,sessionsCount:q.length}),c(null))},[H,a,p,q.length,B]),i.useEffect(()=>{H&&console.info("[ModalDebug][Brain] state",{editingSession:a,hasEditingSessionData:!!p,deleteDialogOpen:u,sessionsToDelete:m.length,sessionsLoading:B})},[H,u,a,p,B,m.length]);const Ns=()=>{if(a===null)return;const s=K=>K?K.split(",").map(X=>X.trim()).filter(Boolean):[],l=K=>K.length?JSON.stringify(K):null,_={mode:f.mode||"study",minutes:parseInt(f.minutes)||0,cards:parseInt(f.cards)||0,confusions:l(s(f.confusions)),weakAnchors:l(s(f.weakAnchors)),concepts:l(s(f.concepts)),issues:l(s(f.issues)),notes:f.notes||null};fe.mutate({id:a,updates:_})},{data:J}=R({queryKey:["obsidian","status"],queryFn:g.obsidian.getStatus,refetchInterval:3e4}),{data:vs,refetch:vt}=R({queryKey:["obsidian","files",N],queryFn:()=>g.obsidian.getFiles(N),enabled:J?.connected===!0}),Cs=async s=>{try{const l=await g.obsidian.getFile(s);l.success&&l.content!==void 0&&(O(s),L(l.content),v(!1))}catch(l){console.error("Failed to load file:",l)}},Ss=async()=>{if(I){n(!0);try{(await g.obsidian.saveFile(I,F)).success&&v(!1)}catch(s){console.error("Failed to save file:",s)}finally{n(!1)}}},ee=s=>{z(s),O(null),L("")},ws=()=>{const s=new Date().toISOString().split("T")[0],l=N?`${N}/Session-${s}.md`:`Session-${s}.md`,_=`# Study Session - ${s}

## Summary


## Concepts Covered
- 

## Strengths
- 

## Areas to Review
- 

## Notes

`;O(l),L(_),v(!0)},{data:U,isLoading:ks,refetch:Oe}=R({queryKey:["anki","status"],queryFn:g.anki.getStatus,refetchInterval:3e4}),{data:As}=R({queryKey:["anki","due"],queryFn:g.anki.getDue,enabled:U?.connected===!0}),{data:Ds=[],refetch:re}=R({queryKey:["anki","drafts"],queryFn:g.anki.getDrafts}),Q=Ds.filter(s=>s.status==="pending"),be=P({mutationFn:g.anki.sync,onSuccess:()=>{G.invalidateQueries({queryKey:["anki"]}),re()}}),Re=P({mutationFn:s=>g.anki.approveDraft(s),onSuccess:()=>{re()}}),Me=P({mutationFn:s=>g.anki.deleteDraft(s),onSuccess:()=>{re()}}),ge=P({mutationFn:({id:s,data:l})=>g.anki.updateDraft(s,l),onSuccess:()=>{re(),w(null)}}),Is=s=>{w(s.id),k({front:s.front,back:s.back,deckName:s.deckName})},Es=()=>{D!==null&&ge.mutate({id:D,data:T})};return e.jsxs(qs,{children:[H&&e.jsxs("div",{className:"fixed bottom-12 right-4 z-[70] bg-black/80 border border-primary text-primary font-terminal text-[10px] px-2 py-1 rounded-none",children:[e.jsx("div",{children:"Brain modals"}),e.jsxs("div",{children:["Edit session: ",a??"none"]}),e.jsxs("div",{children:["Edit data: ",p?"yes":"no"]}),e.jsxs("div",{children:["Delete open: ",u?"yes":"no"]}),e.jsxs("div",{children:["Delete count: ",m.length]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h1",{className:"font-arcade text-xl text-primary flex items-center gap-2",children:[e.jsx(_s,{className:"w-6 h-6"}),"BRAIN ANALYTICS"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SYSTEM STATUS"}),e.jsx(te,{className:"brain-card rounded-none",children:e.jsx(ne,{className:"p-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 font-terminal text-xs",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${J?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Obsidian"}),e.jsx("span",{className:"text-primary",children:J?.connected?"Online":"Offline"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${U?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Anki"}),e.jsx("span",{className:"text-primary",children:U?.connected?"Connected":"Offline"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-muted-foreground",children:[e.jsxs("span",{children:["Cards: ",e.jsx("span",{className:"text-primary",children:Z?.totalCards||0})]}),e.jsxs("span",{children:["Drafts: ",e.jsx("span",{className:"text-primary",children:Q.length})]})]})]})})})]}),e.jsxs(Ks,{defaultValue:"ingestion",className:"w-full",children:[e.jsxs($s,{className:"grid w-full grid-cols-3 rounded-none bg-black border border-secondary/40",children:[e.jsx(Ne,{value:"ingestion",className:"font-arcade text-xs rounded-none data-[state=active]:bg-primary/20 data-[state=active]:text-primary",children:"INGESTION"}),e.jsx(Ne,{value:"data",className:"font-arcade text-xs rounded-none data-[state=active]:bg-primary/20 data-[state=active]:text-primary",children:"DATA"}),e.jsx(Ne,{value:"integrations",className:"font-arcade text-xs rounded-none data-[state=active]:bg-primary/20 data-[state=active]:text-primary",children:"INTEGRATIONS"})]}),e.jsx(ve,{value:"ingestion",className:"border border-t-0 border-secondary/40 rounded-none",children:e.jsx(jt,{})}),e.jsx(ve,{value:"data",className:"border border-t-0 border-secondary/40 rounded-none",children:e.jsx(Nt,{})}),e.jsx(ve,{value:"integrations",className:"border border-t-0 border-secondary/40 rounded-none",children:e.jsxs("div",{className:"space-y-4 p-4 min-w-0",children:[e.jsxs(te,{className:"brain-card rounded-none",children:[e.jsxs(ue,{className:"border-b border-secondary/50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(me,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(Us,{className:"w-4 h-4"}),"OBSIDIAN VAULT",J?.connected?e.jsx(le,{className:"w-3 h-3 text-green-500"}):e.jsx(oe,{className:"w-3 h-3 text-red-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(E,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:ws,disabled:!J?.connected,children:[e.jsx(Gs,{className:"w-3 h-3 mr-1"}),"New Note"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:s=>C(s.target.checked),disabled:!J?.connected,className:"w-4 h-4 accent-primary"}),e.jsx("span",{className:"font-terminal text-xs",children:"Auto-Sync"})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 mt-2 flex-wrap",children:Y.map(s=>e.jsx(E,{size:"sm",variant:N===s.path?"default":"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:()=>ee(s.path),children:s.name},s.path))}),N&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 font-terminal text-xs text-muted-foreground",children:[e.jsx("button",{onClick:()=>ee(""),className:"hover:text-primary",children:"vault"}),N.split("/").map((s,l,_)=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(zs,{className:"w-3 h-3"}),e.jsx("button",{onClick:()=>ee(_.slice(0,l+1).join("/")),className:"hover:text-primary",children:s})]},l))]})]}),e.jsx(ne,{className:"p-0",children:J?.connected?e.jsxs("div",{className:"grid md:grid-cols-2 h-[240px] md:h-[300px]",children:[e.jsx("div",{className:"border-r border-secondary/30",children:e.jsx(ie,{className:"h-[240px] md:h-[300px]",children:e.jsxs("div",{className:"p-2 space-y-1",children:[N&&e.jsxs("button",{onClick:()=>{const s=N.split("/");s.pop(),ee(s.join("/"))},className:"w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs text-muted-foreground",children:[e.jsx(Ge,{className:"w-3 h-3"}),".."]}),vs?.files?.map(s=>{const l=typeof s=="string"?s:s.path,_=l.endsWith("/"),K=l.replace(/\/$/,"").split("/").pop()||l;return e.jsxs("button",{onClick:()=>{if(_){const X=K.replace(/\/$/,"");ee(N?`${N}/${X}`:X)}else{const X=N?`${N}/${K}`:K;Cs(X)}},className:`w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs ${I?.endsWith(K)?"bg-primary/20 text-primary":""}`,children:[_?e.jsx(Ge,{className:"w-3 h-3 text-yellow-500"}):e.jsx(Xs,{className:"w-3 h-3 text-blue-400"}),K]},l)})]})})}),e.jsx("div",{className:"flex flex-col h-[240px] md:h-[300px]",children:I?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-secondary/30",children:[e.jsxs("span",{className:"font-terminal text-xs text-primary truncate",children:[I.split("/").pop(),b&&e.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),e.jsxs(E,{size:"sm",variant:"ghost",onClick:Ss,disabled:!b||t,className:"h-6 px-2",children:[e.jsx(ye,{className:"w-3 h-3 mr-1"}),t?"Saving...":"Save"]})]}),e.jsx("textarea",{value:F,onChange:s=>{L(s.target.value),v(!0)},className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"File content..."})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center font-terminal text-xs text-muted-foreground",children:"Select a file to edit"})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400 mb-2",children:"Obsidian Offline"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Obsidian with Local REST API plugin enabled"})]})})]}),e.jsxs(te,{className:"brain-card rounded-none",children:[e.jsx(ue,{className:"border-b border-secondary/50 p-3",children:e.jsxs(me,{className:"font-arcade text-xs flex items-center gap-2 text-muted-foreground",children:[e.jsx(os,{className:"w-3 h-3"}),"ANKI INTEGRATION",U?.connected?e.jsx(le,{className:"w-3 h-3 text-green-500 ml-auto"}):e.jsx(oe,{className:"w-3 h-3 text-red-500 ml-auto"})]})}),e.jsx(ne,{className:"p-4 space-y-3",children:ks?e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):U?.connected?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Status:"}),e.jsx($e,{variant:"outline",className:"bg-green-500/20 text-green-400 border-green-500",children:"Connected"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Cards Created:"}),e.jsx("span",{className:"font-arcade text-xs text-primary",children:Z?.totalCards||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Due Today:"}),e.jsx("span",{className:"font-arcade text-xs text-secondary",children:As?.dueCount||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Reviewed Today:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:U.reviewedToday||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Decks:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:U.decks?.length||0})]}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[e.jsxs(E,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>Oe(),children:[e.jsx(Je,{className:"w-3 h-3 mr-1"}),"Refresh"]}),e.jsx(E,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>be.mutate(),disabled:be.isPending,children:be.isPending?"Syncing...":"Sync Cards"})]}),Q.length>0&&e.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-arcade text-[10px] text-yellow-400",children:["PENDING CARDS (",Q.length,")"]}),e.jsx("div",{className:"flex gap-1",children:e.jsx(E,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{h.size===Q.length?j(new Set):j(new Set(Q.map(s=>s.id)))},children:h.size===Q.length?"None":"All"})})]}),h.size>0&&e.jsxs("div",{className:"flex gap-1 mb-2",children:[e.jsxs(E,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-green-600 hover:bg-green-700",onClick:()=>{h.forEach(s=>Re.mutate(s)),j(new Set)},children:[e.jsx(le,{className:"w-3 h-3 mr-1"}),"Approve (",h.size,")"]}),e.jsxs(E,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{h.forEach(s=>Me.mutate(s)),j(new Set)},children:[e.jsx(ce,{className:"w-3 h-3 mr-1"}),"Delete (",h.size,")"]})]}),e.jsx(ie,{className:"h-[200px]",children:e.jsx("div",{className:"space-y-2",children:Q.map(s=>e.jsx("div",{className:`p-2 bg-black/40 border text-xs ${h.has(s.id)?"border-primary":"border-secondary/30"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(se,{checked:h.has(s.id),onCheckedChange:l=>{const _=new Set(h);l?_.add(s.id):_.delete(s.id),j(_)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsx("div",{className:"font-terminal text-primary truncate",children:s.front}),e.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:s.back}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx($e,{variant:"outline",className:"text-[9px] border-blue-500/50 text-blue-400 shrink-0",children:s.deckName}),e.jsx(E,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>Is(s),title:"Edit card",children:e.jsx(je,{className:"w-3 h-3"})}),e.jsx(E,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-green-500/50 text-green-400 hover:bg-green-500/20",onClick:()=>Re.mutate(s.id),title:"Approve card",children:e.jsx(le,{className:"w-3 h-3"})}),e.jsx(E,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>Me.mutate(s.id),title:"Delete card",children:e.jsx(ce,{className:"w-3 h-3"})})]})]})]})},s.id))})})]})]}):e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400",children:U?.error||"Anki not connected"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),e.jsxs(E,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>Oe(),children:[e.jsx(Je,{className:"w-3 h-3 mr-1"}),"Retry"]})]})})]})]})})]})]})]}),e.jsx(Fe,{open:!!p,onOpenChange:s=>{s||c(null)},children:e.jsxs(Le,{"data-modal":"brain-edit-session",className:"bg-black border-2 border-primary rounded-none max-w-2xl translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(qe,{children:[e.jsxs(_e,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5"}),"EDIT SESSION #",a]}),e.jsx(ze,{className:"font-terminal text-muted-foreground",children:"Update WRAP methodology fields for this study session"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Mode"}),e.jsxs(We,{value:f.mode,onValueChange:s=>A(l=>({...l,mode:s})),children:[e.jsx(Ye,{className:"rounded-none border-secondary",children:e.jsx(He,{placeholder:"Select mode"})}),e.jsxs(Ue,{className:"rounded-none border-secondary bg-black",children:[e.jsx($,{value:"Core",children:"Core"}),e.jsx($,{value:"Sprint",children:"Sprint"}),e.jsx($,{value:"Drill",children:"Drill"}),e.jsx($,{value:"study",children:"Study"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Minutes"}),e.jsx(Be,{type:"number",value:f.minutes,onChange:s=>A(l=>({...l,minutes:s.target.value})),className:"rounded-none border-secondary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Cards"}),e.jsx(Be,{type:"number",value:f.cards,onChange:s=>A(l=>({...l,cards:s.target.value})),className:"rounded-none border-secondary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Confusions (comma-separated)"}),e.jsx(V,{value:f.confusions,onChange:s=>A(l=>({...l,confusions:s.target.value})),placeholder:"e.g., muscle insertion points, nerve pathways",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Weak Anchors (comma-separated)"}),e.jsx(V,{value:f.weakAnchors,onChange:s=>A(l=>({...l,weakAnchors:s.target.value})),placeholder:"e.g., brachial plexus diagram, ROM measurements",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Concepts (comma-separated)"}),e.jsx(V,{value:f.concepts,onChange:s=>A(l=>({...l,concepts:s.target.value})),placeholder:"e.g., upper extremity anatomy, peripheral nerves",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Issues (comma-separated)"}),e.jsx(V,{value:f.issues,onChange:s=>A(l=>({...l,issues:s.target.value})),placeholder:"e.g., interrupted by phone, lost focus after 30 min",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Notes"}),e.jsx(V,{value:f.notes,onChange:s=>A(l=>({...l,notes:s.target.value})),placeholder:"Free-form observations about the session",className:"rounded-none border-secondary min-h-[80px]"})]})]}),e.jsxs(Ke,{className:"gap-2",children:[e.jsxs(E,{variant:"outline",onClick:()=>c(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(E,{onClick:Ns,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})}),e.jsx(Xe,{open:u&&m.length>0,onOpenChange:d,children:e.jsxs(Ze,{"data-modal":"brain-delete-session",className:"bg-black border-2 border-destructive rounded-none translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(es,{children:[e.jsxs(ss,{className:"font-arcade text-destructive flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5"}),"CONFIRM DELETE"]}),e.jsxs(ts,{className:"font-terminal text-muted-foreground",children:["Are you sure you want to delete ",m.length," session",m.length!==1?"s":"","? This action cannot be undone."]})]}),e.jsxs(ns,{className:"gap-2",children:[e.jsx(as,{className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:"Cancel"}),e.jsxs(rs,{onClick:y,className:"font-terminal rounded-none bg-destructive hover:bg-destructive/80 text-destructive-foreground",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})}),e.jsx(Fe,{open:D!==null,onOpenChange:s=>{s||w(null)},children:e.jsxs(Le,{"data-modal":"brain-edit-draft",className:"bg-black border-2 border-primary rounded-none max-w-lg translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(qe,{children:[e.jsxs(_e,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5"}),"EDIT CARD"]}),e.jsx(ze,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),e.jsx(V,{value:T.front,onChange:s=>k(l=>({...l,front:s.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),e.jsx(V,{value:T.back,onChange:s=>k(l=>({...l,back:s.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),e.jsxs(We,{value:T.deckName,onValueChange:s=>k(l=>({...l,deckName:s})),children:[e.jsx(Ye,{className:"rounded-none border-secondary",children:e.jsx(He,{placeholder:"Select deck"})}),e.jsxs(Ue,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[e.jsx($,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),e.jsx($,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),e.jsx($,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),e.jsx($,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),e.jsx($,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),e.jsx($,{value:"PT::General",children:"PT::General"}),U?.decks?.filter(s=>!s.startsWith("PT::")).map(s=>e.jsx($,{value:s,children:s},s))]})]}),e.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",e.jsx("span",{className:"text-blue-400",children:T.deckName})]})]})]}),e.jsxs(Ke,{className:"gap-2",children:[e.jsxs(E,{variant:"outline",onClick:()=>w(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(E,{onClick:Es,disabled:ge.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),ge.isPending?"Saving...":"Save"]})]})]})})]})}export{Ot as default};
