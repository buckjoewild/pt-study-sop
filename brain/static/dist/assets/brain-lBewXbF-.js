import{c as He,r as c,j as e,b as U,R as qs,d as Bs,e as M,f as $s,P as is,g as Ks,u as ms,X as Ce}from"./index-YP2cgbTz.js";import{h as Us,i as Hs,j as Ws,u as K,a as P,g,L as Ys,k as Gs,C as we,B as C,f as Vs,S as qe,l as Be,T as he,P as ke,D as Qe,c as Xe,d as Ze,e as es,m as ss,I as ts,n as le,o as ns}from"./layout-8Z_bp1KC.js";import{C as be,c as ge,a as Ae,b as Ee}from"./card-DuwihTJ3.js";import{e as Js,B as De,S as as,a as rs,b as os,c as ls,d as $}from"./select-GF0O1_lA.js";import{c as xs,R as Qs,T as Xs,C as Zs,a as ce}from"./index-CLdI049Z.js";import{A as us,a as hs,b as ps,c as fs,d as bs,e as gs,f as ys,g as Ns,T as et}from"./alert-dialog-C5RSgvjO.js";import{F as st,a as cs}from"./folder-lGoGqWAG.js";import{F as tt}from"./file-text-D2t-ndiv.js";import{R as ds}from"./refresh-cw-CkWNDBe5.js";import{i as nt,f as at}from"./format-D7m0hUtg.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],ot=He("database",rt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],ct=He("file",lt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],it=He("layers",dt),js=c.forwardRef(({className:n,...r},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:U("w-full caption-bottom text-sm",n),...r})}));js.displayName="Table";const vs=c.forwardRef(({className:n,...r},a)=>e.jsx("thead",{ref:a,className:U("[&_tr]:border-b",n),...r}));vs.displayName="TableHeader";const Ss=c.forwardRef(({className:n,...r},a)=>e.jsx("tbody",{ref:a,className:U("[&_tr:last-child]:border-0",n),...r}));Ss.displayName="TableBody";const mt=c.forwardRef(({className:n,...r},a)=>e.jsx("tfoot",{ref:a,className:U("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",n),...r}));mt.displayName="TableFooter";const $e=c.forwardRef(({className:n,...r},a)=>e.jsx("tr",{ref:a,className:U("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",n),...r}));$e.displayName="TableRow";const Z=c.forwardRef(({className:n,...r},a)=>e.jsx("th",{ref:a,className:U("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),...r}));Z.displayName="TableHead";const ee=c.forwardRef(({className:n,...r},a)=>e.jsx("td",{ref:a,className:U("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),...r}));ee.displayName="TableCell";const xt=c.forwardRef(({className:n,...r},a)=>e.jsx("caption",{ref:a,className:U("mt-4 text-sm text-muted-foreground",n),...r}));xt.displayName="TableCaption";function ut(n,r,{checkForDefaultPrevented:a=!0}={}){return function(x){if(n?.(x),a===!1||!x.defaultPrevented)return r?.(x)}}var ht=qs[" useInsertionEffect ".trim().toString()]||Bs;function Cs({prop:n,defaultProp:r,onChange:a=()=>{},caller:d}){const[x,i,y]=pt({defaultProp:r,onChange:a}),p=n!==void 0,D=p?n:x;{const u=c.useRef(n!==void 0);c.useEffect(()=>{const j=u.current;j!==p&&console.warn(`${d} is changing from ${j?"controlled":"uncontrolled"} to ${p?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=p},[p,d])}const I=c.useCallback(u=>{if(p){const j=ft(u)?u(n):u;j!==n&&y.current?.(j)}else i(u)},[p,n,i,y]);return[D,I]}function pt({defaultProp:n,onChange:r}){const[a,d]=c.useState(n),x=c.useRef(a),i=c.useRef(r);return ht(()=>{i.current=r},[r]),c.useEffect(()=>{x.current!==a&&(i.current?.(a),x.current=a)},[a,x]),[a,d,i]}function ft(n){return typeof n=="function"}var H="Accordion",bt=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[We,gt,yt]=Js(H),[Ie]=$s(H,[yt,xs]),Ye=xs(),ws=M.forwardRef((n,r)=>{const{type:a,...d}=n,x=d,i=d;return e.jsx(We.Provider,{scope:n.__scopeAccordion,children:a==="multiple"?e.jsx(St,{...i,ref:r}):e.jsx(vt,{...x,ref:r})})});ws.displayName=H;var[ks,Nt]=Ie(H),[As,jt]=Ie(H,{collapsible:!1}),vt=M.forwardRef((n,r)=>{const{value:a,defaultValue:d,onValueChange:x=()=>{},collapsible:i=!1,...y}=n,[p,D]=Cs({prop:a,defaultProp:d??"",onChange:x,caller:H});return e.jsx(ks,{scope:n.__scopeAccordion,value:M.useMemo(()=>p?[p]:[],[p]),onItemOpen:D,onItemClose:M.useCallback(()=>i&&D(""),[i,D]),children:e.jsx(As,{scope:n.__scopeAccordion,collapsible:i,children:e.jsx(Es,{...y,ref:r})})})}),St=M.forwardRef((n,r)=>{const{value:a,defaultValue:d,onValueChange:x=()=>{},...i}=n,[y,p]=Cs({prop:a,defaultProp:d??[],onChange:x,caller:H}),D=M.useCallback(u=>p((j=[])=>[...j,u]),[p]),I=M.useCallback(u=>p((j=[])=>j.filter(_=>_!==u)),[p]);return e.jsx(ks,{scope:n.__scopeAccordion,value:y,onItemOpen:D,onItemClose:I,children:e.jsx(As,{scope:n.__scopeAccordion,collapsible:!0,children:e.jsx(Es,{...i,ref:r})})})}),[Ct,Oe]=Ie(H),Es=M.forwardRef((n,r)=>{const{__scopeAccordion:a,disabled:d,dir:x,orientation:i="vertical",...y}=n,p=M.useRef(null),D=Ks(p,r),I=gt(a),j=Hs(x)==="ltr",_=ut(n.onKeyDown,O=>{if(!bt.includes(O.key))return;const R=O.target,F=I().filter(Y=>!Y.ref.current?.disabled),N=F.findIndex(Y=>Y.ref.current===R),w=F.length;if(N===-1)return;O.preventDefault();let b=N;const V=0,v=w-1,A=()=>{b=N+1,b>v&&(b=V)},W=()=>{b=N-1,b<V&&(b=v)};switch(O.key){case"Home":b=V;break;case"End":b=v;break;case"ArrowRight":i==="horizontal"&&(j?A():W());break;case"ArrowDown":i==="vertical"&&A();break;case"ArrowLeft":i==="horizontal"&&(j?W():A());break;case"ArrowUp":i==="vertical"&&W();break}const T=b%w;F[T].ref.current?.focus()});return e.jsx(Ct,{scope:a,disabled:d,direction:x,orientation:i,children:e.jsx(We.Slot,{scope:a,children:e.jsx(is.div,{...y,"data-orientation":i,ref:D,onKeyDown:d?void 0:_})})})}),Te="AccordionItem",[wt,Ge]=Ie(Te),Ds=M.forwardRef((n,r)=>{const{__scopeAccordion:a,value:d,...x}=n,i=Oe(Te,a),y=Nt(Te,a),p=Ye(a),D=Us(),I=d&&y.value.includes(d)||!1,u=i.disabled||n.disabled;return e.jsx(wt,{scope:a,open:I,disabled:u,triggerId:D,children:e.jsx(Qs,{"data-orientation":i.orientation,"data-state":Ms(I),...p,...x,ref:r,disabled:u,open:I,onOpenChange:j=>{j?y.onItemOpen(d):y.onItemClose(d)}})})});Ds.displayName=Te;var Ts="AccordionHeader",Is=M.forwardRef((n,r)=>{const{__scopeAccordion:a,...d}=n,x=Oe(H,a),i=Ge(Ts,a);return e.jsx(is.h3,{"data-orientation":x.orientation,"data-state":Ms(i.open),"data-disabled":i.disabled?"":void 0,...d,ref:r})});Is.displayName=Ts;var Ke="AccordionTrigger",Os=M.forwardRef((n,r)=>{const{__scopeAccordion:a,...d}=n,x=Oe(H,a),i=Ge(Ke,a),y=jt(Ke,a),p=Ye(a);return e.jsx(We.ItemSlot,{scope:a,children:e.jsx(Xs,{"aria-disabled":i.open&&!y.collapsible||void 0,"data-orientation":x.orientation,id:i.triggerId,...p,...d,ref:r})})});Os.displayName=Ke;var Ps="AccordionContent",Rs=M.forwardRef((n,r)=>{const{__scopeAccordion:a,...d}=n,x=Oe(H,a),i=Ge(Ps,a),y=Ye(a);return e.jsx(Zs,{role:"region","aria-labelledby":i.triggerId,"data-orientation":x.orientation,...y,...d,ref:r,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...n.style}})});Rs.displayName=Ps;function Ms(n){return n?"open":"closed"}var kt=ws,At=Ds,Et=Is,Fs=Os,Ls=Rs;const Ue=kt,de=c.forwardRef(({className:n,...r},a)=>e.jsx(At,{ref:a,className:U("border-b",n),...r}));de.displayName="AccordionItem";const ie=c.forwardRef(({className:n,children:r,...a},d)=>e.jsx(Et,{className:"flex",children:e.jsxs(Fs,{ref:d,className:U("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",n),...a,children:[r,e.jsx(Ws,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));ie.displayName=Fs.displayName;const me=c.forwardRef(({className:n,children:r,...a},d)=>e.jsx(Ls,{ref:d,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:e.jsx("div",{className:U("pb-4 pt-0",n),children:r})}));me.displayName=Ls.displayName;const Dt=`You are extracting a full course syllabus for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Top-level structure:
{
  "term": {
    "startDate": "2026-01-05",
    "endDate": "2026-04-24",
    "timezone": "America/Chicago"
  },
  "modules": [
    {
      "name": "Module 1: ...",
      "orderIndex": 1,
      "topics": ["..."],
      "readings": ["..."],
      "assessments": ["..."]
    }
  ],
  "events": [
    {
      "type": "class" | "lecture" | "reading" | "topic" | "assignment" | "quiz" | "exam" | "assessment",
      "title": "string",
      "date": "YYYY-MM-DD",
      "dueDate": "YYYY-MM-DD | null",
      "startTime": "HH:MM | null",
      "endTime": "HH:MM | null",
      "daysOfWeek": ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
      "delivery": "in_person" | "virtual_sync" | "virtual_async" | "hybrid",
      "assessmentType": "EA | null",
      "moduleName": "Module 1: ... | null",
      "notes": "string | null"
    }
  ]
}

Rules:
1. Include ALL items: class meetings, assignments, quizzes, exams, topics, readings, virtual synchronous/asynchronous activities, and learning assessments (EA).
2. For repeating class meetings, set daysOfWeek + startTime/endTime, and include term start/end.
3. For one-off items, set date or dueDate.
4. Keep moduleName when items belong to a module.
5. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,Tt=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,It=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function Ot(){const n=ms(),[r,a]=c.useState(null),[d,x]=c.useState(null),[i,y]=c.useState(""),[p,D]=c.useState(""),[I,u]=c.useState(null),[j,_]=c.useState(""),[O,R]=c.useState(null),[F,N]=c.useState(null),[w,b]=c.useState({}),[V,v]=c.useState({}),[A,W]=c.useState(new Set),[T,Y]=c.useState(new Set),[pe,ae]=c.useState(null),J=c.useRef(null),{data:Pe=[]}=K({queryKey:["courses"],queryFn:()=>g.courses.getActive()}),{data:k=[]}=K({queryKey:["modules",r],queryFn:()=>r?g.modules.getByCourse(r):Promise.resolve([]),enabled:!!r}),{data:q=[]}=K({queryKey:["scheduleEvents",r],queryFn:()=>r?g.scheduleEvents.getByCourse(r):Promise.resolve([]),enabled:!!r}),{data:se=[]}=K({queryKey:["learningObjectives",r],queryFn:()=>r?g.learningObjectives.getByCourse(r):Promise.resolve([]),enabled:!!r}),Q=P({mutationFn:async s=>{if(!r)throw new Error("Select a course first");const o=JSON.parse(te(s));return g.syllabus.importBulk(r,o)},onSuccess:s=>{n.invalidateQueries({queryKey:["scheduleEvents"]}),n.invalidateQueries({queryKey:["modules"]}),y(""),N({type:"success",message:`Imported: ${s.modulesCreated} modules, ${s.eventsCreated} events (${s.classMeetingsExpanded} class meetings expanded)`}),u(null)},onError:s=>{N({type:"error",message:s.message||"Failed to import syllabus"}),u(s.message||"Failed to import syllabus")}}),re=P({mutationFn:async s=>{if(!r)throw new Error("Select a course first");const o=JSON.parse(te(s));return g.learningObjectives.createBulk(r,d,o)},onSuccess:()=>{n.invalidateQueries({queryKey:["learningObjectives"]}),D(""),u(null)},onError:s=>{u(s.message||"Failed to import LOs")}}),xe=P({mutationFn:({id:s,data:o})=>g.modules.update(s,o),onSuccess:()=>{n.invalidateQueries({queryKey:["modules"]})}}),Re=P({mutationFn:s=>g.modules.delete(s),onSuccess:()=>{n.invalidateQueries({queryKey:["modules"]})}}),Me=P({mutationFn:s=>g.modules.deleteMany(s),onSuccess:()=>{n.invalidateQueries({queryKey:["modules"]}),W(new Set)},onError:s=>{u(s.message||"Failed to delete modules")}}),Ne=P({mutationFn:({id:s,data:o})=>g.scheduleEvents.update(s,o),onSuccess:()=>{n.invalidateQueries({queryKey:["scheduleEvents"]})}}),Fe=P({mutationFn:s=>g.scheduleEvents.delete(s),onSuccess:()=>{n.invalidateQueries({queryKey:["scheduleEvents"]})}}),Le=P({mutationFn:s=>g.scheduleEvents.deleteMany(s),onSuccess:()=>{n.invalidateQueries({queryKey:["scheduleEvents"]}),Y(new Set)},onError:s=>{u(s.message||"Failed to delete schedule items")}}),G=s=>{navigator.clipboard.writeText(s)},te=s=>{const o=s.trim();if(!o)return"";const f=o.match(/```json\s*([\s\S]*?)```/i)||o.match(/```\s*([\s\S]*?)```/i),S=f?f[1].trim():o,L=S.indexOf("{"),ne=S.lastIndexOf("}");return L!==-1&&ne!==-1&&ne>L?S.slice(L,ne+1).trim():S},je=(s,o,f)=>{if(!o.length)return;const S={type:s,ids:o,label:f};J.current=S,ae(S)},X=async()=>{try{R(null);const s=j,f=await g.brain.ingest(s,"pasted_wrap.md");f.sessionSaved?(R({type:"success",message:`âœ“ Session saved! ID: ${f.sessionId}, Cards: ${f.cardsCreated||0}`}),_("")):R({type:"error",message:f.errors?.join(", ")||f.message})}catch(s){R({type:"error",message:s.message||"Failed to ingest"})}};return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"border-2 border-primary rounded-none p-4 bg-primary/5",children:[e.jsx("h2",{className:"text-xl font-arcade text-primary mb-4",children:"WRAP SESSION INGESTION"}),O&&e.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${O.type==="success"?"bg-green-900/30 border border-green-500 text-green-400":"bg-red-900/30 border border-red-500 text-red-400"}`,children:O.message}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>G(It),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:j,onChange:s=>{_(s.target.value),R(null)}})]}),e.jsx("button",{onClick:X,disabled:!j,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]}),e.jsx("h2",{className:"text-xl font-arcade text-primary",children:"MATERIAL INGESTION"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:r||"",onChange:s=>{a(s.target.value?parseInt(s.target.value):null),x(null)},children:[e.jsx("option",{value:"",children:"-- Select Course --"}),Pe.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),I&&e.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:I}),r&&e.jsxs(Ue,{type:"multiple",className:"border border-secondary/40 rounded-none divide-y divide-secondary/40",children:[e.jsxs(de,{value:"syllabus-import",className:"border-secondary/40",children:[e.jsx(ie,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"SYLLABUS IMPORT (MODULES + SCHEDULE)"}),e.jsxs(me,{className:"px-3",children:[e.jsx("button",{onClick:()=>G(Dt),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (combined JSON object) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"term":{"startDate":"2026-01-15","endDate":"2026-05-01","timezone":"America/Chicago"},"modules":[...],"events":[...]}',value:i,onChange:s=>{y(s.target.value),N(null)}}),e.jsx("button",{onClick:()=>Q.mutate(i),disabled:!i||Q.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:Q.isPending?"Importing...":"Import Syllabus"}),F&&e.jsx("div",{className:`mt-2 p-2 border font-terminal text-xs ${F.type==="success"?"border-green-500 text-green-400":"border-red-500 text-red-400"}`,children:F.message})]})]}),e.jsxs(de,{value:"modules",className:"border-secondary/40",children:[e.jsx(ie,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"MODULES"}),e.jsx(me,{className:"px-3",children:k.length===0?e.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"No modules yet. Add modules manually or import."}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const s=new Set;A.size!==k.length&&k.forEach(o=>s.add(o.id)),W(s)},children:A.size===k.length?"Uncheck All":"Check All"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:A.size===0,onClick:()=>{je("modules",Array.from(A),`Delete ${A.size} module(s)? This cannot be undone.`)},children:"Delete"}),e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:A.size===0,onClick:()=>{A.forEach(s=>{const o=w[s];o&&xe.mutate({id:s,data:o})}),b(s=>{const o={...s};return A.forEach(f=>{delete o[f]}),o})},children:"Save"})]}),e.jsxs("table",{className:"w-full text-sm font-terminal",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-secondary/50",children:[e.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),e.jsx("th",{className:"text-left p-2",children:"Module"}),e.jsx("th",{className:"text-center p-2",children:"Order"}),e.jsx("th",{className:"text-center p-2",children:"Files"}),e.jsx("th",{className:"text-center p-2",children:"NotebookLM"}),e.jsx("th",{className:"text-center p-2",children:"Status"}),e.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),e.jsx("tbody",{children:k.map(s=>e.jsxs("tr",{className:"border-b border-secondary/30",children:[e.jsx("td",{className:"text-center p-2",children:e.jsx(ce,{checked:A.has(s.id),onCheckedChange:o=>W(f=>{const S=new Set(f);return o?S.add(s.id):S.delete(s.id),S}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:w[s.id]?.name??s.name,onChange:o=>b(f=>({...f,[s.id]:{...f[s.id],name:o.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"number",className:"w-16 bg-black border border-secondary rounded-none p-1 text-xs font-terminal text-center",value:w[s.id]?.orderIndex??s.orderIndex??0,onChange:o=>b(f=>({...f,[s.id]:{...f[s.id],orderIndex:parseInt(o.target.value||"0",10)}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx(ce,{checked:s.filesDownloaded,onCheckedChange:o=>xe.mutate({id:s.id,data:{filesDownloaded:!!o}}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"text-center p-2",children:e.jsx(ce,{checked:s.notebooklmLoaded,onCheckedChange:o=>xe.mutate({id:s.id,data:{notebooklmLoaded:!!o}}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"text-center p-2",children:s.filesDownloaded&&s.notebooklmLoaded?e.jsx("span",{className:"text-green-400",children:"Ready"}):e.jsx("span",{className:"text-yellow-400",children:"Pending"})}),e.jsxs("td",{className:"text-center p-2 space-x-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!w[s.id],onClick:()=>{const o=w[s.id];o&&(xe.mutate({id:s.id,data:o}),b(f=>{const S={...f};return delete S[s.id],S}))},children:"Save"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>Re.mutate(s.id),children:"Delete"})]})]},s.id))})]})]})})]}),e.jsxs(de,{value:"schedule-items",className:"border-secondary/40",children:[e.jsx(ie,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"SCHEDULE ITEMS"}),e.jsx(me,{className:"px-3",children:q.length===0?e.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"No schedule items yet. Import the syllabus or add events manually."}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const s=new Set;T.size!==q.length&&q.forEach(o=>s.add(o.id)),Y(s)},children:T.size===q.length?"Uncheck All":"Check All"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:T.size===0,onClick:()=>{je("schedule",Array.from(T),`Delete ${T.size} schedule item(s)? This cannot be undone.`)},children:"Delete"}),e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:T.size===0,onClick:()=>{T.forEach(s=>{const o=V[s];o&&Ne.mutate({id:s,data:o})}),v(s=>{const o={...s};return T.forEach(f=>{delete o[f]}),o})},children:"Save"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs font-terminal",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-secondary/50",children:[e.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),e.jsx("th",{className:"text-left p-2",children:"Type"}),e.jsx("th",{className:"text-left p-2",children:"Delivery"}),e.jsx("th",{className:"text-left p-2",children:"Title"}),e.jsx("th",{className:"text-center p-2",children:"Date"}),e.jsx("th",{className:"text-center p-2",children:"Start"}),e.jsx("th",{className:"text-center p-2",children:"End"}),e.jsx("th",{className:"text-center p-2",children:"Due"}),e.jsx("th",{className:"text-left p-2",children:"Notes"}),e.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),e.jsx("tbody",{children:q.map(s=>{const o=V[s.id]||{},f=o.type??s.type??"",S=o.delivery??s.delivery??"",L=o.title??s.title??"",ne=o.date??s.date??"",z=o.startTime??s.startTime??"",ve=o.endTime??s.endTime??"",fe=o.dueDate??s.dueDate??"",Se=o.notes??s.notes??"",ze=!!V[s.id];return e.jsxs("tr",{className:"border-b border-secondary/30 align-top",children:[e.jsx("td",{className:"text-center p-2",children:e.jsx(ce,{checked:T.has(s.id),onCheckedChange:h=>Y(m=>{const oe=new Set(m);return h?oe.add(s.id):oe.delete(s.id),oe}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),e.jsx("td",{className:"p-2",children:e.jsx("select",{className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:f,onChange:h=>v(m=>({...m,[s.id]:{...m[s.id],type:h.target.value}})),children:["class","lecture","reading","topic","assignment","quiz","exam","assessment","other"].map(h=>e.jsx("option",{value:h,children:h},h))})}),e.jsx("td",{className:"p-2",children:e.jsx("select",{className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:S,onChange:h=>v(m=>({...m,[s.id]:{...m[s.id],delivery:h.target.value}})),children:["","in_person","virtual_sync","virtual_async","online_module","hybrid"].map(h=>e.jsx("option",{value:h,children:h||"--"},h))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:L,onChange:h=>v(m=>({...m,[s.id]:{...m[s.id],title:h.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:ne||"",onChange:h=>v(m=>({...m,[s.id]:{...m[s.id],date:h.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:z||"",onChange:h=>v(m=>({...m,[s.id]:{...m[s.id],startTime:h.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:ve||"",onChange:h=>v(m=>({...m,[s.id]:{...m[s.id],endTime:h.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:fe||"",onChange:h=>v(m=>({...m,[s.id]:{...m[s.id],dueDate:h.target.value}}))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:Se||"",onChange:h=>v(m=>({...m,[s.id]:{...m[s.id],notes:h.target.value}}))})}),e.jsxs("td",{className:"text-center p-2 space-x-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!ze,onClick:()=>{Ne.mutate({id:s.id,data:{type:f,title:L,date:ne,startTime:z,endTime:ve,dueDate:fe,notes:Se,delivery:S}}),v(h=>{const m={...h};return delete m[s.id],m})},children:"Save"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>Fe.mutate(s.id),children:"Delete"})]})]},s.id)})})]})})]})})]}),e.jsxs(de,{value:"learning-objectives",className:"border-secondary/40",children:[e.jsx(ie,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"LEARNING OBJECTIVES IMPORT"}),e.jsxs(me,{className:"px-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:d||"",onChange:s=>x(s.target.value?parseInt(s.target.value):null),children:[e.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),k.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsx("button",{onClick:()=>G(Tt),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:p,onChange:s=>D(s.target.value)}),e.jsx("button",{onClick:()=>re.mutate(p),disabled:!p||re.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:re.isPending?"Importing...":"Import LOs"}),se.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",se.length,")"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:se.map(s=>e.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[e.jsx("span",{className:"text-primary",children:s.loCode}),": ",s.title,e.jsx("span",{className:`ml-2 text-[10px] px-1 rounded ${s.status==="solid"?"bg-green-600":s.status==="in_progress"?"bg-yellow-600":s.status==="need_review"?"bg-orange-600":"bg-gray-600"}`,children:s.status})]},s.id))})]})]})]})]}),e.jsx(us,{open:!!pe,onOpenChange:s=>!s&&ae(null),children:e.jsxs(hs,{className:"bg-black border-2 border-primary rounded-none font-terminal text-primary shadow-none max-w-md translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(ps,{className:"text-left",children:[e.jsx(fs,{className:"font-arcade text-destructive",children:"CONFIRM_DELETE"}),e.jsx(bs,{className:"font-terminal text-muted-foreground",children:pe?.label})]}),e.jsxs(gs,{className:"gap-2 sm:justify-end",children:[e.jsx(ys,{className:"rounded-none border-secondary font-terminal text-xs hover:bg-secondary/20",onClick:()=>{J.current=null,ae(null)},children:"CANCEL"}),e.jsx(Ns,{className:"rounded-none bg-destructive text-destructive-foreground font-arcade text-xs hover:bg-destructive/80",type:"button",onClick:()=>{const s=J.current;s&&(s.type==="modules"?Me.mutate(s.ids):Le.mutate(s.ids),J.current=null,ae(null))},children:"DELETE"})]})]})})]})}const Pt=(n,r="MM/dd")=>{if(!n)return"-";try{const a=n instanceof Date?n:new Date(n);return nt(a)?at(a,r):"-"}catch{return"-"}},ye=n=>{if(Array.isArray(n))return n.filter(r=>typeof r=="string");if(typeof n=="string"){const r=n.trim();if(!r)return[];try{const a=JSON.parse(r);if(Array.isArray(a))return a.filter(d=>typeof d=="string")}catch{}return r.split(",").map(a=>a.trim()).filter(Boolean)}return[]};function Ut(){const[n,r]=c.useState(new Set),[a,d]=c.useState(null),[x,i]=c.useState(!1),[y,p]=c.useState([]),[D,I]=c.useState(!1),[u,j]=c.useState(new Set),[_,O]=c.useState(null),[R,F]=c.useState({front:"",back:"",deckName:""}),[N,w]=c.useState({mode:"",minutes:"",cards:"",confusions:"",weakAnchors:"",concepts:"",issues:"",notes:""}),[b,V]=c.useState("School"),[v,A]=c.useState(null),[W,T]=c.useState(""),[Y,pe]=c.useState(!1),[ae,J]=c.useState(!1),Pe=[{name:"EBP",path:"School/Evidence Based Practice"},{name:"ExPhys",path:"School/Exercise Physiology"},{name:"MS1",path:"School/Movement Science 1"},{name:"Neuro",path:"School/Neuroscience"},{name:"TI",path:"School/Theraputic Intervention"}],{data:k=[],isLoading:q}=K({queryKey:["sessions"],queryFn:g.sessions.getAll}),{data:se}=K({queryKey:["brain","metrics"],queryFn:g.brain.getMetrics}),Q=ms(),re=P({mutationFn:t=>g.sessions.deleteMany(t),onSuccess:()=>{Q.invalidateQueries({queryKey:["sessions"]}),Q.invalidateQueries({queryKey:["brain","metrics"]}),r(new Set)}}),xe=P({mutationFn:({id:t,updates:l})=>g.sessions.update(t,l),onSuccess:()=>{Q.invalidateQueries({queryKey:["sessions"]}),Q.invalidateQueries({queryKey:["brain","metrics"]}),d(null)}}),Re=t=>{r(l=>{const E=new Set(l);return E.has(t)?E.delete(t):E.add(t),E})},Me=()=>{n.size===k.length?r(new Set):r(new Set(k.map(t=>t.id)))},Ne=()=>{n.size!==0&&(p(Array.from(n)),i(!0))},Fe=t=>{p([t]),i(!0)},Le=()=>{re.mutate(y),i(!1),p([])};c.useEffect(()=>{if(a!==null){const t=k.find(l=>l.id===a);t&&w({mode:t.mode||"",minutes:t.minutes?.toString()||"",cards:t.cards?.toString()||"",confusions:ye(t.confusions).join(", "),weakAnchors:ye(t.weakAnchors).join(", "),concepts:ye(t.concepts).join(", "),issues:ye(t.issues).join(", "),notes:t.notes||""})}},[a,k]);const G=a!==null?k.find(t=>t.id===a):null,te=typeof window<"u"&&new URLSearchParams(window.location.search).has("debugModals");c.useEffect(()=>{a!==null&&!q&&!G&&(te&&console.warn("[ModalDebug][Brain] Missing session for edit; closing.",{editingSession:a,sessionsCount:k.length}),d(null))},[te,a,G,k.length,q]),c.useEffect(()=>{te&&console.info("[ModalDebug][Brain] state",{editingSession:a,hasEditingSessionData:!!G,deleteDialogOpen:x,sessionsToDelete:y.length,sessionsLoading:q})},[te,x,a,G,q,y.length]);const je=()=>{if(a===null)return;const t=B=>B?B.split(",").map(ue=>ue.trim()).filter(Boolean):[],l=B=>B.length?JSON.stringify(B):null,E={mode:N.mode||"study",minutes:parseInt(N.minutes)||0,cards:parseInt(N.cards)||0,confusions:l(t(N.confusions)),weakAnchors:l(t(N.weakAnchors)),concepts:l(t(N.concepts)),issues:l(t(N.issues)),notes:N.notes||null};xe.mutate({id:a,updates:E})},{data:X}=K({queryKey:["obsidian","status"],queryFn:g.obsidian.getStatus,refetchInterval:3e4}),{data:s,refetch:o}=K({queryKey:["obsidian","files",b],queryFn:()=>g.obsidian.getFiles(b),enabled:X?.connected===!0}),f=async t=>{try{const l=await g.obsidian.getFile(t);l.success&&l.content!==void 0&&(A(t),T(l.content),J(!1))}catch(l){console.error("Failed to load file:",l)}},S=async()=>{if(v){pe(!0);try{(await g.obsidian.saveFile(v,W)).success&&J(!1)}catch(t){console.error("Failed to save file:",t)}finally{pe(!1)}}},L=t=>{V(t),A(null),T("")},ne=()=>{const t=new Date().toISOString().split("T")[0],l=b?`${b}/Session-${t}.md`:`Session-${t}.md`,E=`# Study Session - ${t}

## Summary


## Concepts Covered
- 

## Strengths
- 

## Areas to Review
- 

## Notes

`;A(l),T(E),J(!0)},{data:z,isLoading:ve,refetch:fe}=K({queryKey:["anki","status"],queryFn:g.anki.getStatus,refetchInterval:3e4}),{data:Se}=K({queryKey:["anki","due"],queryFn:g.anki.getDue,enabled:z?.connected===!0}),{data:ze=[],refetch:h}=K({queryKey:["anki","drafts"],queryFn:g.anki.getDrafts}),m=ze.filter(t=>t.status==="pending"),oe=P({mutationFn:g.anki.sync,onSuccess:()=>{Q.invalidateQueries({queryKey:["anki"]}),h()}}),Ve=P({mutationFn:t=>g.anki.approveDraft(t),onSuccess:()=>{h()}}),Je=P({mutationFn:t=>g.anki.deleteDraft(t),onSuccess:()=>{h()}}),_e=P({mutationFn:({id:t,data:l})=>g.anki.updateDraft(t,l),onSuccess:()=>{h(),O(null)}}),zs=t=>{O(t.id),F({front:t.front,back:t.back,deckName:t.deckName})},_s=()=>{_!==null&&_e.mutate({id:_,data:R})};return e.jsxs(Ys,{children:[te&&e.jsxs("div",{className:"fixed bottom-12 right-4 z-[70] bg-black/80 border border-primary text-primary font-terminal text-[10px] px-2 py-1 rounded-none",children:[e.jsx("div",{children:"Brain modals"}),e.jsxs("div",{children:["Edit session: ",a??"none"]}),e.jsxs("div",{children:["Edit data: ",G?"yes":"no"]}),e.jsxs("div",{children:["Delete open: ",x?"yes":"no"]}),e.jsxs("div",{children:["Delete count: ",y.length]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h1",{className:"font-arcade text-xl text-primary flex items-center gap-2",children:[e.jsx(Gs,{className:"w-6 h-6"}),"BRAIN ANALYTICS"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SYSTEM STATUS"}),e.jsx(be,{className:"brain-card rounded-none",children:e.jsx(ge,{className:"p-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 font-terminal text-xs",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${X?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Obsidian"}),e.jsx("span",{className:"text-primary",children:X?.connected?"Online":"Offline"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${z?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Anki"}),e.jsx("span",{className:"text-primary",children:z?.connected?"Connected":"Offline"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-muted-foreground",children:[e.jsxs("span",{children:["Cards: ",e.jsx("span",{className:"text-primary",children:se?.totalCards||0})]}),e.jsxs("span",{children:["Drafts: ",e.jsx("span",{className:"text-primary",children:m.length})]})]})]})})})]}),e.jsx(Ue,{type:"single",collapsible:!0,className:"border border-secondary/40 rounded-none",children:e.jsxs(de,{value:"ingestion",className:"border-secondary/40",children:[e.jsx(ie,{className:"font-arcade text-sm text-primary px-4 hover:no-underline",children:"DATA INGESTION TOOLS"}),e.jsx(me,{className:"px-2",children:e.jsx("div",{className:"pt-2",children:e.jsx(Ot,{})})})]})}),e.jsx(Ue,{type:"single",collapsible:!0,className:"border border-secondary/40 rounded-none",children:e.jsxs(de,{value:"integrations",className:"border-secondary/40",children:[e.jsx(ie,{className:"font-arcade text-sm text-primary px-4 hover:no-underline",children:"INTEGRATIONS"}),e.jsx(me,{className:"px-2",children:e.jsxs("div",{className:"space-y-4 pt-2 min-w-0",children:[e.jsxs(be,{className:"brain-card rounded-none",children:[e.jsxs(Ae,{className:"border-b border-secondary/50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ee,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(st,{className:"w-4 h-4"}),"OBSIDIAN VAULT",X?.connected?e.jsx(we,{className:"w-3 h-3 text-green-500"}):e.jsx(Ce,{className:"w-3 h-3 text-red-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(C,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:ne,disabled:!X?.connected,children:[e.jsx(tt,{className:"w-3 h-3 mr-1"}),"New Note"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:D,onChange:t=>I(t.target.checked),disabled:!X?.connected,className:"w-4 h-4 accent-primary"}),e.jsx("span",{className:"font-terminal text-xs",children:"Auto-Sync"})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 mt-2 flex-wrap",children:Pe.map(t=>e.jsx(C,{size:"sm",variant:b===t.path?"default":"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:()=>L(t.path),children:t.name},t.path))}),b&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 font-terminal text-xs text-muted-foreground",children:[e.jsx("button",{onClick:()=>L(""),className:"hover:text-primary",children:"vault"}),b.split("/").map((t,l,E)=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Vs,{className:"w-3 h-3"}),e.jsx("button",{onClick:()=>L(E.slice(0,l+1).join("/")),className:"hover:text-primary",children:t})]},l))]})]}),e.jsx(ge,{className:"p-0",children:X?.connected?e.jsxs("div",{className:"grid md:grid-cols-2 h-[240px] md:h-[300px]",children:[e.jsx("div",{className:"border-r border-secondary/30",children:e.jsx(qe,{className:"h-[240px] md:h-[300px]",children:e.jsxs("div",{className:"p-2 space-y-1",children:[b&&e.jsxs("button",{onClick:()=>{const t=b.split("/");t.pop(),L(t.join("/"))},className:"w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs text-muted-foreground",children:[e.jsx(cs,{className:"w-3 h-3"}),".."]}),s?.files?.map(t=>{const l=typeof t=="string"?t:t.path,E=l.endsWith("/"),B=l.replace(/\/$/,"").split("/").pop()||l;return e.jsxs("button",{onClick:()=>{if(E){const ue=B.replace(/\/$/,"");L(b?`${b}/${ue}`:ue)}else{const ue=b?`${b}/${B}`:B;f(ue)}},className:`w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs ${v?.endsWith(B)?"bg-primary/20 text-primary":""}`,children:[E?e.jsx(cs,{className:"w-3 h-3 text-yellow-500"}):e.jsx(ct,{className:"w-3 h-3 text-blue-400"}),B]},l)})]})})}),e.jsx("div",{className:"flex flex-col h-[240px] md:h-[300px]",children:v?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-secondary/30",children:[e.jsxs("span",{className:"font-terminal text-xs text-primary truncate",children:[v.split("/").pop(),ae&&e.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),e.jsxs(C,{size:"sm",variant:"ghost",onClick:S,disabled:!ae||Y,className:"h-6 px-2",children:[e.jsx(Be,{className:"w-3 h-3 mr-1"}),Y?"Saving...":"Save"]})]}),e.jsx("textarea",{value:W,onChange:t=>{T(t.target.value),J(!0)},className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"File content..."})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center font-terminal text-xs text-muted-foreground",children:"Select a file to edit"})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400 mb-2",children:"Obsidian Offline"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Obsidian with Local REST API plugin enabled"})]})})]}),e.jsxs(be,{className:"brain-card rounded-none",children:[e.jsx(Ae,{className:"border-b border-secondary/50 p-3",children:e.jsxs(Ee,{className:"font-arcade text-xs flex items-center gap-2 text-muted-foreground",children:[e.jsx(it,{className:"w-3 h-3"}),"ANKI INTEGRATION",z?.connected?e.jsx(we,{className:"w-3 h-3 text-green-500 ml-auto"}):e.jsx(Ce,{className:"w-3 h-3 text-red-500 ml-auto"})]})}),e.jsx(ge,{className:"p-4 space-y-3",children:ve?e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):z?.connected?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Status:"}),e.jsx(De,{variant:"outline",className:"bg-green-500/20 text-green-400 border-green-500",children:"Connected"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Cards Created:"}),e.jsx("span",{className:"font-arcade text-xs text-primary",children:se?.totalCards||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Due Today:"}),e.jsx("span",{className:"font-arcade text-xs text-secondary",children:Se?.dueCount||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Reviewed Today:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:z.reviewedToday||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Decks:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:z.decks?.length||0})]}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[e.jsxs(C,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>fe(),children:[e.jsx(ds,{className:"w-3 h-3 mr-1"}),"Refresh"]}),e.jsx(C,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>oe.mutate(),disabled:oe.isPending,children:oe.isPending?"Syncing...":"Sync Cards"})]}),m.length>0&&e.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-arcade text-[10px] text-yellow-400",children:["PENDING CARDS (",m.length,")"]}),e.jsx("div",{className:"flex gap-1",children:e.jsx(C,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{u.size===m.length?j(new Set):j(new Set(m.map(t=>t.id)))},children:u.size===m.length?"None":"All"})})]}),u.size>0&&e.jsxs("div",{className:"flex gap-1 mb-2",children:[e.jsxs(C,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-green-600 hover:bg-green-700",onClick:()=>{u.forEach(t=>Ve.mutate(t)),j(new Set)},children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Approve (",u.size,")"]}),e.jsxs(C,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{u.forEach(t=>Je.mutate(t)),j(new Set)},children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"Delete (",u.size,")"]})]}),e.jsx(qe,{className:"h-[200px]",children:e.jsx("div",{className:"space-y-2",children:m.map(t=>e.jsx("div",{className:`p-2 bg-black/40 border text-xs ${u.has(t.id)?"border-primary":"border-secondary/30"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ce,{checked:u.has(t.id),onCheckedChange:l=>{const E=new Set(u);l?E.add(t.id):E.delete(t.id),j(E)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsx("div",{className:"font-terminal text-primary truncate",children:t.front}),e.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:t.back}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(De,{variant:"outline",className:"text-[9px] border-blue-500/50 text-blue-400 shrink-0",children:t.deckName}),e.jsx(C,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>zs(t),title:"Edit card",children:e.jsx(ke,{className:"w-3 h-3"})}),e.jsx(C,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-green-500/50 text-green-400 hover:bg-green-500/20",onClick:()=>Ve.mutate(t.id),title:"Approve card",children:e.jsx(we,{className:"w-3 h-3"})}),e.jsx(C,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>Je.mutate(t.id),title:"Delete card",children:e.jsx(he,{className:"w-3 h-3"})})]})]})]})},t.id))})})]})]}):e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400",children:z?.error||"Anki not connected"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),e.jsxs(C,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>fe(),children:[e.jsx(ds,{className:"w-3 h-3 mr-1"}),"Retry"]})]})})]})]})})]})}),e.jsxs("div",{className:"mb-6 min-w-0",children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SESSION EVIDENCE"}),e.jsxs(be,{className:"brain-card rounded-none",children:[e.jsx(Ae,{className:"border-b border-secondary/60 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Ee,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(ot,{className:"w-4 h-4"}),"SESSION EVIDENCE TABLE"]}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Raw WRAP data. All metrics derive from these fields."})]}),n.size>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-terminal text-xs text-muted-foreground",children:[n.size," selected"]}),e.jsxs(C,{size:"sm",variant:"destructive",className:"font-terminal text-xs rounded-none",onClick:Ne,disabled:re.isPending,children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),re.isPending?"Deleting...":"Delete"]})]})]})}),e.jsx(ge,{className:"p-0",children:q?e.jsx("div",{className:"p-8 text-center font-terminal text-muted-foreground",children:"LOADING..."}):k.length===0?e.jsx("div",{className:"p-8 text-center font-terminal text-muted-foreground",children:"NO SESSIONS YET"}):e.jsx(qe,{className:"h-[360px] xl:h-[420px]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(js,{className:"min-w-[620px]",children:[e.jsx(vs,{children:e.jsxs($e,{className:"border-secondary/60 hover:bg-transparent",children:[e.jsx(Z,{className:"w-10 px-2 py-2",children:e.jsx(ce,{checked:n.size===k.length&&k.length>0,onCheckedChange:Me,className:"border-primary data-[state=checked]:bg-primary"})}),e.jsx(Z,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"DATE"}),e.jsx(Z,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"COURSE"}),e.jsx(Z,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"MODE"}),e.jsx(Z,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"MIN"}),e.jsx(Z,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"CARDS"}),e.jsx(Z,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"CONFUSIONS"}),e.jsx(Z,{className:"font-arcade text-[10px] text-primary w-10 px-2 py-2",children:"ACTIONS"})]})}),e.jsx(Ss,{children:k.map(t=>e.jsxs($e,{className:"border-secondary/50 hover:bg-primary/10 font-terminal text-xs","data-testid":`row-session-${t.id}`,children:[e.jsx(ee,{className:"px-2 py-2",children:e.jsx(ce,{checked:n.has(t.id),onCheckedChange:()=>Re(t.id),className:"border-secondary data-[state=checked]:bg-primary"})}),e.jsx(ee,{className:"text-muted-foreground px-2 py-2",children:Pt(t.date)}),e.jsx(ee,{className:"font-bold px-2 py-2",children:t.topic||"-"}),e.jsx(ee,{className:"px-2 py-2",children:e.jsx(De,{variant:"outline",className:"rounded-none border-secondary font-normal text-[10px]",children:t.mode})}),e.jsx(ee,{className:"px-2 py-2",children:t.minutes||0}),e.jsx(ee,{className:"px-2 py-2",children:t.cards||0}),e.jsx(ee,{className:"max-w-[150px] truncate text-[10px] text-muted-foreground px-2 py-2",children:ye(t.confusions).join(", ")||"-"}),e.jsx(ee,{className:"px-2 py-2",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(C,{size:"icon",variant:"ghost",className:"h-6 w-6 rounded-none hover:bg-primary/20",onClick:()=>d(t.id),title:"Edit session",children:e.jsx(ke,{className:"w-3 h-3"})}),e.jsx(C,{size:"icon",variant:"ghost",className:"h-6 w-6 rounded-none hover:bg-destructive/20 text-destructive",onClick:()=>Fe(t.id),title:"Delete session",children:e.jsx(he,{className:"w-3 h-3"})})]})})]},t.id))})]})})})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"ISSUES LOG"}),e.jsxs(be,{className:"brain-card rounded-none",children:[e.jsxs(Ae,{className:"border-b border-secondary p-4",children:[e.jsxs(Ee,{className:"font-arcade text-sm flex items-center gap-2 text-red-400",children:[e.jsx(et,{className:"w-4 h-4"}),"ISSUES AND FAILURES LOG"]}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Aggregated session issues: interruptions, source-lock failures, workflow problems"})]}),e.jsx(ge,{className:"p-4",children:(se?.issuesLog||[]).length===0?e.jsx("div",{className:"text-center font-terminal text-muted-foreground py-8",children:"NO ISSUES LOGGED"}):e.jsx("div",{className:"space-y-2",children:se?.issuesLog.map((t,l)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border border-red-500/30 bg-red-500/5 font-terminal text-sm",children:[e.jsx("span",{className:"text-red-300",children:t.issue}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:t.course}),e.jsxs(De,{variant:"outline",className:"rounded-none border-red-500/50 text-red-400",children:["x",t.count]})]})]},l))})})]})]})]})]}),e.jsx(Qe,{open:!!G,onOpenChange:t=>{t||d(null)},children:e.jsxs(Xe,{"data-modal":"brain-edit-session",className:"bg-black border-2 border-primary rounded-none max-w-2xl translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(Ze,{children:[e.jsxs(es,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5"}),"EDIT SESSION #",a]}),e.jsx(ss,{className:"font-terminal text-muted-foreground",children:"Update WRAP methodology fields for this study session"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Mode"}),e.jsxs(as,{value:N.mode,onValueChange:t=>w(l=>({...l,mode:t})),children:[e.jsx(rs,{className:"rounded-none border-secondary",children:e.jsx(os,{placeholder:"Select mode"})}),e.jsxs(ls,{className:"rounded-none border-secondary bg-black",children:[e.jsx($,{value:"Core",children:"Core"}),e.jsx($,{value:"Sprint",children:"Sprint"}),e.jsx($,{value:"Drill",children:"Drill"}),e.jsx($,{value:"study",children:"Study"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Minutes"}),e.jsx(ts,{type:"number",value:N.minutes,onChange:t=>w(l=>({...l,minutes:t.target.value})),className:"rounded-none border-secondary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Cards"}),e.jsx(ts,{type:"number",value:N.cards,onChange:t=>w(l=>({...l,cards:t.target.value})),className:"rounded-none border-secondary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Confusions (comma-separated)"}),e.jsx(le,{value:N.confusions,onChange:t=>w(l=>({...l,confusions:t.target.value})),placeholder:"e.g., muscle insertion points, nerve pathways",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Weak Anchors (comma-separated)"}),e.jsx(le,{value:N.weakAnchors,onChange:t=>w(l=>({...l,weakAnchors:t.target.value})),placeholder:"e.g., brachial plexus diagram, ROM measurements",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Concepts (comma-separated)"}),e.jsx(le,{value:N.concepts,onChange:t=>w(l=>({...l,concepts:t.target.value})),placeholder:"e.g., upper extremity anatomy, peripheral nerves",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Issues (comma-separated)"}),e.jsx(le,{value:N.issues,onChange:t=>w(l=>({...l,issues:t.target.value})),placeholder:"e.g., interrupted by phone, lost focus after 30 min",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Notes"}),e.jsx(le,{value:N.notes,onChange:t=>w(l=>({...l,notes:t.target.value})),placeholder:"Free-form observations about the session",className:"rounded-none border-secondary min-h-[80px]"})]})]}),e.jsxs(ns,{className:"gap-2",children:[e.jsxs(C,{variant:"outline",onClick:()=>d(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(C,{onClick:je,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})}),e.jsx(us,{open:x&&y.length>0,onOpenChange:i,children:e.jsxs(hs,{"data-modal":"brain-delete-session",className:"bg-black border-2 border-destructive rounded-none translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(ps,{children:[e.jsxs(fs,{className:"font-arcade text-destructive flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),"CONFIRM DELETE"]}),e.jsxs(bs,{className:"font-terminal text-muted-foreground",children:["Are you sure you want to delete ",y.length," session",y.length!==1?"s":"","? This action cannot be undone."]})]}),e.jsxs(gs,{className:"gap-2",children:[e.jsx(ys,{className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:"Cancel"}),e.jsxs(Ns,{onClick:Le,className:"font-terminal rounded-none bg-destructive hover:bg-destructive/80 text-destructive-foreground",children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})}),e.jsx(Qe,{open:_!==null,onOpenChange:t=>{t||O(null)},children:e.jsxs(Xe,{"data-modal":"brain-edit-draft",className:"bg-black border-2 border-primary rounded-none max-w-lg translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[e.jsxs(Ze,{children:[e.jsxs(es,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5"}),"EDIT CARD"]}),e.jsx(ss,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),e.jsx(le,{value:R.front,onChange:t=>F(l=>({...l,front:t.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),e.jsx(le,{value:R.back,onChange:t=>F(l=>({...l,back:t.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),e.jsxs(as,{value:R.deckName,onValueChange:t=>F(l=>({...l,deckName:t})),children:[e.jsx(rs,{className:"rounded-none border-secondary",children:e.jsx(os,{placeholder:"Select deck"})}),e.jsxs(ls,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[e.jsx($,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),e.jsx($,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),e.jsx($,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),e.jsx($,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),e.jsx($,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),e.jsx($,{value:"PT::General",children:"PT::General"}),z?.decks?.filter(t=>!t.startsWith("PT::")).map(t=>e.jsx($,{value:t,children:t},t))]})]}),e.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",e.jsx("span",{className:"text-blue-400",children:R.deckName})]})]})]}),e.jsxs(ns,{className:"gap-2",children:[e.jsxs(C,{variant:"outline",onClick:()=>O(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(C,{onClick:_s,disabled:_e.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),_e.isPending?"Saving...":"Save"]})]})]})})]})}export{Ut as default};
