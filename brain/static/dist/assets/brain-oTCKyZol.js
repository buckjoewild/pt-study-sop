const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ConceptMapEditor-CJKp0G6i.js","assets/index-DF-Ci4pY.js","assets/index-BCBMJA-W.css","assets/zoom-DwwqPMg_.js","assets/layout-DTksDvAT.js","assets/plus-Lju3iire.js","assets/file-text-GC7nl1lM.js","assets/badge-CHdU4YP4.js","assets/circle-check-BWnCljP-.js","assets/triangle-alert-p5paEkYD.js","assets/star-DZXq3dmF.js","assets/search-CTRw4orC.js","assets/index-CCOpRHMl.js","assets/select-Ctls9wht.js","assets/index-ph0M9LG5.js","assets/message-square-tBF_zfhx.js","assets/tabs-DJHd11mn.js","assets/loader-circle-b8bJQH5G.js","assets/send-BNkO-TRT.js","assets/checkbox-C2pP7FBD.js","assets/external-link-DxZAScSn.js","assets/ConceptMapEditor-BZV40eAE.css","assets/VaultGraphView-D-dv9xJB.js","assets/react-force-graph-2d-D3BFYnsY.js","assets/MindMapView-Dqy_WITy.js"])))=>i.map(i=>d[i]);
import{c as Z,r as c,R as yn,j as n,b as ue,X as vt,f as Sr,a as vn,P as Xe,u as kt,g as kr,h as Cr,d as Ze,e as et,_ as Ct}from"./index-DF-Ci4pY.js";import{q as Er,u as Y,p as G,B as q,I as ke,S as Oe,o as wt,r as Pr,f as Et,h as Pt,i as Rt,j as It,k as zt,s as Tt,m as Be,e as me,n as lt,l as Ke,t as Kt,v as Rr,L as Ir}from"./layout-DTksDvAT.js";import{B as Ue,C as Ce,a as Ee,b as Pe,c as Re}from"./badge-CHdU4YP4.js";import{C as zr}from"./circle-check-BWnCljP-.js";import{C as wn,T as At}from"./triangle-alert-p5paEkYD.js";import{A as Tr,S as Ar}from"./star-DZXq3dmF.js";import{R as ze,S as Mr}from"./search-CTRw4orC.js";import{F as jn,M as Dr,r as $r,D as Lr}from"./index-CCOpRHMl.js";import{F as Mt}from"./file-text-GC7nl1lM.js";import{C as Or,S as _r,a as Fr,b as Hr,c as Vr,d as he}from"./select-Ctls9wht.js";import{C as Gr,u as qr}from"./index-ph0M9LG5.js";import{M as Nn}from"./message-square-tBF_zfhx.js";import{L as _e,c as Sn,R as Br,I as Kr,T as Ur,a as Wr,b as ct,d as dt,C as Jr}from"./tabs-DJHd11mn.js";import{L as Dt}from"./loader-circle-b8bJQH5G.js";import{S as Yr}from"./send-BNkO-TRT.js";import{C as kn}from"./checkbox-C2pP7FBD.js";import{E as Qr}from"./external-link-DxZAScSn.js";import{P as Ut}from"./plus-Lju3iire.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Zr=Z("arrow-left",Xr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],ts=Z("brain-circuit",es);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Wt=Z("calendar-days",ns);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],ss=Z("columns-2",rs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],os=Z("copy",as);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],$t=Z("download",is);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],cs=Z("file",ls);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],us=Z("folder",ds);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],fs=Z("image",ms);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],hs=Z("maximize-2",ps);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],gs=Z("minimize-2",xs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],ys=Z("network",bs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}]],ws=Z("rows-2",vs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],Ns=Z("table-2",js),tt=c.createContext(null);tt.displayName="PanelGroupContext";const W={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},Lt=10,be=c.useLayoutEffect,Jt=yn.useId,Ss=typeof Jt=="function"?Jt:()=>null;let ks=0;function Ot(e=null){const t=Ss(),r=c.useRef(e||t||null);return r.current===null&&(r.current=""+ks++),e??r.current}function Cn({children:e,className:t="",collapsedSize:r,collapsible:s,defaultSize:a,forwardedRef:o,id:i,maxSize:l,minSize:d,onCollapse:x,onExpand:h,onResize:b,order:g,style:y,tagName:w="div",...P}){const f=c.useContext(tt);if(f===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:u,expandPanel:p,getPanelSize:v,getPanelStyle:N,groupId:D,isPanelCollapsed:A,reevaluatePanelConstraints:R,registerPanel:k,resizePanel:H,unregisterPanel:j}=f,C=Ot(i),T=c.useRef({callbacks:{onCollapse:x,onExpand:h,onResize:b},constraints:{collapsedSize:r,collapsible:s,defaultSize:a,maxSize:l,minSize:d},id:C,idIsFromProps:i!==void 0,order:g});c.useRef({didLogMissingDefaultSizeWarning:!1}),be(()=>{const{callbacks:$,constraints:M}=T.current,F={...M};T.current.id=C,T.current.idIsFromProps=i!==void 0,T.current.order=g,$.onCollapse=x,$.onExpand=h,$.onResize=b,M.collapsedSize=r,M.collapsible=s,M.defaultSize=a,M.maxSize=l,M.minSize=d,(F.collapsedSize!==M.collapsedSize||F.collapsible!==M.collapsible||F.maxSize!==M.maxSize||F.minSize!==M.minSize)&&R(T.current,F)}),be(()=>{const $=T.current;return k($),()=>{j($)}},[g,C,k,j]),c.useImperativeHandle(o,()=>({collapse:()=>{u(T.current)},expand:$=>{p(T.current,$)},getId(){return C},getSize(){return v(T.current)},isCollapsed(){return A(T.current)},isExpanded(){return!A(T.current)},resize:$=>{H(T.current,$)}}),[u,p,v,A,C,H]);const _=N(T.current,a);return c.createElement(w,{...P,children:e,className:t,id:C,style:{..._,...y},[W.groupId]:D,[W.panel]:"",[W.panelCollapsible]:s||void 0,[W.panelId]:C,[W.panelSize]:parseFloat(""+_.flexGrow).toFixed(1)})}const En=c.forwardRef((e,t)=>c.createElement(Cn,{...e,forwardedRef:t}));Cn.displayName="Panel";En.displayName="forwardRef(Panel)";let jt=null,qe=-1,fe=null;function Cs(e,t){if(t){const r=(t&Tn)!==0,s=(t&An)!==0,a=(t&Mn)!==0,o=(t&Dn)!==0;if(r)return a?"se-resize":o?"ne-resize":"e-resize";if(s)return a?"sw-resize":o?"nw-resize":"w-resize";if(a)return"s-resize";if(o)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function Es(){fe!==null&&(document.head.removeChild(fe),jt=null,fe=null,qe=-1)}function ut(e,t){var r,s;const a=Cs(e,t);if(jt!==a){if(jt=a,fe===null&&(fe=document.createElement("style"),document.head.appendChild(fe)),qe>=0){var o;(o=fe.sheet)===null||o===void 0||o.removeRule(qe)}qe=(r=(s=fe.sheet)===null||s===void 0?void 0:s.insertRule(`*{cursor: ${a} !important;}`))!==null&&r!==void 0?r:-1}}function Pn(e){return e.type==="keydown"}function Rn(e){return e.type.startsWith("pointer")}function In(e){return e.type.startsWith("mouse")}function nt(e){if(Rn(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(In(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function Ps(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function Rs(e,t,r){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function Is(e,t){if(e===t)throw new Error("Cannot compare node with itself");const r={a:Xt(e),b:Xt(t)};let s;for(;r.a.at(-1)===r.b.at(-1);)e=r.a.pop(),t=r.b.pop(),s=e;O(s,"Stacking order can only be calculated for elements with a common ancestor");const a={a:Qt(Yt(r.a)),b:Qt(Yt(r.b))};if(a.a===a.b){const o=s.childNodes,i={a:r.a.at(-1),b:r.b.at(-1)};let l=o.length;for(;l--;){const d=o[l];if(d===i.a)return 1;if(d===i.b)return-1}}return Math.sign(a.a-a.b)}const zs=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function Ts(e){var t;const r=getComputedStyle((t=zn(e))!==null&&t!==void 0?t:e).display;return r==="flex"||r==="inline-flex"}function As(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||Ts(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||zs.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function Yt(e){let t=e.length;for(;t--;){const r=e[t];if(O(r,"Missing node"),As(r))return r}return null}function Qt(e){return e&&Number(getComputedStyle(e).zIndex)||0}function Xt(e){const t=[];for(;e;)t.push(e),e=zn(e);return t}function zn(e){const{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}const Tn=1,An=2,Mn=4,Dn=8,Ms=Ps()==="coarse";let oe=[],Te=!1,ge=new Map,rt=new Map;const Fe=new Set;function Ds(e,t,r,s,a){var o;const{ownerDocument:i}=t,l={direction:r,element:t,hitAreaMargins:s,setResizeHandlerState:a},d=(o=ge.get(i))!==null&&o!==void 0?o:0;return ge.set(i,d+1),Fe.add(l),We(),function(){var h;rt.delete(e),Fe.delete(l);const b=(h=ge.get(i))!==null&&h!==void 0?h:1;if(ge.set(i,b-1),We(),b===1&&ge.delete(i),oe.includes(l)){const g=oe.indexOf(l);g>=0&&oe.splice(g,1),Ft(),a("up",!0,null)}}}function $s(e){const{target:t}=e,{x:r,y:s}=nt(e);Te=!0,_t({target:t,x:r,y:s}),We(),oe.length>0&&(Je("down",e),e.preventDefault(),$n(t)||e.stopImmediatePropagation())}function mt(e){const{x:t,y:r}=nt(e);if(Te&&e.buttons===0&&(Te=!1,Je("up",e)),!Te){const{target:s}=e;_t({target:s,x:t,y:r})}Je("move",e),Ft(),oe.length>0&&e.preventDefault()}function ft(e){const{target:t}=e,{x:r,y:s}=nt(e);rt.clear(),Te=!1,oe.length>0&&(e.preventDefault(),$n(t)||e.stopImmediatePropagation()),Je("up",e),_t({target:t,x:r,y:s}),Ft(),We()}function $n(e){let t=e;for(;t;){if(t.hasAttribute(W.resizeHandle))return!0;t=t.parentElement}return!1}function _t({target:e,x:t,y:r}){oe.splice(0);let s=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(s=e),Fe.forEach(a=>{const{element:o,hitAreaMargins:i}=a,l=o.getBoundingClientRect(),{bottom:d,left:x,right:h,top:b}=l,g=Ms?i.coarse:i.fine;if(t>=x-g&&t<=h+g&&r>=b-g&&r<=d+g){if(s!==null&&document.contains(s)&&o!==s&&!o.contains(s)&&!s.contains(o)&&Is(s,o)>0){let w=s,P=!1;for(;w&&!w.contains(o);){if(Rs(w.getBoundingClientRect(),l)){P=!0;break}w=w.parentElement}if(P)return}oe.push(a)}})}function pt(e,t){rt.set(e,t)}function Ft(){let e=!1,t=!1;oe.forEach(s=>{const{direction:a}=s;a==="horizontal"?e=!0:t=!0});let r=0;rt.forEach(s=>{r|=s}),e&&t?ut("intersection",r):e?ut("horizontal",r):t?ut("vertical",r):Es()}let ht=new AbortController;function We(){ht.abort(),ht=new AbortController;const e={capture:!0,signal:ht.signal};Fe.size&&(Te?(oe.length>0&&ge.forEach((t,r)=>{const{body:s}=r;t>0&&(s.addEventListener("contextmenu",ft,e),s.addEventListener("pointerleave",mt,e),s.addEventListener("pointermove",mt,e))}),window.addEventListener("pointerup",ft,e),window.addEventListener("pointercancel",ft,e)):ge.forEach((t,r)=>{const{body:s}=r;t>0&&(s.addEventListener("pointerdown",$s,e),s.addEventListener("pointermove",mt,e))}))}function Je(e,t){Fe.forEach(r=>{const{setResizeHandlerState:s}=r,a=oe.includes(r);s(e,a,t)})}function Ls(){const[e,t]=c.useState(0);return c.useCallback(()=>t(r=>r+1),[])}function O(e,t){if(!e)throw console.error(t),Error(t)}function ye(e,t,r=Lt){return e.toFixed(r)===t.toFixed(r)?0:e>t?1:-1}function de(e,t,r=Lt){return ye(e,t,r)===0}function te(e,t,r){return ye(e,t,r)===0}function Os(e,t,r){if(e.length!==t.length)return!1;for(let s=0;s<e.length;s++){const a=e[s],o=t[s];if(!te(a,o,r))return!1}return!0}function Ie({panelConstraints:e,panelIndex:t,size:r}){const s=e[t];O(s!=null,`Panel constraints not found for index ${t}`);let{collapsedSize:a=0,collapsible:o,maxSize:i=100,minSize:l=0}=s;if(ye(r,l)<0)if(o){const d=(a+l)/2;ye(r,d)<0?r=a:r=l}else r=l;return r=Math.min(i,r),r=parseFloat(r.toFixed(Lt)),r}function $e({delta:e,initialLayout:t,panelConstraints:r,pivotIndices:s,prevLayout:a,trigger:o}){if(te(e,0))return t;const i=[...t],[l,d]=s;O(l!=null,"Invalid first pivot index"),O(d!=null,"Invalid second pivot index");let x=0;if(o==="keyboard"){{const b=e<0?d:l,g=r[b];O(g,`Panel constraints not found for index ${b}`);const{collapsedSize:y=0,collapsible:w,minSize:P=0}=g;if(w){const f=t[b];if(O(f!=null,`Previous layout not found for panel index ${b}`),te(f,y)){const u=P-f;ye(u,Math.abs(e))>0&&(e=e<0?0-u:u)}}}{const b=e<0?l:d,g=r[b];O(g,`No panel constraints found for index ${b}`);const{collapsedSize:y=0,collapsible:w,minSize:P=0}=g;if(w){const f=t[b];if(O(f!=null,`Previous layout not found for panel index ${b}`),te(f,P)){const u=f-y;ye(u,Math.abs(e))>0&&(e=e<0?0-u:u)}}}}{const b=e<0?1:-1;let g=e<0?d:l,y=0;for(;;){const P=t[g];O(P!=null,`Previous layout not found for panel index ${g}`);const u=Ie({panelConstraints:r,panelIndex:g,size:100})-P;if(y+=u,g+=b,g<0||g>=r.length)break}const w=Math.min(Math.abs(e),Math.abs(y));e=e<0?0-w:w}{let g=e<0?l:d;for(;g>=0&&g<r.length;){const y=Math.abs(e)-Math.abs(x),w=t[g];O(w!=null,`Previous layout not found for panel index ${g}`);const P=w-y,f=Ie({panelConstraints:r,panelIndex:g,size:P});if(!te(w,f)&&(x+=w-f,i[g]=f,x.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?g--:g++}}if(Os(a,i))return a;{const b=e<0?d:l,g=t[b];O(g!=null,`Previous layout not found for panel index ${b}`);const y=g+x,w=Ie({panelConstraints:r,panelIndex:b,size:y});if(i[b]=w,!te(w,y)){let P=y-w,u=e<0?d:l;for(;u>=0&&u<r.length;){const p=i[u];O(p!=null,`Previous layout not found for panel index ${u}`);const v=p+P,N=Ie({panelConstraints:r,panelIndex:u,size:v});if(te(p,N)||(P-=N-p,i[u]=N),te(P,0))break;e>0?u--:u++}}}const h=i.reduce((b,g)=>g+b,0);return te(h,100)?i:a}function _s({layout:e,panelsArray:t,pivotIndices:r}){let s=0,a=100,o=0,i=0;const l=r[0];O(l!=null,"No pivot index found"),t.forEach((b,g)=>{const{constraints:y}=b,{maxSize:w=100,minSize:P=0}=y;g===l?(s=P,a=w):(o+=P,i+=w)});const d=Math.min(a,100-o),x=Math.max(s,100-i),h=e[l];return{valueMax:d,valueMin:x,valueNow:h}}function He(e,t=document){return Array.from(t.querySelectorAll(`[${W.resizeHandleId}][data-panel-group-id="${e}"]`))}function Ln(e,t,r=document){const a=He(e,r).findIndex(o=>o.getAttribute(W.resizeHandleId)===t);return a??null}function On(e,t,r){const s=Ln(e,t,r);return s!=null?[s,s+1]:[-1,-1]}function _n(e,t=document){var r;if(t instanceof HTMLElement&&(t==null||(r=t.dataset)===null||r===void 0?void 0:r.panelGroupId)==e)return t;const s=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return s||null}function st(e,t=document){const r=t.querySelector(`[${W.resizeHandleId}="${e}"]`);return r||null}function Fs(e,t,r,s=document){var a,o,i,l;const d=st(t,s),x=He(e,s),h=d?x.indexOf(d):-1,b=(a=(o=r[h])===null||o===void 0?void 0:o.id)!==null&&a!==void 0?a:null,g=(i=(l=r[h+1])===null||l===void 0?void 0:l.id)!==null&&i!==void 0?i:null;return[b,g]}function Hs({committedValuesRef:e,eagerValuesRef:t,groupId:r,layout:s,panelDataArray:a,panelGroupElement:o,setLayout:i}){c.useRef({didWarnAboutMissingResizeHandle:!1}),be(()=>{if(!o)return;const l=He(r,o);for(let d=0;d<a.length-1;d++){const{valueMax:x,valueMin:h,valueNow:b}=_s({layout:s,panelsArray:a,pivotIndices:[d,d+1]}),g=l[d];if(g!=null){const y=a[d];O(y,`No panel data found for index "${d}"`),g.setAttribute("aria-controls",y.id),g.setAttribute("aria-valuemax",""+Math.round(x)),g.setAttribute("aria-valuemin",""+Math.round(h)),g.setAttribute("aria-valuenow",b!=null?""+Math.round(b):"")}}return()=>{l.forEach((d,x)=>{d.removeAttribute("aria-controls"),d.removeAttribute("aria-valuemax"),d.removeAttribute("aria-valuemin"),d.removeAttribute("aria-valuenow")})}},[r,s,a,o]),c.useEffect(()=>{if(!o)return;const l=t.current;O(l,"Eager values not found");const{panelDataArray:d}=l,x=_n(r,o);O(x!=null,`No group found for id "${r}"`);const h=He(r,o);O(h,`No resize handles found for group id "${r}"`);const b=h.map(g=>{const y=g.getAttribute(W.resizeHandleId);O(y,"Resize handle element has no handle id attribute");const[w,P]=Fs(r,y,d,o);if(w==null||P==null)return()=>{};const f=u=>{if(!u.defaultPrevented)switch(u.key){case"Enter":{u.preventDefault();const p=d.findIndex(v=>v.id===w);if(p>=0){const v=d[p];O(v,`No panel data found for index ${p}`);const N=s[p],{collapsedSize:D=0,collapsible:A,minSize:R=0}=v.constraints;if(N!=null&&A){const k=$e({delta:te(N,D)?R-D:D-N,initialLayout:s,panelConstraints:d.map(H=>H.constraints),pivotIndices:On(r,y,o),prevLayout:s,trigger:"keyboard"});s!==k&&i(k)}}break}}};return g.addEventListener("keydown",f),()=>{g.removeEventListener("keydown",f)}});return()=>{b.forEach(g=>g())}},[o,e,t,r,s,a,i])}function Zt(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Fn(e,t){const r=e==="horizontal",{x:s,y:a}=nt(t);return r?s:a}function Vs(e,t,r,s,a){const o=r==="horizontal",i=st(t,a);O(i,`No resize handle element found for id "${t}"`);const l=i.getAttribute(W.groupId);O(l,"Resize handle element has no group id attribute");let{initialCursorPosition:d}=s;const x=Fn(r,e),h=_n(l,a);O(h,`No group element found for id "${l}"`);const b=h.getBoundingClientRect(),g=o?b.width:b.height;return(x-d)/g*100}function Gs(e,t,r,s,a,o){if(Pn(e)){const i=r==="horizontal";let l=0;e.shiftKey?l=100:a!=null?l=a:l=10;let d=0;switch(e.key){case"ArrowDown":d=i?0:l;break;case"ArrowLeft":d=i?-l:0;break;case"ArrowRight":d=i?l:0;break;case"ArrowUp":d=i?0:-l;break;case"End":d=100;break;case"Home":d=-100;break}return d}else return s==null?0:Vs(e,t,r,s,o)}function qs({panelDataArray:e}){const t=Array(e.length),r=e.map(o=>o.constraints);let s=0,a=100;for(let o=0;o<e.length;o++){const i=r[o];O(i,`Panel constraints not found for index ${o}`);const{defaultSize:l}=i;l!=null&&(s++,t[o]=l,a-=l)}for(let o=0;o<e.length;o++){const i=r[o];O(i,`Panel constraints not found for index ${o}`);const{defaultSize:l}=i;if(l!=null)continue;const d=e.length-s,x=a/d;s++,t[o]=x,a-=x}return t}function ve(e,t,r){t.forEach((s,a)=>{const o=e[a];O(o,`Panel data not found for index ${a}`);const{callbacks:i,constraints:l,id:d}=o,{collapsedSize:x=0,collapsible:h}=l,b=r[d];if(b==null||s!==b){r[d]=s;const{onCollapse:g,onExpand:y,onResize:w}=i;w&&w(s,b),h&&(g||y)&&(y&&(b==null||de(b,x))&&!de(s,x)&&y(),g&&(b==null||!de(b,x))&&de(s,x)&&g())}})}function Ge(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function Bs({defaultSize:e,dragState:t,layout:r,panelData:s,panelIndex:a,precision:o=3}){const i=r[a];let l;return i==null?l=e!=null?e.toPrecision(o):"1":s.length===1?l="1":l=i.toPrecision(o),{flexBasis:0,flexGrow:l,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}function Ks(e,t=10){let r=null;return(...a)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>{e(...a)},t)}}function en(e){try{if(typeof localStorage<"u")e.getItem=t=>localStorage.getItem(t),e.setItem=(t,r)=>{localStorage.setItem(t,r)};else throw new Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function Hn(e){return`react-resizable-panels:${e}`}function Vn(e){return e.map(t=>{const{constraints:r,id:s,idIsFromProps:a,order:o}=t;return a?s:o?`${o}:${JSON.stringify(r)}`:JSON.stringify(r)}).sort((t,r)=>t.localeCompare(r)).join(",")}function Gn(e,t){try{const r=Hn(e),s=t.getItem(r);if(s){const a=JSON.parse(s);if(typeof a=="object"&&a!=null)return a}}catch{}return null}function Us(e,t,r){var s,a;const o=(s=Gn(e,r))!==null&&s!==void 0?s:{},i=Vn(t);return(a=o[i])!==null&&a!==void 0?a:null}function Ws(e,t,r,s,a){var o;const i=Hn(e),l=Vn(t),d=(o=Gn(e,a))!==null&&o!==void 0?o:{};d[l]={expandToSizes:Object.fromEntries(r.entries()),layout:s};try{a.setItem(i,JSON.stringify(d))}catch(x){console.error(x)}}function tn({layout:e,panelConstraints:t}){const r=[...e],s=r.reduce((o,i)=>o+i,0);if(r.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${r.map(o=>`${o}%`).join(", ")}`);if(!te(s,100)&&r.length>0)for(let o=0;o<t.length;o++){const i=r[o];O(i!=null,`No layout data found for index ${o}`);const l=100/s*i;r[o]=l}let a=0;for(let o=0;o<t.length;o++){const i=r[o];O(i!=null,`No layout data found for index ${o}`);const l=Ie({panelConstraints:t,panelIndex:o,size:i});i!=l&&(a+=i-l,r[o]=l)}if(!te(a,0))for(let o=0;o<t.length;o++){const i=r[o];O(i!=null,`No layout data found for index ${o}`);const l=i+a,d=Ie({panelConstraints:t,panelIndex:o,size:l});if(i!==d&&(a-=d-i,r[o]=d,te(a,0)))break}return r}const Js=100,Le={getItem:e=>(en(Le),Le.getItem(e)),setItem:(e,t)=>{en(Le),Le.setItem(e,t)}},nn={};function qn({autoSaveId:e=null,children:t,className:r="",direction:s,forwardedRef:a,id:o=null,onLayout:i=null,keyboardResizeBy:l=null,storage:d=Le,style:x,tagName:h="div",...b}){const g=Ot(o),y=c.useRef(null),[w,P]=c.useState(null),[f,u]=c.useState([]),p=Ls(),v=c.useRef({}),N=c.useRef(new Map),D=c.useRef(0),A=c.useRef({autoSaveId:e,direction:s,dragState:w,id:g,keyboardResizeBy:l,onLayout:i,storage:d}),R=c.useRef({layout:f,panelDataArray:[],panelDataArrayChanged:!1});c.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),c.useImperativeHandle(a,()=>({getId:()=>A.current.id,getLayout:()=>{const{layout:m}=R.current;return m},setLayout:m=>{const{onLayout:S}=A.current,{layout:z,panelDataArray:E}=R.current,I=tn({layout:m,panelConstraints:E.map(L=>L.constraints)});Zt(z,I)||(u(I),R.current.layout=I,S&&S(I),ve(E,I,v.current))}}),[]),be(()=>{A.current.autoSaveId=e,A.current.direction=s,A.current.dragState=w,A.current.id=g,A.current.onLayout=i,A.current.storage=d}),Hs({committedValuesRef:A,eagerValuesRef:R,groupId:g,layout:f,panelDataArray:R.current.panelDataArray,setLayout:u,panelGroupElement:y.current}),c.useEffect(()=>{const{panelDataArray:m}=R.current;if(e){if(f.length===0||f.length!==m.length)return;let S=nn[e];S==null&&(S=Ks(Ws,Js),nn[e]=S);const z=[...m],E=new Map(N.current);S(e,z,E,f,d)}},[e,f,d]),c.useEffect(()=>{});const k=c.useCallback(m=>{const{onLayout:S}=A.current,{layout:z,panelDataArray:E}=R.current;if(m.constraints.collapsible){const I=E.map(ie=>ie.constraints),{collapsedSize:L=0,panelSize:V,pivotIndices:K}=xe(E,m,z);if(O(V!=null,`Panel size not found for panel "${m.id}"`),!de(V,L)){N.current.set(m.id,V);const le=Ne(E,m)===E.length-1?V-L:L-V,U=$e({delta:le,initialLayout:z,panelConstraints:I,pivotIndices:K,prevLayout:z,trigger:"imperative-api"});Ge(z,U)||(u(U),R.current.layout=U,S&&S(U),ve(E,U,v.current))}}},[]),H=c.useCallback((m,S)=>{const{onLayout:z}=A.current,{layout:E,panelDataArray:I}=R.current;if(m.constraints.collapsible){const L=I.map(ae=>ae.constraints),{collapsedSize:V=0,panelSize:K=0,minSize:ie=0,pivotIndices:le}=xe(I,m,E),U=S??ie;if(de(K,V)){const ae=N.current.get(m.id),Ae=ae!=null&&ae>=U?ae:U,it=Ne(I,m)===I.length-1?K-Ae:Ae-K,Q=$e({delta:it,initialLayout:E,panelConstraints:L,pivotIndices:le,prevLayout:E,trigger:"imperative-api"});Ge(E,Q)||(u(Q),R.current.layout=Q,z&&z(Q),ve(I,Q,v.current))}}},[]),j=c.useCallback(m=>{const{layout:S,panelDataArray:z}=R.current,{panelSize:E}=xe(z,m,S);return O(E!=null,`Panel size not found for panel "${m.id}"`),E},[]),C=c.useCallback((m,S)=>{const{panelDataArray:z}=R.current,E=Ne(z,m);return Bs({defaultSize:S,dragState:w,layout:f,panelData:z,panelIndex:E})},[w,f]),T=c.useCallback(m=>{const{layout:S,panelDataArray:z}=R.current,{collapsedSize:E=0,collapsible:I,panelSize:L}=xe(z,m,S);return O(L!=null,`Panel size not found for panel "${m.id}"`),I===!0&&de(L,E)},[]),_=c.useCallback(m=>{const{layout:S,panelDataArray:z}=R.current,{collapsedSize:E=0,collapsible:I,panelSize:L}=xe(z,m,S);return O(L!=null,`Panel size not found for panel "${m.id}"`),!I||ye(L,E)>0},[]),$=c.useCallback(m=>{const{panelDataArray:S}=R.current;S.push(m),S.sort((z,E)=>{const I=z.order,L=E.order;return I==null&&L==null?0:I==null?-1:L==null?1:I-L}),R.current.panelDataArrayChanged=!0,p()},[p]);be(()=>{if(R.current.panelDataArrayChanged){R.current.panelDataArrayChanged=!1;const{autoSaveId:m,onLayout:S,storage:z}=A.current,{layout:E,panelDataArray:I}=R.current;let L=null;if(m){const K=Us(m,I,z);K&&(N.current=new Map(Object.entries(K.expandToSizes)),L=K.layout)}L==null&&(L=qs({panelDataArray:I}));const V=tn({layout:L,panelConstraints:I.map(K=>K.constraints)});Zt(E,V)||(u(V),R.current.layout=V,S&&S(V),ve(I,V,v.current))}}),be(()=>{const m=R.current;return()=>{m.layout=[]}},[]);const M=c.useCallback(m=>{let S=!1;const z=y.current;return z&&window.getComputedStyle(z,null).getPropertyValue("direction")==="rtl"&&(S=!0),function(I){I.preventDefault();const L=y.current;if(!L)return()=>null;const{direction:V,dragState:K,id:ie,keyboardResizeBy:le,onLayout:U}=A.current,{layout:ae,panelDataArray:Ae}=R.current,{initialLayout:Ve}=K??{},it=On(ie,m,L);let Q=Gs(I,m,V,K,le,L);const qt=V==="horizontal";qt&&S&&(Q=-Q);const jr=Ae.map(Nr=>Nr.constraints),Me=$e({delta:Q,initialLayout:Ve??ae,panelConstraints:jr,pivotIndices:it,prevLayout:ae,trigger:Pn(I)?"keyboard":"mouse-or-touch"}),Bt=!Ge(ae,Me);(Rn(I)||In(I))&&D.current!=Q&&(D.current=Q,!Bt&&Q!==0?qt?pt(m,Q<0?Tn:An):pt(m,Q<0?Mn:Dn):pt(m,0)),Bt&&(u(Me),R.current.layout=Me,U&&U(Me),ve(Ae,Me,v.current))}},[]),F=c.useCallback((m,S)=>{const{onLayout:z}=A.current,{layout:E,panelDataArray:I}=R.current,L=I.map(ae=>ae.constraints),{panelSize:V,pivotIndices:K}=xe(I,m,E);O(V!=null,`Panel size not found for panel "${m.id}"`);const le=Ne(I,m)===I.length-1?V-S:S-V,U=$e({delta:le,initialLayout:E,panelConstraints:L,pivotIndices:K,prevLayout:E,trigger:"imperative-api"});Ge(E,U)||(u(U),R.current.layout=U,z&&z(U),ve(I,U,v.current))},[]),B=c.useCallback((m,S)=>{const{layout:z,panelDataArray:E}=R.current,{collapsedSize:I=0,collapsible:L}=S,{collapsedSize:V=0,collapsible:K,maxSize:ie=100,minSize:le=0}=m.constraints,{panelSize:U}=xe(E,m,z);U!=null&&(L&&K&&de(U,I)?de(I,V)||F(m,V):U<le?F(m,le):U>ie&&F(m,ie))},[F]),J=c.useCallback((m,S)=>{const{direction:z}=A.current,{layout:E}=R.current;if(!y.current)return;const I=st(m,y.current);O(I,`Drag handle element not found for id "${m}"`);const L=Fn(z,S);P({dragHandleId:m,dragHandleRect:I.getBoundingClientRect(),initialCursorPosition:L,initialLayout:E})},[]),ne=c.useCallback(()=>{P(null)},[]),ce=c.useCallback(m=>{const{panelDataArray:S}=R.current,z=Ne(S,m);z>=0&&(S.splice(z,1),delete v.current[m.id],R.current.panelDataArrayChanged=!0,p())},[p]),se=c.useMemo(()=>({collapsePanel:k,direction:s,dragState:w,expandPanel:H,getPanelSize:j,getPanelStyle:C,groupId:g,isPanelCollapsed:T,isPanelExpanded:_,reevaluatePanelConstraints:B,registerPanel:$,registerResizeHandle:M,resizePanel:F,startDragging:J,stopDragging:ne,unregisterPanel:ce,panelGroupElement:y.current}),[k,w,s,H,j,C,g,T,_,B,$,M,F,J,ne,ce]),re={display:"flex",flexDirection:s==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return c.createElement(tt.Provider,{value:se},c.createElement(h,{...b,children:t,className:r,id:o,ref:y,style:{...re,...x},[W.group]:"",[W.groupDirection]:s,[W.groupId]:g}))}const Bn=c.forwardRef((e,t)=>c.createElement(qn,{...e,forwardedRef:t}));qn.displayName="PanelGroup";Bn.displayName="forwardRef(PanelGroup)";function Ne(e,t){return e.findIndex(r=>r===t||r.id===t.id)}function xe(e,t,r){const s=Ne(e,t),o=s===e.length-1?[s-1,s]:[s,s+1],i=r[s];return{...t.constraints,panelSize:i,pivotIndices:o}}function Ys({disabled:e,handleId:t,resizeHandler:r,panelGroupElement:s}){c.useEffect(()=>{if(e||r==null||s==null)return;const a=st(t,s);if(a==null)return;const o=i=>{if(!i.defaultPrevented)switch(i.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{i.preventDefault(),r(i);break}case"F6":{i.preventDefault();const l=a.getAttribute(W.groupId);O(l,`No group element found for id "${l}"`);const d=He(l,s),x=Ln(l,t,s);O(x!==null,`No resize element found for id "${t}"`);const h=i.shiftKey?x>0?x-1:d.length-1:x+1<d.length?x+1:0;d[h].focus();break}}};return a.addEventListener("keydown",o),()=>{a.removeEventListener("keydown",o)}},[s,e,t,r])}function Kn({children:e=null,className:t="",disabled:r=!1,hitAreaMargins:s,id:a,onBlur:o,onClick:i,onDragging:l,onFocus:d,onPointerDown:x,onPointerUp:h,style:b={},tabIndex:g=0,tagName:y="div",...w}){var P,f;const u=c.useRef(null),p=c.useRef({onClick:i,onDragging:l,onPointerDown:x,onPointerUp:h});c.useEffect(()=>{p.current.onClick=i,p.current.onDragging=l,p.current.onPointerDown=x,p.current.onPointerUp=h});const v=c.useContext(tt);if(v===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:N,groupId:D,registerResizeHandle:A,startDragging:R,stopDragging:k,panelGroupElement:H}=v,j=Ot(a),[C,T]=c.useState("inactive"),[_,$]=c.useState(!1),[M,F]=c.useState(null),B=c.useRef({state:C});be(()=>{B.current.state=C}),c.useEffect(()=>{if(r)F(null);else{const se=A(j);F(()=>se)}},[r,j,A]);const J=(P=s?.coarse)!==null&&P!==void 0?P:15,ne=(f=s?.fine)!==null&&f!==void 0?f:5;c.useEffect(()=>{if(r||M==null)return;const se=u.current;O(se,"Element ref not attached");let re=!1;return Ds(j,se,N,{coarse:J,fine:ne},(S,z,E)=>{if(!z){T("inactive");return}switch(S){case"down":{T("drag"),re=!1,O(E,'Expected event to be defined for "down" action'),R(j,E);const{onDragging:I,onPointerDown:L}=p.current;I?.(!0),L?.();break}case"move":{const{state:I}=B.current;re=!0,I!=="drag"&&T("hover"),O(E,'Expected event to be defined for "move" action'),M(E);break}case"up":{T("hover"),k();const{onClick:I,onDragging:L,onPointerUp:V}=p.current;L?.(!1),V?.(),re||I?.();break}}})},[J,N,r,ne,A,j,M,R,k]),Ys({disabled:r,handleId:j,resizeHandler:M,panelGroupElement:H});const ce={touchAction:"none",userSelect:"none"};return c.createElement(y,{...w,children:e,className:t,id:a,onBlur:()=>{$(!1),o?.()},onFocus:()=>{$(!0),d?.()},ref:u,role:"separator",style:{...ce,...b},tabIndex:g,[W.groupDirection]:N,[W.groupId]:D,[W.resizeHandle]:"",[W.resizeHandleActive]:C==="drag"?"pointer":_?"keyboard":void 0,[W.resizeHandleEnabled]:!r,[W.resizeHandleId]:j,[W.resizeHandleState]:C})}Kn.displayName="PanelResizeHandle";const Qs=({className:e,...t})=>n.jsx(Bn,{className:ue("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",e),...t}),rn=En,Xs=({withHandle:e,className:t,...r})=>n.jsx(Kn,{className:ue("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",t),...r,children:e&&n.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:n.jsx(Er,{className:"h-2.5 w-2.5"})})}),Un=[{id:"ebp",name:"EBP",path:"School/Evidence Based Practice"},{id:"exphys",name:"ExPhys",path:"School/Exercise Physiology"},{id:"ms1",name:"MS1",path:"School/Movement Science 1"},{id:"neuro",name:"Neuro",path:"School/Neuroscience"},{id:"ti",name:"TI",path:"School/Therapeutic Intervention"}];function Zs(){return Un.map(e=>e.path)}function ea(e,t){try{const r=localStorage.getItem(e);if(r!==null)return JSON.parse(r)}catch{}return t}function ta(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}function na(){const[e,t]=c.useState(()=>ea("brain-main-mode","edit")),[r,s]=c.useState(null),[a,o]=c.useState(""),[i,l]=c.useState(!1),[d,x]=c.useState(!1),[h,b]=c.useState(!1),[g,y]=c.useState(!1),w=c.useCallback(j=>{t(j),ta("brain-main-mode",j)},[]),{data:P}=Y({queryKey:["obsidian","status"],queryFn:G.obsidian.getStatus,refetchInterval:3e4}),{data:f}=Y({queryKey:["obsidian","config"],queryFn:G.obsidian.getConfig}),{data:u}=Y({queryKey:["obsidian","vault-index"],queryFn:()=>G.obsidian.getVaultIndex(),enabled:P?.connected===!0}),{data:p}=Y({queryKey:["anki","status"],queryFn:G.anki.getStatus,refetchInterval:3e4}),{data:v}=Y({queryKey:["brain","metrics"],queryFn:G.brain.getMetrics}),{data:N=[]}=Y({queryKey:["anki","drafts"],queryFn:G.anki.getDrafts}),D=N.filter(j=>j.status==="pending"),A=c.useCallback(async j=>{try{const C=await G.obsidian.getFile(j);C.success&&C.content!==void 0&&(s(j),o(C.content),l(!1),x(!1))}catch(C){console.error("Failed to load file:",C)}},[]),R=c.useCallback(async()=>{if(r){b(!0);try{(await G.obsidian.saveFile(r,a)).success&&l(!1)}catch(j){console.error("Failed to save file:",j)}finally{b(!1)}}},[r,a]),k=c.useCallback(j=>{o(j),l(!0)},[]),H=c.useCallback(async(j,C)=>{if(C){const _=f?.vaultName||"Treys School";window.open(`obsidian://open?vault=${encodeURIComponent(_)}&file=${encodeURIComponent(j)}`,"_blank");return}const T=u?.paths?.[j];if(T){await A(T),x(!0);return}for(const _ of Zs())try{const $=await G.obsidian.getFile(`${_}/${j}.md`);if($.success&&$.content!==void 0){s(`${_}/${j}.md`),o($.content),l(!1),x(!0);return}}catch{}console.warn(`Note not found: ${j}`)},[f,u,A]);return{mainMode:e,setMainMode:w,currentFile:r,setCurrentFile:s,fileContent:a,setFileContent:k,hasChanges:i,setHasChanges:l,previewMode:d,setPreviewMode:x,isSaving:h,openFile:A,saveFile:R,importOpen:g,setImportOpen:y,handleWikilinkClick:H,obsidianStatus:P,obsidianConfig:f,vaultIndex:u,ankiStatus:p,metrics:v,ankiDrafts:N,pendingDrafts:D}}const sn=[{id:"study",label:"Study",tab:null,section:null},{id:"wrap",label:"Wrap",tab:null,section:null},{id:"generate",label:"Generate JSON",tab:null,section:null},{id:"attach",label:"Attach JSON",tab:null,section:null},{id:"planner",label:"Planner",tab:null,section:null},{id:"actions",label:"Actions",tab:null,section:null}];function ra({workspace:e}){const[t,r]=c.useState(!1),{data:s=[]}=Y({queryKey:["sessions"],queryFn:G.sessions.getAll}),{data:a=[]}=Y({queryKey:["planner-queue"],queryFn:G.planner.getQueue}),o=new Date,i=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`,l=y=>{const w=typeof y=="string"?new Date(y):y;return`${w.getFullYear()}-${String(w.getMonth()+1).padStart(2,"0")}-${String(w.getDate()).padStart(2,"0")}`===i},d=s.some(y=>l(y.date)),x=a.length>0,h=s.some(y=>l(y.date)&&y.cards>0),b={study:d,wrap:d,generate:h,attach:h,planner:x,actions:x},g=c.useCallback(y=>{y.preventDefault(),r(!1),Array.from(y.dataTransfer.files).length>0&&e.setImportOpen(!0)},[e]);return n.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 border-b-2 border-primary/50 bg-black/60 flex-wrap ${t?"ring-2 ring-primary":""}`,onDragOver:y=>{y.preventDefault(),r(!0)},onDragLeave:()=>r(!1),onDrop:g,children:[n.jsx("div",{className:"flex items-center gap-0.5 mr-2",children:sn.map((y,w)=>{const P=b[y.id]??!1;return n.jsxs("div",{className:"flex items-center gap-0.5",children:[n.jsxs("div",{className:`flex items-center gap-0.5 px-1.5 py-0.5 text-xs font-terminal ${P?"text-green-400":"text-muted-foreground"}`,title:y.label,children:[P?n.jsx(zr,{className:"w-3 h-3"}):n.jsx(wn,{className:"w-3 h-3"}),n.jsx("span",{className:"hidden xl:inline",children:y.label})]}),w<sn.length-1&&n.jsx(Tr,{className:"w-2 h-2 text-muted-foreground/50"})]},y.id)})}),n.jsx("div",{className:"w-px h-5 bg-primary/30"}),n.jsxs(q,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none font-terminal text-xs border-primary/50",onClick:()=>e.setImportOpen(!0),children:[n.jsx($t,{className:"w-3 h-3 mr-1"}),"Import"]}),n.jsxs("div",{className:"flex items-center gap-3 ml-auto font-terminal text-xs",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${e.obsidianStatus?.connected?"bg-green-500":"bg-red-500"}`}),n.jsx("span",{className:"text-muted-foreground",children:"Obsidian"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${e.ankiStatus?.connected?"bg-green-500":"bg-red-500"}`}),n.jsx("span",{className:"text-muted-foreground",children:"Anki"})]}),e.pendingDrafts.length>0&&n.jsxs(Ue,{variant:"outline",className:"h-5 px-1.5 text-xs rounded-none border-secondary/50 text-secondary",children:[e.pendingDrafts.length," drafts"]})]})]})}class Se extends c.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null},this.reset=()=>{this.setState({hasError:!1,error:null})}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("ErrorBoundary caught error:",t,r),this.props.onError?.(t,r)}componentDidUpdate(t){this.state.hasError&&this.props.resetKeys&&this.props.resetKeys.some((s,a)=>s!==t.resetKeys?.[a])&&this.reset()}render(){return this.state.hasError?this.props.fallback?this.props.fallback:n.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[n.jsx(At,{className:"w-10 h-10 text-red-500 mb-3"}),n.jsx("h3",{className:"font-arcade text-sm text-red-400 mb-2",children:"COMPONENT ERROR"}),n.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4 max-w-xs",children:this.state.error?.message||"Something went wrong"}),n.jsxs(q,{variant:"outline",size:"sm",onClick:this.reset,className:"rounded-none font-terminal text-xs",children:[n.jsx(ze,{className:"w-3 h-3 mr-1"}),"Try Again"]})]}):this.props.children}}function sa({onReset:e}){return n.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:[n.jsx(At,{className:"w-8 h-8 text-red-500 mb-2"}),n.jsx("p",{className:"font-terminal text-xs text-red-400 mb-2",children:"Sidebar Error"}),n.jsxs(q,{variant:"ghost",size:"sm",onClick:e,className:"rounded-none font-terminal text-xs h-6",children:[n.jsx(ze,{className:"w-3 h-3 mr-1"}),"Retry"]})]})}function De({tabName:e,onReset:t}){return n.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[n.jsx(At,{className:"w-10 h-10 text-red-500 mb-3"}),n.jsxs("h3",{className:"font-arcade text-sm text-red-400 mb-2",children:[e," TAB ERROR"]}),n.jsxs("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:["Failed to load ",e.toLowerCase()," view"]}),n.jsxs(q,{variant:"outline",size:"sm",onClick:t,className:"rounded-none font-terminal text-xs",children:[n.jsx(ze,{className:"w-3 h-3 mr-1"}),"Reload Tab"]})]})}function Wn({name:e,isFolder:t,isExpanded:r,isActive:s,depth:a,onClick:o}){return n.jsxs("button",{onClick:o,className:`w-full flex items-center gap-1.5 py-1 hover:bg-secondary/20 font-terminal text-sm ${s?"bg-primary/20 text-primary":""}`,style:{paddingLeft:`${a*12+8}px`},children:[t?n.jsxs(n.Fragment,{children:[r?n.jsx(Or,{className:"w-3 h-3 text-muted-foreground shrink-0","aria-hidden":"true"}):n.jsx(Gr,{className:"w-3 h-3 text-muted-foreground shrink-0","aria-hidden":"true"}),n.jsx(us,{className:"w-3.5 h-3.5 text-yellow-500 shrink-0","aria-hidden":"true"})]}):n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"w-3 shrink-0"}),n.jsx(cs,{className:"w-3.5 h-3.5 text-blue-400 shrink-0","aria-hidden":"true"})]}),n.jsx("span",{className:"truncate",children:e})]})}function Jn({folderPath:e,depth:t,expandedFolders:r,toggleFolder:s,workspace:a,connected:o}){const{data:i}=Y({queryKey:["obsidian","files",e],queryFn:()=>G.obsidian.getFiles(e),enabled:o}),l=i?.files||[];return n.jsx(n.Fragment,{children:l.map(d=>{const x=typeof d=="string"?d:d.path,h=x.endsWith("/"),b=x.replace(/\/$/,"").split("/").pop()||x,g=`${e}/${b}`,y=r.has(g);return n.jsxs("div",{children:[n.jsx(Wn,{name:b,isFolder:h,isExpanded:y,isActive:a.currentFile?.endsWith(b)||!1,depth:t,onClick:()=>{h?s(g):a.openFile(g)}}),h&&y&&n.jsx(Jn,{folderPath:g,depth:t+1,expandedFolders:r,toggleFolder:s,workspace:a,connected:o})]},x)})})}function an({workspace:e}){const[t,r]=c.useState("School"),[s,a]=c.useState(""),[o,i]=c.useState(new Set),[l,d]=c.useState(0),x=e.obsidianStatus?.connected===!0,{data:h}=Y({queryKey:["obsidian","files",t],queryFn:()=>G.obsidian.getFiles(t),enabled:x}),b=c.useCallback(p=>{r(p),i(new Set)},[]),g=c.useCallback(()=>{const p=t.split("/");p.pop(),b(p.join("/"))},[t,b]),y=c.useCallback(p=>{i(v=>{const N=new Set(v);return N.has(p)?N.delete(p):N.add(p),N})},[]),w=c.useCallback(()=>{const p=new Date().toISOString().split("T")[0],v=t?`${t}/Session-${p}.md`:`Session-${p}.md`,N=`# Study Session - ${p}

## Summary


## Concepts Covered
- 

## Notes

`;e.setCurrentFile(v),e.setFileContent(N),e.setHasChanges(!0)},[t,e]),P=c.useMemo(()=>{const p=h?.files||[];if(!s.trim())return p;const v=s.toLowerCase();return p.filter(N=>(typeof N=="string"?N:N.path).toLowerCase().includes(v))},[h,s]),f=t.includes("/"),u=c.useMemo(()=>t?t.split("/"):[],[t]);return x?n.jsxs("div",{className:"flex flex-col h-full min-h-0 overflow-hidden",children:[n.jsxs("div",{className:"p-2 space-y-1.5 border-b border-primary/30 shrink-0",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Mr,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground","aria-hidden":"true"}),n.jsx(ke,{value:s,onChange:p=>a(p.target.value),placeholder:"Search files...",className:"h-6 pl-7 text-sm font-terminal rounded-none border-secondary/50 bg-black/40","aria-label":"Search files"})]}),n.jsxs(q,{size:"sm",variant:"outline",className:"w-full h-5 text-xs font-terminal rounded-none border-primary/50",onClick:w,children:[n.jsx(Mt,{className:"w-2.5 h-2.5 mr-1","aria-hidden":"true"}),"New Note"]})]}),n.jsx("div",{className:"flex flex-col gap-0.5 p-1.5 border-b border-primary/30 shrink-0",children:Un.map(p=>n.jsx("button",{onClick:()=>b(p.path),className:`text-left px-2 py-1 text-xs font-terminal rounded-none transition-colors ${t===p.path?"bg-primary/20 text-primary border-l-2 border-primary":"text-muted-foreground hover:text-foreground hover:bg-secondary/20"}`,"aria-pressed":t===p.path,children:p.name},p.path))}),t&&n.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 font-terminal text-xs text-muted-foreground border-b border-secondary/20 flex-wrap shrink-0",children:[f&&n.jsx("button",{onClick:g,className:"hover:text-primary shrink-0",title:"Go to parent folder","aria-label":"Go to parent folder",children:n.jsx(Zr,{className:"w-3 h-3","aria-hidden":"true"})}),u.map((p,v,N)=>n.jsxs("span",{className:"flex items-center gap-0.5",children:[v>0&&n.jsx("span",{className:"text-muted-foreground",children:"/"}),n.jsx("button",{onClick:()=>b(N.slice(0,v+1).join("/")),className:"hover:text-primary",children:p})]},v))]}),n.jsx(Se,{fallback:n.jsx(sa,{onReset:()=>d(p=>p+1)}),children:n.jsx(Oe,{className:"flex-1 min-h-0 border-b border-primary/30",children:n.jsx("div",{className:"py-1",children:P.map(p=>{const v=typeof p=="string"?p:p.path,N=v.endsWith("/"),D=v.replace(/\/$/,"").split("/").pop()||v,A=t?`${t}/${D}`:D,R=o.has(A),k=e.currentFile?.endsWith(D)||!1;return n.jsxs("div",{children:[n.jsx(Wn,{name:D,isFolder:N,isExpanded:R,isActive:k,depth:0,onClick:()=>{N?y(A):e.openFile(A)}}),N&&R&&n.jsx(Jn,{folderPath:A,depth:1,expandedFolders:o,toggleFolder:y,workspace:e,connected:x})]},v)})})})},`filetree-${l}`)]}):n.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4",children:[n.jsx(jn,{className:"w-6 h-6 text-red-500 mb-2","aria-hidden":"true"}),n.jsx("p",{className:"font-terminal text-sm text-red-400 text-center",children:"Obsidian Offline"}),n.jsx("p",{className:"font-terminal text-xs text-muted-foreground text-center mt-1",children:"Open Obsidian with Local REST API"})]})}const aa=`Generate Anki flashcards from the following study material. Output ONLY a numbered list in this exact format:

1. Front: [question]
Back: [answer]
Tags: [comma-separated tags like: Module1, Obj2, TopicName]

Rules:
- Front = the question only (no module/objective prefixes)
- Back = concise answer
- Tags = include Module#, Obj#, and topic keywords
- One card per concept
- No extra text before or after the list

Study material:
[PASTE YOUR NOTES HERE]`;function on(e,t){if(t.length===0)return e;const r=[];for(const s of t)r.push({type:"image_url",image_url:{url:s}});return e.trim()&&r.push({type:"text",text:e}),r}function oa({mode:e,setMode:t,ingestTarget:r,setIngestTarget:s,promptCopied:a,setPromptCopied:o}){const i=()=>{navigator.clipboard.writeText(aa),o(!0),setTimeout(()=>o(!1),2e3)};return n.jsxs("div",{className:"px-3 py-1 border-b border-primary/30 flex items-center justify-between gap-2 shrink-0",children:[n.jsxs("div",{className:"flex bg-black/40 border border-primary/40 rounded-none overflow-hidden mr-2",children:[n.jsxs("button",{onClick:()=>t("chat"),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${e==="chat"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[n.jsx(Nn,{className:"w-3 h-3"})," CHAT"]}),n.jsxs("button",{onClick:()=>t("ingest"),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${e==="ingest"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[n.jsx(ts,{className:"w-3 h-3"})," INGEST"]})]}),n.jsx("p",{className:"text-xs text-muted-foreground truncate flex-1",children:e==="chat"?"Chat with Gemini Flash":"Paste notes to create cards & save sessions"}),e==="ingest"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"flex bg-black/40 border border-primary/40 rounded-none overflow-hidden shrink-0",children:["anki","obsidian","both"].map(l=>n.jsxs("button",{onClick:()=>s(l),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${r===l?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[l==="anki"&&n.jsxs(n.Fragment,{children:[n.jsx(_e,{className:"w-3 h-3"})," ANKI"]}),l==="obsidian"&&n.jsxs(n.Fragment,{children:[n.jsx(wt,{className:"w-3 h-3"})," OBSIDIAN"]}),l==="both"&&n.jsx(n.Fragment,{children:"BOTH"})]},l))}),n.jsx("button",{type:"button",className:"bg-primary hover:bg-primary/80 px-2 py-0.5 rounded-none text-xs font-terminal shrink-0",onClick:i,children:a?"Copied!":"Copy Prompt"})]})]})}function ia({messages:e,loading:t,mode:r,scrollRef:s}){const a=c.useCallback(()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},[s]);return c.useEffect(()=>{a()},[e,a]),n.jsxs("div",{ref:s,className:"flex-1 overflow-y-auto px-4 py-2 space-y-3",children:[e.length===0&&n.jsx("p",{className:"text-muted-foreground text-sm font-terminal text-center py-8",children:r==="chat"?"Ask anything. Paste screenshots with Ctrl+V.":"Paste your study notes to ingest into Brain."}),e.map((o,i)=>n.jsx("div",{className:`flex ${o.role==="user"?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`max-w-[80%] rounded-none px-3 py-2 text-sm font-terminal whitespace-pre-wrap ${o.role==="user"?"bg-primary/20 text-foreground border border-primary/30":"bg-secondary/40 text-foreground border border-secondary/60"}`,children:[o.images?.map((l,d)=>n.jsx("img",{src:l,alt:"attached",className:"max-h-32 rounded-none mb-1"},d)),o.content]})},i)),t&&n.jsx("div",{className:"flex justify-start",children:n.jsx("div",{className:"bg-secondary/40 border border-secondary/60 rounded-none px-3 py-2",children:n.jsx(Dt,{className:"w-4 h-4 animate-spin text-primary"})})})]})}function la({images:e,onRemove:t}){return e.length===0?null:n.jsx("div",{className:"px-4 py-1 flex gap-2 flex-wrap shrink-0",children:e.map((r,s)=>n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:r,alt:"pending",className:"h-12 rounded-none border border-primary/30"}),n.jsx("button",{onClick:()=>t(s),className:"absolute -top-1 -right-1 bg-destructive rounded-none p-0.5","aria-label":"Remove image",children:n.jsx(vt,{className:"w-3 h-3"})})]},s))})}function ca({input:e,setInput:t,onSend:r,onImageSelect:s,onPaste:a,loading:o,mode:i}){const l=c.useRef(null),d=h=>{h.key==="Enter"&&!h.shiftKey&&(h.preventDefault(),r())},x=h=>{const b=h.target.files;b&&(s(b),h.target.value="")};return n.jsxs("div",{className:"flex items-end gap-2 px-4 py-2 border-t border-primary/30 shrink-0",children:[n.jsx("input",{ref:l,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:x}),i==="chat"&&n.jsx(q,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:()=>l.current?.click(),"aria-label":"Attach image",children:n.jsx(fs,{className:"w-4 h-4 text-primary"})}),n.jsx("textarea",{value:e,onChange:h=>t(h.target.value),onKeyDown:d,onPaste:a,placeholder:i==="chat"?"Ask anything... (Ctrl+V to paste images)":"Paste study notes to ingest...",rows:i==="ingest"?3:1,className:"flex-1 bg-black/60 border-2 border-muted-foreground/20 rounded-none px-3 py-1.5 text-sm font-terminal resize-none focus:outline-none focus:ring-1 focus:ring-ring"}),n.jsx(q,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:r,disabled:o,"aria-label":"Send message",children:n.jsx(Yr,{className:"w-4 h-4 text-primary"})})]})}function Nt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e?.(a),r===!1||!a.defaultPrevented)return t?.(a)}}var da=yn[" useInsertionEffect ".trim().toString()]||Sr;function ua({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){const[a,o,i]=ma({defaultProp:t,onChange:r}),l=e!==void 0,d=l?e:a;{const h=c.useRef(e!==void 0);c.useEffect(()=>{const b=h.current;b!==l&&console.warn(`${s} is changing from ${b?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=l},[l,s])}const x=c.useCallback(h=>{if(l){const b=fa(h)?h(e):h;b!==e&&i.current?.(b)}else o(h)},[l,e,o,i]);return[d,x]}function ma({defaultProp:e,onChange:t}){const[r,s]=c.useState(e),a=c.useRef(r),o=c.useRef(t);return da(()=>{o.current=t},[t]),c.useEffect(()=>{a.current!==r&&(o.current?.(r),a.current=r)},[r,a]),[r,s,o]}function fa(e){return typeof e=="function"}var Ht="Radio",[pa,Yn]=vn(Ht),[ha,xa]=pa(Ht),Qn=c.forwardRef((e,t)=>{const{__scopeRadio:r,name:s,checked:a=!1,required:o,disabled:i,value:l="on",onCheck:d,form:x,...h}=e,[b,g]=c.useState(null),y=kt(t,f=>g(f)),w=c.useRef(!1),P=b?x||!!b.closest("form"):!0;return n.jsxs(ha,{scope:r,checked:a,disabled:i,children:[n.jsx(Xe.button,{type:"button",role:"radio","aria-checked":a,"data-state":tr(a),"data-disabled":i?"":void 0,disabled:i,value:l,...h,ref:y,onClick:Nt(e.onClick,f=>{a||d?.(),P&&(w.current=f.isPropagationStopped(),w.current||f.stopPropagation())})}),P&&n.jsx(er,{control:b,bubbles:!w.current,name:s,value:l,checked:a,required:o,disabled:i,form:x,style:{transform:"translateX(-100%)"}})]})});Qn.displayName=Ht;var Xn="RadioIndicator",Zn=c.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:s,...a}=e,o=xa(Xn,r);return n.jsx(kr,{present:s||o.checked,children:n.jsx(Xe.span,{"data-state":tr(o.checked),"data-disabled":o.disabled?"":void 0,...a,ref:t})})});Zn.displayName=Xn;var ga="RadioBubbleInput",er=c.forwardRef(({__scopeRadio:e,control:t,checked:r,bubbles:s=!0,...a},o)=>{const i=c.useRef(null),l=kt(i,o),d=qr(r),x=Cr(t);return c.useEffect(()=>{const h=i.current;if(!h)return;const b=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(b,"checked").set;if(d!==r&&y){const w=new Event("click",{bubbles:s});y.call(h,r),h.dispatchEvent(w)}},[d,r,s]),n.jsx(Xe.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:l,style:{...a.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});er.displayName=ga;function tr(e){return e?"checked":"unchecked"}var ba=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],at="RadioGroup",[ya]=vn(at,[Sn,Yn]),nr=Sn(),rr=Yn(),[va,wa]=ya(at),sr=c.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:s,defaultValue:a,value:o,required:i=!1,disabled:l=!1,orientation:d,dir:x,loop:h=!0,onValueChange:b,...g}=e,y=nr(r),w=Pr(x),[P,f]=ua({prop:o,defaultProp:a??null,onChange:b,caller:at});return n.jsx(va,{scope:r,name:s,required:i,disabled:l,value:P,onValueChange:f,children:n.jsx(Br,{asChild:!0,...y,orientation:d,dir:w,loop:h,children:n.jsx(Xe.div,{role:"radiogroup","aria-required":i,"aria-orientation":d,"data-disabled":l?"":void 0,dir:w,...g,ref:t})})})});sr.displayName=at;var ar="RadioGroupItem",or=c.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:s,...a}=e,o=wa(ar,r),i=o.disabled||s,l=nr(r),d=rr(r),x=c.useRef(null),h=kt(t,x),b=o.value===a.value,g=c.useRef(!1);return c.useEffect(()=>{const y=P=>{ba.includes(P.key)&&(g.current=!0)},w=()=>g.current=!1;return document.addEventListener("keydown",y),document.addEventListener("keyup",w),()=>{document.removeEventListener("keydown",y),document.removeEventListener("keyup",w)}},[]),n.jsx(Kr,{asChild:!0,...l,focusable:!i,active:b,children:n.jsx(Qn,{disabled:i,required:o.required,checked:b,...d,...a,name:o.name,ref:h,onCheck:()=>o.onValueChange(a.value),onKeyDown:Nt(y=>{y.key==="Enter"&&y.preventDefault()}),onFocus:Nt(a.onFocus,()=>{g.current&&x.current?.click()})})})});or.displayName=ar;var ja="RadioGroupIndicator",ir=c.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...s}=e,a=rr(r);return n.jsx(Zn,{...a,...s,ref:t})});ir.displayName=ja;var lr=sr,cr=or,Na=ir;const dr=c.forwardRef(({className:e,...t},r)=>n.jsx(lr,{className:ue("grid gap-2",e),...t,ref:r}));dr.displayName=lr.displayName;const ur=c.forwardRef(({className:e,...t},r)=>n.jsx(cr,{ref:r,className:ue("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(Na,{className:"flex items-center justify-center",children:n.jsx(wn,{className:"h-3.5 w-3.5 fill-primary"})})}));ur.displayName=cr.displayName;const Sa=/(\[\[.*?\]\])/g,ka=/!\[\[(.*?)\]\]/g,Ca=[".png",".jpg",".jpeg",".gif",".svg",".webp",".bmp"],Ea=/^\[!([\w-]+)\]\s*(.*)?$/,ln={note:"border-blue-500/50 bg-blue-500/10",tip:"border-green-500/50 bg-green-500/10",important:"border-purple-500/50 bg-purple-500/10",warning:"border-yellow-500/50 bg-yellow-500/10",caution:"border-red-500/50 bg-red-500/10",info:"border-blue-400/50 bg-blue-400/10",abstract:"border-cyan-500/50 bg-cyan-500/10",summary:"border-cyan-500/50 bg-cyan-500/10",todo:"border-blue-500/50 bg-blue-500/10",success:"border-green-500/50 bg-green-500/10",question:"border-yellow-400/50 bg-yellow-400/10",example:"border-purple-400/50 bg-purple-400/10",quote:"border-gray-400/50 bg-gray-400/10",bug:"border-red-400/50 bg-red-400/10",danger:"border-red-500/50 bg-red-500/10",fail:"border-red-500/50 bg-red-500/10",failure:"border-red-500/50 bg-red-500/10"};function xt(e,t){return e.split(Sa).map((r,s)=>{const a=r.match(/^\[\[(.*?)\]\]$/);if(a){const o=a[1].includes("|")?a[1].split("|")[1]:a[1],i=a[1].includes("|")?a[1].split("|")[0]:a[1];return n.jsx("span",{className:"text-blue-400 hover:text-blue-300 cursor-pointer underline decoration-dotted",onClick:l=>t?.(i,l.shiftKey),title:`${i} (Shift+click for Obsidian app)`,children:o},s)}return n.jsx("span",{children:r},s)})}function Pa(e){return e.replace(ka,(t,r)=>{const s=r.toLowerCase();return Ca.some(o=>s.endsWith(o))?`![${r}](/api/obsidian/vault-file/${encodeURIComponent(r)})`:`[[${r}]]`})}function Ra(e){const t=e.split(`
`),r=[];let s=!1,a="",o="",i=[];const l=()=>{if(!s)return;const d=ln[a.toLowerCase()]||ln.note,x=o||a.charAt(0).toUpperCase()+a.slice(1);r.push(`<div class="callout ${d} border-l-4 rounded px-3 py-2 my-2">`),r.push(`<div class="font-bold text-xs uppercase tracking-wider mb-1">${x}</div>`),r.push(""),r.push(i.join(`
`)),r.push(""),r.push("</div>"),s=!1,i=[]};for(const d of t){if(d.startsWith("> ")){const x=d.slice(2),h=x.match(Ea);if(h&&!s){s=!0,a=h[1],o=h[2]||"";continue}if(s){i.push(x);continue}}else if(d===">"&&s){i.push("");continue}else l();r.push(d)}return l(),r.join(`
`)}function mr({content:e,onWikilinkClick:t}){const r=Ra(Pa(e)),s={h1:({children:a})=>n.jsx("h1",{className:"text-xl font-bold text-primary border-b border-primary/30 pb-1 mb-3 mt-4",children:a}),h2:({children:a})=>n.jsx("h2",{className:"text-lg font-bold text-primary/90 border-b border-primary/20 pb-1 mb-2 mt-3",children:a}),h3:({children:a})=>n.jsx("h3",{className:"text-base font-semibold text-primary/80 mb-2 mt-3",children:a}),h4:({children:a})=>n.jsx("h4",{className:"text-sm font-semibold text-primary/70 mb-1 mt-2",children:a}),p:({children:a})=>typeof a=="string"?n.jsx("p",{className:"mb-2 leading-relaxed",children:xt(a,t)}):n.jsx("p",{className:"mb-2 leading-relaxed",children:a}),strong:({children:a})=>n.jsx("strong",{className:"font-bold text-foreground",children:a}),em:({children:a})=>n.jsx("em",{className:"italic text-foreground/90",children:a}),ul:({children:a})=>n.jsx("ul",{className:"list-disc list-inside mb-2 space-y-0.5 ml-2",children:a}),ol:({children:a})=>n.jsx("ol",{className:"list-decimal list-inside mb-2 space-y-0.5 ml-2",children:a}),li:({children:a})=>typeof a=="string"?n.jsx("li",{className:"leading-relaxed",children:xt(a,t)}):n.jsx("li",{className:"leading-relaxed",children:a}),blockquote:({children:a})=>n.jsx("blockquote",{className:"border-l-4 border-primary/30 pl-3 my-2 text-muted-foreground italic",children:a}),code:({children:a,className:o})=>o?.startsWith("language-")?n.jsx("code",{className:"block bg-black/80 border border-secondary/40 rounded p-3 my-2 text-xs font-mono overflow-x-auto whitespace-pre",children:a}):n.jsx("code",{className:"bg-secondary/40 px-1.5 py-0.5 rounded text-xs font-mono text-primary",children:a}),pre:({children:a})=>n.jsx("pre",{className:"my-2",children:a}),hr:()=>n.jsx("hr",{className:"border-primary/20 my-4"}),a:({href:a,children:o})=>n.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:o}),table:({children:a})=>n.jsx("div",{className:"overflow-x-auto my-2",children:n.jsx("table",{className:"w-full text-xs border-collapse border border-secondary/40",children:a})}),th:({children:a})=>n.jsx("th",{className:"border border-secondary/40 bg-secondary/20 px-2 py-1 text-left font-semibold",children:a}),td:({children:a})=>typeof a=="string"?n.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:xt(a,t)}):n.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:a}),img:({src:a,alt:o})=>n.jsx("img",{src:a,alt:o||"",className:"max-w-full rounded border border-secondary/40 my-2",loading:"lazy"}),del:({children:a})=>n.jsx("del",{className:"line-through text-muted-foreground",children:a}),input:({checked:a,...o})=>n.jsx("input",{type:"checkbox",checked:a,readOnly:!0,className:"mr-1.5 accent-primary",...o})};return n.jsx("div",{className:"obsidian-preview prose-invert max-w-none text-sm leading-relaxed",children:n.jsx(Dr,{remarkPlugins:[$r],components:s,allowedElements:void 0,unwrapDisallowed:!1,children:r})})}function Ia({line:e,index:t}){const r=e.startsWith("+"),s=e.startsWith("-");return n.jsx("div",{className:`font-terminal text-[11px] px-2 ${r?"bg-green-900/30 text-green-400":s?"bg-red-900/30 text-red-400":"text-muted-foreground"}`,children:e})}function za({open:e,onOpenChange:t,loading:r,error:s,rawNotes:a,organized:o,destination:i,selectedDestinationId:l,setSelectedDestinationId:d,customDestination:x,setCustomDestination:h,checklistState:b,onToggleChecklist:g,diffLines:y,onConfirm:w,onCancel:P}){const f=Object.values(b).length===0?!0:Object.values(b).every(Boolean),p=i?l==="custom"?x.trim():i.options.find(N=>N.id===l)?.path||"":"";return n.jsx(Et,{open:e,onOpenChange:t,children:n.jsxs(Pt,{className:"max-w-6xl w-full h-[85vh] bg-black border-2 border-primary rounded-none p-4 overflow-hidden",children:[n.jsxs(Rt,{className:"space-y-1",children:[n.jsxs(It,{className:"font-arcade text-sm text-primary flex items-center gap-2",children:[n.jsx(Mt,{className:"w-4 h-4"}),"ORGANIZE + REVIEW"]}),n.jsx(zt,{className:"font-terminal text-[11px] text-muted-foreground",children:"Review the organized notes, compare to raw, then choose where to save."})]}),s&&n.jsx("div",{className:"border border-red-500/50 bg-red-900/20 text-red-200 font-terminal text-xs p-2 rounded-none",children:s}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 h-[70vh]",children:[n.jsx("div",{className:"col-span-2 flex flex-col gap-3",children:n.jsxs(Ur,{defaultValue:"preview",className:"w-full",children:[n.jsxs(Wr,{className:"grid grid-cols-3 rounded-none",children:[n.jsx(ct,{value:"preview",className:"rounded-none text-xs",children:"Preview"}),n.jsx(ct,{value:"raw",className:"rounded-none text-xs",children:"Raw"}),n.jsx(ct,{value:"diff",className:"rounded-none text-xs",children:"Diff"})]}),n.jsx(dt,{value:"preview",className:"mt-2",children:n.jsx(Oe,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-3",children:n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"font-arcade text-xs text-primary",children:o?.title||"Untitled"}),n.jsx(mr,{content:o?.markdown||""})]})})}),n.jsx(dt,{value:"raw",className:"mt-2",children:n.jsx(Oe,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-3",children:n.jsx("pre",{className:"whitespace-pre-wrap font-terminal text-[11px] text-foreground",children:a})})}),n.jsx(dt,{value:"diff",className:"mt-2",children:n.jsx(Oe,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-0",children:n.jsx("div",{className:"p-2",children:y.length===0?n.jsx("div",{className:"text-muted-foreground font-terminal text-xs",children:"No diff available."}):y.map((v,N)=>n.jsx(Ia,{line:v,index:N},N))})})})]})}),n.jsxs("div",{className:"col-span-1 flex flex-col gap-3",children:[n.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[n.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"DESTINATION"}),n.jsx(dr,{value:l,onValueChange:d,className:"space-y-2",children:(i?.options||[]).map(v=>n.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[n.jsx(ur,{value:v.id,className:"mt-1"}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"font-terminal text-[11px] text-foreground flex items-center gap-1",children:[v.label,v.exists&&n.jsx(Ue,{variant:"outline",className:"text-[9px]",children:"existing"})]}),n.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground break-all",children:v.path||"Custom path"})]})]},v.id))}),l==="custom"&&n.jsxs("div",{className:"mt-2 space-y-1",children:[n.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground",children:"Custom path"}),n.jsx(ke,{value:x,onChange:v=>h(v.target.value),placeholder:"School/Therapeutic Intervention/Module 01 - Title.md",className:"bg-black border-secondary/60 rounded-none text-xs font-terminal"})]})]}),n.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[n.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"REVIEW CHECKLIST"}),n.jsx("div",{className:"space-y-2",children:(o?.checklist||[]).map(v=>n.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[n.jsx(kn,{checked:!!b[v],onCheckedChange:()=>g(v)}),n.jsx("span",{className:"font-terminal text-[11px] text-foreground",children:v})]},v))})]}),(o?.suggested_links||[]).length>0&&n.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[n.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"SUGGESTED LINKS"}),n.jsx("div",{className:"space-y-1",children:o?.suggested_links?.map(v=>n.jsxs("div",{className:"font-terminal text-[11px] text-muted-foreground",children:["[[",v,"]]"]},v))})]}),n.jsxs("div",{className:"flex gap-2 mt-auto",children:[n.jsx(q,{variant:"outline",className:"flex-1 rounded-none font-terminal text-xs",onClick:P,disabled:r,children:"Cancel"}),n.jsxs(q,{className:"flex-1 bg-primary hover:bg-primary/80 rounded-none font-terminal text-xs",onClick:w,disabled:!f||r||!p,children:[n.jsx(Jr,{className:"w-3 h-3 mr-1"}),r?"Saving...":"Confirm & Save"]})]})]})]})]})})}function Ta(){const[e,t]=c.useState(!1),[r,s]=c.useState(!1),[a,o]=c.useState(null),[i,l]=c.useState(""),[d,x]=c.useState(null),[h,b]=c.useState(null),[g,y]=c.useState(""),[w,P]=c.useState(""),[f,u]=c.useState({}),[p,v]=c.useState([]),N=(j,C)=>{const T=j.split(`
`),_=C.split(`
`),$=[];let M=0,F=0;for(;M<T.length||F<_.length;){const B=T[M],J=_[F];if(M<T.length&&F<_.length&&B===J){$.push(` ${B}`),M+=1,F+=1;continue}M<T.length&&($.push(`-${B}`),M+=1),F<_.length&&($.push(`+${J}`),F+=1)}return $},D=c.useCallback(()=>{t(!1),s(!1),o(null),l(""),x(null),b(null),y(""),P(""),u({}),v([])},[]),A=c.useCallback(async j=>{s(!0),o(null),l(j);try{const C=await G.brain.organizePreview(j);if(!C.success||!C.organized||!C.destination)throw new Error(C.error||"Unable to organize notes.");x(C.organized),b(C.destination),y("recommended");const T=C.organized.checklist??[],_={};return T.forEach($=>{_[$]=!1}),u(_),v(N(j,C.organized.markdown||"")),t(!0),!0}catch(C){const T=C instanceof Error?C.message:String(C);return o(T),!1}finally{s(!1)}},[]),R=c.useCallback(j=>{u(C=>({...C,[j]:!C[j]}))},[]),k=c.useCallback(()=>h?g==="custom"?w.trim():h.options.find(C=>C.id===g)?.path||"":"",[h,g,w]),H=Object.values(f).length===0?!0:Object.values(f).every(Boolean);return{open:e,setOpen:t,loading:r,error:a,rawNotes:i,organized:d,destination:h,selectedDestinationId:g,setSelectedDestinationId:y,customDestination:w,setCustomDestination:P,checklistState:f,diffLines:p,allChecklistChecked:H,reset:D,startPreview:A,toggleChecklist:R,getSelectedDestinationPath:k}}function Aa(){const[e,t]=c.useState("chat"),[r,s]=c.useState([]),[a,o]=c.useState(""),[i,l]=c.useState([]),[d,x]=c.useState(!1),[h,b]=c.useState("anki"),[g,y]=c.useState(!1),w=c.useRef(null),P=Ze(),{toast:f}=et(),u=Ta(),p=c.useCallback(j=>{const C=new FileReader;C.onload=()=>{typeof C.result=="string"&&l(T=>[...T,C.result])},C.readAsDataURL(j)},[]),v=c.useCallback(j=>{const C=j.clipboardData?.items;if(C){for(const T of Array.from(C))if(T.type.startsWith("image/")){j.preventDefault();const _=T.getAsFile();_&&p(_)}}},[p]),N=c.useCallback(j=>{for(const C of Array.from(j))C.type.startsWith("image/")&&p(C)},[p]),D=c.useCallback(j=>{l(C=>C.filter((T,_)=>_!==j))},[]),A=c.useCallback(async(j,C)=>{s(B=>[...B,{role:"assistant",content:""}]);const T=r.map(B=>({role:B.role,content:B.images?.length?on(B.content,B.images):B.content})).concat([{role:"user",content:on(j,C)}]),$=(await fetch("/api/brain/quick-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:T})})).body?.getReader(),M=new TextDecoder;if(!$)throw new Error("No response body");let F="";for(;;){const{done:B,value:J}=await $.read();if(B)break;F+=M.decode(J,{stream:!0});const ne=F.split(`
`);F=ne.pop()??"";for(const ce of ne){if(!ce.startsWith("data: "))continue;const se=ce.slice(6);if(se==="[DONE]")break;try{const re=JSON.parse(se);if(re.error){s(m=>{const S=[...m];return S[S.length-1]={role:"assistant",content:`Error: ${re.error}`},S});return}re.content&&s(m=>{const S=[...m],z=S[S.length-1];return S[S.length-1]={...z,content:z.content+re.content},S})}catch{}}}},[r]),R=c.useCallback(async(j,C)=>{try{const $={message:j,syncToObsidian:h==="obsidian"||h==="both",mode:h==="both"?"all":h,destinationPath:C?.destinationPath,organizedMarkdown:C?.organizedMarkdown,organizedTitle:C?.organizedTitle,confirmWrite:C?.confirmWrite},M=await G.brain.chat($);let F=M.response;const B={cardsCreated:M.cardsCreated,sessionSaved:M.sessionSaved,sessionId:M.sessionId},J=[];M.sessionSaved&&J.push(`Session saved (ID: ${M.sessionId})`),M.cardsCreated&&J.push(`${M.cardsCreated} Anki cards created`),M.obsidianSynced&&J.push("Synced to Obsidian"),M.obsidianError&&J.push(`Obsidian error: ${M.obsidianError}`),J.length>0&&(F=`${J.join(" | ")}

${F}`),s(ne=>[...ne,{role:"assistant",content:F,meta:B}]),P.invalidateQueries({queryKey:["anki","drafts"]}),P.invalidateQueries({queryKey:["brain","metrics"]}),P.invalidateQueries({queryKey:["sessions"]})}catch(T){const _=T instanceof Error?T.message:String(T);s($=>[...$,{role:"assistant",content:`Error: ${_}`}]),f({title:"Ingest failed",description:_,variant:"destructive"})}},[h,P,f]),k=c.useCallback(async()=>{const j=a.trim();if(!j&&i.length===0)return;const C={role:"user",content:j,images:[...i]};s(T=>[...T,C]),o(""),l([]),x(!0);try{e==="chat"?await A(j,C.images??[]):h==="obsidian"||h==="both"?await u.startPreview(j)||s(_=>[..._,{role:"assistant",content:"Error: Unable to prepare preview."}]):await R(j)}catch(T){const _=T instanceof Error?T.message:String(T);s($=>{const M=$[$.length-1];if(M?.role==="assistant"&&!M.content){const F=[...$];return F[F.length-1]={role:"assistant",content:`Error: ${_}`},F}return[...$,{role:"assistant",content:`Error: ${_}`}]})}finally{x(!1)}},[a,i,e,h,A,R,u]),H=c.useCallback(async()=>{if(!u.organized)return;const j=u.getSelectedDestinationPath();if(!j){u.setOpen(!1),f({title:"Error",description:"Select a destination path.",variant:"destructive"});return}x(!0);try{await R(u.rawNotes,{destinationPath:j,organizedMarkdown:u.organized.markdown,organizedTitle:u.organized.title,confirmWrite:!0}),u.reset()}catch(C){const T=C instanceof Error?C.message:String(C);f({title:"Save failed",description:T,variant:"destructive"})}finally{x(!1)}},[u,R,f]);return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx(oa,{mode:e,setMode:t,ingestTarget:h,setIngestTarget:b,promptCopied:g,setPromptCopied:y}),n.jsx(ia,{messages:r,loading:d,mode:e,scrollRef:w}),n.jsx(la,{images:i,onRemove:D}),n.jsx(ca,{input:a,setInput:o,onSend:k,onImageSelect:N,onPaste:v,loading:d,mode:e}),n.jsx(za,{open:u.open,onOpenChange:j=>{j?u.setOpen(!0):u.reset()},loading:u.loading,error:u.error,rawNotes:u.rawNotes,organized:u.organized,destination:u.destination,selectedDestinationId:u.selectedDestinationId,setSelectedDestinationId:u.setSelectedDestinationId,customDestination:u.customDestination,setCustomDestination:u.setCustomDestination,checklistState:u.checklistState,onToggleChecklist:u.toggleChecklist,diffLines:u.diffLines,onConfirm:H,onCancel:u.reset})]})}const Ma="/assets/TreysStudySystemIMAGE-nejJlbV0.jpg";function Da({workspace:e}){const[t,r]=c.useState(!1);return c.useEffect(()=>{if(!t)return;const s=a=>{a.key==="Escape"&&r(!1)};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[t]),e.currentFile?n.jsxs("div",{className:ue("flex flex-col",t?"fixed inset-0 z-50 bg-black":"h-full"),children:[n.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 border-b border-secondary/30 bg-black/40",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsxs("span",{className:"font-terminal text-sm text-primary truncate",children:[e.currentFile.split("/").pop(),e.hasChanges&&n.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),n.jsx("button",{onClick:()=>{const s=e.obsidianConfig?.vaultName||"Treys School",a=e.currentFile.replace(/\.md$/,"");window.open(`obsidian://open?vault=${encodeURIComponent(s)}&file=${encodeURIComponent(a)}`,"_blank")},className:"text-muted-foreground hover:text-primary shrink-0",title:"Open in Obsidian",children:n.jsx(Qr,{className:"w-3 h-3"})})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(q,{size:"sm",variant:"ghost",className:"h-5 px-2 text-xs font-terminal",onClick:()=>e.setPreviewMode(!e.previewMode),children:e.previewMode?"Edit":"Preview"}),n.jsxs(q,{size:"sm",variant:"ghost",onClick:e.saveFile,disabled:!e.hasChanges||e.isSaving,className:"h-5 px-2 text-xs font-terminal",children:[n.jsx(Tt,{className:"w-3 h-3 mr-1"}),e.isSaving?"Saving...":"Save"]}),n.jsx(q,{size:"sm",variant:"ghost",className:"h-5 px-1.5 text-xs font-terminal",onClick:()=>r(!t),title:t?"Exit fullscreen":"Fullscreen",children:t?n.jsx(gs,{className:"w-3 h-3"}):n.jsx(hs,{className:"w-3 h-3"})})]})]}),e.previewMode?n.jsx("div",{className:"flex-1 p-3 bg-black/60 font-terminal overflow-y-auto",children:n.jsx(mr,{content:e.fileContent,onWikilinkClick:e.handleWikilinkClick})}):n.jsx("textarea",{value:e.fileContent,onChange:s=>e.setFileContent(s.target.value),className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary overflow-y-auto min-h-[200px]",placeholder:"File content...",style:{height:"100%"}})]}):n.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-muted-foreground font-terminal text-sm gap-2 relative overflow-hidden",children:[n.jsx("img",{src:Ma,alt:"",className:"absolute inset-0 w-full h-full object-cover opacity-20 pointer-events-none select-none"}),n.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-2",children:[n.jsx(Mt,{className:"w-8 h-8 opacity-30"}),n.jsx("p",{children:"Select a file from the vault sidebar"}),n.jsx("p",{className:"text-xs",children:"or create a new note"})]})]})}const $a=c.lazy(()=>Ct(()=>import("./ConceptMapEditor-CJKp0G6i.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then(e=>({default:e.ConceptMapEditor}))),La=c.lazy(()=>Ct(()=>import("./VaultGraphView-D-dv9xJB.js"),__vite__mapDeps([22,1,2,23,3,4,19,14])).then(e=>({default:e.VaultGraphView}))),Oa=c.lazy(()=>Ct(()=>import("./MindMapView-Dqy_WITy.js"),__vite__mapDeps([24,1,2,23,3,4,19,14])).then(e=>({default:e.MindMapView})));class _a extends c.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromError(t){return{error:t.message}}render(){return this.state.error?n.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-2 p-4",children:[n.jsx("p",{className:"font-arcade text-xs text-red-400",children:"GRAPH RENDER ERROR"}),n.jsx("p",{className:"font-terminal text-xs text-muted-foreground text-center",children:this.state.error}),n.jsx("button",{className:"font-terminal text-sm text-primary underline",onClick:()=>this.setState({error:null}),children:"Try again"})]}):this.props.children}}function Fa(){return n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx(Dt,{className:"w-6 h-6 animate-spin text-primary"})})}function Ha(){const[e,t]=c.useState("concept"),r=[{id:"concept",label:"Concept Map"},{id:"vault",label:"Vault Graph"},{id:"mindmap",label:"Mind Map"}];return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex items-center gap-1 px-3 py-1.5 border-b border-secondary/30 bg-black/40 shrink-0",children:r.map(s=>n.jsx("button",{onClick:()=>t(s.id),className:`px-2.5 py-1 font-terminal text-xs transition-colors ${e===s.id?"bg-primary/20 text-primary border border-primary/40":"text-muted-foreground hover:text-foreground border border-transparent"}`,children:s.label},s.id))}),n.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:n.jsx(_a,{children:n.jsxs(c.Suspense,{fallback:n.jsx(Fa,{}),children:[e==="concept"&&n.jsx($a,{}),e==="vault"&&n.jsx(La,{}),e==="mindmap"&&n.jsx(Oa,{})]})})})]})}function Va(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const r=document.implementation.createHTMLDocument(),s=r.createElement("base"),a=r.createElement("a");return r.head.appendChild(s),r.body.appendChild(a),t&&(s.href=t),a.href=e,a.href}const Ga=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function pe(e){const t=[];for(let r=0,s=e.length;r<s;r++)t.push(e[r]);return t}let we=null;function fr(e={}){return we||(e.includeStyleProperties?(we=e.includeStyleProperties,we):(we=pe(window.getComputedStyle(document.documentElement)),we))}function Ye(e,t){const s=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return s?parseFloat(s.replace("px","")):0}function qa(e){const t=Ye(e,"border-left-width"),r=Ye(e,"border-right-width");return e.clientWidth+t+r}function Ba(e){const t=Ye(e,"border-top-width"),r=Ye(e,"border-bottom-width");return e.clientHeight+t+r}function pr(e,t={}){const r=t.width||qa(e),s=t.height||Ba(e);return{width:r,height:s}}function Ka(){let e,t;try{t=process}catch{}const r=t&&t.env?t.env.devicePixelRatio:null;return r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const ee=16384;function Ua(e){(e.width>ee||e.height>ee)&&(e.width>ee&&e.height>ee?e.width>e.height?(e.height*=ee/e.width,e.width=ee):(e.width*=ee/e.height,e.height=ee):e.width>ee?(e.height*=ee/e.width,e.width=ee):(e.width*=ee/e.height,e.height=ee))}function Qe(e){return new Promise((t,r)=>{const s=new Image;s.onload=()=>{s.decode().then(()=>{requestAnimationFrame(()=>t(s))})},s.onerror=r,s.crossOrigin="anonymous",s.decoding="async",s.src=e})}async function Wa(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function Ja(e,t,r){const s="http://www.w3.org/2000/svg",a=document.createElementNS(s,"svg"),o=document.createElementNS(s,"foreignObject");return a.setAttribute("width",`${t}`),a.setAttribute("height",`${r}`),a.setAttribute("viewBox",`0 0 ${t} ${r}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),a.appendChild(o),o.appendChild(e),Wa(a)}const X=(e,t)=>{if(e instanceof t)return!0;const r=Object.getPrototypeOf(e);return r===null?!1:r.constructor.name===t.name||X(r,t)};function Ya(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function Qa(e,t){return fr(t).map(r=>{const s=e.getPropertyValue(r),a=e.getPropertyPriority(r);return`${r}: ${s}${a?" !important":""};`}).join(" ")}function Xa(e,t,r,s){const a=`.${e}:${t}`,o=r.cssText?Ya(r):Qa(r,s);return document.createTextNode(`${a}{${o}}`)}function cn(e,t,r,s){const a=window.getComputedStyle(e,r),o=a.getPropertyValue("content");if(o===""||o==="none")return;const i=Ga();try{t.className=`${t.className} ${i}`}catch{return}const l=document.createElement("style");l.appendChild(Xa(i,r,a,s)),t.appendChild(l)}function Za(e,t,r){cn(e,t,":before",r),cn(e,t,":after",r)}const dn="application/font-woff",un="image/jpeg",eo={woff:dn,woff2:dn,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:un,jpeg:un,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function to(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function Vt(e){const t=to(e).toLowerCase();return eo[t]||""}function no(e){return e.split(/,/)[1]}function St(e){return e.search(/^(data:)/)!==-1}function ro(e,t){return`data:${t};base64,${e}`}async function hr(e,t,r){const s=await fetch(e,t);if(s.status===404)throw new Error(`Resource "${s.url}" not found`);const a=await s.blob();return new Promise((o,i)=>{const l=new FileReader;l.onerror=i,l.onloadend=()=>{try{o(r({res:s,result:l.result}))}catch(d){i(d)}},l.readAsDataURL(a)})}const gt={};function so(e,t,r){let s=e.replace(/\?.*/,"");return r&&(s=e),/ttf|otf|eot|woff2?/i.test(s)&&(s=s.replace(/.*\//,"")),t?`[${t}]${s}`:s}async function Gt(e,t,r){const s=so(e,t,r.includeQueryParams);if(gt[s]!=null)return gt[s];r.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let a;try{const o=await hr(e,r.fetchRequestInit,({res:i,result:l})=>(t||(t=i.headers.get("Content-Type")||""),no(l)));a=ro(o,t)}catch(o){a=r.imagePlaceholder||"";let i=`Failed to fetch resource: ${e}`;o&&(i=typeof o=="string"?o:o.message),i&&console.warn(i)}return gt[s]=a,a}async function ao(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):Qe(t)}async function oo(e,t){if(e.currentSrc){const o=document.createElement("canvas"),i=o.getContext("2d");o.width=e.clientWidth,o.height=e.clientHeight,i?.drawImage(e,0,0,o.width,o.height);const l=o.toDataURL();return Qe(l)}const r=e.poster,s=Vt(r),a=await Gt(r,s,t);return Qe(a)}async function io(e,t){var r;try{if(!((r=e?.contentDocument)===null||r===void 0)&&r.body)return await ot(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function lo(e,t){return X(e,HTMLCanvasElement)?ao(e):X(e,HTMLVideoElement)?oo(e,t):X(e,HTMLIFrameElement)?io(e,t):e.cloneNode(xr(e))}const co=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",xr=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function uo(e,t,r){var s,a;if(xr(t))return t;let o=[];return co(e)&&e.assignedNodes?o=pe(e.assignedNodes()):X(e,HTMLIFrameElement)&&(!((s=e.contentDocument)===null||s===void 0)&&s.body)?o=pe(e.contentDocument.body.childNodes):o=pe(((a=e.shadowRoot)!==null&&a!==void 0?a:e).childNodes),o.length===0||X(e,HTMLVideoElement)||await o.reduce((i,l)=>i.then(()=>ot(l,r)).then(d=>{d&&t.appendChild(d)}),Promise.resolve()),t}function mo(e,t,r){const s=t.style;if(!s)return;const a=window.getComputedStyle(e);a.cssText?(s.cssText=a.cssText,s.transformOrigin=a.transformOrigin):fr(r).forEach(o=>{let i=a.getPropertyValue(o);o==="font-size"&&i.endsWith("px")&&(i=`${Math.floor(parseFloat(i.substring(0,i.length-2)))-.1}px`),X(e,HTMLIFrameElement)&&o==="display"&&i==="inline"&&(i="block"),o==="d"&&t.getAttribute("d")&&(i=`path(${t.getAttribute("d")})`),s.setProperty(o,i,a.getPropertyPriority(o))})}function fo(e,t){X(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),X(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function po(e,t){if(X(e,HTMLSelectElement)){const r=t,s=Array.from(r.children).find(a=>e.value===a.getAttribute("value"));s&&s.setAttribute("selected","")}}function ho(e,t,r){return X(t,Element)&&(mo(e,t,r),Za(e,t,r),fo(e,t),po(e,t)),t}async function xo(e,t){const r=e.querySelectorAll?e.querySelectorAll("use"):[];if(r.length===0)return e;const s={};for(let o=0;o<r.length;o++){const l=r[o].getAttribute("xlink:href");if(l){const d=e.querySelector(l),x=document.querySelector(l);!d&&x&&!s[l]&&(s[l]=await ot(x,t,!0))}}const a=Object.values(s);if(a.length){const o="http://www.w3.org/1999/xhtml",i=document.createElementNS(o,"svg");i.setAttribute("xmlns",o),i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.style.display="none";const l=document.createElementNS(o,"defs");i.appendChild(l);for(let d=0;d<a.length;d++)l.appendChild(a[d]);e.appendChild(i)}return e}async function ot(e,t,r){return!r&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(s=>lo(s,t)).then(s=>uo(e,s,t)).then(s=>ho(e,s,t)).then(s=>xo(s,t))}const gr=/url\((['"]?)([^'"]+?)\1\)/g,go=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,bo=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function yo(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function vo(e){const t=[];return e.replace(gr,(r,s,a)=>(t.push(a),r)),t.filter(r=>!St(r))}async function wo(e,t,r,s,a){try{const o=r?Va(t,r):t,i=Vt(t);let l;return a||(l=await Gt(o,i,s)),e.replace(yo(t),`$1${l}$3`)}catch{}return e}function jo(e,{preferredFontFormat:t}){return t?e.replace(bo,r=>{for(;;){const[s,,a]=go.exec(r)||[];if(!a)return"";if(a===t)return`src: ${s};`}}):e}function br(e){return e.search(gr)!==-1}async function yr(e,t,r){if(!br(e))return e;const s=jo(e,r);return vo(s).reduce((o,i)=>o.then(l=>wo(l,i,t,r)),Promise.resolve(s))}async function je(e,t,r){var s;const a=(s=t.style)===null||s===void 0?void 0:s.getPropertyValue(e);if(a){const o=await yr(a,null,r);return t.style.setProperty(e,o,t.style.getPropertyPriority(e)),!0}return!1}async function No(e,t){await je("background",e,t)||await je("background-image",e,t),await je("mask",e,t)||await je("-webkit-mask",e,t)||await je("mask-image",e,t)||await je("-webkit-mask-image",e,t)}async function So(e,t){const r=X(e,HTMLImageElement);if(!(r&&!St(e.src))&&!(X(e,SVGImageElement)&&!St(e.href.baseVal)))return;const s=r?e.src:e.href.baseVal,a=await Gt(s,Vt(s),t);await new Promise((o,i)=>{e.onload=o,e.onerror=t.onImageErrorHandler?(...d)=>{try{o(t.onImageErrorHandler(...d))}catch(x){i(x)}}:i;const l=e;l.decode&&(l.decode=o),l.loading==="lazy"&&(l.loading="eager"),r?(e.srcset="",e.src=a):e.href.baseVal=a})}async function ko(e,t){const s=pe(e.childNodes).map(a=>vr(a,t));await Promise.all(s).then(()=>e)}async function vr(e,t){X(e,Element)&&(await No(e,t),await So(e,t),await ko(e,t))}function Co(e,t){const{style:r}=e;t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=`${t.width}px`),t.height&&(r.height=`${t.height}px`);const s=t.style;return s!=null&&Object.keys(s).forEach(a=>{r[a]=s[a]}),e}const mn={};async function fn(e){let t=mn[e];if(t!=null)return t;const s=await(await fetch(e)).text();return t={url:e,cssText:s},mn[e]=t,t}async function pn(e,t){let r=e.cssText;const s=/url\(["']?([^"')]+)["']?\)/g,o=(r.match(/url\([^)]+\)/g)||[]).map(async i=>{let l=i.replace(s,"$1");return l.startsWith("https://")||(l=new URL(l,e.url).href),hr(l,t.fetchRequestInit,({result:d})=>(r=r.replace(i,`url(${d})`),[i,d]))});return Promise.all(o).then(()=>r)}function hn(e){if(e==null)return[];const t=[],r=/(\/\*[\s\S]*?\*\/)/gi;let s=e.replace(r,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=a.exec(s);if(d===null)break;t.push(d[0])}s=s.replace(a,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",l=new RegExp(i,"gi");for(;;){let d=o.exec(s);if(d===null){if(d=l.exec(s),d===null)break;o.lastIndex=l.lastIndex}else l.lastIndex=o.lastIndex;t.push(d[0])}return t}async function Eo(e,t){const r=[],s=[];return e.forEach(a=>{if("cssRules"in a)try{pe(a.cssRules||[]).forEach((o,i)=>{if(o.type===CSSRule.IMPORT_RULE){let l=i+1;const d=o.href,x=fn(d).then(h=>pn(h,t)).then(h=>hn(h).forEach(b=>{try{a.insertRule(b,b.startsWith("@import")?l+=1:a.cssRules.length)}catch(g){console.error("Error inserting rule from remote css",{rule:b,error:g})}})).catch(h=>{console.error("Error loading remote css",h.toString())});s.push(x)}})}catch(o){const i=e.find(l=>l.href==null)||document.styleSheets[0];a.href!=null&&s.push(fn(a.href).then(l=>pn(l,t)).then(l=>hn(l).forEach(d=>{i.insertRule(d,i.cssRules.length)})).catch(l=>{console.error("Error loading remote stylesheet",l)})),console.error("Error inlining remote css file",o)}}),Promise.all(s).then(()=>(e.forEach(a=>{if("cssRules"in a)try{pe(a.cssRules||[]).forEach(o=>{r.push(o)})}catch(o){console.error(`Error while reading CSS rules from ${a.href}`,o)}}),r))}function Po(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>br(t.style.getPropertyValue("src")))}async function Ro(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=pe(e.ownerDocument.styleSheets),s=await Eo(r,t);return Po(s)}function wr(e){return e.trim().replace(/["']/g,"")}function Io(e){const t=new Set;function r(s){(s.style.fontFamily||getComputedStyle(s).fontFamily).split(",").forEach(o=>{t.add(wr(o))}),Array.from(s.children).forEach(o=>{o instanceof HTMLElement&&r(o)})}return r(e),t}async function zo(e,t){const r=await Ro(e,t),s=Io(e);return(await Promise.all(r.filter(o=>s.has(wr(o.style.fontFamily))).map(o=>{const i=o.parentStyleSheet?o.parentStyleSheet.href:null;return yr(o.cssText,i,t)}))).join(`
`)}async function To(e,t){const r=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await zo(e,t);if(r){const s=document.createElement("style"),a=document.createTextNode(r);s.appendChild(a),e.firstChild?e.insertBefore(s,e.firstChild):e.appendChild(s)}}async function Ao(e,t={}){const{width:r,height:s}=pr(e,t),a=await ot(e,t,!0);return await To(a,t),await vr(a,t),Co(a,t),await Ja(a,r,s)}async function Mo(e,t={}){const{width:r,height:s}=pr(e,t),a=await Ao(e,t),o=await Qe(a),i=document.createElement("canvas"),l=i.getContext("2d"),d=t.pixelRatio||Ka(),x=t.canvasWidth||r,h=t.canvasHeight||s;return i.width=x*d,i.height=h*d,t.skipAutoScale||Ua(i),i.style.width=`${x}`,i.style.height=`${h}`,t.backgroundColor&&(l.fillStyle=t.backgroundColor,l.fillRect(0,0,i.width,i.height)),l.drawImage(o,0,0,i.width,i.height),i}async function Do(e,t={}){return(await Mo(e,t)).toDataURL()}const bt={title:"Untitled Comparison",columns:["Concept A","Concept B"],rows:[{feature:"Feature 1",values:["",""],isKey:!1},{feature:"Feature 2",values:["",""],isKey:!1},{feature:"Feature 3",values:["",""],isKey:!1}]};function xn(e){const t=`| Feature | ${e.columns.join(" | ")} |`,r=`|${"----|".repeat(e.columns.length+1)}`,s=e.rows.map(a=>`| ${a.isKey?`**${a.feature}**`:a.feature} | ${a.values.join(" | ")} |`);return[t,r,...s].join(`
`)}function $o({className:e}){const[t,r]=c.useState(()=>({...bt,columns:[...bt.columns],rows:bt.rows.map(u=>({...u,values:[...u.values]}))})),s=c.useRef(null),{toast:a}=et(),o=c.useCallback(u=>{r(p=>({...p,title:u}))},[]),i=c.useCallback((u,p)=>{r(v=>{const N=[...v.columns];return N[u]=p,{...v,columns:N}})},[]),l=c.useCallback((u,p)=>{r(v=>{const N=v.rows.map((D,A)=>A===u?{...D,feature:p}:D);return{...v,rows:N}})},[]),d=c.useCallback((u,p,v)=>{r(N=>{const D=N.rows.map((A,R)=>{if(R!==u)return A;const k=[...A.values];return k[p]=v,{...A,values:k}});return{...N,rows:D}})},[]),x=c.useCallback(u=>{r(p=>{const v=p.rows.map((N,D)=>D===u?{...N,isKey:!N.isKey}:N);return{...p,rows:v}})},[]),h=c.useCallback(()=>{r(u=>{if(u.columns.length>=4)return u;const p=[...u.columns,`Concept ${u.columns.length+1}`],v=u.rows.map(N=>({...N,values:[...N.values,""]}));return{...u,columns:p,rows:v}})},[]),b=c.useCallback(u=>{r(p=>{if(p.columns.length<=2)return p;const v=p.columns.filter((D,A)=>A!==u),N=p.rows.map(D=>({...D,values:D.values.filter((A,R)=>R!==u)}));return{...p,columns:v,rows:N}})},[]),g=c.useCallback(()=>{r(u=>({...u,rows:[...u.rows,{feature:`Feature ${u.rows.length+1}`,values:u.columns.map(()=>""),isKey:!1}]}))},[]),y=c.useCallback(u=>{r(p=>p.rows.length<=1?p:{...p,rows:p.rows.filter((v,N)=>N!==u)})},[]),w=c.useCallback(()=>{const u=xn(t);navigator.clipboard.writeText(u),a({title:"Markdown copied to clipboard"})},[t,a]),P=c.useCallback(async()=>{if(s.current)try{const u=await Do(s.current,{backgroundColor:"#000",quality:1}),p=document.createElement("a");p.download=`${t.title.replace(/[/\\?%*:|"<>]/g,"-")}.png`,p.href=u,p.click(),a({title:"PNG exported"})}catch(u){a({title:"Export failed",description:String(u),variant:"destructive"})}},[t.title,a]),f=c.useCallback(async()=>{const u=xn(t),p=t.title.replace(/[/\\?%*:|"<>]/g,"-"),v=`---
type: comparison-table
created: ${new Date().toISOString()}
---

# ${t.title}

${u}
`,N=`Comparison Tables/${p}.md`;try{await G.obsidian.saveFile(N,v),a({title:"Saved to vault",description:N})}catch(D){a({title:"Save failed",description:String(D),variant:"destructive"})}},[t,a]);return n.jsxs("div",{className:ue("flex flex-col h-full",e),children:[n.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 border-b border-secondary/30 bg-black/40 shrink-0 flex-wrap",children:[n.jsxs(q,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:h,disabled:t.columns.length>=4,title:"Add column",children:[n.jsx(ss,{className:"w-3 h-3"}),n.jsx(Ut,{className:"w-2 h-2"})]}),n.jsxs(q,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:g,title:"Add row",children:[n.jsx(ws,{className:"w-3 h-3"}),n.jsx(Ut,{className:"w-2 h-2"})]}),n.jsx("div",{className:"w-px h-4 bg-secondary/30"}),n.jsx(q,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:w,title:"Copy markdown",children:n.jsx(os,{className:"w-3 h-3"})}),n.jsx(q,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:P,title:"Export PNG",children:n.jsx($t,{className:"w-3 h-3"})}),n.jsx(q,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:f,title:"Save to vault",children:n.jsx(Tt,{className:"w-3 h-3"})}),n.jsxs("span",{className:"ml-auto text-[9px] font-terminal text-muted-foreground",children:[t.columns.length,"C / ",t.rows.length,"R"]})]}),n.jsx("div",{className:"px-2 py-1 border-b border-secondary/20",children:n.jsx(ke,{value:t.title,onChange:u=>o(u.target.value),className:"h-6 text-xs font-arcade bg-transparent border-none px-1 text-primary focus-visible:ring-0",placeholder:"Table title..."})}),n.jsx("div",{className:"flex-1 overflow-auto p-2",children:n.jsxs("div",{ref:s,className:"bg-black/80 border-2 border-primary/50",children:[n.jsxs("div",{className:"flex border-b-2 border-primary/50",children:[n.jsx("div",{className:"w-28 shrink-0 p-1 border-r border-secondary/30 bg-black/60",children:n.jsx("span",{className:"font-arcade text-[9px] text-muted-foreground",children:"FEATURE"})}),t.columns.map((u,p)=>n.jsxs("div",{className:"flex-1 min-w-[100px] p-1 border-r border-secondary/30 bg-black/60 flex items-center gap-1",children:[n.jsx(ke,{value:u,onChange:v=>i(p,v.target.value),className:"h-5 text-[10px] font-arcade bg-transparent border-none px-0 text-primary focus-visible:ring-0 flex-1"}),t.columns.length>2&&n.jsx("button",{onClick:()=>b(p),className:"text-muted-foreground hover:text-destructive shrink-0",children:n.jsx(Be,{className:"w-2.5 h-2.5"})})]},p))]}),t.rows.map((u,p)=>n.jsxs("div",{className:ue("flex border-b border-secondary/20",u.isKey&&"border-l-2 border-l-primary"),children:[n.jsxs("div",{className:"w-28 shrink-0 p-1 border-r border-secondary/30 flex items-center gap-1",children:[n.jsx("button",{onClick:()=>x(p),className:ue("shrink-0",u.isKey?"text-primary":"text-muted-foreground/40 hover:text-muted-foreground"),title:"Toggle key feature",children:n.jsx(Ar,{className:"w-2.5 h-2.5",fill:u.isKey?"currentColor":"none"})}),n.jsx(ke,{value:u.feature,onChange:v=>l(p,v.target.value),className:ue("h-5 text-[10px] font-terminal bg-transparent border-none px-0 focus-visible:ring-0 flex-1",u.isKey?"text-primary font-bold":"text-secondary-foreground")}),t.rows.length>1&&n.jsx("button",{onClick:()=>y(p),className:"text-muted-foreground hover:text-destructive shrink-0",children:n.jsx(Be,{className:"w-2.5 h-2.5"})})]}),u.values.map((v,N)=>n.jsx("div",{className:"flex-1 min-w-[100px] p-1 border-r border-secondary/30",children:n.jsx(ke,{value:v,onChange:D=>d(p,N,D.target.value),className:"h-5 text-[10px] font-terminal bg-transparent border-none px-0 text-secondary-foreground focus-visible:ring-0",placeholder:"..."})},N))]},p))]})})]})}function Lo({totalCards:e,compact:t}){const[r,s]=c.useState(new Set),[a,o]=c.useState(null),[i,l]=c.useState({front:"",back:"",deckName:""}),d=Ze(),{toast:x}=et(),{data:h,isLoading:b,refetch:g}=Y({queryKey:["anki","status"],queryFn:G.anki.getStatus,refetchInterval:3e4}),{data:y}=Y({queryKey:["anki","due"],queryFn:G.anki.getDue,enabled:h?.connected===!0}),{data:w=[],refetch:P}=Y({queryKey:["anki","drafts"],queryFn:G.anki.getDrafts}),f=w.filter(k=>k.status==="pending"),u=me({mutationFn:G.anki.sync,onSuccess:k=>{d.invalidateQueries({queryKey:["anki"]}),P(),x({title:"Anki sync complete",description:k.output||"Cards synced successfully"})},onError:k=>{x({title:"Anki sync failed",description:k.message,variant:"destructive"})}}),p=me({mutationFn:k=>G.anki.approveDraft(k),onSuccess:()=>P()}),v=me({mutationFn:k=>G.anki.deleteDraft(k),onMutate:async k=>{await d.cancelQueries({queryKey:["anki","drafts"]});const H=d.getQueryData(["anki","drafts"]);return d.setQueryData(["anki","drafts"],j=>j?j.filter(C=>C.id!==k):[]),{prev:H}},onError:(k,H,j)=>{j?.prev&&d.setQueryData(["anki","drafts"],j.prev)},onSettled:()=>P()}),N=me({mutationFn:({id:k,data:H})=>G.anki.updateDraft(k,H),onSuccess:()=>{P(),o(null)}}),D=k=>{o(k.id),l({front:k.front,back:k.back,deckName:k.deckName})},A=()=>{a!==null&&N.mutate({id:a,data:i})},R=n.jsx("div",{className:t?"p-3 space-y-3":"p-4 space-y-3",children:b?n.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):h?.connected?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex flex-wrap items-center gap-4 font-terminal text-xs",children:[n.jsx(Ue,{variant:"outline",className:"bg-green-500/20 text-green-400 border-green-500",children:"Connected"}),n.jsxs("span",{className:"text-muted-foreground",children:["Cards: ",n.jsx("span",{className:"text-primary font-arcade",children:e})]}),n.jsxs("span",{className:"text-muted-foreground",children:["Due: ",n.jsx("span",{className:"text-secondary font-arcade",children:y?.dueCount||0})]}),n.jsxs("span",{className:"text-muted-foreground",children:["Reviewed: ",n.jsx("span",{className:"font-arcade",children:h.reviewedToday||0})]}),n.jsxs("span",{className:"text-muted-foreground",children:["Decks: ",n.jsx("span",{className:"font-arcade",children:h.decks?.length||0})]})]}),n.jsxs("div",{className:"pt-2 flex gap-2",children:[n.jsxs(q,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>g(),children:[n.jsx(ze,{className:"w-3 h-3 mr-1"}),"Refresh"]}),n.jsxs(q,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>u.mutate(),disabled:u.isPending,children:[u.isPending?n.jsx(Dt,{className:"w-3 h-3 mr-1 animate-spin"}):n.jsx(ze,{className:"w-3 h-3 mr-1"}),u.isPending?"Syncing...":"Sync Cards"]})]}),u.isError&&n.jsxs("div",{className:"p-2 bg-red-500/10 border border-red-500/30 text-red-400 font-terminal text-[10px]",children:[n.jsx("span",{className:"font-arcade",children:"SYNC ERROR:"})," ",u.error?.message||"Unknown error",n.jsx(q,{size:"sm",variant:"outline",className:"ml-2 h-5 px-2 text-[10px] font-terminal border-red-500/50 text-red-400",onClick:()=>u.mutate(),disabled:u.isPending,children:"Retry"})]}),f.length>0&&n.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsxs("span",{className:"font-arcade text-[10px] text-yellow-400",children:["PENDING CARDS (",f.length,")"]}),n.jsx("div",{className:"flex gap-1",children:n.jsx(q,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{r.size===f.length?s(new Set):s(new Set(f.map(k=>k.id)))},children:r.size===f.length?"None":"All"})})]}),r.size>0&&n.jsxs("div",{className:"flex gap-1 mb-2",children:[n.jsxs(q,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-green-600 hover:bg-green-700",onClick:()=>{r.forEach(k=>p.mutate(k)),s(new Set)},children:[n.jsx(lt,{className:"w-3 h-3 mr-1"}),"Approve (",r.size,")"]}),n.jsxs(q,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{r.forEach(k=>v.mutate(k)),s(new Set)},children:[n.jsx(Be,{className:"w-3 h-3 mr-1"}),"Delete (",r.size,")"]})]}),n.jsx(Oe,{className:"h-[140px]",children:n.jsx("div",{className:"space-y-2",children:f.map(k=>n.jsx("div",{className:`p-2 bg-black/40 border text-xs ${r.has(k.id)?"border-primary":"border-secondary/30"}`,children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(kn,{checked:r.has(k.id),onCheckedChange:H=>{const j=new Set(r);H?j.add(k.id):j.delete(k.id),s(j)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),n.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[n.jsx("div",{className:"font-terminal text-primary truncate",children:k.front}),n.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:k.back}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx(Ue,{variant:"outline",className:"text-[9px] border-blue-500/50 text-blue-400 shrink-0",children:k.deckName}),n.jsx(q,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>D(k),title:"Edit card",children:n.jsx(Ke,{className:"w-3 h-3"})}),n.jsx(q,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-green-500/50 text-green-400 hover:bg-green-500/20",onClick:()=>p.mutate(k.id),title:"Approve card",children:n.jsx(lt,{className:"w-3 h-3"})}),n.jsx(q,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>v.mutate(k.id),title:"Delete card",children:n.jsx(Be,{className:"w-3 h-3"})})]})]})]})},k.id))})})]})]}):n.jsxs("div",{className:"text-center space-y-2",children:[n.jsx("p",{className:"font-terminal text-xs text-red-400",children:h?.error||"Anki not connected"}),n.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),n.jsxs(q,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>g(),children:[n.jsx(ze,{className:"w-3 h-3 mr-1"}),"Retry"]})]})});return n.jsxs(n.Fragment,{children:[t?R:n.jsxs(Ce,{className:"bg-black/40 border-2 border-primary rounded-none",children:[n.jsx(Ee,{className:"border-b border-primary/50 p-4",children:n.jsxs(Pe,{className:"font-arcade text-sm flex items-center gap-3",children:[n.jsx(_e,{className:"w-4 h-4"}),"ANKI INTEGRATION",h?.connected?n.jsx(lt,{className:"w-3 h-3 text-green-500 ml-auto"}):n.jsx(vt,{className:"w-3 h-3 text-red-500 ml-auto"})]})}),n.jsx(Re,{className:"p-0",children:R})]}),n.jsx(Et,{open:a!==null,onOpenChange:k=>{k||o(null)},children:n.jsxs(Pt,{"data-modal":"brain-edit-draft",className:"bg-black border-2 border-primary rounded-none max-w-lg translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[n.jsxs(Rt,{children:[n.jsxs(It,{className:"font-arcade text-primary flex items-center gap-2",children:[n.jsx(Ke,{className:"w-5 h-5"}),"EDIT CARD"]}),n.jsx(zt,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),n.jsxs("div",{className:"space-y-4 font-terminal",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),n.jsx(Kt,{value:i.front,onChange:k=>l(H=>({...H,front:k.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),n.jsx(Kt,{value:i.back,onChange:k=>l(H=>({...H,back:k.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),n.jsxs(_r,{value:i.deckName,onValueChange:k=>l(H=>({...H,deckName:k})),children:[n.jsx(Fr,{className:"rounded-none border-secondary",children:n.jsx(Hr,{placeholder:"Select deck"})}),n.jsxs(Vr,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[n.jsx(he,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),n.jsx(he,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),n.jsx(he,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),n.jsx(he,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),n.jsx(he,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),n.jsx(he,{value:"PT::General",children:"PT::General"}),h?.decks?.filter(k=>!k.startsWith("PT::")).map(k=>n.jsx(he,{value:k,children:k},k))]})]}),n.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",n.jsx("span",{className:"text-blue-400",children:i.deckName})]})]})]}),n.jsxs(Rr,{className:"gap-2",children:[n.jsxs(q,{variant:"outline",onClick:()=>o(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[n.jsx(vt,{className:"w-4 h-4 mr-2"}),"Cancel"]}),n.jsxs(q,{onClick:A,disabled:N.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[n.jsx(Tt,{className:"w-4 h-4 mr-2"}),N.isPending?"Saving...":"Save"]})]})]})})]})}const yt=[{id:"edit",label:"EDIT",icon:Ke},{id:"chat",label:"CHAT",icon:Nn},{id:"graph",label:"GRAPH",icon:ys},{id:"table",label:"TABLE",icon:Ns},{id:"anki",label:"ANKI",icon:_e}];function gn({workspace:e}){const[t,r]=c.useState({}),s=c.useCallback(o=>{r(i=>({...i,[o]:(i[o]||0)+1}))},[]);c.useEffect(()=>{const o=i=>{if(!i.altKey||i.ctrlKey||i.metaKey)return;const l=parseInt(i.key,10)-1;l>=0&&l<yt.length&&(i.preventDefault(),e.setMainMode(yt[l].id))};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[e]);const a=e.mainMode;return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex items-center gap-0 border-b border-primary/40 bg-black/40 shrink-0",children:yt.map(o=>{const i=o.icon,l=a===o.id;return n.jsxs("button",{onClick:()=>e.setMainMode(o.id),className:`flex items-center gap-1.5 px-3 py-1.5 font-arcade text-xs transition-colors ${l?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,"aria-pressed":l,children:[n.jsx(i,{className:"w-3.5 h-3.5","aria-hidden":"true"}),o.label,o.id==="anki"&&e.pendingDrafts.length>0&&n.jsx("span",{className:"ml-1 px-1 py-0 text-xs bg-secondary text-black font-arcade",children:e.pendingDrafts.length})]},o.id)})}),n.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden flex flex-col",children:[a==="edit"&&n.jsx(Se,{fallback:n.jsx(De,{tabName:"EDIT",onReset:()=>s("edit")}),children:n.jsx(Da,{workspace:e})},`edit-${t.edit||0}`),a==="chat"&&n.jsx(Se,{fallback:n.jsx(De,{tabName:"CHAT",onReset:()=>s("chat")}),children:n.jsx(Aa,{})},`chat-${t.chat||0}`),a==="graph"&&n.jsx(Se,{fallback:n.jsx(De,{tabName:"GRAPH",onReset:()=>s("graph")}),children:n.jsx(Ha,{})},`graph-${t.graph||0}`),a==="table"&&n.jsx(Se,{fallback:n.jsx(De,{tabName:"TABLE",onReset:()=>s("table")}),children:n.jsx($o,{})},`table-${t.table||0}`),a==="anki"&&n.jsx(Se,{fallback:n.jsx(De,{tabName:"ANKI",onReset:()=>s("anki")}),children:n.jsx(Lo,{totalCards:e.metrics?.totalCards||0,compact:!0})},`anki-${t.anki||0}`)]})]})}function Oo(){const[e,t]=c.useState(""),[r,s]=c.useState(null),[a,o]=c.useState("auto"),[i,l]=c.useState([]),d=Ze(),{toast:x}=et(),{data:h=[]}=Y({queryKey:["sessions"],queryFn:G.sessions.getAll}),g=h.map(f=>({id:f.id,date:f.date,topic:f.topic,mainTopic:f.mainTopic,mode:f.mode,createdAt:f.createdAt})).slice().sort((f,u)=>{const p=f.date||f.createdAt||"";return(u.date||u.createdAt||"").localeCompare(p)}).slice(0,20),y=me({mutationFn:()=>G.planner.generate(),onSuccess:f=>{x({title:"Planner tasks generated",description:`${f.tasks_created} review tasks created`}),d.invalidateQueries({queryKey:["planner","queue"]})},onError:f=>{x({title:"Failed to generate tasks",description:f.message,variant:"destructive"})}}),w=me({mutationFn:async()=>{if(!r)throw new Error("Select a session first");let f;try{f=JSON.parse(e)}catch{throw new Error("Invalid JSON  check syntax")}let u=a;if(u==="auto"){const N=Object.keys(f),D=["source_lock","plan_of_attack","frameworks_used","buckets","confusables_interleaved","anki_cards","glossary","exit_ticket_blurt","exit_ticket_muddiest","exit_ticket_next_action","retrospective_status","spaced_reviews","next_session","errors_by_type","errors_by_severity","error_patterns","spacing_algorithm","rsr_adaptive_adjustment","adaptive_multipliers"];u=N.some(A=>D.includes(A))?"enhanced":"tracker"}const p=u==="tracker"?f:void 0,v=u==="enhanced"?f:void 0;return G.brain.ingestSessionJson(r,p,v)},onSuccess:f=>{x({title:"JSON ingested",description:`${f.fields_updated} fields updated on session #${f.session_id}`}),d.invalidateQueries({queryKey:["sessions"]}),d.invalidateQueries({queryKey:["brain","metrics"]}),x({title:"Next step: Generate planner tasks?",description:"Create review tasks from weak anchors",duration:1e4,action:n.jsx(q,{size:"sm",onClick:()=>y.mutate(),disabled:y.isPending,className:"bg-primary text-black hover:bg-primary/80",children:y.isPending?"Generating...":"Generate Now"})}),t(""),l([])},onError:f=>{x({title:"Ingestion failed",description:f.message,variant:"destructive"})}});function P(){const f=[];if(r||f.push("Select a session"),!e.trim())f.push("Paste JSON first");else try{const u=JSON.parse(e);(typeof u!="object"||Array.isArray(u))&&f.push("JSON must be an object, not array"),u.schema_version&&u.schema_version!=="9.4"&&f.push(`Expected schema_version 9.4, got ${u.schema_version}`)}catch{f.push("Invalid JSON syntax")}return l(f),f.length===0}return n.jsxs(Ce,{className:"bg-black/40 border-2 border-primary rounded-none",children:[n.jsx(Ee,{className:"border-b border-primary/50 p-4",children:n.jsxs(Pe,{className:"font-arcade text-sm flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 bg-primary inline-block"}),"SESSION_JSON_INGEST"]})}),n.jsxs(Re,{className:"p-4 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"TARGET SESSION"}),n.jsxs("select",{value:r??"",onChange:f=>s(f.target.value?Number(f.target.value):null),className:"w-full bg-black border border-primary/50 text-white font-terminal text-xs p-2 rounded-none focus:border-primary outline-none",children:[n.jsx("option",{value:"",children:"-- select session --"}),g.map(f=>n.jsxs("option",{value:f.id,children:["#",f.id," | ",f.date?.slice(0,10)||"?"," | ",f.topic||f.mainTopic||"Untitled"," | ",f.mode||"?"]},f.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"JSON TYPE"}),n.jsx("div",{className:"flex gap-2",children:["auto","tracker","enhanced"].map(f=>n.jsx("button",{onClick:()=>o(f),className:`px-3 py-1 font-arcade text-xs rounded-none border ${a===f?"bg-primary text-black border-primary":"border-primary/30 text-muted-foreground hover:text-white"}`,children:f.toUpperCase()},f))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"PASTE TRACKER OR ENHANCED JSON"}),n.jsx("textarea",{value:e,onChange:f=>t(f.target.value),placeholder:'{"schema_version": "9.4", "topic": "...", "mode": "Core", ...}',rows:10,className:"w-full bg-black border border-primary/50 text-green-400 font-terminal text-xs p-2 rounded-none focus:border-primary outline-none resize-y"})]}),i.length>0&&n.jsx("div",{className:"border border-red-500/50 bg-red-500/10 p-2 font-terminal text-xs text-red-400 space-y-1",children:i.map((f,u)=>n.jsxs("div",{children:["- ",f]},u))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>{P()&&w.mutate()},disabled:w.isPending,className:"px-4 py-2 bg-primary text-black font-arcade text-xs rounded-none hover:bg-primary/80 disabled:opacity-50",children:w.isPending?"INGESTING...":"INGEST"}),n.jsx("button",{onClick:P,className:"px-4 py-2 border border-primary/50 text-primary font-arcade text-xs rounded-none hover:bg-primary/10",children:"VALIDATE"}),n.jsx("button",{onClick:()=>{t(""),l([])},className:"px-4 py-2 border border-primary/30 text-muted-foreground font-arcade text-xs rounded-none hover:text-white",children:"CLEAR"})]})]})]})}const _o=`You are extracting a course schedule for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "name": "Course Name (e.g. Anatomy & Physiology II)",
  "term": {
    "startDate": "2026-01-05",
    "endDate": "2026-04-24",
    "timezone": "America/Chicago"
  },
  "events": [
    {
      "type": "class" | "lecture" | "reading" | "topic" | "assignment" | "quiz" | "exam" | "assessment",
      "title": "string",
      "date": "YYYY-MM-DD",
      "dueDate": "YYYY-MM-DD | null",
      "startTime": "HH:MM | null",
      "endTime": "HH:MM | null",
      "daysOfWeek": ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
      "delivery": "in_person" | "virtual_sync" | "virtual_async" | "hybrid",
      "assessmentType": "EA | null",
      "moduleName": "Module 1: ... | null",
      "notes": "string | null"
    }
  ]
}

Rules:
1. Include ALL schedule items: class meetings, assignments, quizzes, exams, readings, virtual activities, and learning assessments (EA).
2. For repeating class meetings, set daysOfWeek + startTime/endTime, and include term start/end.
3. For one-off items, set date or dueDate.
4. Do NOT include a "modules" array  schedule only.
5. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,Fo=`You are extracting course module structure for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "modules": [
    {
      "name": "Module 1: Topic Name",
      "orderIndex": 1,
      "topics": ["Topic A", "Topic B"],
      "readings": ["Chapter 1", "Article X"],
      "assessments": ["Quiz 1", "Exam 1"]
    }
  ]
}

Rules:
1. Include ALL modules/units with their topics, readings, and assessments.
2. orderIndex should be sequential starting at 1.
3. Do NOT include dates or events  structure only.
4. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,Ho=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,Vo=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function Go(){const e=Ze(),[t,r]=c.useState(null),[s,a]=c.useState(null),[o,i]=c.useState("schedule"),[l,d]=c.useState(""),[x,h]=c.useState(""),[b,g]=c.useState(""),[y,w]=c.useState(""),[P,f]=c.useState(null),[u,p]=c.useState(null),[v,N]=c.useState(null),[D,A]=c.useState(null),[R,k]=c.useState(null),[H,j]=c.useState(null),{data:C=[]}=Y({queryKey:["courses"],queryFn:()=>G.courses.getActive()}),{data:T=[]}=Y({queryKey:["modules",t],queryFn:()=>t?G.modules.getByCourse(t):Promise.resolve([]),enabled:!!t}),{data:_=[]}=Y({queryKey:["learningObjectives",t],queryFn:()=>t?G.learningObjectives.getByCourse(t):Promise.resolve([]),enabled:!!t}),$=m=>{const S=m.trim();if(!S)return"";const z=S.match(/```json\s*([\s\S]*?)```/i)||S.match(/```\s*([\s\S]*?)```/i),E=z?z[1].trim():S,I=E.indexOf("["),L=E.lastIndexOf("]"),V=E.indexOf("{"),K=E.lastIndexOf("}");return I!==-1&&L!==-1&&L>I&&(V===-1||I<V)?E.slice(I,L+1).trim():V!==-1&&K!==-1&&K>V?E.slice(V,K+1).trim():E},M=m=>{navigator.clipboard.writeText(m)},F=me({mutationFn:async m=>{if(!t)throw new Error("Select a course first");const z={...JSON.parse($(m)),modules:[]};return G.syllabus.importBulk(t,z)},onSuccess:m=>{e.invalidateQueries({queryKey:["scheduleEvents"]}),d(""),k(null),N({type:"success",message:`Imported: ${m.eventsCreated} events (${m.classMeetingsExpanded} class meetings expanded)`}),f(null)},onError:m=>{N({type:"error",message:m.message||"Failed to import schedule"})}}),B=me({mutationFn:async m=>{if(!t)throw new Error("Select a course first");const S=JSON.parse($(m)),z=S.modules||S;return G.modules.createBulk(t,z)},onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]}),h(""),j(null),A({type:"success",message:"Modules imported successfully"}),f(null)},onError:m=>{A({type:"error",message:m.message||"Failed to import modules"})}}),J=me({mutationFn:async m=>{if(!t)throw new Error("Select a course first");const S=JSON.parse($(m));return G.learningObjectives.createBulk(t,s,S)},onSuccess:()=>{e.invalidateQueries({queryKey:["learningObjectives"]}),g(""),f(null)},onError:m=>{f(m.message||"Failed to import LOs")}}),ne=m=>{const S=[];try{const z=$(m);if(!z){k({isValid:!1,errors:["No JSON found"]});return}const E=JSON.parse(z);(!E||typeof E!="object")&&S.push("JSON must be an object"),(!E.name||typeof E.name!="string")&&S.push("Missing 'name' field"),!E.term||typeof E.term!="object"?S.push("Missing 'term' object"):(E.term.startDate||S.push("term.startDate is required"),E.term.endDate||S.push("term.endDate is required")),Array.isArray(E.events)||S.push("Missing 'events' array"),S.length===0?k({isValid:!0,errors:[],preview:{courseName:E.name,eventCount:E.events.length,startDate:E.term?.startDate,endDate:E.term?.endDate}}):k({isValid:!1,errors:S})}catch(z){k({isValid:!1,errors:[`Invalid JSON: ${z.message}`]})}},ce=m=>{const S=[];try{const z=$(m);if(!z){j({isValid:!1,errors:["No JSON found"]});return}const E=JSON.parse(z),I=E.modules||(Array.isArray(E)?E:null);Array.isArray(I)?I.length===0&&S.push("modules array is empty"):S.push("Missing 'modules' array"),S.length===0?j({isValid:!0,errors:[],preview:{moduleCount:I.length}}):j({isValid:!1,errors:S})}catch(z){j({isValid:!1,errors:[`Invalid JSON: ${z.message}`]})}},se=async()=>{try{p(null);const m=await G.brain.chat(y,!1,"wrap");m.sessionSaved?(p({type:"success",message:`Session saved! ID: ${m.sessionId}, Cards: ${m.cardsCreated||0}`}),w("")):p({type:"error",message:m.sessionError||"Failed to process WRAP content"})}catch(m){p({type:"error",message:m.message||"Failed to ingest"})}},re=[{key:"schedule",label:"SCHEDULE",icon:n.jsx(Wt,{className:"w-3.5 h-3.5"})},{key:"modules",label:"MODULES",icon:n.jsx(_e,{className:"w-3.5 h-3.5"})},{key:"objectives",label:"OBJECTIVES",icon:n.jsx(wt,{className:"w-3.5 h-3.5"})}];return n.jsxs("div",{className:"space-y-6 p-4",children:[n.jsx(Oo,{}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),n.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:t||"",onChange:m=>{r(m.target.value?parseInt(m.target.value):null),a(null)},children:[n.jsx("option",{value:"",children:"-- Select Course --"}),C.map(m=>n.jsx("option",{value:m.id,children:m.name},m.id))]})]}),!t&&n.jsx("p",{className:"text-center text-muted-foreground font-terminal text-sm py-8",children:"Select a course above to begin ingestion."}),t&&n.jsxs(Ce,{className:"bg-black/40 border-2 border-primary rounded-none mb-6",children:[n.jsx(Ee,{className:"border-b border-primary/50 p-4",children:n.jsxs(Pe,{className:"font-arcade text-sm flex items-center gap-2",children:[n.jsx(Lr,{className:"w-4 h-4"}),"WRAP SESSION INGESTION"]})}),n.jsxs(Re,{className:"p-4",children:[u&&n.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${u.type==="success"?"bg-green-900/30 border border-green-500 text-green-400":"bg-red-900/30 border border-red-500 text-red-400"}`,children:u.message}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("button",{onClick:()=>M(Vo),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),n.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),n.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:y,onChange:m=>{w(m.target.value),p(null)}})]}),n.jsx("button",{onClick:se,disabled:!y,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]})]}),t&&P&&n.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:P}),t&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"flex border-b border-primary/50",children:re.map(m=>n.jsxs("button",{onClick:()=>i(m.key),className:`flex items-center gap-1.5 px-4 py-2 font-arcade text-xs border-b-2 transition-colors ${o===m.key?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-primary/70"}`,type:"button",children:[m.icon,m.label]},m.key))}),o==="schedule"&&n.jsxs(Ce,{className:"bg-black/40 border-2 border-primary rounded-none",children:[n.jsx(Ee,{className:"border-b border-primary/50 p-4",children:n.jsxs(Pe,{className:"font-arcade text-sm flex items-center gap-2",children:[n.jsx(Wt,{className:"w-4 h-4"}),"SCHEDULE IMPORT"]})}),n.jsxs(Re,{className:"p-4 space-y-4",children:[n.jsx("button",{onClick:()=>M(_o),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),n.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (schedule JSON) below:"}),n.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"name":"...","term":{...},"events":[...]}',value:l,onChange:m=>{d(m.target.value),N(null),m.target.value.trim()?ne(m.target.value):k(null)}}),R&&!R.isValid&&n.jsxs("div",{className:"p-2 border border-red-500 bg-red-900/30 rounded-none font-terminal text-xs text-red-400",children:[n.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),R.errors.map((m,S)=>n.jsxs("div",{children:[" ",m]},S))]}),R?.isValid&&R.preview&&n.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[n.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Course:"})," ",R.preview.courseName]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Events:"})," ",R.preview.eventCount]}),R.preview.startDate&&n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Start:"})," ",R.preview.startDate]}),R.preview.endDate&&n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"End:"})," ",R.preview.endDate]})]})]}),n.jsx("button",{onClick:()=>F.mutate(l),disabled:!R?.isValid||F.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:F.isPending?"Importing...":"Import Schedule"}),v&&n.jsx("div",{className:`p-2 border font-terminal text-xs ${v.type==="success"?"border-green-500 text-green-400":"border-red-500 text-red-400"}`,children:v.message})]})]}),o==="modules"&&n.jsxs(Ce,{className:"bg-black/40 border-2 border-primary rounded-none",children:[n.jsx(Ee,{className:"border-b border-primary/50 p-4",children:n.jsxs(Pe,{className:"font-arcade text-sm flex items-center gap-2",children:[n.jsx(_e,{className:"w-4 h-4"}),"MODULES IMPORT"]})}),n.jsxs(Re,{className:"p-4 space-y-4",children:[n.jsx("button",{onClick:()=>M(Fo),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),n.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (modules JSON) below:"}),n.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"modules":[{"name":"Module 1: ...","orderIndex":1,"topics":[...],"readings":[...],"assessments":[...]}]}',value:x,onChange:m=>{h(m.target.value),A(null),m.target.value.trim()?ce(m.target.value):j(null)}}),H&&!H.isValid&&n.jsxs("div",{className:"p-2 border border-red-500 bg-red-900/30 rounded-none font-terminal text-xs text-red-400",children:[n.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),H.errors.map((m,S)=>n.jsxs("div",{children:[" ",m]},S))]}),H?.isValid&&H.preview&&n.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[n.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Modules:"})," ",H.preview.moduleCount]})]}),n.jsx("button",{onClick:()=>B.mutate(x),disabled:!H?.isValid||B.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:B.isPending?"Importing...":"Import Modules"}),D&&n.jsx("div",{className:`p-2 border font-terminal text-xs ${D.type==="success"?"border-green-500 text-green-400":"border-red-500 text-red-400"}`,children:D.message})]})]}),o==="objectives"&&n.jsxs(Ce,{className:"bg-black/40 border-2 border-primary rounded-none",children:[n.jsx(Ee,{className:"border-b border-primary/50 p-4",children:n.jsxs(Pe,{className:"font-arcade text-sm flex items-center gap-2",children:[n.jsx(wt,{className:"w-4 h-4"}),"LEARNING OBJECTIVES IMPORT"]})}),n.jsxs(Re,{className:"p-4 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),n.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:s||"",onChange:m=>a(m.target.value?parseInt(m.target.value):null),children:[n.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),T.map(m=>n.jsx("option",{value:m.id,children:m.name},m.id))]})]}),n.jsx("button",{onClick:()=>M(Ho),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),n.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),n.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:b,onChange:m=>g(m.target.value)}),n.jsx("button",{onClick:()=>J.mutate(b),disabled:!b||J.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:J.isPending?"Importing...":"Import LOs"}),_.length>0&&n.jsxs("div",{children:[n.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",_.length,")"]}),n.jsx("div",{className:"max-h-48 overflow-y-auto",children:_.map(m=>n.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[n.jsx("span",{className:"text-primary",children:m.loCode}),": ",m.title,n.jsx("span",{className:`ml-2 text-[10px] px-1 rounded-none ${m.status==="solid"?"bg-green-600":m.status==="in_progress"?"bg-yellow-600":m.status==="need_review"?"bg-orange-600":"bg-secondary"}`,children:m.status})]},m.id))})]})]})]})]})]})}function qo({workspace:e}){return n.jsx(Et,{open:e.importOpen,onOpenChange:e.setImportOpen,children:n.jsxs(Pt,{"data-modal":"brain-import",className:"max-w-2xl bg-black border-2 border-primary rounded-none",children:[n.jsxs(Rt,{children:[n.jsxs(It,{className:"font-arcade text-sm text-primary flex items-center gap-2",children:[n.jsx($t,{className:"w-4 h-4"}),"IMPORT / INGEST"]}),n.jsx(zt,{className:"font-terminal text-xs text-muted-foreground",children:"Import study materials, JSON session data, or documents into the system."})]}),n.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:n.jsx(Go,{})})]})})}const Bo=["vault","main"];function bn(){if(typeof window>"u")return"main";const t=new URLSearchParams(window.location.search).get("tab");return Bo.includes(t)?t:"main"}function Ko(e){if(typeof window>"u")return;const t=new URLSearchParams(window.location.search);t.set("tab",e);const r=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},"",r)}function Uo(){const e=na(),[t,r]=c.useState("main");c.useEffect(()=>{r(bn())},[]);const s=c.useCallback(a=>{r(a),Ko(a)},[]);return c.useEffect(()=>{const a=()=>{r(bn())};return window.addEventListener("popstate",a),()=>window.removeEventListener("popstate",a)},[]),n.jsx(Ir,{children:n.jsxs("div",{className:"fixed inset-x-0 top-[68px] bottom-[48px] flex flex-col min-w-0 overflow-hidden z-30",children:[n.jsx(ra,{workspace:e}),n.jsx("div",{className:"hidden lg:flex flex-1 min-h-0",children:n.jsxs(Qs,{direction:"horizontal",autoSaveId:"brain-workspace-v2",className:"h-full",children:[n.jsx(rn,{defaultSize:20,minSize:12,maxSize:35,children:n.jsx("div",{className:"h-full border-r border-primary/30 bg-black/30",children:n.jsx(an,{workspace:e})})}),n.jsx(Xs,{withHandle:!0}),n.jsx(rn,{defaultSize:80,minSize:50,children:n.jsx("div",{className:"h-full",children:n.jsx(gn,{workspace:e})})})]})}),n.jsxs("div",{className:"flex flex-col flex-1 min-h-0 lg:hidden",children:[n.jsxs("div",{className:"flex-1 min-h-0 overflow-auto",children:[t==="vault"&&n.jsx(an,{workspace:e}),t==="main"&&n.jsx(gn,{workspace:e})]}),n.jsxs("nav",{className:"flex items-center border-t-2 border-primary/50 bg-black/80 shrink-0","aria-label":"Mobile navigation",children:[n.jsxs("button",{onClick:()=>s("vault"),className:`flex-1 flex flex-col items-center gap-0.5 py-3 text-xs font-terminal transition-colors ${t==="vault"?"text-primary":"text-muted-foreground"}`,"aria-current":t==="vault"?"page":void 0,"aria-label":"Vault",children:[n.jsx(jn,{className:"w-5 h-5","aria-hidden":"true"}),"Vault"]}),n.jsxs("button",{onClick:()=>s("main"),className:`flex-1 flex flex-col items-center gap-0.5 py-3 text-xs font-terminal transition-colors ${t==="main"?"text-primary":"text-muted-foreground"}`,"aria-current":t==="main"?"page":void 0,"aria-label":"Content",children:[n.jsx(Ke,{className:"w-5 h-5","aria-hidden":"true"}),"Content"]})]})]}),n.jsx(qo,{workspace:e})]})})}const mi=Object.freeze(Object.defineProperty({__proto__:null,default:Uo},Symbol.toStringTag,{value:"Module"}));export{Zr as A,$t as D,gs as M,hs as a,mi as b,Do as t};
