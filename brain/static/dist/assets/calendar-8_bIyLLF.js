import{c as ar,r as u,j as r,b as q,h as _r,e as $,i as gt,u as En,X as Qr,a as or}from"./index-Bj_YF3lV.js";import{y as Vr,B as P,f as Dn,D as mt,c as pt,I as ae,n as pn,o as At,T as xn,z as Wr,A as ir,u as Fe,a as J,g as G,S as vn,L as Xr,j as Jr,d as rn,e as sn}from"./layout-B-mhNZFe.js";import{C as lr,a as cr,b as Zr,d as es,c as ts}from"./card-B--4jsze.js";import{R as zn,B as Fn}from"./badge-D3MYMPg2.js";import{R as ns,b as rs,d as ss,a as as}from"./index-CrdfPkJA.js";import{S as tt,a as nt,b as rt,c as st,d as Q}from"./select-DUho-Crf.js";import{c as at,P as bn,a as Qe,b as os,i as is,C as dr,d as ls}from"./isTomorrow-BeddH3jP.js";import{t as de,c as yn,m as Sn,a as Tn,g as cs,i as ur,f as V,s as an}from"./format-D7m0hUtg.js";import{C as ds}from"./clock-d4DvFfzw.js";import{L as us,a as fs}from"./loader-circle-DT7qlSl2.js";import{S as hs,a as gs}from"./send-Crcu5ps4.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ps=ar("external-link",ms);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],fr=ar("text-align-start",xs);function wn(e,t){const n=de(e);if(isNaN(t))return yn(e,NaN);if(!t)return n;const s=n.getDate(),a=yn(e,n.getTime());a.setMonth(n.getMonth()+t+1,0);const i=a.getDate();return s>=i?a:(n.setFullYear(a.getFullYear(),a.getMonth(),s),n)}function vs(e,t){const n=+de(e);return yn(e,n+t)}function bs(e,t){return vs(e,t*Sn)}function hr(e,t){const n=t*7;return at(e,n)}function ys(e){return t=>{const n=Math.trunc,s=n(t);return s===0?0:s}}function ws(e,t){return+de(e)-+de(t)}function Pn(e,t,n){const s=ws(e,t)/Tn;return ys()(s)}function on(e){const t=de(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function ln(e,t){const n=de(e.start),s=de(e.end);let a=+n>+s;const i=a?+n:+s,l=a?s:n;l.setHours(0,0,0,0);let c=1;const d=[];for(;+l<=i;)d.push(de(l)),l.setDate(l.getDate()+c),l.setHours(0,0,0,0);return a?d.reverse():d}function cn(e){const t=de(e);return t.setDate(1),t.setHours(0,0,0,0),t}function $n(e,t){const n=cs(),s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,a=de(e),i=a.getDay(),l=(i<s?-7:0)+6-(i-s);return a.setDate(a.getDate()+l),a.setHours(23,59,59,999),a}function Un(e,t){const n=de(e),s=de(t);return n.getFullYear()===s.getFullYear()&&n.getMonth()===s.getMonth()}function Ns(e,t){return at(e,-1)}function gr(e,t){const s=Ds(e);let a;if(s.date){const d=Ss(s.date,2);a=Ts(d.restDateString,d.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let l=0,c;if(s.time&&(l=Rs(s.time),isNaN(l)))return new Date(NaN);if(s.timezone){if(c=ks(s.timezone),isNaN(c))return new Date(NaN)}else{const d=new Date(i+l),h=new Date(0);return h.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),h.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),h}return new Date(i+l+c)}const kt={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Cs=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,js=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Es=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ds(e){const t={},n=e.split(kt.dateTimeDelimiter);let s;if(n.length>2)return t;if(/:/.test(n[0])?s=n[0]:(t.date=n[0],s=n[1],kt.timeZoneDelimiter.test(t.date)&&(t.date=e.split(kt.timeZoneDelimiter)[0],s=e.substr(t.date.length,e.length))),s){const a=kt.timezone.exec(s);a?(t.time=s.replace(a[1],""),t.timezone=a[1]):t.time=s}return t}function Ss(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=e.match(n);if(!s)return{year:NaN,restDateString:""};const a=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?a:i*100,restDateString:e.slice((s[1]||s[2]).length)}}function Ts(e,t){if(t===null)return new Date(NaN);const n=e.match(Cs);if(!n)return new Date(NaN);const s=!!n[4],a=ht(n[1]),i=ht(n[2])-1,l=ht(n[3]),c=ht(n[4]),d=ht(n[5])-1;if(s)return Ls(t,c,d)?Ms(t,c,d):new Date(NaN);{const h=new Date(0);return!As(t,i,l)||!Os(t,a)?new Date(NaN):(h.setUTCFullYear(t,i,Math.max(a,l)),h)}}function ht(e){return e?parseInt(e):1}function Rs(e){const t=e.match(js);if(!t)return NaN;const n=dn(t[1]),s=dn(t[2]),a=dn(t[3]);return zs(n,s,a)?n*Sn+s*Tn+a*1e3:NaN}function dn(e){return e&&parseFloat(e.replace(",","."))||0}function ks(e){if(e==="Z")return 0;const t=e.match(Es);if(!t)return 0;const n=t[1]==="+"?-1:1,s=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return Fs(s,a)?n*(s*Sn+a*Tn):NaN}function Ms(e,t,n){const s=new Date(0);s.setUTCFullYear(e,0,4);const a=s.getUTCDay()||7,i=(t-1)*7+n+1-a;return s.setUTCDate(s.getUTCDate()+i),s}const Is=[31,null,31,30,31,30,31,31,30,31,30,31];function mr(e){return e%400===0||e%4===0&&e%100!==0}function As(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(Is[t]||(mr(e)?29:28))}function Os(e,t){return t>=1&&t<=(mr(e)?366:365)}function Ls(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function zs(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function Fs(e,t){return t>=0&&t<=59}function Le(e,t){const n=de(e);return n.setHours(t),n}function ze(e,t){const n=de(e);return n.setMinutes(t),n}function Yn(e,t){return wn(e,-1)}function Ps(e,t){return hr(e,-1)}var $s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Us=$s.reduce((e,t)=>{const n=Vr(`Primitive.${t}`),s=u.forwardRef((a,i)=>{const{asChild:l,...c}=a,d=l?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),r.jsx(d,{...c,ref:i})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),Ys="Label",pr=u.forwardRef((e,t)=>r.jsx(Us.label,{...e,ref:t,onMouseDown:n=>{n.target.closest("button, input, select, textarea")||(e.onMouseDown?.(n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));pr.displayName=Ys;var xr=pr;const Ks=_r("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),H=u.forwardRef(({className:e,...t},n)=>r.jsx(xr,{ref:n,className:q(Ks(),e),...t}));H.displayName=xr.displayName;function qs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return u.useMemo(()=>s=>{t.forEach(a=>a(s))},t)}const Yt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function it(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Rn(e){return"nodeType"in e}function le(e){var t,n;return e?it(e)?e:Rn(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function kn(e){const{Document:t}=le(e);return e instanceof t}function Ct(e){return it(e)?!1:e instanceof le(e).HTMLElement}function vr(e){return e instanceof le(e).SVGElement}function lt(e){return e?it(e)?e.document:Rn(e)?kn(e)?e:Ct(e)||vr(e)?e.ownerDocument:document:document:document}const Ce=Yt?u.useLayoutEffect:u.useEffect;function Kt(e){const t=u.useRef(e);return Ce(()=>{t.current=e}),u.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function Hs(){const e=u.useRef(null),t=u.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),n=u.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function yt(e,t){t===void 0&&(t=[e]);const n=u.useRef(e);return Ce(()=>{n.current!==e&&(n.current=e)},t),n}function jt(e,t){const n=u.useRef();return u.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function Lt(e){const t=Kt(e),n=u.useRef(null),s=u.useCallback(a=>{a!==n.current&&t?.(a,n.current),n.current=a},[]);return[n,s]}function zt(e){const t=u.useRef();return u.useEffect(()=>{t.current=e},[e]),t.current}let un={};function Et(e,t){return u.useMemo(()=>{if(t)return t;const n=un[e]==null?0:un[e]+1;return un[e]=n,e+"-"+n},[e,t])}function br(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((i,l)=>{const c=Object.entries(l);for(const[d,h]of c){const f=i[d];f!=null&&(i[d]=f+e*h)}return i},{...t})}}const ot=br(1),wt=br(-1);function Gs(e){return"clientX"in e&&"clientY"in e}function qt(e){if(!e)return!1;const{KeyboardEvent:t}=le(e.target);return t&&e instanceof t}function Bs(e){if(!e)return!1;const{TouchEvent:t}=le(e.target);return t&&e instanceof t}function Ft(e){if(Bs(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Gs(e)?{x:e.clientX,y:e.clientY}:null}const $e=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[$e.Translate.toString(e),$e.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),Kn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function _s(e){return e.matches(Kn)?e:e.querySelector(Kn)}const Qs={display:"none"};function Vs(e){let{id:t,value:n}=e;return $.createElement("div",{id:t,style:Qs},n)}function Ws(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return $.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},n)}function Xs(){const[e,t]=u.useState("");return{announce:u.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const yr=u.createContext(null);function Js(e){const t=u.useContext(yr);u.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Zs(){const[e]=u.useState(()=>new Set),t=u.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[u.useCallback(s=>{let{type:a,event:i}=s;e.forEach(l=>{var c;return(c=l[a])==null?void 0:c.call(l,i)})},[e]),t]}const ea={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},ta={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function na(e){let{announcements:t=ta,container:n,hiddenTextDescribedById:s,screenReaderInstructions:a=ea}=e;const{announce:i,announcement:l}=Xs(),c=Et("DndLiveRegion"),[d,h]=u.useState(!1);if(u.useEffect(()=>{h(!0)},[]),Js(u.useMemo(()=>({onDragStart(m){let{active:g}=m;i(t.onDragStart({active:g}))},onDragMove(m){let{active:g,over:v}=m;t.onDragMove&&i(t.onDragMove({active:g,over:v}))},onDragOver(m){let{active:g,over:v}=m;i(t.onDragOver({active:g,over:v}))},onDragEnd(m){let{active:g,over:v}=m;i(t.onDragEnd({active:g,over:v}))},onDragCancel(m){let{active:g,over:v}=m;i(t.onDragCancel({active:g,over:v}))}}),[i,t])),!d)return null;const f=$.createElement($.Fragment,null,$.createElement(Vs,{id:s,value:a.draggable}),$.createElement(Ws,{id:c,announcement:l}));return n?gt.createPortal(f,n):f}var W;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(W||(W={}));function Pt(){}function qn(e,t){return u.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function ra(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return u.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const je=Object.freeze({x:0,y:0});function wr(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function sa(e,t){const n=Ft(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function Nr(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function aa(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function Hn(e){let{left:t,top:n,height:s,width:a}=e;return[{x:t,y:n},{x:t+a,y:n},{x:t,y:n+s},{x:t+a,y:n+s}]}function Cr(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Gn(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const oa=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=Gn(t,t.left,t.top),i=[];for(const l of s){const{id:c}=l,d=n.get(c);if(d){const h=wr(Gn(d),a);i.push({id:c,data:{droppableContainer:l,value:h}})}}return i.sort(Nr)},ia=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=Hn(t),i=[];for(const l of s){const{id:c}=l,d=n.get(c);if(d){const h=Hn(d),f=a.reduce((g,v,E)=>g+wr(h[E],v),0),m=Number((f/4).toFixed(4));i.push({id:c,data:{droppableContainer:l,value:m}})}}return i.sort(Nr)};function la(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),l=a-s,c=i-n;if(s<a&&n<i){const d=t.width*t.height,h=e.width*e.height,f=l*c,m=f/(d+h-f);return Number(m.toFixed(4))}return 0}const ca=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=[];for(const i of s){const{id:l}=i,c=n.get(l);if(c){const d=la(c,t);d>0&&a.push({id:l,data:{droppableContainer:i,value:d}})}}return a.sort(aa)};function da(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function jr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:je}function ua(e){return function(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),i=1;i<s;i++)a[i-1]=arguments[i];return a.reduce((l,c)=>({...l,top:l.top+e*c.y,bottom:l.bottom+e*c.y,left:l.left+e*c.x,right:l.right+e*c.x}),{...n})}}const fa=ua(1);function Er(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function ha(e,t,n){const s=Er(t);if(!s)return e;const{scaleX:a,scaleY:i,x:l,y:c}=s,d=e.left-l-(1-a)*parseFloat(n),h=e.top-c-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),f=a?e.width/a:e.width,m=i?e.height/i:e.height;return{width:f,height:m,top:h,right:d+f,bottom:h+m,left:d}}const ga={ignoreTransform:!1};function ct(e,t){t===void 0&&(t=ga);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:h,transformOrigin:f}=le(e).getComputedStyle(e);h&&(n=ha(n,h,f))}const{top:s,left:a,width:i,height:l,bottom:c,right:d}=n;return{top:s,left:a,width:i,height:l,bottom:c,right:d}}function Bn(e){return ct(e,{ignoreTransform:!0})}function ma(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function pa(e,t){return t===void 0&&(t=le(e).getComputedStyle(e)),t.position==="fixed"}function xa(e,t){t===void 0&&(t=le(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=t[a];return typeof i=="string"?n.test(i):!1})}function Ht(e,t){const n=[];function s(a){if(t!=null&&n.length>=t||!a)return n;if(kn(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!Ct(a)||vr(a)||n.includes(a))return n;const i=le(e).getComputedStyle(a);return a!==e&&xa(a,i)&&n.push(a),pa(a,i)?n:s(a.parentNode)}return e?s(e):n}function Dr(e){const[t]=Ht(e,1);return t??null}function fn(e){return!Yt||!e?null:it(e)?e:Rn(e)?kn(e)||e===lt(e).scrollingElement?window:Ct(e)?e:null:null}function Sr(e){return it(e)?e.scrollX:e.scrollLeft}function Tr(e){return it(e)?e.scrollY:e.scrollTop}function Nn(e){return{x:Sr(e),y:Tr(e)}}var Z;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Z||(Z={}));function Rr(e){return!Yt||!e?!1:e===document.scrollingElement}function kr(e){const t={x:0,y:0},n=Rr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,l=e.scrollTop>=s.y,c=e.scrollLeft>=s.x;return{isTop:a,isLeft:i,isBottom:l,isRight:c,maxScroll:s,minScroll:t}}const va={x:.2,y:.2};function ba(e,t,n,s,a){let{top:i,left:l,right:c,bottom:d}=n;s===void 0&&(s=10),a===void 0&&(a=va);const{isTop:h,isBottom:f,isLeft:m,isRight:g}=kr(e),v={x:0,y:0},E={x:0,y:0},w={height:t.height*a.y,width:t.width*a.x};return!h&&i<=t.top+w.height?(v.y=Z.Backward,E.y=s*Math.abs((t.top+w.height-i)/w.height)):!f&&d>=t.bottom-w.height&&(v.y=Z.Forward,E.y=s*Math.abs((t.bottom-w.height-d)/w.height)),!g&&c>=t.right-w.width?(v.x=Z.Forward,E.x=s*Math.abs((t.right-w.width-c)/w.width)):!m&&l<=t.left+w.width&&(v.x=Z.Backward,E.x=s*Math.abs((t.left+w.width-l)/w.width)),{direction:v,speed:E}}function ya(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:l}=window;return{top:0,left:0,right:i,bottom:l,width:i,height:l}}const{top:t,left:n,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function Mr(e){return e.reduce((t,n)=>ot(t,Nn(n)),je)}function wa(e){return e.reduce((t,n)=>t+Sr(n),0)}function Na(e){return e.reduce((t,n)=>t+Tr(n),0)}function Ir(e,t){if(t===void 0&&(t=ct),!e)return;const{top:n,left:s,bottom:a,right:i}=t(e);Dr(e)&&(a<=0||i<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Ca=[["x",["left","right"],wa],["y",["top","bottom"],Na]];class Mn{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=Ht(n),a=Mr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,l,c]of Ca)for(const d of l)Object.defineProperty(this,d,{get:()=>{const h=c(s),f=a[i]-h;return this.rect[d]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class xt{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var a;(a=this.target)==null||a.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function ja(e){const{EventTarget:t}=le(e);return e instanceof t?e:lt(e)}function hn(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var ye;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ye||(ye={}));function _n(e){e.preventDefault()}function Ea(e){e.stopPropagation()}var O;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(O||(O={}));const Ar={start:[O.Space,O.Enter],cancel:[O.Esc],end:[O.Space,O.Enter,O.Tab]},Da=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case O.Right:return{...n,x:n.x+25};case O.Left:return{...n,x:n.x-25};case O.Down:return{...n,y:n.y+25};case O.Up:return{...n,y:n.y-25}}};class In{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new xt(lt(n)),this.windowListeners=new xt(le(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ye.Resize,this.handleCancel),this.windowListeners.add(ye.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ye.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&Ir(s),n(je)}handleKeyDown(t){if(qt(t)){const{active:n,context:s,options:a}=this.props,{keyboardCodes:i=Ar,coordinateGetter:l=Da,scrollBehavior:c="smooth"}=a,{code:d}=t;if(i.end.includes(d)){this.handleEnd(t);return}if(i.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:h}=s.current,f=h?{x:h.left,y:h.top}:je;this.referenceCoordinates||(this.referenceCoordinates=f);const m=l(t,{active:n,context:s.current,currentCoordinates:f});if(m){const g=wt(m,f),v={x:0,y:0},{scrollableAncestors:E}=s.current;for(const w of E){const N=t.code,{isTop:k,isRight:R,isLeft:x,isBottom:b,maxScroll:C,minScroll:T}=kr(w),S=ya(w),M={x:Math.min(N===O.Right?S.right-S.width/2:S.right,Math.max(N===O.Right?S.left:S.left+S.width/2,m.x)),y:Math.min(N===O.Down?S.bottom-S.height/2:S.bottom,Math.max(N===O.Down?S.top:S.top+S.height/2,m.y))},F=N===O.Right&&!R||N===O.Left&&!x,L=N===O.Down&&!b||N===O.Up&&!k;if(F&&M.x!==m.x){const A=w.scrollLeft+g.x,Y=N===O.Right&&A<=C.x||N===O.Left&&A>=T.x;if(Y&&!g.y){w.scrollTo({left:A,behavior:c});return}Y?v.x=w.scrollLeft-A:v.x=N===O.Right?w.scrollLeft-C.x:w.scrollLeft-T.x,v.x&&w.scrollBy({left:-v.x,behavior:c});break}else if(L&&M.y!==m.y){const A=w.scrollTop+g.y,Y=N===O.Down&&A<=C.y||N===O.Up&&A>=T.y;if(Y&&!g.x){w.scrollTo({top:A,behavior:c});return}Y?v.y=w.scrollTop-A:v.y=N===O.Down?w.scrollTop-C.y:w.scrollTop-T.y,v.y&&w.scrollBy({top:-v.y,behavior:c});break}}this.handleMove(t,ot(wt(m,this.referenceCoordinates),v))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}In.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=Ar,onActivation:a}=t,{active:i}=n;const{code:l}=e.nativeEvent;if(s.start.includes(l)){const c=i.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),a?.({event:e.nativeEvent}),!0)}return!1}}];function Qn(e){return!!(e&&"distance"in e)}function Vn(e){return!!(e&&"delay"in e)}class An{constructor(t,n,s){var a;s===void 0&&(s=ja(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:l}=i;this.props=t,this.events=n,this.document=lt(l),this.documentListeners=new xt(this.document),this.listeners=new xt(s),this.windowListeners=new xt(le(l)),this.initialCoordinates=(a=Ft(i))!=null?a:je,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ye.Resize,this.handleCancel),this.windowListeners.add(ye.DragStart,_n),this.windowListeners.add(ye.VisibilityChange,this.handleCancel),this.windowListeners.add(ye.ContextMenu,_n),this.documentListeners.add(ye.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Vn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Qn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(ye.Click,Ea,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ye.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:a,props:i}=this,{onMove:l,options:{activationConstraint:c}}=i;if(!a)return;const d=(n=Ft(t))!=null?n:je,h=wt(a,d);if(!s&&c){if(Qn(c)){if(c.tolerance!=null&&hn(h,c.tolerance))return this.handleCancel();if(hn(h,c.distance))return this.handleStart()}if(Vn(c)&&hn(h,c.tolerance))return this.handleCancel();this.handlePending(c,h);return}t.cancelable&&t.preventDefault(),l(d)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===O.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Sa={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class On extends An{constructor(t){const{event:n}=t,s=lt(n.target);super(t,Sa,s)}}On.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s?.({event:n}),!0)}}];const Ta={move:{name:"mousemove"},end:{name:"mouseup"}};var Cn;(function(e){e[e.RightClick=2]="RightClick"})(Cn||(Cn={}));class Ra extends An{constructor(t){super(t,Ta,lt(t.event.target))}}Ra.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===Cn.RightClick?!1:(s?.({event:n}),!0)}}];const gn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class ka extends An{constructor(t){super(t,gn)}static setup(){return window.addEventListener(gn.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(gn.move.name,t)};function t(){}}}ka.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:a}=n;return a.length>1?!1:(s?.({event:n}),!0)}}];var vt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(vt||(vt={}));var $t;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})($t||($t={}));function Ma(e){let{acceleration:t,activator:n=vt.Pointer,canScroll:s,draggingRect:a,enabled:i,interval:l=5,order:c=$t.TreeOrder,pointerCoordinates:d,scrollableAncestors:h,scrollableAncestorRects:f,delta:m,threshold:g}=e;const v=Aa({delta:m,disabled:!i}),[E,w]=Hs(),N=u.useRef({x:0,y:0}),k=u.useRef({x:0,y:0}),R=u.useMemo(()=>{switch(n){case vt.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case vt.DraggableRect:return a}},[n,a,d]),x=u.useRef(null),b=u.useCallback(()=>{const T=x.current;if(!T)return;const S=N.current.x*k.current.x,M=N.current.y*k.current.y;T.scrollBy(S,M)},[]),C=u.useMemo(()=>c===$t.TreeOrder?[...h].reverse():h,[c,h]);u.useEffect(()=>{if(!i||!h.length||!R){w();return}for(const T of C){if(s?.(T)===!1)continue;const S=h.indexOf(T),M=f[S];if(!M)continue;const{direction:F,speed:L}=ba(T,M,R,t,g);for(const A of["x","y"])v[A][F[A]]||(L[A]=0,F[A]=0);if(L.x>0||L.y>0){w(),x.current=T,E(b,l),N.current=L,k.current=F;return}}N.current={x:0,y:0},k.current={x:0,y:0},w()},[t,b,s,w,i,l,JSON.stringify(R),JSON.stringify(v),E,h,C,f,JSON.stringify(g)])}const Ia={x:{[Z.Backward]:!1,[Z.Forward]:!1},y:{[Z.Backward]:!1,[Z.Forward]:!1}};function Aa(e){let{delta:t,disabled:n}=e;const s=zt(t);return jt(a=>{if(n||!s||!a)return Ia;const i={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[Z.Backward]:a.x[Z.Backward]||i.x===-1,[Z.Forward]:a.x[Z.Forward]||i.x===1},y:{[Z.Backward]:a.y[Z.Backward]||i.y===-1,[Z.Forward]:a.y[Z.Forward]||i.y===1}}},[n,t,s])}function Oa(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return jt(a=>{var i;return t==null?null:(i=s??a)!=null?i:null},[s,t])}function La(e,t){return u.useMemo(()=>e.reduce((n,s)=>{const{sensor:a}=s,i=a.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,s)}));return[...n,...i]},[]),[e,t])}var Nt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Nt||(Nt={}));var jn;(function(e){e.Optimized="optimized"})(jn||(jn={}));const Wn=new Map;function za(e,t){let{dragging:n,dependencies:s,config:a}=t;const[i,l]=u.useState(null),{frequency:c,measure:d,strategy:h}=a,f=u.useRef(e),m=N(),g=yt(m),v=u.useCallback(function(k){k===void 0&&(k=[]),!g.current&&l(R=>R===null?k:R.concat(k.filter(x=>!R.includes(x))))},[g]),E=u.useRef(null),w=jt(k=>{if(m&&!n)return Wn;if(!k||k===Wn||f.current!==e||i!=null){const R=new Map;for(let x of e){if(!x)continue;if(i&&i.length>0&&!i.includes(x.id)&&x.rect.current){R.set(x.id,x.rect.current);continue}const b=x.node.current,C=b?new Mn(d(b),b):null;x.rect.current=C,C&&R.set(x.id,C)}return R}return k},[e,i,n,m,d]);return u.useEffect(()=>{f.current=e},[e]),u.useEffect(()=>{m||v()},[n,m]),u.useEffect(()=>{i&&i.length>0&&l(null)},[JSON.stringify(i)]),u.useEffect(()=>{m||typeof c!="number"||E.current!==null||(E.current=setTimeout(()=>{v(),E.current=null},c))},[c,m,v,...s]),{droppableRects:w,measureDroppableContainers:v,measuringScheduled:i!=null};function N(){switch(h){case Nt.Always:return!1;case Nt.BeforeDragging:return n;default:return!n}}}function Ln(e,t){return jt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Fa(e,t){return Ln(e,t)}function Pa(e){let{callback:t,disabled:n}=e;const s=Kt(t),a=u.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(s)},[s,n]);return u.useEffect(()=>()=>a?.disconnect(),[a]),a}function Gt(e){let{callback:t,disabled:n}=e;const s=Kt(t),a=u.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(s)},[n]);return u.useEffect(()=>()=>a?.disconnect(),[a]),a}function $a(e){return new Mn(ct(e),e)}function Xn(e,t,n){t===void 0&&(t=$a);const[s,a]=u.useState(null);function i(){a(d=>{if(!e)return null;if(e.isConnected===!1){var h;return(h=d??n)!=null?h:null}const f=t(e);return JSON.stringify(d)===JSON.stringify(f)?d:f})}const l=Pa({callback(d){if(e)for(const h of d){const{type:f,target:m}=h;if(f==="childList"&&m instanceof HTMLElement&&m.contains(e)){i();break}}}}),c=Gt({callback:i});return Ce(()=>{i(),e?(c?.observe(e),l?.observe(document.body,{childList:!0,subtree:!0})):(c?.disconnect(),l?.disconnect())},[e]),s}function Ua(e){const t=Ln(e);return jr(e,t)}const Jn=[];function Ya(e){const t=u.useRef(e),n=jt(s=>e?s&&s!==Jn&&e&&t.current&&e.parentNode===t.current.parentNode?s:Ht(e):Jn,[e]);return u.useEffect(()=>{t.current=e},[e]),n}function Ka(e){const[t,n]=u.useState(null),s=u.useRef(e),a=u.useCallback(i=>{const l=fn(i.target);l&&n(c=>c?(c.set(l,Nn(l)),new Map(c)):null)},[]);return u.useEffect(()=>{const i=s.current;if(e!==i){l(i);const c=e.map(d=>{const h=fn(d);return h?(h.addEventListener("scroll",a,{passive:!0}),[h,Nn(h)]):null}).filter(d=>d!=null);n(c.length?new Map(c):null),s.current=e}return()=>{l(e),l(i)};function l(c){c.forEach(d=>{const h=fn(d);h?.removeEventListener("scroll",a)})}},[a,e]),u.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,l)=>ot(i,l),je):Mr(e):je,[e,t])}function Zn(e,t){t===void 0&&(t=[]);const n=u.useRef(null);return u.useEffect(()=>{n.current=null},t),u.useEffect(()=>{const s=e!==je;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?wt(e,n.current):je}function qa(e){u.useEffect(()=>{if(!Yt)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function Ha(e,t){return u.useMemo(()=>e.reduce((n,s)=>{let{eventName:a,handler:i}=s;return n[a]=l=>{i(l,t)},n},{}),[e,t])}function Or(e){return u.useMemo(()=>e?ma(e):null,[e])}const er=[];function Ga(e,t){t===void 0&&(t=ct);const[n]=e,s=Or(n?le(n):null),[a,i]=u.useState(er);function l(){i(()=>e.length?e.map(d=>Rr(d)?s:new Mn(t(d),d)):er)}const c=Gt({callback:l});return Ce(()=>{c?.disconnect(),l(),e.forEach(d=>c?.observe(d))},[e]),a}function Lr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ct(t)?t:e}function Ba(e){let{measure:t}=e;const[n,s]=u.useState(null),a=u.useCallback(h=>{for(const{target:f}of h)if(Ct(f)){s(m=>{const g=t(f);return m?{...m,width:g.width,height:g.height}:g});break}},[t]),i=Gt({callback:a}),l=u.useCallback(h=>{const f=Lr(h);i?.disconnect(),f&&i?.observe(f),s(f?t(f):null)},[t,i]),[c,d]=Lt(l);return u.useMemo(()=>({nodeRef:c,rect:n,setRef:d}),[n,c,d])}const _a=[{sensor:On,options:{}},{sensor:In,options:{}}],Qa={current:{}},Ot={draggable:{measure:Bn},droppable:{measure:Bn,strategy:Nt.WhileDragging,frequency:jn.Optimized},dragOverlay:{measure:ct}};class bt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const Va={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new bt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Pt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ot,measureDroppableContainers:Pt,windowRect:null,measuringScheduled:!1},zr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Pt,draggableNodes:new Map,over:null,measureDroppableContainers:Pt},Dt=u.createContext(zr),Fr=u.createContext(Va);function Wa(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new bt}}}function Xa(e,t){switch(t.type){case W.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case W.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case W.DragEnd:case W.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case W.RegisterDroppable:{const{element:n}=t,{id:s}=n,a=new bt(e.droppable.containers);return a.set(s,n),{...e,droppable:{...e.droppable,containers:a}}}case W.SetDroppableDisabled:{const{id:n,key:s,disabled:a}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const l=new bt(e.droppable.containers);return l.set(n,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:l}}}case W.UnregisterDroppable:{const{id:n,key:s}=t,a=e.droppable.containers.get(n);if(!a||s!==a.key)return e;const i=new bt(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Ja(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:a}=u.useContext(Dt),i=zt(s),l=zt(n?.id);return u.useEffect(()=>{if(!t&&!s&&i&&l!=null){if(!qt(i)||document.activeElement===i.target)return;const c=a.get(l);if(!c)return;const{activatorNode:d,node:h}=c;if(!d.current&&!h.current)return;requestAnimationFrame(()=>{for(const f of[d.current,h.current]){if(!f)continue;const m=_s(f);if(m){m.focus();break}}})}},[s,t,a,l,i]),null}function Pr(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...s}),n):n}function Za(e){return u.useMemo(()=>({draggable:{...Ot.draggable,...e?.draggable},droppable:{...Ot.droppable,...e?.droppable},dragOverlay:{...Ot.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function eo(e){let{activeNode:t,measure:n,initialRect:s,config:a=!0}=e;const i=u.useRef(!1),{x:l,y:c}=typeof a=="boolean"?{x:a,y:a}:a;Ce(()=>{if(!l&&!c||!t){i.current=!1;return}if(i.current||!s)return;const h=t?.node.current;if(!h||h.isConnected===!1)return;const f=n(h),m=jr(f,s);if(l||(m.x=0),c||(m.y=0),i.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const g=Dr(h);g&&g.scrollBy({top:m.y,left:m.x})}},[t,l,c,s,n])}const Bt=u.createContext({...je,scaleX:1,scaleY:1});var Pe;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Pe||(Pe={}));const to=u.memo(function(t){var n,s,a,i;let{id:l,accessibility:c,autoScroll:d=!0,children:h,sensors:f=_a,collisionDetection:m=ca,measuring:g,modifiers:v,...E}=t;const w=u.useReducer(Xa,void 0,Wa),[N,k]=w,[R,x]=Zs(),[b,C]=u.useState(Pe.Uninitialized),T=b===Pe.Initialized,{draggable:{active:S,nodes:M,translate:F},droppable:{containers:L}}=N,A=S!=null?M.get(S):null,Y=u.useRef({initial:null,translated:null}),ee=u.useMemo(()=>{var B;return S!=null?{id:S,data:(B=A?.data)!=null?B:Qa,rect:Y}:null},[S,A]),he=u.useRef(null),[ue,Ve]=u.useState(null),[X,ke]=u.useState(null),Ee=yt(E,Object.values(E)),We=Et("DndDescribedBy",l),Xe=u.useMemo(()=>L.getEnabled(),[L]),te=Za(g),{droppableRects:we,measureDroppableContainers:Te,measuringScheduled:Ue}=za(Xe,{dragging:T,dependencies:[F.x,F.y],config:te.droppable}),ce=Oa(M,S),Re=u.useMemo(()=>X?Ft(X):null,[X]),ge=Be(),fe=Fa(ce,te.draggable.measure);eo({activeNode:S!=null?M.get(S):null,config:ge.layoutShiftCompensation,initialRect:fe,measure:te.draggable.measure});const z=Xn(ce,te.draggable.measure,fe),Me=Xn(ce?ce.parentElement:null),oe=u.useRef({activatorEvent:null,active:null,activeNode:ce,collisionRect:null,collisions:null,droppableRects:we,draggableNodes:M,draggingNode:null,draggingNodeRect:null,droppableContainers:L,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ie=L.getNodeFor((n=oe.current.over)==null?void 0:n.id),me=Ba({measure:te.dragOverlay.measure}),Ye=(s=me.nodeRef.current)!=null?s:ce,Ke=T?(a=me.rect)!=null?a:z:null,_t=!!(me.nodeRef.current&&me.rect),St=Ua(_t?null:z),Je=Or(Ye?le(Ye):null),De=Ya(T?Ie??ce:null),Ze=Ga(De),dt=Pr(v,{transform:{x:F.x-St.x,y:F.y-St.y,scaleX:1,scaleY:1},activatorEvent:X,active:ee,activeNodeRect:z,containerNodeRect:Me,draggingNodeRect:Ke,over:oe.current.over,overlayNodeRect:me.rect,scrollableAncestors:De,scrollableAncestorRects:Ze,windowRect:Je}),Qt=Re?ot(Re,F):null,et=Ka(De),pe=Zn(et),Vt=Zn(et,[z]),Ae=ot(dt,pe),Oe=Ke?fa(Ke,dt):null,qe=ee&&Oe?m({active:ee,collisionRect:Oe,droppableRects:we,droppableContainers:Xe,pointerCoordinates:Qt}):null,Tt=Cr(qe,"id"),[xe,Rt]=u.useState(null),Wt=_t?dt:ot(dt,Vt),Xt=da(Wt,(i=xe?.rect)!=null?i:null,z),ut=u.useRef(null),He=u.useCallback((B,_)=>{let{sensor:ne,options:Se}=_;if(he.current==null)return;const re=M.get(he.current);if(!re)return;const ie=B.nativeEvent,se=new ne({active:he.current,activeNode:re,event:ie,options:Se,context:oe,onAbort(K){if(!M.get(K))return;const{onDragAbort:o}=Ee.current,p={id:K};o?.(p),R({type:"onDragAbort",event:p})},onPending(K,Ne,o,p){if(!M.get(K))return;const{onDragPending:j}=Ee.current,D={id:K,constraint:Ne,initialCoordinates:o,offset:p};j?.(D),R({type:"onDragPending",event:D})},onStart(K){const Ne=he.current;if(Ne==null)return;const o=M.get(Ne);if(!o)return;const{onDragStart:p}=Ee.current,y={activatorEvent:ie,active:{id:Ne,data:o.data,rect:Y}};gt.unstable_batchedUpdates(()=>{p?.(y),C(Pe.Initializing),k({type:W.DragStart,initialCoordinates:K,active:Ne}),R({type:"onDragStart",event:y}),Ve(ut.current),ke(ie)})},onMove(K){k({type:W.DragMove,coordinates:K})},onEnd:ve(W.DragEnd),onCancel:ve(W.DragCancel)});ut.current=se;function ve(K){return async function(){const{active:o,collisions:p,over:y,scrollAdjustedTranslate:j}=oe.current;let D=null;if(o&&j){const{cancelDrop:I}=Ee.current;D={activatorEvent:ie,active:o,collisions:p,delta:j,over:y},K===W.DragEnd&&typeof I=="function"&&await Promise.resolve(I(D))&&(K=W.DragCancel)}he.current=null,gt.unstable_batchedUpdates(()=>{k({type:K}),C(Pe.Uninitialized),Rt(null),Ve(null),ke(null),ut.current=null;const I=K===W.DragEnd?"onDragEnd":"onDragCancel";if(D){const U=Ee.current[I];U?.(D),R({type:I,event:D})}})}}},[M]),Jt=u.useCallback((B,_)=>(ne,Se)=>{const re=ne.nativeEvent,ie=M.get(Se);if(he.current!==null||!ie||re.dndKit||re.defaultPrevented)return;const se={active:ie};B(ne,_.options,se)===!0&&(re.dndKit={capturedBy:_.sensor},he.current=Se,He(ne,_))},[M,He]),Ge=La(f,Jt);qa(f),Ce(()=>{z&&b===Pe.Initializing&&C(Pe.Initialized)},[z,b]),u.useEffect(()=>{const{onDragMove:B}=Ee.current,{active:_,activatorEvent:ne,collisions:Se,over:re}=oe.current;if(!_||!ne)return;const ie={active:_,activatorEvent:ne,collisions:Se,delta:{x:Ae.x,y:Ae.y},over:re};gt.unstable_batchedUpdates(()=>{B?.(ie),R({type:"onDragMove",event:ie})})},[Ae.x,Ae.y]),u.useEffect(()=>{const{active:B,activatorEvent:_,collisions:ne,droppableContainers:Se,scrollAdjustedTranslate:re}=oe.current;if(!B||he.current==null||!_||!re)return;const{onDragOver:ie}=Ee.current,se=Se.get(Tt),ve=se&&se.rect.current?{id:se.id,rect:se.rect.current,data:se.data,disabled:se.disabled}:null,K={active:B,activatorEvent:_,collisions:ne,delta:{x:re.x,y:re.y},over:ve};gt.unstable_batchedUpdates(()=>{Rt(ve),ie?.(K),R({type:"onDragOver",event:K})})},[Tt]),Ce(()=>{oe.current={activatorEvent:X,active:ee,activeNode:ce,collisionRect:Oe,collisions:qe,droppableRects:we,draggableNodes:M,draggingNode:Ye,draggingNodeRect:Ke,droppableContainers:L,over:xe,scrollableAncestors:De,scrollAdjustedTranslate:Ae},Y.current={initial:Ke,translated:Oe}},[ee,ce,qe,Oe,M,Ye,Ke,we,L,xe,De,Ae]),Ma({...ge,delta:F,draggingRect:Oe,pointerCoordinates:Qt,scrollableAncestors:De,scrollableAncestorRects:Ze});const Zt=u.useMemo(()=>({active:ee,activeNode:ce,activeNodeRect:z,activatorEvent:X,collisions:qe,containerNodeRect:Me,dragOverlay:me,draggableNodes:M,droppableContainers:L,droppableRects:we,over:xe,measureDroppableContainers:Te,scrollableAncestors:De,scrollableAncestorRects:Ze,measuringConfiguration:te,measuringScheduled:Ue,windowRect:Je}),[ee,ce,z,X,qe,Me,me,M,L,we,xe,Te,De,Ze,te,Ue,Je]),en=u.useMemo(()=>({activatorEvent:X,activators:Ge,active:ee,activeNodeRect:z,ariaDescribedById:{draggable:We},dispatch:k,draggableNodes:M,over:xe,measureDroppableContainers:Te}),[X,Ge,ee,z,k,We,M,xe,Te]);return $.createElement(yr.Provider,{value:x},$.createElement(Dt.Provider,{value:en},$.createElement(Fr.Provider,{value:Zt},$.createElement(Bt.Provider,{value:Xt},h)),$.createElement(Ja,{disabled:c?.restoreFocus===!1})),$.createElement(na,{...c,hiddenTextDescribedById:We}));function Be(){const B=ue?.autoScrollEnabled===!1,_=typeof d=="object"?d.enabled===!1:d===!1,ne=T&&!B&&!_;return typeof d=="object"?{...d,enabled:ne}:{enabled:ne}}}),no=u.createContext(null),tr="button",ro="Draggable";function so(e){let{id:t,data:n,disabled:s=!1,attributes:a}=e;const i=Et(ro),{activators:l,activatorEvent:c,active:d,activeNodeRect:h,ariaDescribedById:f,draggableNodes:m,over:g}=u.useContext(Dt),{role:v=tr,roleDescription:E="draggable",tabIndex:w=0}=a??{},N=d?.id===t,k=u.useContext(N?Bt:no),[R,x]=Lt(),[b,C]=Lt(),T=Ha(l,t),S=yt(n);Ce(()=>(m.set(t,{id:t,key:i,node:R,activatorNode:b,data:S}),()=>{const F=m.get(t);F&&F.key===i&&m.delete(t)}),[m,t]);const M=u.useMemo(()=>({role:v,tabIndex:w,"aria-disabled":s,"aria-pressed":N&&v===tr?!0:void 0,"aria-roledescription":E,"aria-describedby":f.draggable}),[s,v,w,N,E,f.draggable]);return{active:d,activatorEvent:c,activeNodeRect:h,attributes:M,isDragging:N,listeners:s?void 0:T,node:R,over:g,setNodeRef:x,setActivatorNodeRef:C,transform:k}}function $r(){return u.useContext(Fr)}const ao="Droppable",oo={timeout:25};function io(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:a}=e;const i=Et(ao),{active:l,dispatch:c,over:d,measureDroppableContainers:h}=u.useContext(Dt),f=u.useRef({disabled:n}),m=u.useRef(!1),g=u.useRef(null),v=u.useRef(null),{disabled:E,updateMeasurementsFor:w,timeout:N}={...oo,...a},k=yt(w??s),R=u.useCallback(()=>{if(!m.current){m.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{h(Array.isArray(k.current)?k.current:[k.current]),v.current=null},N)},[N]),x=Gt({callback:R,disabled:E||!l}),b=u.useCallback((M,F)=>{x&&(F&&(x.unobserve(F),m.current=!1),M&&x.observe(M))},[x]),[C,T]=Lt(b),S=yt(t);return u.useEffect(()=>{!x||!C.current||(x.disconnect(),m.current=!1,x.observe(C.current))},[C,x]),u.useEffect(()=>(c({type:W.RegisterDroppable,element:{id:s,key:i,disabled:n,node:C,rect:g,data:S}}),()=>c({type:W.UnregisterDroppable,key:i,id:s})),[s]),u.useEffect(()=>{n!==f.current.disabled&&(c({type:W.SetDroppableDisabled,id:s,key:i,disabled:n}),f.current.disabled=n)},[s,i,n,c]),{active:l,rect:g,isOver:d?.id===s,node:C,over:d,setNodeRef:T}}function lo(e){let{animation:t,children:n}=e;const[s,a]=u.useState(null),[i,l]=u.useState(null),c=zt(n);return!n&&!s&&c&&a(c),Ce(()=>{if(!i)return;const d=s?.key,h=s?.props.id;if(d==null||h==null){a(null);return}Promise.resolve(t(h,i)).then(()=>{a(null)})},[t,s,i]),$.createElement($.Fragment,null,n,s?u.cloneElement(s,{ref:l}):null)}const co={x:0,y:0,scaleX:1,scaleY:1};function uo(e){let{children:t}=e;return $.createElement(Dt.Provider,{value:zr},$.createElement(Bt.Provider,{value:co},t))}const fo={position:"fixed",touchAction:"none"},ho=e=>qt(e)?"transform 250ms ease":void 0,go=u.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:a,children:i,className:l,rect:c,style:d,transform:h,transition:f=ho}=e;if(!c)return null;const m=a?h:{...h,scaleX:1,scaleY:1},g={...fo,width:c.width,height:c.height,top:c.top,left:c.left,transform:$e.Transform.toString(m),transformOrigin:a&&s?sa(s,c):void 0,transition:typeof f=="function"?f(s):f,...d};return $.createElement(n,{className:l,style:g,ref:t},i)}),mo=e=>t=>{let{active:n,dragOverlay:s}=t;const a={},{styles:i,className:l}=e;if(i!=null&&i.active)for(const[c,d]of Object.entries(i.active))d!==void 0&&(a[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,d));if(i!=null&&i.dragOverlay)for(const[c,d]of Object.entries(i.dragOverlay))d!==void 0&&s.node.style.setProperty(c,d);return l!=null&&l.active&&n.node.classList.add(l.active),l!=null&&l.dragOverlay&&s.node.classList.add(l.dragOverlay),function(){for(const[d,h]of Object.entries(a))n.node.style.setProperty(d,h);l!=null&&l.active&&n.node.classList.remove(l.active)}},po=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:$e.Transform.toString(t)},{transform:$e.Transform.toString(n)}]},xo={duration:250,easing:"ease",keyframes:po,sideEffects:mo({styles:{active:{opacity:"0"}}})};function vo(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:a}=e;return Kt((i,l)=>{if(t===null)return;const c=n.get(i);if(!c)return;const d=c.node.current;if(!d)return;const h=Lr(l);if(!h)return;const{transform:f}=le(l).getComputedStyle(l),m=Er(f);if(!m)return;const g=typeof t=="function"?t:bo(t);return Ir(d,a.draggable.measure),g({active:{id:i,data:c.data,node:d,rect:a.draggable.measure(d)},draggableNodes:n,dragOverlay:{node:l,rect:a.dragOverlay.measure(h)},droppableContainers:s,measuringConfiguration:a,transform:m})})}function bo(e){const{duration:t,easing:n,sideEffects:s,keyframes:a}={...xo,...e};return i=>{let{active:l,dragOverlay:c,transform:d,...h}=i;if(!t)return;const f={x:c.rect.left-l.rect.left,y:c.rect.top-l.rect.top},m={scaleX:d.scaleX!==1?l.rect.width*d.scaleX/c.rect.width:1,scaleY:d.scaleY!==1?l.rect.height*d.scaleY/c.rect.height:1},g={x:d.x-f.x,y:d.y-f.y,...m},v=a({...h,active:l,dragOverlay:c,transform:{initial:d,final:g}}),[E]=v,w=v[v.length-1];if(JSON.stringify(E)===JSON.stringify(w))return;const N=s?.({active:l,dragOverlay:c,...h}),k=c.node.animate(v,{duration:t,easing:n,fill:"forwards"});return new Promise(R=>{k.onfinish=()=>{N?.(),R()}})}}let nr=0;function yo(e){return u.useMemo(()=>{if(e!=null)return nr++,nr},[e])}const wo=$.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:a,transition:i,modifiers:l,wrapperElement:c="div",className:d,zIndex:h=999}=e;const{activatorEvent:f,active:m,activeNodeRect:g,containerNodeRect:v,draggableNodes:E,droppableContainers:w,dragOverlay:N,over:k,measuringConfiguration:R,scrollableAncestors:x,scrollableAncestorRects:b,windowRect:C}=$r(),T=u.useContext(Bt),S=yo(m?.id),M=Pr(l,{activatorEvent:f,active:m,activeNodeRect:g,containerNodeRect:v,draggingNodeRect:N.rect,over:k,overlayNodeRect:N.rect,scrollableAncestors:x,scrollableAncestorRects:b,transform:T,windowRect:C}),F=Ln(g),L=vo({config:s,draggableNodes:E,droppableContainers:w,measuringConfiguration:R}),A=F?N.setRef:void 0;return $.createElement(uo,null,$.createElement(lo,{animation:L},m&&S?$.createElement(go,{key:S,id:m.id,ref:A,as:c,activatorEvent:f,adjustScale:t,className:d,transition:i,rect:F,style:{zIndex:h,...a},transform:M},n):null))});function Ur(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function No(e,t){return e.reduce((n,s,a)=>{const i=t.get(s);return i&&(n[a]=i),n},Array(e.length))}function Mt(e){return e!==null&&e>=0}function Co(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function jo(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Yr=e=>{let{rects:t,activeIndex:n,overIndex:s,index:a}=e;const i=Ur(t,s,n),l=t[a],c=i[a];return!c||!l?null:{x:c.left-l.left,y:c.top-l.top,scaleX:c.width/l.width,scaleY:c.height/l.height}},It={scaleX:1,scaleY:1},Eo=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:a,rects:i,overIndex:l}=e;const c=(t=i[n])!=null?t:s;if(!c)return null;if(a===n){const h=i[l];return h?{x:0,y:n<l?h.top+h.height-(c.top+c.height):h.top-c.top,...It}:null}const d=Do(i,a,n);return a>n&&a<=l?{x:0,y:-c.height-d,...It}:a<n&&a>=l?{x:0,y:c.height+d,...It}:{x:0,y:0,...It}};function Do(e,t,n){const s=e[t],a=e[t-1],i=e[t+1];return s?n<t?a?s.top-(a.top+a.height):i?i.top-(s.top+s.height):0:i?i.top-(s.top+s.height):a?s.top-(a.top+a.height):0:0}const Kr="Sortable",qr=$.createContext({activeIndex:-1,containerId:Kr,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Yr,disabled:{draggable:!1,droppable:!1}});function So(e){let{children:t,id:n,items:s,strategy:a=Yr,disabled:i=!1}=e;const{active:l,dragOverlay:c,droppableRects:d,over:h,measureDroppableContainers:f}=$r(),m=Et(Kr,n),g=c.rect!==null,v=u.useMemo(()=>s.map(T=>typeof T=="object"&&"id"in T?T.id:T),[s]),E=l!=null,w=l?v.indexOf(l.id):-1,N=h?v.indexOf(h.id):-1,k=u.useRef(v),R=!Co(v,k.current),x=N!==-1&&w===-1||R,b=jo(i);Ce(()=>{R&&E&&f(v)},[R,v,E,f]),u.useEffect(()=>{k.current=v},[v]);const C=u.useMemo(()=>({activeIndex:w,containerId:m,disabled:b,disableTransforms:x,items:v,overIndex:N,useDragOverlay:g,sortedRects:No(v,d),strategy:a}),[w,m,b.draggable,b.droppable,x,v,N,d,g,a]);return $.createElement(qr.Provider,{value:C},t)}const To=e=>{let{id:t,items:n,activeIndex:s,overIndex:a}=e;return Ur(n,s,a).indexOf(t)},Ro=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:a,items:i,newIndex:l,previousItems:c,previousContainerId:d,transition:h}=e;return!h||!s||c!==i&&a===l?!1:n?!0:l!==a&&t===d},ko={duration:200,easing:"ease"},Hr="transform",Mo=$e.Transition.toString({property:Hr,duration:0,easing:"linear"}),Io={roleDescription:"sortable"};function Ao(e){let{disabled:t,index:n,node:s,rect:a}=e;const[i,l]=u.useState(null),c=u.useRef(n);return Ce(()=>{if(!t&&n!==c.current&&s.current){const d=a.current;if(d){const h=ct(s.current,{ignoreTransform:!0}),f={x:d.left-h.left,y:d.top-h.top,scaleX:d.width/h.width,scaleY:d.height/h.height};(f.x||f.y)&&l(f)}}n!==c.current&&(c.current=n)},[t,n,s,a]),u.useEffect(()=>{i&&l(null)},[i]),i}function Gr(e){let{animateLayoutChanges:t=Ro,attributes:n,disabled:s,data:a,getNewIndex:i=To,id:l,strategy:c,resizeObserverConfig:d,transition:h=ko}=e;const{items:f,containerId:m,activeIndex:g,disabled:v,disableTransforms:E,sortedRects:w,overIndex:N,useDragOverlay:k,strategy:R}=u.useContext(qr),x=Oo(s,v),b=f.indexOf(l),C=u.useMemo(()=>({sortable:{containerId:m,index:b,items:f},...a}),[m,a,b,f]),T=u.useMemo(()=>f.slice(f.indexOf(l)),[f,l]),{rect:S,node:M,isOver:F,setNodeRef:L}=io({id:l,data:C,disabled:x.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...d}}),{active:A,activatorEvent:Y,activeNodeRect:ee,attributes:he,setNodeRef:ue,listeners:Ve,isDragging:X,over:ke,setActivatorNodeRef:Ee,transform:We}=so({id:l,data:C,attributes:{...Io,...n},disabled:x.draggable}),Xe=qs(L,ue),te=!!A,we=te&&!E&&Mt(g)&&Mt(N),Te=!k&&X,Ue=Te&&we?We:null,Re=we?Ue??(c??R)({rects:w,activeNodeRect:ee,activeIndex:g,overIndex:N,index:b}):null,ge=Mt(g)&&Mt(N)?i({id:l,items:f,activeIndex:g,overIndex:N}):b,fe=A?.id,z=u.useRef({activeId:fe,items:f,newIndex:ge,containerId:m}),Me=f!==z.current.items,oe=t({active:A,containerId:m,isDragging:X,isSorting:te,id:l,index:b,items:f,newIndex:z.current.newIndex,previousItems:z.current.items,previousContainerId:z.current.containerId,transition:h,wasDragging:z.current.activeId!=null}),Ie=Ao({disabled:!oe,index:b,node:M,rect:S});return u.useEffect(()=>{te&&z.current.newIndex!==ge&&(z.current.newIndex=ge),m!==z.current.containerId&&(z.current.containerId=m),f!==z.current.items&&(z.current.items=f)},[te,ge,m,f]),u.useEffect(()=>{if(fe===z.current.activeId)return;if(fe!=null&&z.current.activeId==null){z.current.activeId=fe;return}const Ye=setTimeout(()=>{z.current.activeId=fe},50);return()=>clearTimeout(Ye)},[fe]),{active:A,activeIndex:g,attributes:he,data:C,rect:S,index:b,newIndex:ge,items:f,isOver:F,isSorting:te,isDragging:X,listeners:Ve,node:M,overIndex:N,over:ke,setNodeRef:Xe,setActivatorNodeRef:Ee,setDroppableNodeRef:L,setDraggableNodeRef:ue,transform:Ie??Re,transition:me()};function me(){if(Ie||Me&&z.current.newIndex===b)return Mo;if(!(Te&&!qt(Y)||!h)&&(te||oe))return $e.Transition.toString({...h,property:Hr})}}function Oo(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(s=e?.droppable)!=null?s:t.droppable}}function Ut(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Lo=[O.Down,O.Right,O.Up,O.Left],zo=(e,t)=>{let{context:{active:n,collisionRect:s,droppableRects:a,droppableContainers:i,over:l,scrollableAncestors:c}}=t;if(Lo.includes(e.code)){if(e.preventDefault(),!n||!s)return;const d=[];i.getEnabled().forEach(m=>{if(!m||m!=null&&m.disabled)return;const g=a.get(m.id);if(g)switch(e.code){case O.Down:s.top<g.top&&d.push(m);break;case O.Up:s.top>g.top&&d.push(m);break;case O.Left:s.left>g.left&&d.push(m);break;case O.Right:s.left<g.left&&d.push(m);break}});const h=ia({collisionRect:s,droppableRects:a,droppableContainers:d});let f=Cr(h,"id");if(f===l?.id&&h.length>1&&(f=h[1].id),f!=null){const m=i.get(n.id),g=i.get(f),v=g?a.get(g.id):null,E=g?.node.current;if(E&&v&&m&&g){const N=Ht(E).some((T,S)=>c[S]!==T),k=Br(m,g),R=Fo(m,g),x=N||!k?{x:0,y:0}:{x:R?s.width-v.width:0,y:R?s.height-v.height:0},b={x:v.left,y:v.top};return x.x&&x.y?b:wt(b,x)}}}};function Br(e,t){return!Ut(e)||!Ut(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Fo(e,t){return!Ut(e)||!Ut(t)||!Br(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Po=ns,$o=rs,Uo=ss;function Yo({dateStr:e}){if(!e)return null;try{const t=gr(e);if(!ur(t))return null;let n=V(t,"MMM d");Qe(t)&&(n="Today"),os(t)&&(n="Tomorrow");const s=is(t)&&!Qe(t);return r.jsxs("div",{className:`flex items-center gap-1 text-[10px] border px-1.5 py-0.5 rounded-full ${s?"text-red-400 border-red-400/50":"text-muted-foreground border-border"}`,children:[r.jsx(Wr,{className:"w-3 h-3"}),n]})}catch{return null}}function rr({task:e,onToggle:t,onDelete:n,onEdit:s}){const{attributes:a,listeners:i,setNodeRef:l,transform:c,transition:d,isDragging:h}=Gr({id:e.id,data:{type:"Task",...e}}),f={transform:$e.Translate.toString(c),transition:d,opacity:h?.5:1};return r.jsx("div",{ref:l,style:f,...a,...i,className:"mb-2 touch-none select-none relative group",children:r.jsxs("div",{className:`
            p-3 rounded-xl border border-transparent hover:border-border/50 transition-all
            flex gap-3 items-start bg-transparent hover:bg-accent/5
            ${h?"ring-2 ring-primary/50 bg-accent/10 z-50":""}
        `,onClick:()=>s(e),children:[r.jsx("div",{onClick:m=>{m.stopPropagation(),t(e)},className:`
                mt-0.5 w-5 h-5 rounded-full border-2 flex items-center justify-center cursor-pointer transition-colors
                ${e.status==="completed"?"bg-primary border-primary":"border-muted-foreground/60 hover:border-primary"}
            `,children:e.status==="completed"&&r.jsx("div",{className:"w-2.5 h-1.5 border-b-2 border-l-2 border-black rotate-[-45deg] mb-0.5"})}),r.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[r.jsx("div",{className:`text-sm font-medium leading-tight truncate ${e.status==="completed"?"line-through text-muted-foreground":"text-foreground"}`,children:e.title}),(e.notes||e.due)&&r.jsxs("div",{className:"flex flex-wrap gap-2 items-center mt-1",children:[e.due&&r.jsx(Yo,{dateStr:e.due}),e.notes&&r.jsxs("div",{className:"flex items-center text-[10px] text-muted-foreground gap-1",children:[r.jsx(fr,{className:"w-3 h-3"}),r.jsx("span",{className:"truncate max-w-[150px] opacity-70",children:e.notes.split(`
`)[0]})]})]})]})]})})}function sr({task:e,isOpen:t,onClose:n,onSave:s,onDelete:a,isCreating:i,activeListId:l,availableLists:c=[]}){const[d,h]=u.useState(""),[f,m]=u.useState(""),[g,v]=u.useState(""),[E,w]=u.useState(""),[N,k]=u.useState("");u.useEffect(()=>{if(t){if(i)h(""),m(""),v(""),w(""),k(l||c[0]?.id||"");else if(e)if(h(e.title),m(e.notes||""),k(e.listId),e.due)try{const x=gr(e.due);ur(x)&&v(V(x,"yyyy-MM-dd"))}catch{}else v("")}},[t,e,i,l]);const R=()=>{if(!d)return;let x;g&&(x=E?`${g}T${E}:00Z`:`${g}T00:00:00Z`),s({title:d,notes:f,due:x,listId:N}),n()};return r.jsx(mt,{open:t,onOpenChange:x=>!x&&n(),children:r.jsxs(pt,{className:"sm:max-w-[500px] border-border bg-[#1E1E1E] text-white p-0 gap-0 overflow-hidden shadow-2xl rounded-xl",children:[r.jsx("div",{className:"p-6 pb-2",children:r.jsx(ae,{value:d,onChange:x=>h(x.target.value),placeholder:"Add title",className:"text-2xl font-normal bg-transparent border-0 border-b border-white/20 rounded-none px-0 py-2 focus-visible:ring-0 focus-visible:border-blue-400 placeholder:text-muted-foreground/50 h-auto",autoFocus:i})}),r.jsxs("div",{className:"p-6 pt-2 space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ds,{className:"w-5 h-5 text-muted-foreground shrink-0"}),r.jsxs("div",{className:"flex-1 flex gap-2",children:[r.jsx(ae,{type:"date",value:g,onChange:x=>v(x.target.value),className:"bg-white/5 border-white/10 text-sm w-[150px]"}),r.jsx(ae,{type:"time",value:E,onChange:x=>w(x.target.value),className:"bg-white/5 border-white/10 text-sm w-[120px]"})]})]}),r.jsxs("div",{className:"flex items-center gap-2 pl-7",children:[r.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2 cursor-not-allowed opacity-70",children:[r.jsx("div",{className:"w-4 h-4 rounded-full border border-current"}),"Does not repeat"]}),r.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2 ml-4 cursor-not-allowed opacity-70",children:[r.jsx("div",{className:"w-4 h-4 border border-current"}),"All day"]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(fr,{className:"w-5 h-5 text-muted-foreground shrink-0 mt-2"}),r.jsx(pn,{value:f,onChange:x=>m(x.target.value),placeholder:"Add description",className:"bg-transparent border-0 resize-none min-h-[100px] focus-visible:ring-0 p-0 text-sm leading-relaxed placeholder:text-muted-foreground/50"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-5 shrink-0"})," ",r.jsxs(tt,{value:N,onValueChange:k,children:[r.jsx(nt,{className:"w-[150px] h-8 bg-white/5 border-white/10 text-xs",children:r.jsx(rt,{placeholder:"Select List"})}),r.jsx(st,{children:c.map(x=>r.jsx(Q,{value:x.id,children:x.title},x.id))})]})]})]}),r.jsxs(At,{className:"p-4 bg-white/5 flex justify-between items-center",children:[!i&&e?r.jsx(P,{variant:"ghost",size:"icon",onClick:()=>{confirm("Delete?")&&(a(e.id,e.listId),n())},children:r.jsx(xn,{className:"w-4 h-4 text-muted-foreground hover:text-red-400"})}):r.jsx("div",{}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(P,{variant:"ghost",onClick:n,className:"hover:bg-white/10",children:"Cancel"}),r.jsx(P,{onClick:R,disabled:!d,className:"bg-blue-600 hover:bg-blue-700 text-white rounded-full px-6",children:"Save"})]})]})]})})}function Ko({listId:e,title:t,tasks:n,onAddTask:s,onEdit:a,onToggle:i,onDelete:l}){const{setNodeRef:c}=Gr({id:e,data:{type:"Container",listId:e}}),d=n.filter(f=>f.status!=="completed"),h=n.filter(f=>f.status==="completed");return r.jsxs("div",{ref:c,className:"flex-1 min-w-[260px] max-w-[300px] flex flex-col h-full bg-[#1A1A1A] rounded-2xl overflow-hidden border border-white/5 my-1",children:[r.jsxs("div",{className:"p-4 flex items-center justify-between pb-2",children:[r.jsx("h3",{className:"font-medium text-lg text-white tracking-wide truncate",children:t==="Reclaim"?" Reclaim":t}),r.jsx("div",{className:"flex gap-1",children:r.jsxs(P,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-white",children:[r.jsx("div",{className:"w-1 h-1 bg-current rounded-full mb-0.5"}),r.jsx("div",{className:"w-1 h-1 bg-current rounded-full mb-0.5"}),r.jsx("div",{className:"w-1 h-1 bg-current rounded-full"})]})})]}),r.jsx("div",{className:"px-4 pb-2",children:r.jsxs("button",{onClick:()=>s(e),className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-white transition-colors group w-full text-left",children:[r.jsx("div",{className:"w-6 h-6 rounded-full bg-accent/20 flex items-center justify-center group-hover:bg-blue-500/20 group-hover:text-blue-400",children:r.jsx(bn,{className:"w-4 h-4"})}),"Add a task"]})}),r.jsx("div",{className:"flex-1 overflow-y-auto px-2 py-2 overflow-x-hidden [&::-webkit-scrollbar]:w-1.5 [&::-webkit-scrollbar-thumb]:bg-white/20 [&::-webkit-scrollbar-thumb]:rounded-full hover:[&::-webkit-scrollbar-thumb]:bg-white/40 [&::-webkit-scrollbar-track]:bg-transparent",children:r.jsxs(So,{items:n.map(f=>f.id),strategy:Eo,children:[d.length>0?r.jsx("div",{className:"space-y-1",children:d.map(f=>r.jsx(rr,{task:f,onToggle:i,onEdit:a,onDelete:l},f.id))}):h.length===0&&r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center opacity-40",children:[r.jsx("div",{className:"mb-4 text-4xl grayscale",children:""}),r.jsx("p",{className:"text-sm font-medium",children:"No tasks yet"})]}),h.length>0&&r.jsx("div",{className:"mt-4 pt-2 border-t border-white/5",children:r.jsxs(Po,{children:[r.jsxs($o,{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-white w-full py-2 px-2 hover:bg-white/5 rounded-md transition-colors",children:[r.jsx(Dn,{className:"w-4 h-4 transition-transform ui-open:rotate-90"}),"Completed (",h.length,")"]}),r.jsx(Uo,{className:"space-y-1 pl-2 mt-1",children:h.map(f=>r.jsx(rr,{task:f,onToggle:i,onEdit:a,onDelete:l},f.id))})]})})]})})]})}function qo({onClick:e}){return r.jsxs(P,{onClick:e,variant:"outline",size:"sm",className:"rounded-none font-arcade text-xs border-primary text-primary hover:bg-primary hover:text-black",children:[r.jsx(ir,{className:"w-4 h-4 mr-1"})," AI_ASSIST"]})}function Ho({isOpen:e,onClose:t}){const[n,s]=u.useState([]),[a,i]=u.useState(""),l=u.useRef(null),c=En(),{data:d,isLoading:h,refetch:f}=Fe({queryKey:["google-status"],queryFn:G.google.getStatus,retry:1,enabled:e}),m=J({mutationFn:async()=>{const{authUrl:w}=await G.google.getAuthUrl();window.location.href=w}});u.useEffect(()=>{e&&f()},[e,f]),u.useEffect(()=>{l.current&&(l.current.scrollTop=l.current.scrollHeight)},[n,e]);const g=J({mutationFn:async w=>G.calendar.assistant(w),onSuccess:w=>{s(N=>[...N,{role:"assistant",content:w.response,isError:!w.success}]),c.invalidateQueries({queryKey:["events"]}),c.invalidateQueries({queryKey:["google-tasks"]}),c.invalidateQueries({queryKey:["google-calendar"]}),c.refetchQueries({queryKey:["google-calendar"]})},onError:w=>{s(N=>[...N,{role:"assistant",content:`Network Error: ${w}`,isError:!0}])}}),v=()=>{if(!a.trim())return;const w={role:"user",content:a};s(N=>[...N,w]),i(""),g.mutate(a)},E=w=>{w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),v())};return e?r.jsxs(lr,{className:"fixed left-0 top-[68px] bottom-[40px] w-[380px] shadow-2xl z-50 flex flex-col border-r-2 border-primary bg-black text-white rounded-none animate-in fade-in slide-in-from-left-4 duration-300",children:[r.jsxs(cr,{className:"p-3 border-b border-primary/50 flex flex-row items-center justify-between bg-primary/10",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ir,{className:"w-5 h-5 text-primary"}),r.jsxs("div",{children:[r.jsx(Zr,{className:"text-sm font-arcade tracking-wider text-primary",children:"AI_ASSISTANT"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(es,{className:"text-[10px] text-muted-foreground font-terminal",children:"Calendar + Tasks Assistant"}),!h&&d?.connected&&r.jsx("span",{className:"text-[9px] font-arcade text-green-400",children:"CONNECTED"})]})]})]}),r.jsx(P,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:t,children:r.jsx(Qr,{className:"h-4 w-4 text-muted-foreground hover:text-white"})})]}),r.jsx(vn,{className:"flex-1 p-3",ref:l,children:r.jsxs("div",{className:"space-y-3",children:[!h&&!d?.connected&&r.jsxs("div",{className:"border border-yellow-500/50 bg-yellow-500/10 text-yellow-200 text-[10px] font-terminal px-3 py-2 flex items-center justify-between gap-3",children:[r.jsx("span",{children:"Calendar not connected."}),r.jsxs(P,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none border-yellow-500 text-yellow-200 hover:bg-yellow-500/20 font-arcade text-[9px]",onClick:()=>m.mutate(),disabled:m.isPending,children:[r.jsx(us,{className:"w-3 h-3 mr-1"}),m.isPending?"CONNECTING...":"CONNECT GOOGLE CALENDAR"]})]}),n.length===0&&r.jsxs("div",{className:"text-center text-muted-foreground text-xs mt-8 space-y-2",children:[r.jsx("p",{className:"font-terminal",children:"Ask me to create events or tasks."}),r.jsx("p",{className:"text-[10px] opacity-50 font-terminal",children:'"Add a workout tomorrow at 3pm"'}),r.jsx("p",{className:"text-[10px] opacity-50 font-terminal",children:'"Schedule PT study session Friday 2pm"'})]}),n.map((w,N)=>r.jsx("div",{className:`flex ${w.role==="user"?"justify-end":"justify-start"}`,children:r.jsx("div",{className:`max-w-[85%] px-3 py-2 text-xs font-terminal whitespace-pre-wrap ${w.role==="user"?"bg-primary text-black":w.isError?"bg-red-500/10 border border-red-500/50 text-red-300":"bg-white/10 text-white border border-white/10"}`,children:w.content})},N)),g.isPending&&r.jsx("div",{className:"flex justify-start",children:r.jsxs("div",{className:"bg-white/5 border border-white/10 px-3 py-2 text-[10px] flex items-center gap-2 text-muted-foreground font-terminal",children:[r.jsx(fs,{className:"h-3 w-3 animate-spin"}),"Thinking..."]})})]})}),r.jsxs("div",{className:"p-3 border-t border-primary/50",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx(ae,{value:a,onChange:w=>i(w.target.value),onKeyDown:E,placeholder:"Type a command...",className:"bg-black border-secondary font-terminal text-sm rounded-none focus-visible:ring-primary",disabled:g.isPending}),r.jsx(P,{onClick:v,disabled:g.isPending||!a.trim(),className:"rounded-none bg-primary text-black hover:bg-primary/90",children:r.jsx(hs,{className:"h-4 w-4"})})]}),r.jsx("div",{className:"text-[9px] text-center mt-1 text-muted-foreground/50 font-terminal",children:"OpenRouter  GPT-4o-mini"})]})]}):null}const mn=Array.from({length:24},(e,t)=>t),_e=60;function Go({tasks:e,taskLists:t}){const n=En(),{toast:s}=or(),[a,i]=u.useState(null),[l,c]=u.useState(null),[d,h]=u.useState(0),[f,m]=u.useState(null),g=ra(qn(On,{activationConstraint:{distance:8}}),qn(In,{coordinateGetter:zo})),v=J({mutationFn:x=>G.googleTasks.move(x.taskId,x.listId,x.destListId,x.previous,x.parent),onSuccess:()=>n.invalidateQueries({queryKey:["google-tasks"]}),onError:()=>s({title:"Move Failed",variant:"destructive"})}),E=J({mutationFn:x=>G.googleTasks.update(x.id,x.listId,x.data),onSuccess:()=>{n.invalidateQueries({queryKey:["google-tasks"]}),c(null)}}),w=J({mutationFn:x=>G.googleTasks.create(x.listId,{title:x.title,status:"needsAction"}),onSuccess:()=>n.invalidateQueries({queryKey:["google-tasks"]})}),N=J({mutationFn:x=>G.googleTasks.delete(x.id,x.listId),onSuccess:()=>n.invalidateQueries({queryKey:["google-tasks"]})}),k=J({mutationFn:x=>G.googleTasks.update(x.id,x.listId,{status:x.status==="completed"?"needsAction":"completed"}),onSuccess:()=>n.invalidateQueries({queryKey:["google-tasks"]})}),R=x=>{const{active:b,over:C}=x;if(i(null),!C)return;const T=e.find(M=>M.id===b.id);if(!T)return;let S=null;if(C.data.current?.listId)S=C.data.current.listId;else if(C.data.current?.type==="Container")S=C.id;else{const M=e.find(F=>F.id===C.id);M&&(S=M.listId)}if(S&&(b.id!==C.id||T.listId!==S)){const M=e.filter(L=>L.listId===S).sort((L,A)=>(L.position||"").localeCompare(A.position||""));let F;if(b.id!==C.id){e.findIndex(A=>A.id===b.id);const L=M.findIndex(A=>A.id===C.id);L!==-1&&L>0&&(F=M[L-1].id)}v.mutate({taskId:T.id,listId:T.listId,destListId:S,previous:F})}};return r.jsxs(to,{sensors:g,collisionDetection:oa,onDragEnd:R,onDragStart:x=>i(x.active.id),children:[r.jsxs("div",{className:"flex h-full items-start justify-center gap-4 pt-4",children:[r.jsx(P,{variant:"ghost",size:"icon",onClick:()=>h(x=>(x-1+t.length)%t.length),className:"h-10 w-10 mt-3 rounded-full border border-white/10 hover:bg-white/10 hover:text-white shrink-0",children:r.jsx(dr,{className:"h-5 w-5"})}),t.length>0&&(()=>{const x=t[d],b=e.filter(C=>C.listId===x.id).sort((C,T)=>(C.position||"").localeCompare(T.position||""));return r.jsx("div",{className:"h-full w-[320px] shrink-0",children:r.jsx(Ko,{listId:x.id,title:x.title,tasks:b,onAddTask:C=>m(C),onEdit:C=>c(C),onToggle:C=>k.mutate(C),onDelete:(C,T)=>{confirm("Delete task?")&&N.mutate({id:C,listId:T})}},x.id)})})(),r.jsx(P,{variant:"ghost",size:"icon",onClick:()=>h(x=>(x+1)%t.length),className:"h-10 w-10 mt-3 rounded-full border border-white/10 hover:bg-white/10 hover:text-white shrink-0",children:r.jsx(Dn,{className:"h-5 w-5"})})]}),r.jsx(wo,{children:a?r.jsx("div",{className:"opacity-80 rotate-2 cursor-grabbing",children:r.jsx("div",{className:"p-2 border bg-card text-primary font-arcade text-xs border-primary",children:e.find(x=>x.id===a)?.title||"Task"})}):null}),r.jsx(sr,{task:l,isOpen:!!l,onClose:()=>c(null),onSave:x=>{l&&E.mutate({id:l.id,listId:l.listId,data:x})},onDelete:(x,b)=>N.mutate({id:x,listId:b}),availableLists:t}),r.jsx(sr,{task:null,isOpen:!!f,isCreating:!0,activeListId:f||void 0,availableLists:t,onClose:()=>m(null),onSave:x=>{f&&x.title&&w.mutate({listId:f,title:x.title,...x})},onDelete:()=>{}})]})}function ri(){const e=En(),{toast:t}=or(),[n,s]=u.useState(new Date),[a,i]=u.useState("month"),[l,c]=u.useState(!1),[d,h]=u.useState(!1),[f,m]=u.useState(null),[g,v]=u.useState({title:"",date:"",endDate:"",startTime:"09:00",endTime:"10:00",allDay:!1,eventType:"study",color:"#ef4444",recurrence:"",calendarId:""}),[E,w]=u.useState(new Set),[N,k]=u.useState(!0),[R,x]=u.useState(""),[b,C]=u.useState(null),[T,S]=u.useState(!1),[M,F]=u.useState(!1),[L,A]=u.useState(!1),Y=typeof window<"u"&&new URLSearchParams(window.location.search).has("debugModals"),[ee,he]=u.useState(()=>{const o=localStorage.getItem("pinnedCalendars");return o?JSON.parse(o):[]}),[ue,Ve]=u.useState(()=>{const o=localStorage.getItem("hiddenCalendars");return o?JSON.parse(o):[]}),[X,ke]=u.useState(!1),[Ee,We]=u.useState(!1);u.useEffect(()=>{d&&!f&&(Y&&console.warn("[ModalDebug][Calendar] Edit modal open without event; closing."),h(!1))},[Y,f,d]),u.useEffect(()=>{T&&!b&&(Y&&console.warn("[ModalDebug][Calendar] Google edit modal open without event; closing."),S(!1))},[Y,b,T]),u.useEffect(()=>{Y&&console.info("[ModalDebug][Calendar] state",{showEditModal:d,selectedEvent:f?.id??null,showGoogleEditModal:T,selectedGoogleEvent:b?.id??null,showCalendarSettings:X,showEventModal:l})},[Y,f,b,X,d,l,T]);const Xe=o=>{Ve(p=>{const y=p.includes(o),j=y?p.filter(D=>D!==o):[...p,o];return localStorage.setItem("hiddenCalendars",JSON.stringify(j)),y||w(D=>{const I=new Set(D);return I.delete(o),I}),j})},te=cn(n),we=on(n),Te=an(te,{weekStartsOn:0}),Ue=$n(we,{weekStartsOn:0}),ce=ln({start:Te,end:Ue}),Re=an(n,{weekStartsOn:0}),ge=ln({start:Re,end:at(Re,6)}),{data:fe=[]}=Fe({queryKey:["events"],queryFn:G.events.getAll}),{data:z=[],isLoading:Me,refetch:oe}=Fe({queryKey:["google-calendar",n.getFullYear(),n.getMonth()],queryFn:async()=>{const o=cn(Yn(n)).toISOString(),p=on(wn(n,1)).toISOString(),y=await fetch(`/api/google-calendar/events?timeMin=${encodeURIComponent(o)}&timeMax=${encodeURIComponent(p)}`);if(!y.ok)throw new Error("Failed to fetch");return y.json()}}),{data:Ie=[]}=Fe({queryKey:["tasks"],queryFn:G.tasks.getAll}),{data:me=[],isLoading:Ye,isError:Ke,refetch:_t}=Fe({queryKey:["google-tasks"],queryFn:G.googleTasks.getAll,retry:1}),{data:St=[]}=Fe({queryKey:["google-task-lists"],queryFn:G.googleTasks.getLists}),{data:Je=[]}=Fe({queryKey:["google-calendar-list"],queryFn:async()=>{const o=await fetch("/api/google-calendar/calendars");if(!o.ok)throw new Error("Failed to fetch calendar list");return o.json()}}),{data:De,refetch:Ze,isLoading:dt,error:Qt}=Fe({queryKey:["google-status"],queryFn:G.google.getStatus,retry:1}),et=J({mutationFn:async()=>{const{authUrl:o}=await G.google.getAuthUrl();window.location.href=o}});J({mutationFn:G.google.disconnect,onSuccess:()=>{Ze(),e.invalidateQueries({queryKey:["google-calendar-events"]}),e.invalidateQueries({queryKey:["google-calendar-list"]}),e.invalidateQueries({queryKey:["google-tasks"]})}});const pe=u.useMemo(()=>Je.map(o=>({id:o.id,name:o.summary,color:o.backgroundColor||"#888888"})),[Je]),Vt=u.useMemo(()=>pe.filter(o=>!ue.includes(o.id)),[pe,ue]);u.useEffect(()=>{if(pe.length>0&&E.size===0){const o=ee.length>0?ee:pe.slice(0,2).map(p=>p.id);w(new Set(o))}},[pe,ee]),u.useEffect(()=>{if(pe.length>0&&ee.length===0&&!localStorage.getItem("pinnedCalendars")){const o=pe.slice(0,2).map(p=>p.id);he(o),localStorage.setItem("pinnedCalendars",JSON.stringify(o))}},[pe,ee]);const Ae=o=>{w(p=>{const y=new Set(p);return y.has(o)?y.delete(o):y.add(o),y})},Oe=J({mutationFn:G.events.create,onSuccess:()=>{e.invalidateQueries({queryKey:["events"]}),g.calendarId&&g.calendarId!=="local"&&(e.invalidateQueries({queryKey:["google-calendar"]}),oe()),c(!1),ut()}}),qe=J({mutationFn:({id:o,data:p})=>G.events.update(o,p),onSuccess:()=>{e.invalidateQueries({queryKey:["events"]}),h(!1),m(null)}}),Tt=J({mutationFn:G.events.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["events"]}),h(!1),m(null)}});J({mutationFn:G.tasks.create,onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}}),J({mutationFn:({id:o,status:p})=>G.tasks.update(o,{status:p==="completed"?"pending":"completed"}),onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}}),J({mutationFn:async o=>{const p=await fetch("/api/google-tasks/@default",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:o})});if(!p.ok)throw new Error("Failed to create task");return p.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-tasks"]})}}),J({mutationFn:async({taskId:o,completed:p})=>{const y=await fetch(`/api/google-tasks/@default/${o}/toggle`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({completed:p})});if(!y.ok)throw new Error("Failed to toggle task");return y.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-tasks"]})}});const xe=J({mutationFn:async({eventId:o,calendarId:p})=>{const y=await fetch(`/api/google-calendar/events/${encodeURIComponent(p)}/${encodeURIComponent(o)}`,{method:"DELETE"});if(!y.ok)throw new Error("Failed to delete event");return y.status===204?null:y.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-calendar"]}),oe(),t({title:"EVENT_DELETED",description:"Event removed from Google Calendar"}),S(!1),C(null)},onError:o=>{t({title:"DELETE_FAILED",description:o.message,variant:"destructive"})}}),Rt=J({mutationFn:async o=>{if(!o.calendarId)throw new Error("Missing calendarId");const p=await fetch(`/api/google-calendar/events/${encodeURIComponent(o.calendarId)}/${encodeURIComponent(o.id)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({summary:o.summary,description:o.description,location:o.location,start:o.start,end:o.end,recurrence:o.recurrence})});if(!p.ok)throw new Error("Failed to update google event");return p.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-calendar"]}),oe(),t({title:"EVENT_UPDATED",description:"Changes synced to Google Calendar"}),S(!1)},onError:o=>{t({title:"SYNC_FAILED",description:o.message,variant:"destructive"})}}),Wt=()=>{b&&b.calendarId&&(b.recurringEventId?confirm("Delete this single occurrence?")&&xe.mutate({eventId:b.id,calendarId:b.calendarId}):b.recurrence&&b.recurrence.length>0?confirm("Delete the ENTIRE series? This cannot be undone.")&&xe.mutate({eventId:b.id,calendarId:b.calendarId}):confirm("Delete this event?")&&xe.mutate({eventId:b.id,calendarId:b.calendarId}))},Xt=()=>{b&&Rt.mutate(b)},ut=()=>{v({title:"",date:"",endDate:"",startTime:"09:00",endTime:"10:00",allDay:!1,eventType:"study",color:"#ef4444",recurrence:"",calendarId:""})},He=o=>{if("summary"in o){const p=o,y=!!p.start?.date&&!p.start?.dateTime,j=p.start?.dateTime||p.start?.date||new Date().toISOString(),D=p.end?.dateTime||p.end?.date||j;return{id:p.id,title:p.summary||"Untitled",start:new Date(j),end:new Date(D),allDay:y,isGoogle:!0,calendarColor:p.calendarColor,calendarName:p.calendarSummary,originalEvent:o}}else{const p=o,y=new Date(p.date),j=p.endDate?new Date(p.endDate):bs(y,1);return{id:p.id,title:p.title,start:y,end:j,allDay:p.allDay||!1,isGoogle:!1,eventType:p.eventType,originalEvent:o}}},Jt=()=>{if(g.title&&g.date){const[o,p]=g.startTime.split(":").map(Number),[y,j]=g.endTime.split(":").map(Number),D=ze(Le(new Date(g.date),o),p);let I=null;if(g.allDay)g.endDate&&(I=at(new Date(g.endDate),1));else{const U=g.endDate||g.date;I=ze(Le(new Date(U),y),j)}Oe.mutate({title:g.title,date:D,endDate:I,allDay:g.allDay,eventType:g.eventType,color:g.color,recurrence:g.recurrence||null,calendarId:g.calendarId||null})}},Ge=(o,p)=>{const y=p??9;v({title:"",date:V(o,"yyyy-MM-dd"),endDate:"",startTime:`${y.toString().padStart(2,"0")}:00`,endTime:`${(y+1).toString().padStart(2,"0")}:00`,allDay:!1,eventType:"study",color:"#ef4444",recurrence:"",calendarId:"local"}),c(!0)},Zt=o=>{o&&(m(o),h(!0))},en=o=>{o&&(C(o),S(!0))},Be=o=>{o.isGoogle?en(o.originalEvent):Zt(o.originalEvent)};u.useMemo(()=>{if(!R.trim())return[];const o=R.toLowerCase(),p=[];return N&&fe.forEach(y=>{y.title.toLowerCase().includes(o)&&p.push(He(y))}),z.forEach(y=>{E.size>0&&y.calendarId&&!E.has(y.calendarId)||y.summary?.toLowerCase().includes(o)&&p.push(He(y))}),p.sort((y,j)=>y.start.getTime()-j.start.getTime())},[R,fe,z,N,E]);const B=(o,p)=>{const y=Le(ze(p,0),0),j=Le(ze(p,59),23);return o.start<=j&&o.end>=y},_=o=>{const p=[];return N&&fe.forEach(y=>{const j=He(y);B(j,o)&&p.push(j)}),z.forEach(y=>{if(E.size>0&&y.calendarId&&!E.has(y.calendarId))return;const j=He(y);B(j,o)&&p.push(j)}),p.sort((y,j)=>y.allDay&&!j.allDay?-1:!y.allDay&&j.allDay?1:y.start.getTime()-j.start.getTime())},ne=o=>{s(a==="month"?o==="prev"?Yn(n):wn(n,1):a==="week"?o==="prev"?Ps(n):hr(n,1):o==="prev"?Ns(n):at(n,1))},Se=()=>s(new Date),re=o=>{s(o),i("day")};Ie.filter(o=>o.status==="pending").length,me.filter(o=>o.status==="needsAction").length;const ie=()=>a==="month"?V(n,"MMMM yyyy").toUpperCase():a==="week"?`${V(Re,"MMM d")} - ${V(at(Re,6),"MMM d, yyyy")}`.toUpperCase():V(n,"EEEE, MMMM d, yyyy").toUpperCase(),se=o=>{const p="backdrop-blur-sm shadow-sm transition-all duration-200 hover:scale-[1.02] hover:z-50 hover:shadow-lg";if(o.isGoogle)return`${p} text-white font-medium border-l-4`;switch(o.eventType){case"study":return`${p} bg-red-500/30 text-white border-l-4 border-red-500`;case"lecture":return`${p} bg-cyan-500/30 text-white border-l-4 border-cyan-500`;case"exam":return`${p} bg-amber-500/30 text-white border-l-4 border-amber-500`;default:return`${p} bg-red-500/30 text-white border-l-4 border-red-500`}},ve=o=>{if(o.isGoogle&&o.calendarColor){const p=o.calendarColor.replace("#",""),y=parseInt(p.substring(0,2),16),j=parseInt(p.substring(2,4),16),D=parseInt(p.substring(4,6),16);return{backgroundColor:`rgba(${y}, ${j}, ${D}, 0.35)`,borderLeftColor:o.calendarColor,boxShadow:"0 4px 6px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.1)"}}return{boxShadow:"0 4px 6px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.1)"}},K=(o,p,y=0,j=1)=>{const D=Pn(o.start,p),I=Pn(o.end,o.start),U=D/60*_e,be=Math.max(I/60*_e,24),ft=j>1?`${100/j}%`:"calc(100% - 4px)",tn=j>1?`${y/j*100}%`:"0",nn={top:`${U}px`,height:`${be}px`,width:ft,left:tn};return o.calendarColor&&(nn.backgroundColor=o.calendarColor,nn.borderLeftColor=o.calendarColor),nn},Ne=o=>{const p=new Map;if(o.length===0)return p;const y=[...o].sort((D,I)=>D.start.getTime()-I.start.getTime()),j=[];for(const D of y){let I=-1;for(let U=0;U<j.length;U++)if(D.start>=j[U]){I=U;break}I===-1?(I=j.length,j.push(D.end)):j[I]=D.end,p.set(D.id,{column:I,totalColumns:1})}for(const D of y){let I=1;for(const be of y)if(D.id!==be.id&&D.start<be.end&&D.end>be.start){const ft=p.get(D.id)?.column||0,tn=p.get(be.id)?.column||0;I=Math.max(I,ft+1,tn+1)}const U=p.get(D.id);U&&p.set(D.id,{...U,totalColumns:I})}return p};return r.jsxs(Xr,{children:[Y&&r.jsxs("div",{className:"fixed bottom-12 right-4 z-[70] bg-black/80 border border-primary text-primary font-terminal text-[10px] px-2 py-1 rounded-none",children:[r.jsx("div",{children:"Calendar modals"}),r.jsxs("div",{children:["Edit event: ",d?"open":"closed"]}),r.jsxs("div",{children:["Selected event: ",f?.id??"none"]}),r.jsxs("div",{children:["Google edit: ",T?"open":"closed"]}),r.jsxs("div",{children:["Google event: ",b?.id??"none"]}),r.jsxs("div",{children:["Manage calendars: ",X?"open":"closed"]}),r.jsxs("div",{children:["Create event: ",l?"open":"closed"]})]}),r.jsx("div",{className:"h-[calc(100vh-80px)]",children:r.jsx("div",{className:"flex flex-col h-full",children:r.jsxs(lr,{className:"bg-black/40 border-2 border-primary rounded-none flex-1 flex flex-col overflow-hidden",children:[r.jsxs(cr,{className:"border-b border-primary/30 p-4 flex flex-row justify-between items-center shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(P,{size:"sm",variant:"outline",className:"rounded-none border-primary text-primary hover:bg-primary hover:text-black font-arcade text-xs",onClick:Se,"data-testid":"button-today",children:"TODAY"}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(P,{size:"icon",variant:"ghost",className:"h-8 w-8 rounded-none hover:bg-primary/20",onClick:()=>ne("prev"),"data-testid":"button-prev",children:r.jsx(dr,{className:"h-4 w-4"})}),r.jsx(P,{size:"icon",variant:"ghost",className:"h-8 w-8 rounded-none hover:bg-primary/20",onClick:()=>ne("next"),"data-testid":"button-next",children:r.jsx(Dn,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{className:"font-arcade text-sm md:text-lg text-primary hover:text-primary/80 flex items-center gap-1 transition-colors",onClick:()=>A(!L),"data-testid":"text-header-title",children:[ie(),r.jsx(Jr,{className:q("w-4 h-4 transition-transform",L&&"rotate-180")})]}),L&&r.jsx("div",{className:"absolute top-full left-0 mt-2 z-50 bg-black border-2 border-primary p-2 shadow-lg",children:r.jsxs("div",{className:"grid grid-cols-7 gap-1 text-center min-w-[200px]",children:[["S","M","T","W","T","F","S"].map((o,p)=>r.jsx("div",{className:"font-arcade text-[8px] text-muted-foreground p-1",children:o},p)),ln({start:an(cn(n),{weekStartsOn:0}),end:$n(on(n),{weekStartsOn:0})}).slice(0,42).map((o,p)=>r.jsx("button",{onClick:()=>{re(o),A(!1)},className:q("font-terminal text-[10px] p-1 hover:bg-primary/20 transition-colors",!Un(o,n)&&"text-muted-foreground/50",Qe(o)&&"bg-primary text-black",ls(o,n)&&!Qe(o)&&"ring-1 ring-primary"),children:V(o,"d")},p))]})})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative hidden md:block",children:[r.jsx(gs,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-muted-foreground"}),r.jsx(ae,{className:"rounded-none bg-black/60 border-secondary pl-7 pr-2 font-terminal text-xs h-8 w-40",placeholder:"Search...",value:R,onChange:o=>x(o.target.value),"data-testid":"input-search-events"})]}),r.jsx(qo,{onClick:()=>F(!0)}),r.jsx(P,{size:"sm",variant:"ghost",className:"rounded-none hover:bg-primary/20",onClick:()=>oe(),disabled:Me,"data-testid":"button-sync",children:r.jsx(zn,{className:q("h-4 w-4",Me&&"animate-spin")})}),r.jsx("div",{className:"flex border border-secondary rounded-none",children:["month","week","day","tasks"].map(o=>r.jsx(P,{size:"sm",variant:a===o?"default":"ghost",className:q("rounded-none font-arcade text-[10px] px-2",a===o?"bg-primary text-black":""),onClick:()=>i(o),"data-testid":`button-${o}-view`,children:o.toUpperCase()},o))}),r.jsxs(P,{size:"sm",className:"rounded-none font-arcade text-xs bg-primary text-black hover:bg-primary/90",onClick:()=>Ge(n),"data-testid":"button-create-event-header",children:[r.jsx(bn,{className:"w-4 h-4 mr-1"})," CREATE"]})]})]}),r.jsxs("div",{className:"px-4 py-1.5 border-b border-primary/20 bg-black/60 flex items-center gap-3 shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-3 overflow-x-auto flex-1 min-w-0",children:[r.jsx("span",{className:"font-arcade text-[10px] text-muted-foreground shrink-0",children:"CALENDARS:"}),r.jsxs("div",{className:"flex items-center gap-1.5 cursor-pointer hover:opacity-80 transition-opacity shrink-0",onClick:()=>k(!N),children:[r.jsx("div",{className:q("w-2.5 h-2.5 rounded-sm",N?"bg-primary":"bg-muted-foreground/30")}),r.jsx("span",{className:q("font-terminal text-xs",N?"text-primary":"text-muted-foreground"),children:"Local"})]}),Vt.map(o=>r.jsxs("div",{className:"flex items-center gap-1.5 cursor-pointer hover:opacity-80 transition-opacity shrink-0",onClick:()=>Ae(o.id),children:[r.jsx("div",{className:"w-2.5 h-2.5 rounded-sm",style:{backgroundColor:E.has(o.id)?o.color:"rgba(100,100,100,0.3)"}}),r.jsx("span",{className:q("font-terminal text-xs truncate max-w-[80px]",E.has(o.id)?"":"text-muted-foreground"),children:o.name})]},o.id)),ue.length>0&&r.jsxs("span",{className:"font-terminal text-[10px] text-muted-foreground shrink-0",children:["+",ue.length," hidden"]})]}),r.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[r.jsx(P,{size:"sm",variant:"ghost",className:"h-6 px-2 rounded-none hover:bg-primary/20 font-arcade text-[9px]",onClick:()=>{Y&&console.info("[ModalDebug][Calendar] MANAGE click"),ke(!0)},children:"MANAGE"}),De?.connected?r.jsxs("div",{className:"flex items-center gap-1 text-green-500",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-current"}),r.jsx("span",{className:"font-terminal text-[10px]",children:"SYNCED"})]}):r.jsx(P,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none border-yellow-500 text-yellow-500 hover:bg-yellow-500/20 font-arcade text-[9px]",onClick:()=>et.mutate(),disabled:et.isPending,children:et.isPending?"CONNECTING...":"CONNECT GOOGLE"})]})]}),r.jsx(mt,{open:X,onOpenChange:ke,modal:!1,children:r.jsxs(pt,{"data-modal":"calendar-manage",className:"bg-black border-2 border-primary rounded-none max-w-md pointer-events-auto translate-y-0 data-[state=open]:animate-none data-[state=closed]:animate-none",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[r.jsx(rn,{children:r.jsx(sn,{className:"font-arcade text-primary",children:"MANAGE CALENDARS"})}),r.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:[r.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:"Toggle calendars to show/hide them in the legend."}),pe.map(o=>r.jsxs("div",{className:q("flex items-center gap-3 p-2 border border-zinc-800 cursor-pointer hover:bg-zinc-900 transition-colors",ue.includes(o.id)&&"opacity-50"),onClick:()=>Xe(o.id),children:[r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:o.color}}),r.jsx("span",{className:"font-terminal text-sm flex-1",children:o.name}),r.jsx("span",{className:q("font-arcade text-[10px] px-2 py-0.5",ue.includes(o.id)?"text-red-500":"text-green-500"),children:ue.includes(o.id)?"HIDDEN":"VISIBLE"})]},o.id))]}),r.jsx(At,{children:r.jsx(P,{variant:"outline",className:"rounded-none border-primary font-arcade text-xs",onClick:()=>ke(!1),children:"CLOSE"})})]})}),r.jsxs(ts,{className:"p-0 flex-1 overflow-hidden flex flex-col",children:[a==="month"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-7 border-b border-zinc-800 bg-zinc-900/80 shrink-0",children:["SUN","MON","TUE","WED","THU","FRI","SAT"].map(o=>r.jsx("div",{className:"p-2 text-center font-arcade text-xs text-zinc-400 border-r border-zinc-800 last:border-r-0",children:o},o))}),r.jsx("div",{className:"grid grid-cols-7 flex-1 overflow-auto",children:ce.map((o,p)=>{const y=_(o),j=Un(o,n),D=Qe(o);return r.jsxs("div",{onClick:()=>re(o),className:q("min-h-[90px] border-r border-b border-zinc-800 p-1.5 cursor-pointer transition-colors hover:bg-zinc-800/50",!j&&"bg-zinc-900/60 text-zinc-600",p%7===6&&"border-r-0"),"data-testid":`day-cell-${V(o,"yyyy-MM-dd")}`,children:[r.jsx("div",{className:q("text-right font-mono text-sm w-6 h-6 flex items-center justify-center ml-auto",D&&"bg-red-500 text-white rounded-full font-bold"),children:V(o,"d")}),r.jsxs("div",{className:"space-y-0.5 mt-1",children:[y.slice(0,3).map((I,U)=>r.jsx("div",{className:q("text-[10px] font-mono truncate px-1.5 py-0.5 rounded cursor-pointer hover:brightness-110",se(I)),style:ve(I),title:I.title,onClick:be=>{be.stopPropagation(),Be(I)},children:I.title},`${I.id}-${U}`)),y.length>3&&r.jsxs("div",{className:"text-[10px] font-mono text-zinc-400 px-1 mt-0.5",children:["+",y.length-3," more"]})]})]},p)})})]}),a==="week"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-8 border-b border-zinc-800 bg-zinc-900/80 shrink-0",children:[r.jsx("div",{className:"p-2 w-16 border-r border-zinc-800"}),ge.map(o=>r.jsxs("div",{className:"p-2 text-center border-r border-zinc-800 last:border-r-0 cursor-pointer hover:bg-zinc-800/50",onClick:()=>re(o),children:[r.jsx("div",{className:"font-arcade text-xs text-zinc-400",children:V(o,"EEE").toUpperCase()}),r.jsx("div",{className:q("font-mono text-lg mt-1 w-8 h-8 flex items-center justify-center mx-auto",Qe(o)&&"bg-red-500 text-white rounded-full font-bold"),children:V(o,"d")})]},o.toISOString()))]}),r.jsxs("div",{className:"grid grid-cols-8 border-b border-zinc-800 bg-zinc-900/60 shrink-0",children:[r.jsx("div",{className:"p-1 w-16 border-r border-zinc-800 text-xs font-mono text-zinc-500 text-right pr-2",children:"ALL DAY"}),ge.map(o=>{const p=_(o).filter(y=>y.allDay);return r.jsx("div",{className:"border-r border-zinc-800 last:border-r-0 p-0.5 min-h-[28px]",children:p.map((y,j)=>r.jsx("div",{className:q("text-[10px] font-mono truncate px-1.5 py-0.5 rounded cursor-pointer hover:brightness-110",se(y)),style:ve(y),onClick:D=>{D.stopPropagation(),Be(y)},children:y.title},j))},`allday-${o.toISOString()}`)})]}),r.jsx(vn,{className:"flex-1",children:r.jsxs("div",{className:"grid grid-cols-8 relative",style:{height:`${24*_e}px`},children:[r.jsx("div",{className:"w-16 border-r border-zinc-800",children:mn.map(o=>r.jsx("div",{className:"border-b border-zinc-800/50 text-right pr-2 font-mono text-[11px] text-zinc-500",style:{height:`${_e}px`},children:o===0?"12 AM":o<12?`${o} AM`:o===12?"12 PM":`${o-12} PM`},o))}),ge.map(o=>{const p=Le(ze(o,0),0),y=_(o).filter(D=>!D.allDay),j=Ne(y);return r.jsxs("div",{className:"relative border-r border-zinc-800/50 last:border-r-0",children:[mn.map(D=>r.jsx("div",{className:"border-b border-zinc-800/30 cursor-pointer hover:bg-zinc-800/30",style:{height:`${_e}px`},onClick:()=>Ge(o,D)},D)),y.map((D,I)=>{const U=j.get(D.id)||{column:0,totalColumns:1},be={...K(D,p,U.column,U.totalColumns),...ve(D)};return r.jsxs("div",{className:q("absolute rounded p-1 cursor-pointer overflow-hidden",se(D)),style:be,onClick:ft=>{ft.stopPropagation(),Be(D)},children:[r.jsx("div",{className:"text-[10px] font-mono font-medium truncate",children:D.title}),r.jsx("div",{className:"text-[9px] opacity-80 font-mono",children:V(D.start,"h:mma")})]},I)})]},o.toISOString())})]})})]}),a==="day"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"p-4 border-b border-zinc-800 bg-zinc-900/80 shrink-0 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-arcade text-xs text-zinc-400",children:V(n,"EEEE").toUpperCase()}),r.jsx("div",{className:q("font-mono text-2xl font-bold",Qe(n)&&"text-red-500"),children:V(n,"d")})]}),r.jsxs(P,{size:"sm",className:"rounded-none font-arcade text-xs bg-red-500 text-white hover:bg-red-600",onClick:()=>Ge(n),"data-testid":"button-create-event",children:[r.jsx(bn,{className:"w-4 h-4 mr-1"})," CREATE"]})]}),(()=>{const o=_(n).filter(p=>p.allDay);return o.length===0?null:r.jsxs("div",{className:"p-3 border-b border-secondary/50 bg-black/40 shrink-0 flex gap-2 flex-wrap items-center",children:[r.jsx("span",{className:"font-mono text-sm text-muted-foreground",children:"ALL DAY:"}),o.map((p,y)=>r.jsx("div",{className:q("text-sm font-mono px-3 py-1 rounded cursor-pointer hover:brightness-110",se(p)),style:ve(p),onClick:j=>{j.stopPropagation(),Be(p)},children:p.title},y))]})})(),r.jsx(vn,{className:"flex-1",children:r.jsxs("div",{className:"relative",style:{height:`${24*_e}px`},children:[mn.map(o=>r.jsxs("div",{className:"flex border-b border-zinc-800/30 cursor-pointer hover:bg-zinc-800/30",style:{height:`${_e}px`},onClick:()=>Ge(n,o),children:[r.jsx("div",{className:"w-20 text-right pr-2 font-mono text-xs text-zinc-500 shrink-0 pt-1",children:o===0?"12 AM":o<12?`${o} AM`:o===12?"12 PM":`${o-12} PM`}),r.jsx("div",{className:"flex-1 border-l border-zinc-800/50"})]},o)),(()=>{const o=_(n).filter(j=>!j.allDay),p=Ne(o),y=Le(ze(n,0),0);return r.jsx("div",{className:"absolute top-0 left-20 right-0",children:o.map((j,D)=>{const I=p.get(j.id)||{column:0,totalColumns:1},U={...K(j,y,I.column,I.totalColumns),...ve(j)};return r.jsxs("div",{className:q("absolute rounded p-2 cursor-pointer",se(j)),style:U,onClick:be=>{be.stopPropagation(),Be(j)},children:[r.jsx("div",{className:"font-bold text-sm font-mono truncate",children:j.title}),r.jsxs("div",{className:"text-xs font-mono opacity-80",children:[V(j.start,"h:mm a")," - ",V(j.end,"h:mm a")]})]},D)})})})()]})})]}),a==="tasks"&&r.jsx("div",{className:"flex-1 overflow-hidden bg-black/40 p-4",children:r.jsx(Go,{tasks:me,taskLists:St})})]})]})})}),r.jsx(mt,{open:l,onOpenChange:c,children:r.jsxs(pt,{"data-modal":"calendar-create",className:"bg-black border-2 border-primary rounded-none max-w-lg max-h-[90vh] overflow-y-auto translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[r.jsx(rn,{children:r.jsx(sn,{className:"font-arcade text-primary",children:"CREATE_EVENT"})}),r.jsxs("div",{className:"space-y-4 py-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"TITLE"}),r.jsx(ae,{className:"rounded-none bg-black border-secondary focus-visible:ring-primary",placeholder:"Event title...",value:g.title,onChange:o=>v({...g,title:o.target.value}),"data-testid":"input-modal-title"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"START DATE"}),r.jsx(ae,{type:"date",className:"rounded-none bg-black border-secondary",value:g.date,onChange:o=>v({...g,date:o.target.value}),"data-testid":"input-modal-date"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"END DATE"}),r.jsx(ae,{type:"date",className:"rounded-none bg-black border-secondary",value:g.endDate,onChange:o=>v({...g,endDate:o.target.value}),placeholder:g.date,"data-testid":"input-modal-end-date"})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(as,{id:"allDay",checked:g.allDay,onCheckedChange:o=>v({...g,allDay:!!o})}),r.jsx(H,{htmlFor:"allDay",className:"font-terminal text-sm",children:"All day"})]}),!g.allDay&&r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"START TIME"}),r.jsx(ae,{type:"time",className:"rounded-none bg-black border-secondary",value:g.startTime,onChange:o=>v({...g,startTime:o.target.value}),"data-testid":"input-modal-start"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"END TIME"}),r.jsx(ae,{type:"time",className:"rounded-none bg-black border-secondary",value:g.endTime,onChange:o=>v({...g,endTime:o.target.value}),"data-testid":"input-modal-end"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"TYPE"}),r.jsxs(tt,{value:g.eventType,onValueChange:o=>v({...g,eventType:o}),children:[r.jsx(nt,{className:"rounded-none bg-black border-secondary","data-testid":"select-event-type",children:r.jsx(rt,{})}),r.jsxs(st,{className:"rounded-none bg-black border-primary",children:[r.jsx(Q,{value:"study",children:"STUDY"}),r.jsx(Q,{value:"lecture",children:"LECTURE"}),r.jsx(Q,{value:"exam",children:"EXAM"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"COLOR"}),r.jsx("div",{className:"flex gap-2 flex-wrap",children:["#ef4444","#f97316","#eab308","#22c55e","#3b82f6","#8b5cf6","#ec4899","#6b7280"].map(o=>r.jsx("button",{type:"button",className:q("w-6 h-6 rounded-sm border-2",g.color===o?"border-white":"border-transparent"),style:{backgroundColor:o},onClick:()=>v({...g,color:o}),"data-testid":`color-${o}`},o))})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"REPEAT"}),r.jsxs(tt,{value:g.recurrence,onValueChange:o=>v({...g,recurrence:o}),children:[r.jsx(nt,{className:"rounded-none bg-black border-secondary","data-testid":"select-recurrence",children:r.jsx(rt,{placeholder:"No repeat"})}),r.jsxs(st,{className:"rounded-none bg-black border-primary",children:[r.jsx(Q,{value:"none",children:"NO REPEAT"}),r.jsx(Q,{value:"daily",children:"DAILY"}),r.jsx(Q,{value:"weekly",children:"WEEKLY"}),r.jsx(Q,{value:"monthly",children:"MONTHLY"}),r.jsx(Q,{value:"yearly",children:"YEARLY"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"CALENDAR"}),r.jsxs(tt,{value:g.calendarId,onValueChange:o=>v({...g,calendarId:o}),children:[r.jsx(nt,{className:"rounded-none bg-black border-secondary","data-testid":"select-calendar",children:r.jsx(rt,{placeholder:"Local"})}),r.jsxs(st,{className:"rounded-none bg-black border-primary",children:[r.jsx(Q,{value:"local",children:"LOCAL"}),pe.map(o=>r.jsx(Q,{value:o.id,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:o.color}}),o.name]})},o.id))]})]})]})]})]}),r.jsxs(At,{children:[r.jsx(P,{variant:"ghost",className:"rounded-none font-arcade text-xs",onClick:()=>c(!1),children:"CANCEL"}),r.jsx(P,{className:"rounded-none font-arcade text-xs bg-primary text-black hover:bg-primary/90",onClick:Jt,disabled:!g.title||!g.date,"data-testid":"button-save-event",children:"SAVE"})]})]})}),r.jsx(mt,{open:d&&!!f,onOpenChange:o=>{h(o),o||m(null)},children:r.jsxs(pt,{"data-modal":"calendar-edit",className:"bg-black border-2 border-primary rounded-none max-w-md translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[r.jsx(rn,{children:r.jsx(sn,{className:"font-arcade text-primary",children:"EDIT_EVENT"})}),f&&r.jsxs("div",{className:"space-y-4 py-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"TITLE"}),r.jsx(ae,{className:"rounded-none bg-black border-secondary focus-visible:ring-primary",value:f.title,onChange:o=>m({...f,title:o.target.value}),"data-testid":"input-edit-title"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"DATE"}),r.jsx(ae,{type:"date",className:"rounded-none bg-black border-secondary",value:V(new Date(f.date),"yyyy-MM-dd"),onChange:o=>{const[p,y]=[new Date(f.date).getHours(),new Date(f.date).getMinutes()];m({...f,date:ze(Le(new Date(o.target.value),p),y)})},"data-testid":"input-edit-date"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"TIME"}),r.jsx(ae,{type:"time",className:"rounded-none bg-black border-secondary",value:V(new Date(f.date),"HH:mm"),onChange:o=>{const[p,y]=o.target.value.split(":").map(Number);m({...f,date:ze(Le(new Date(f.date),p),y)})},"data-testid":"input-edit-time"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"TYPE"}),r.jsxs(tt,{value:f.eventType||"study",onValueChange:o=>m({...f,eventType:o}),children:[r.jsx(nt,{className:"rounded-none bg-black border-secondary","data-testid":"select-edit-type",children:r.jsx(rt,{})}),r.jsxs(st,{className:"rounded-none bg-black border-primary",children:[r.jsx(Q,{value:"study",children:"STUDY"}),r.jsx(Q,{value:"lecture",children:"LECTURE"}),r.jsx(Q,{value:"exam",children:"EXAM"})]})]})]})]}),r.jsxs(At,{className:"flex justify-between",children:[r.jsxs(P,{variant:"ghost",className:"rounded-none font-arcade text-xs text-red-500 hover:text-red-400 hover:bg-red-500/10",onClick:()=>f&&Tt.mutate(f.id),"data-testid":"button-delete-event",children:[r.jsx(xn,{className:"w-4 h-4 mr-1"})," DELETE"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(P,{variant:"ghost",className:"rounded-none font-arcade text-xs",onClick:()=>h(!1),children:"CANCEL"}),r.jsx(P,{className:"rounded-none font-arcade text-xs bg-primary text-black hover:bg-primary/90",onClick:()=>f&&qe.mutate({id:f.id,data:{title:f.title,date:f.date,eventType:f.eventType}}),"data-testid":"button-update-event",children:"UPDATE"})]})]})]})}),r.jsx(mt,{open:T&&!!b,onOpenChange:o=>{S(o),o||C(null)},children:r.jsx(pt,{"data-modal":"calendar-edit-google",className:"font-arcade bg-black border-2 border-green-500 rounded-none max-w-md p-0 overflow-hidden translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:b&&r.jsxs("div",{className:"flex flex-col h-full",children:[r.jsxs("div",{className:"bg-green-500/20 border-b border-green-500 p-4 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),r.jsx("span",{className:"text-green-500 font-bold tracking-wider",children:"EDIT_GOOGLE_EVENT"})]}),b.recurringEventId&&r.jsx(Fn,{variant:"outline",className:"text-[10px] border-green-500 text-green-500",children:"INSTANCE"}),b.recurrence&&r.jsx(Fn,{variant:"outline",className:"text-[10px] border-green-500 text-green-500",children:"SERIES"})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"text-xs text-green-500/80",children:"EVENT_TITLE_"}),r.jsx(ae,{value:b.summary||"",onChange:o=>C({...b,summary:o.target.value}),className:"bg-black border-green-500/50 focus:border-green-500 text-green-500 font-terminal text-lg h-12 rounded-none"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"text-xs text-green-500/80",children:"START_TIME_"}),r.jsx(ae,{type:"datetime-local",value:b.start?.dateTime?.substring(0,16)||b.start?.date+"T00:00"||"",onChange:o=>{const p=o.target.value;C({...b,start:{dateTime:p}})},disabled:!!b.start?.date&&!b.start?.dateTime,className:"bg-black border-green-500/50 text-green-500 font-terminal rounded-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"text-xs text-green-500/80",children:"END_TIME_"}),r.jsx(ae,{type:"datetime-local",value:b.end?.dateTime?.substring(0,16)||b.end?.date+"T00:00"||"",onChange:o=>C({...b,end:{dateTime:o.target.value}}),disabled:!!b.end?.date&&!b.end?.dateTime,className:"bg-black border-green-500/50 text-green-500 font-terminal rounded-none"})]})]}),!b.recurringEventId&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{className:"text-xs text-green-500/80 flex items-center gap-2",children:["RECURRENCE_PATTERN_",r.jsx(zn,{className:"w-3 h-3"})]}),r.jsxs(tt,{value:b.recurrence?.[0]||"none",onValueChange:o=>{C({...b,recurrence:o==="none"?void 0:[o]})},children:[r.jsx(nt,{className:"bg-black border-green-500/50 text-green-500 rounded-none h-8 font-terminal text-xs",children:r.jsx(rt,{placeholder:"No Recurrence"})}),r.jsxs(st,{className:"bg-black border-green-500 text-green-500 font-terminal",children:[r.jsx(Q,{value:"none",children:"None"}),r.jsx(Q,{value:"RRULE:FREQ=DAILY",children:"Daily"}),r.jsx(Q,{value:"RRULE:FREQ=WEEKLY",children:"Weekly"}),r.jsx(Q,{value:"RRULE:FREQ=MONTHLY",children:"Monthly"}),r.jsx(Q,{value:"RRULE:FREQ=YEARLY",children:"Yearly"})]})]}),b.recurrence&&!["RRULE:FREQ=DAILY","RRULE:FREQ=WEEKLY","RRULE:FREQ=MONTHLY","RRULE:FREQ=YEARLY"].includes(b.recurrence[0])&&r.jsx(pn,{value:b.recurrence[0],onChange:o=>C({...b,recurrence:[o.target.value]}),className:"bg-black border-green-500/30 text-green-100/70 text-[10px] font-mono h-12 rounded-none",placeholder:"RRULE:FREQ=WEEKLY;BYDAY=MO,WE"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"text-xs text-green-500/80",children:"DESCRIPTION_"}),r.jsx(pn,{value:b.description||"",onChange:o=>C({...b,description:o.target.value}),className:"bg-black border-green-500/50 text-green-500 font-terminal min-h-[100px] rounded-none resize-none"})]}),r.jsxs("div",{className:"pt-2 flex items-center justify-between gap-4 border-t border-green-500/20 mt-4",children:[r.jsxs(P,{variant:"destructive",size:"sm",onClick:Wt,className:"rounded-none bg-red-900/20 text-red-500 hover:bg-red-900/40 border border-red-900/50 font-arcade text-xs",children:[r.jsx(xn,{className:"w-4 h-4 mr-2"}),"DELETE"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(P,{variant:"ghost",className:"bg-transparent border border-green-500/50 text-green-500 hover:bg-green-500/10 rounded-none font-arcade text-xs",onClick:()=>window.open(b.htmlLink,"_blank"),children:[r.jsx(ps,{className:"w-4 h-4 mr-2"})," OPEN"]}),r.jsx(P,{className:"bg-green-500 text-black hover:bg-green-400 rounded-none font-arcade text-xs px-6",onClick:Xt,children:"SAVE CHANGES"})]})]})]})]})})}),r.jsx(Ho,{isOpen:M,onClose:()=>F(!1)})]})}export{ri as default};
