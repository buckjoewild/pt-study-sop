import{c as Kt,r as d,j as r,b as K,f as ns,R as U,g as gt,h as rs,i as dr,e as ss,P as Dn,k as os,d as as,u as Sn,X as is,a as ur}from"./index-CDeS5KDC.js";import{z as ls,A as cs,B as F,D as mt,c as pt,I as ae,o as xn,S as Je,f as Ze,g as et,h as tt,i as G,p as Lt,T as vn,E as ds,F as fr,u as Le,a as X,k as _,j as bn,L as us,H as fs,d as sn,e as on}from"./select-mLMzr1sc.js";import{C as hr,a as gr,b as hs,d as gs,c as ms}from"./card-CGvdjm45.js";import{C as Tn,B as Yn}from"./badge-BL6JUzmD.js";import{C as ps}from"./checkbox-CLvYNDFE.js";import{c as nt,P as yn,a as Be,b as xs,i as vs,C as mr,d as bs}from"./isTomorrow-Ccm5xIuS.js";import{t as de,c as wn,m as Rn,a as kn,g as ys,i as pr,f as Q,s as an}from"./format-D7m0hUtg.js";import{C as ws}from"./clock-DcJxoxPu.js";import{S as Ns,R as qn}from"./send-BDKKlA1B.js";import{S as Cs}from"./search-cFWbB4bU.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Es=Kt("external-link",js);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Ss=Kt("link",Ds);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Rs=Kt("loader-circle",Ts);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],xr=Kt("text-align-start",ks);function Nn(e,t){const n=de(e);if(isNaN(t))return wn(e,NaN);if(!t)return n;const s=n.getDate(),o=wn(e,n.getTime());o.setMonth(n.getMonth()+t+1,0);const i=o.getDate();return s>=i?o:(n.setFullYear(o.getFullYear(),o.getMonth(),s),n)}function Is(e,t){const n=+de(e);return wn(e,n+t)}function Ms(e,t){return Is(e,t*Rn)}function vr(e,t){const n=t*7;return nt(e,n)}function As(e){return t=>{const n=Math.trunc,s=n(t);return s===0?0:s}}function Os(e,t){return+de(e)-+de(t)}function Kn(e,t,n){const s=Os(e,t)/kn;return As()(s)}function ln(e){const t=de(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function cn(e,t){const n=de(e.start),s=de(e.end);let o=+n>+s;const i=o?+n:+s,l=o?s:n;l.setHours(0,0,0,0);let c=1;const u=[];for(;+l<=i;)u.push(de(l)),l.setDate(l.getDate()+c),l.setHours(0,0,0,0);return o?u.reverse():u}function dn(e){const t=de(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Hn(e,t){const n=ys(),s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,o=de(e),i=o.getDay(),l=(i<s?-7:0)+6-(i-s);return o.setDate(o.getDate()+l),o.setHours(23,59,59,999),o}function _n(e,t){const n=de(e),s=de(t);return n.getFullYear()===s.getFullYear()&&n.getMonth()===s.getMonth()}function Ls(e,t){return nt(e,-1)}function br(e,t){const s=$s(e);let o;if(s.date){const u=Us(s.date,2);o=Ys(u.restDateString,u.year)}if(!o||isNaN(o.getTime()))return new Date(NaN);const i=o.getTime();let l=0,c;if(s.time&&(l=qs(s.time),isNaN(l)))return new Date(NaN);if(s.timezone){if(c=Ks(s.timezone),isNaN(c))return new Date(NaN)}else{const u=new Date(i+l),h=new Date(0);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return new Date(i+l+c)}const Mt={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},zs=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Ps=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Fs=/^([+-])(\d{2})(?::?(\d{2}))?$/;function $s(e){const t={},n=e.split(Mt.dateTimeDelimiter);let s;if(n.length>2)return t;if(/:/.test(n[0])?s=n[0]:(t.date=n[0],s=n[1],Mt.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Mt.timeZoneDelimiter)[0],s=e.substr(t.date.length,e.length))),s){const o=Mt.timezone.exec(s);o?(t.time=s.replace(o[1],""),t.timezone=o[1]):t.time=s}return t}function Us(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=e.match(n);if(!s)return{year:NaN,restDateString:""};const o=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?o:i*100,restDateString:e.slice((s[1]||s[2]).length)}}function Ys(e,t){if(t===null)return new Date(NaN);const n=e.match(zs);if(!n)return new Date(NaN);const s=!!n[4],o=ht(n[1]),i=ht(n[2])-1,l=ht(n[3]),c=ht(n[4]),u=ht(n[5])-1;if(s)return Qs(t,c,u)?Hs(t,c,u):new Date(NaN);{const h=new Date(0);return!Bs(t,i,l)||!Gs(t,o)?new Date(NaN):(h.setUTCFullYear(t,i,Math.max(o,l)),h)}}function ht(e){return e?parseInt(e):1}function qs(e){const t=e.match(Ps);if(!t)return NaN;const n=un(t[1]),s=un(t[2]),o=un(t[3]);return Vs(n,s,o)?n*Rn+s*kn+o*1e3:NaN}function un(e){return e&&parseFloat(e.replace(",","."))||0}function Ks(e){if(e==="Z")return 0;const t=e.match(Fs);if(!t)return 0;const n=t[1]==="+"?-1:1,s=parseInt(t[2]),o=t[3]&&parseInt(t[3])||0;return Ws(s,o)?n*(s*Rn+o*kn):NaN}function Hs(e,t,n){const s=new Date(0);s.setUTCFullYear(e,0,4);const o=s.getUTCDay()||7,i=(t-1)*7+n+1-o;return s.setUTCDate(s.getUTCDate()+i),s}const _s=[31,null,31,30,31,30,31,31,30,31,30,31];function yr(e){return e%400===0||e%4===0&&e%100!==0}function Bs(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(_s[t]||(yr(e)?29:28))}function Gs(e,t){return t>=1&&t<=(yr(e)?366:365)}function Qs(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function Vs(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function Ws(e,t){return t>=0&&t<=59}function Ae(e,t){const n=de(e);return n.setHours(t),n}function Oe(e,t){const n=de(e);return n.setMinutes(t),n}function Bn(e,t){return Nn(e,-1)}function Xs(e,t){return vr(e,-1)}var Js=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Zs=Js.reduce((e,t)=>{const n=ls(`Primitive.${t}`),s=d.forwardRef((o,i)=>{const{asChild:l,...c}=o,u=l?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),r.jsx(u,{...c,ref:i})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),eo="Label",wr=d.forwardRef((e,t)=>r.jsx(Zs.label,{...e,ref:t,onMouseDown:n=>{n.target.closest("button, input, select, textarea")||(e.onMouseDown?.(n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));wr.displayName=eo;var Nr=wr;const to=ns("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),H=d.forwardRef(({className:e,...t},n)=>r.jsx(Nr,{ref:n,className:K(to(),e),...t}));H.displayName=Nr.displayName;function no(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d.useMemo(()=>s=>{t.forEach(o=>o(s))},t)}const Ht=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function st(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function In(e){return"nodeType"in e}function le(e){var t,n;return e?st(e)?e:In(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Mn(e){const{Document:t}=le(e);return e instanceof t}function Ct(e){return st(e)?!1:e instanceof le(e).HTMLElement}function Cr(e){return e instanceof le(e).SVGElement}function ot(e){return e?st(e)?e.document:In(e)?Mn(e)?e:Ct(e)||Cr(e)?e.ownerDocument:document:document:document}const be=Ht?d.useLayoutEffect:d.useEffect;function _t(e){const t=d.useRef(e);return be(()=>{t.current=e}),d.useCallback(function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return t.current==null?void 0:t.current(...s)},[])}function ro(){const e=d.useRef(null),t=d.useCallback((s,o)=>{e.current=setInterval(s,o)},[]),n=d.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function yt(e,t){t===void 0&&(t=[e]);const n=d.useRef(e);return be(()=>{n.current!==e&&(n.current=e)},t),n}function jt(e,t){const n=d.useRef();return d.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function Pt(e){const t=_t(e),n=d.useRef(null),s=d.useCallback(o=>{o!==n.current&&t?.(o,n.current),n.current=o},[]);return[n,s]}function Ft(e){const t=d.useRef();return d.useEffect(()=>{t.current=e},[e]),t.current}let fn={};function Et(e,t){return d.useMemo(()=>{if(t)return t;const n=fn[e]==null?0:fn[e]+1;return fn[e]=n,e+"-"+n},[e,t])}function jr(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return s.reduce((i,l)=>{const c=Object.entries(l);for(const[u,h]of c){const f=i[u];f!=null&&(i[u]=f+e*h)}return i},{...t})}}const rt=jr(1),wt=jr(-1);function so(e){return"clientX"in e&&"clientY"in e}function Bt(e){if(!e)return!1;const{KeyboardEvent:t}=le(e.target);return t&&e instanceof t}function oo(e){if(!e)return!1;const{TouchEvent:t}=le(e.target);return t&&e instanceof t}function $t(e){if(oo(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return so(e)?{x:e.clientX,y:e.clientY}:null}const Pe=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Pe.Translate.toString(e),Pe.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),Gn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ao(e){return e.matches(Gn)?e:e.querySelector(Gn)}const io={display:"none"};function lo(e){let{id:t,value:n}=e;return U.createElement("div",{id:t,style:io},n)}function co(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return U.createElement("div",{id:t,style:o,role:"status","aria-live":s,"aria-atomic":!0},n)}function uo(){const[e,t]=d.useState("");return{announce:d.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const Er=d.createContext(null);function fo(e){const t=d.useContext(Er);d.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function ho(){const[e]=d.useState(()=>new Set),t=d.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[d.useCallback(s=>{let{type:o,event:i}=s;e.forEach(l=>{var c;return(c=l[o])==null?void 0:c.call(l,i)})},[e]),t]}const go={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},mo={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function po(e){let{announcements:t=mo,container:n,hiddenTextDescribedById:s,screenReaderInstructions:o=go}=e;const{announce:i,announcement:l}=uo(),c=Et("DndLiveRegion"),[u,h]=d.useState(!1);if(d.useEffect(()=>{h(!0)},[]),fo(d.useMemo(()=>({onDragStart(g){let{active:m}=g;i(t.onDragStart({active:m}))},onDragMove(g){let{active:m,over:v}=g;t.onDragMove&&i(t.onDragMove({active:m,over:v}))},onDragOver(g){let{active:m,over:v}=g;i(t.onDragOver({active:m,over:v}))},onDragEnd(g){let{active:m,over:v}=g;i(t.onDragEnd({active:m,over:v}))},onDragCancel(g){let{active:m,over:v}=g;i(t.onDragCancel({active:m,over:v}))}}),[i,t])),!u)return null;const f=U.createElement(U.Fragment,null,U.createElement(lo,{id:s,value:o.draggable}),U.createElement(co,{id:c,announcement:l}));return n?gt.createPortal(f,n):f}var V;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(V||(V={}));function Ut(){}function Qn(e,t){return d.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function xo(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const ye=Object.freeze({x:0,y:0});function Dr(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function vo(e,t){const n=$t(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function Sr(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function bo(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function Vn(e){let{left:t,top:n,height:s,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+s},{x:t+o,y:n+s}]}function Tr(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Wn(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const yo=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const o=Wn(t,t.left,t.top),i=[];for(const l of s){const{id:c}=l,u=n.get(c);if(u){const h=Dr(Wn(u),o);i.push({id:c,data:{droppableContainer:l,value:h}})}}return i.sort(Sr)},wo=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const o=Vn(t),i=[];for(const l of s){const{id:c}=l,u=n.get(c);if(u){const h=Vn(u),f=o.reduce((m,v,D)=>m+Dr(h[D],v),0),g=Number((f/4).toFixed(4));i.push({id:c,data:{droppableContainer:l,value:g}})}}return i.sort(Sr)};function No(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),l=o-s,c=i-n;if(s<o&&n<i){const u=t.width*t.height,h=e.width*e.height,f=l*c,g=f/(u+h-f);return Number(g.toFixed(4))}return 0}const Co=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const o=[];for(const i of s){const{id:l}=i,c=n.get(l);if(c){const u=No(c,t);u>0&&o.push({id:l,data:{droppableContainer:i,value:u}})}}return o.sort(bo)};function jo(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Rr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ye}function Eo(e){return function(n){for(var s=arguments.length,o=new Array(s>1?s-1:0),i=1;i<s;i++)o[i-1]=arguments[i];return o.reduce((l,c)=>({...l,top:l.top+e*c.y,bottom:l.bottom+e*c.y,left:l.left+e*c.x,right:l.right+e*c.x}),{...n})}}const Do=Eo(1);function kr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function So(e,t,n){const s=kr(t);if(!s)return e;const{scaleX:o,scaleY:i,x:l,y:c}=s,u=e.left-l-(1-o)*parseFloat(n),h=e.top-c-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),f=o?e.width/o:e.width,g=i?e.height/i:e.height;return{width:f,height:g,top:h,right:u+f,bottom:h+g,left:u}}const To={ignoreTransform:!1};function at(e,t){t===void 0&&(t=To);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:h,transformOrigin:f}=le(e).getComputedStyle(e);h&&(n=So(n,h,f))}const{top:s,left:o,width:i,height:l,bottom:c,right:u}=n;return{top:s,left:o,width:i,height:l,bottom:c,right:u}}function Xn(e){return at(e,{ignoreTransform:!0})}function Ro(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function ko(e,t){return t===void 0&&(t=le(e).getComputedStyle(e)),t.position==="fixed"}function Io(e,t){t===void 0&&(t=le(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=t[o];return typeof i=="string"?n.test(i):!1})}function Gt(e,t){const n=[];function s(o){if(t!=null&&n.length>=t||!o)return n;if(Mn(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!Ct(o)||Cr(o)||n.includes(o))return n;const i=le(e).getComputedStyle(o);return o!==e&&Io(o,i)&&n.push(o),ko(o,i)?n:s(o.parentNode)}return e?s(e):n}function Ir(e){const[t]=Gt(e,1);return t??null}function hn(e){return!Ht||!e?null:st(e)?e:In(e)?Mn(e)||e===ot(e).scrollingElement?window:Ct(e)?e:null:null}function Mr(e){return st(e)?e.scrollX:e.scrollLeft}function Ar(e){return st(e)?e.scrollY:e.scrollTop}function Cn(e){return{x:Mr(e),y:Ar(e)}}var J;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(J||(J={}));function Or(e){return!Ht||!e?!1:e===document.scrollingElement}function Lr(e){const t={x:0,y:0},n=Or(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,l=e.scrollTop>=s.y,c=e.scrollLeft>=s.x;return{isTop:o,isLeft:i,isBottom:l,isRight:c,maxScroll:s,minScroll:t}}const Mo={x:.2,y:.2};function Ao(e,t,n,s,o){let{top:i,left:l,right:c,bottom:u}=n;s===void 0&&(s=10),o===void 0&&(o=Mo);const{isTop:h,isBottom:f,isLeft:g,isRight:m}=Lr(e),v={x:0,y:0},D={x:0,y:0},y={height:t.height*o.y,width:t.width*o.x};return!h&&i<=t.top+y.height?(v.y=J.Backward,D.y=s*Math.abs((t.top+y.height-i)/y.height)):!f&&u>=t.bottom-y.height&&(v.y=J.Forward,D.y=s*Math.abs((t.bottom-y.height-u)/y.height)),!m&&c>=t.right-y.width?(v.x=J.Forward,D.x=s*Math.abs((t.right-y.width-c)/y.width)):!g&&l<=t.left+y.width&&(v.x=J.Backward,D.x=s*Math.abs((t.left+y.width-l)/y.width)),{direction:v,speed:D}}function Oo(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:l}=window;return{top:0,left:0,right:i,bottom:l,width:i,height:l}}const{top:t,left:n,right:s,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:o,width:e.clientWidth,height:e.clientHeight}}function zr(e){return e.reduce((t,n)=>rt(t,Cn(n)),ye)}function Lo(e){return e.reduce((t,n)=>t+Mr(n),0)}function zo(e){return e.reduce((t,n)=>t+Ar(n),0)}function Pr(e,t){if(t===void 0&&(t=at),!e)return;const{top:n,left:s,bottom:o,right:i}=t(e);Ir(e)&&(o<=0||i<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Po=[["x",["left","right"],Lo],["y",["top","bottom"],zo]];class An{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=Gt(n),o=zr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,l,c]of Po)for(const u of l)Object.defineProperty(this,u,{get:()=>{const h=c(s),f=o[i]-h;return this.rect[u]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class xt{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var o;(o=this.target)==null||o.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function Fo(e){const{EventTarget:t}=le(e);return e instanceof t?e:ot(e)}function gn(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var xe;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(xe||(xe={}));function Jn(e){e.preventDefault()}function $o(e){e.stopPropagation()}var O;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(O||(O={}));const Fr={start:[O.Space,O.Enter],cancel:[O.Esc],end:[O.Space,O.Enter,O.Tab]},Uo=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case O.Right:return{...n,x:n.x+25};case O.Left:return{...n,x:n.x-25};case O.Down:return{...n,y:n.y+25};case O.Up:return{...n,y:n.y-25}}};class On{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new xt(ot(n)),this.windowListeners=new xt(le(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(xe.Resize,this.handleCancel),this.windowListeners.add(xe.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(xe.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&Pr(s),n(ye)}handleKeyDown(t){if(Bt(t)){const{active:n,context:s,options:o}=this.props,{keyboardCodes:i=Fr,coordinateGetter:l=Uo,scrollBehavior:c="smooth"}=o,{code:u}=t;if(i.end.includes(u)){this.handleEnd(t);return}if(i.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:h}=s.current,f=h?{x:h.left,y:h.top}:ye;this.referenceCoordinates||(this.referenceCoordinates=f);const g=l(t,{active:n,context:s.current,currentCoordinates:f});if(g){const m=wt(g,f),v={x:0,y:0},{scrollableAncestors:D}=s.current;for(const y of D){const N=t.code,{isTop:S,isRight:E,isLeft:x,isBottom:w,maxScroll:C,minScroll:I}=Lr(y),T=Oo(y),k={x:Math.min(N===O.Right?T.right-T.width/2:T.right,Math.max(N===O.Right?T.left:T.left+T.width/2,g.x)),y:Math.min(N===O.Down?T.bottom-T.height/2:T.bottom,Math.max(N===O.Down?T.top:T.top+T.height/2,g.y))},z=N===O.Right&&!E||N===O.Left&&!x,L=N===O.Down&&!w||N===O.Up&&!S;if(z&&k.x!==g.x){const A=y.scrollLeft+m.x,Z=N===O.Right&&A<=C.x||N===O.Left&&A>=I.x;if(Z&&!m.y){y.scrollTo({left:A,behavior:c});return}Z?v.x=y.scrollLeft-A:v.x=N===O.Right?y.scrollLeft-C.x:y.scrollLeft-I.x,v.x&&y.scrollBy({left:-v.x,behavior:c});break}else if(L&&k.y!==g.y){const A=y.scrollTop+m.y,Z=N===O.Down&&A<=C.y||N===O.Up&&A>=I.y;if(Z&&!m.x){y.scrollTo({top:A,behavior:c});return}Z?v.y=y.scrollTop-A:v.y=N===O.Down?y.scrollTop-C.y:y.scrollTop-I.y,v.y&&y.scrollBy({top:-v.y,behavior:c});break}}this.handleMove(t,rt(wt(g,this.referenceCoordinates),v))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}On.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=Fr,onActivation:o}=t,{active:i}=n;const{code:l}=e.nativeEvent;if(s.start.includes(l)){const c=i.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),o?.({event:e.nativeEvent}),!0)}return!1}}];function Zn(e){return!!(e&&"distance"in e)}function er(e){return!!(e&&"delay"in e)}class Ln{constructor(t,n,s){var o;s===void 0&&(s=Fo(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:l}=i;this.props=t,this.events=n,this.document=ot(l),this.documentListeners=new xt(this.document),this.listeners=new xt(s),this.windowListeners=new xt(le(l)),this.initialCoordinates=(o=$t(i))!=null?o:ye,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(xe.Resize,this.handleCancel),this.windowListeners.add(xe.DragStart,Jn),this.windowListeners.add(xe.VisibilityChange,this.handleCancel),this.windowListeners.add(xe.ContextMenu,Jn),this.documentListeners.add(xe.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(er(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Zn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:o}=this.props;o(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(xe.Click,$o,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(xe.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:o,props:i}=this,{onMove:l,options:{activationConstraint:c}}=i;if(!o)return;const u=(n=$t(t))!=null?n:ye,h=wt(o,u);if(!s&&c){if(Zn(c)){if(c.tolerance!=null&&gn(h,c.tolerance))return this.handleCancel();if(gn(h,c.distance))return this.handleStart()}if(er(c)&&gn(h,c.tolerance))return this.handleCancel();this.handlePending(c,h);return}t.cancelable&&t.preventDefault(),l(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===O.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Yo={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class zn extends Ln{constructor(t){const{event:n}=t,s=ot(n.target);super(t,Yo,s)}}zn.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s?.({event:n}),!0)}}];const qo={move:{name:"mousemove"},end:{name:"mouseup"}};var jn;(function(e){e[e.RightClick=2]="RightClick"})(jn||(jn={}));class Ko extends Ln{constructor(t){super(t,qo,ot(t.event.target))}}Ko.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===jn.RightClick?!1:(s?.({event:n}),!0)}}];const mn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Ho extends Ln{constructor(t){super(t,mn)}static setup(){return window.addEventListener(mn.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(mn.move.name,t)};function t(){}}}Ho.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:o}=n;return o.length>1?!1:(s?.({event:n}),!0)}}];var vt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(vt||(vt={}));var Yt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Yt||(Yt={}));function _o(e){let{acceleration:t,activator:n=vt.Pointer,canScroll:s,draggingRect:o,enabled:i,interval:l=5,order:c=Yt.TreeOrder,pointerCoordinates:u,scrollableAncestors:h,scrollableAncestorRects:f,delta:g,threshold:m}=e;const v=Go({delta:g,disabled:!i}),[D,y]=ro(),N=d.useRef({x:0,y:0}),S=d.useRef({x:0,y:0}),E=d.useMemo(()=>{switch(n){case vt.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case vt.DraggableRect:return o}},[n,o,u]),x=d.useRef(null),w=d.useCallback(()=>{const I=x.current;if(!I)return;const T=N.current.x*S.current.x,k=N.current.y*S.current.y;I.scrollBy(T,k)},[]),C=d.useMemo(()=>c===Yt.TreeOrder?[...h].reverse():h,[c,h]);d.useEffect(()=>{if(!i||!h.length||!E){y();return}for(const I of C){if(s?.(I)===!1)continue;const T=h.indexOf(I),k=f[T];if(!k)continue;const{direction:z,speed:L}=Ao(I,k,E,t,m);for(const A of["x","y"])v[A][z[A]]||(L[A]=0,z[A]=0);if(L.x>0||L.y>0){y(),x.current=I,D(w,l),N.current=L,S.current=z;return}}N.current={x:0,y:0},S.current={x:0,y:0},y()},[t,w,s,y,i,l,JSON.stringify(E),JSON.stringify(v),D,h,C,f,JSON.stringify(m)])}const Bo={x:{[J.Backward]:!1,[J.Forward]:!1},y:{[J.Backward]:!1,[J.Forward]:!1}};function Go(e){let{delta:t,disabled:n}=e;const s=Ft(t);return jt(o=>{if(n||!s||!o)return Bo;const i={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[J.Backward]:o.x[J.Backward]||i.x===-1,[J.Forward]:o.x[J.Forward]||i.x===1},y:{[J.Backward]:o.y[J.Backward]||i.y===-1,[J.Forward]:o.y[J.Forward]||i.y===1}}},[n,t,s])}function Qo(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return jt(o=>{var i;return t==null?null:(i=s??o)!=null?i:null},[s,t])}function Vo(e,t){return d.useMemo(()=>e.reduce((n,s)=>{const{sensor:o}=s,i=o.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,s)}));return[...n,...i]},[]),[e,t])}var Nt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Nt||(Nt={}));var En;(function(e){e.Optimized="optimized"})(En||(En={}));const tr=new Map;function Wo(e,t){let{dragging:n,dependencies:s,config:o}=t;const[i,l]=d.useState(null),{frequency:c,measure:u,strategy:h}=o,f=d.useRef(e),g=N(),m=yt(g),v=d.useCallback(function(S){S===void 0&&(S=[]),!m.current&&l(E=>E===null?S:E.concat(S.filter(x=>!E.includes(x))))},[m]),D=d.useRef(null),y=jt(S=>{if(g&&!n)return tr;if(!S||S===tr||f.current!==e||i!=null){const E=new Map;for(let x of e){if(!x)continue;if(i&&i.length>0&&!i.includes(x.id)&&x.rect.current){E.set(x.id,x.rect.current);continue}const w=x.node.current,C=w?new An(u(w),w):null;x.rect.current=C,C&&E.set(x.id,C)}return E}return S},[e,i,n,g,u]);return d.useEffect(()=>{f.current=e},[e]),d.useEffect(()=>{g||v()},[n,g]),d.useEffect(()=>{i&&i.length>0&&l(null)},[JSON.stringify(i)]),d.useEffect(()=>{g||typeof c!="number"||D.current!==null||(D.current=setTimeout(()=>{v(),D.current=null},c))},[c,g,v,...s]),{droppableRects:y,measureDroppableContainers:v,measuringScheduled:i!=null};function N(){switch(h){case Nt.Always:return!1;case Nt.BeforeDragging:return n;default:return!n}}}function Pn(e,t){return jt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Xo(e,t){return Pn(e,t)}function Jo(e){let{callback:t,disabled:n}=e;const s=_t(t),o=d.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(s)},[s,n]);return d.useEffect(()=>()=>o?.disconnect(),[o]),o}function Qt(e){let{callback:t,disabled:n}=e;const s=_t(t),o=d.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(s)},[n]);return d.useEffect(()=>()=>o?.disconnect(),[o]),o}function Zo(e){return new An(at(e),e)}function nr(e,t,n){t===void 0&&(t=Zo);const[s,o]=d.useState(null);function i(){o(u=>{if(!e)return null;if(e.isConnected===!1){var h;return(h=u??n)!=null?h:null}const f=t(e);return JSON.stringify(u)===JSON.stringify(f)?u:f})}const l=Jo({callback(u){if(e)for(const h of u){const{type:f,target:g}=h;if(f==="childList"&&g instanceof HTMLElement&&g.contains(e)){i();break}}}}),c=Qt({callback:i});return be(()=>{i(),e?(c?.observe(e),l?.observe(document.body,{childList:!0,subtree:!0})):(c?.disconnect(),l?.disconnect())},[e]),s}function ea(e){const t=Pn(e);return Rr(e,t)}const rr=[];function ta(e){const t=d.useRef(e),n=jt(s=>e?s&&s!==rr&&e&&t.current&&e.parentNode===t.current.parentNode?s:Gt(e):rr,[e]);return d.useEffect(()=>{t.current=e},[e]),n}function na(e){const[t,n]=d.useState(null),s=d.useRef(e),o=d.useCallback(i=>{const l=hn(i.target);l&&n(c=>c?(c.set(l,Cn(l)),new Map(c)):null)},[]);return d.useEffect(()=>{const i=s.current;if(e!==i){l(i);const c=e.map(u=>{const h=hn(u);return h?(h.addEventListener("scroll",o,{passive:!0}),[h,Cn(h)]):null}).filter(u=>u!=null);n(c.length?new Map(c):null),s.current=e}return()=>{l(e),l(i)};function l(c){c.forEach(u=>{const h=hn(u);h?.removeEventListener("scroll",o)})}},[o,e]),d.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,l)=>rt(i,l),ye):zr(e):ye,[e,t])}function sr(e,t){t===void 0&&(t=[]);const n=d.useRef(null);return d.useEffect(()=>{n.current=null},t),d.useEffect(()=>{const s=e!==ye;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?wt(e,n.current):ye}function ra(e){d.useEffect(()=>{if(!Ht)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function sa(e,t){return d.useMemo(()=>e.reduce((n,s)=>{let{eventName:o,handler:i}=s;return n[o]=l=>{i(l,t)},n},{}),[e,t])}function $r(e){return d.useMemo(()=>e?Ro(e):null,[e])}const or=[];function oa(e,t){t===void 0&&(t=at);const[n]=e,s=$r(n?le(n):null),[o,i]=d.useState(or);function l(){i(()=>e.length?e.map(u=>Or(u)?s:new An(t(u),u)):or)}const c=Qt({callback:l});return be(()=>{c?.disconnect(),l(),e.forEach(u=>c?.observe(u))},[e]),o}function Ur(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ct(t)?t:e}function aa(e){let{measure:t}=e;const[n,s]=d.useState(null),o=d.useCallback(h=>{for(const{target:f}of h)if(Ct(f)){s(g=>{const m=t(f);return g?{...g,width:m.width,height:m.height}:m});break}},[t]),i=Qt({callback:o}),l=d.useCallback(h=>{const f=Ur(h);i?.disconnect(),f&&i?.observe(f),s(f?t(f):null)},[t,i]),[c,u]=Pt(l);return d.useMemo(()=>({nodeRef:c,rect:n,setRef:u}),[n,c,u])}const ia=[{sensor:zn,options:{}},{sensor:On,options:{}}],la={current:{}},zt={draggable:{measure:Xn},droppable:{measure:Xn,strategy:Nt.WhileDragging,frequency:En.Optimized},dragOverlay:{measure:at}};class bt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const ca={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new bt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ut},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:zt,measureDroppableContainers:Ut,windowRect:null,measuringScheduled:!1},Yr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ut,draggableNodes:new Map,over:null,measureDroppableContainers:Ut},Dt=d.createContext(Yr),qr=d.createContext(ca);function da(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new bt}}}function ua(e,t){switch(t.type){case V.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case V.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case V.DragEnd:case V.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case V.RegisterDroppable:{const{element:n}=t,{id:s}=n,o=new bt(e.droppable.containers);return o.set(s,n),{...e,droppable:{...e.droppable,containers:o}}}case V.SetDroppableDisabled:{const{id:n,key:s,disabled:o}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const l=new bt(e.droppable.containers);return l.set(n,{...i,disabled:o}),{...e,droppable:{...e.droppable,containers:l}}}case V.UnregisterDroppable:{const{id:n,key:s}=t,o=e.droppable.containers.get(n);if(!o||s!==o.key)return e;const i=new bt(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function fa(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:o}=d.useContext(Dt),i=Ft(s),l=Ft(n?.id);return d.useEffect(()=>{if(!t&&!s&&i&&l!=null){if(!Bt(i)||document.activeElement===i.target)return;const c=o.get(l);if(!c)return;const{activatorNode:u,node:h}=c;if(!u.current&&!h.current)return;requestAnimationFrame(()=>{for(const f of[u.current,h.current]){if(!f)continue;const g=ao(f);if(g){g.focus();break}}})}},[s,t,o,l,i]),null}function Kr(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((o,i)=>i({transform:o,...s}),n):n}function ha(e){return d.useMemo(()=>({draggable:{...zt.draggable,...e?.draggable},droppable:{...zt.droppable,...e?.droppable},dragOverlay:{...zt.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function ga(e){let{activeNode:t,measure:n,initialRect:s,config:o=!0}=e;const i=d.useRef(!1),{x:l,y:c}=typeof o=="boolean"?{x:o,y:o}:o;be(()=>{if(!l&&!c||!t){i.current=!1;return}if(i.current||!s)return;const h=t?.node.current;if(!h||h.isConnected===!1)return;const f=n(h),g=Rr(f,s);if(l||(g.x=0),c||(g.y=0),i.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const m=Ir(h);m&&m.scrollBy({top:g.y,left:g.x})}},[t,l,c,s,n])}const Vt=d.createContext({...ye,scaleX:1,scaleY:1});var ze;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ze||(ze={}));const ma=d.memo(function(t){var n,s,o,i;let{id:l,accessibility:c,autoScroll:u=!0,children:h,sensors:f=ia,collisionDetection:g=Co,measuring:m,modifiers:v,...D}=t;const y=d.useReducer(ua,void 0,da),[N,S]=y,[E,x]=ho(),[w,C]=d.useState(ze.Uninitialized),I=w===ze.Initialized,{draggable:{active:T,nodes:k,translate:z},droppable:{containers:L}}=N,A=T!=null?k.get(T):null,Z=d.useRef({initial:null,translated:null}),ue=d.useMemo(()=>{var Y;return T!=null?{id:T,data:(Y=A?.data)!=null?Y:la,rect:Z}:null},[T,A]),W=d.useRef(null),[Fe,Ge]=d.useState(null),[ee,it]=d.useState(null),we=yt(D,Object.values(D)),$e=Et("DndDescribedBy",l),Qe=d.useMemo(()=>L.getEnabled(),[L]),ne=ha(m),{droppableRects:ve,measureDroppableContainers:De,measuringScheduled:Ue}=Wo(Qe,{dragging:I,dependencies:[z.x,z.y],config:ne.droppable}),te=Qo(k,T),Re=d.useMemo(()=>ee?$t(ee):null,[ee]),ge=It(),fe=Xo(te,ne.draggable.measure);ga({activeNode:T!=null?k.get(T):null,config:ge.layoutShiftCompensation,initialRect:fe,measure:ne.draggable.measure});const P=nr(te,ne.draggable.measure,fe),Ne=nr(te?te.parentElement:null),me=d.useRef({activatorEvent:null,active:null,activeNode:te,collisionRect:null,collisions:null,droppableRects:ve,draggableNodes:k,draggingNode:null,draggingNodeRect:null,droppableContainers:L,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Se=L.getNodeFor((n=me.current.over)==null?void 0:n.id),Ce=aa({measure:ne.dragOverlay.measure}),Ye=(s=Ce.nodeRef.current)!=null?s:te,qe=I?(o=Ce.rect)!=null?o:P:null,St=!!(Ce.nodeRef.current&&Ce.rect),lt=ea(St?null:P),ct=$r(Ye?le(Ye):null),je=ta(I?Se??te:null),dt=oa(je),ut=Kr(v,{transform:{x:z.x-lt.x,y:z.y-lt.y,scaleX:1,scaleY:1},activatorEvent:ee,active:ue,activeNodeRect:P,containerNodeRect:Ne,draggingNodeRect:qe,over:me.current.over,overlayNodeRect:Ce.rect,scrollableAncestors:je,scrollableAncestorRects:dt,windowRect:ct}),Ve=Re?rt(Re,z):null,he=na(je),Xt=sr(he),Jt=sr(he,[P]),ke=rt(ut,Xt),Ie=qe?Do(qe,ut):null,Ke=ue&&Ie?g({active:ue,collisionRect:Ie,droppableRects:ve,droppableContainers:Qe,pointerCoordinates:Ve}):null,We=Tr(Ke,"id"),[Ee,Tt]=d.useState(null),Zt=St?ut:rt(ut,Jt),en=jo(Zt,(i=Ee?.rect)!=null?i:null,P),Me=d.useRef(null),Rt=d.useCallback((Y,re)=>{let{sensor:ie,options:pe}=re;if(W.current==null)return;const ce=k.get(W.current);if(!ce)return;const B=Y.nativeEvent,se=new ie({active:W.current,activeNode:ce,event:B,options:pe,context:me,onAbort(q){if(!k.get(q))return;const{onDragAbort:p}=we.current,b={id:q};p?.(b),E({type:"onDragAbort",event:b})},onPending(q,a,p,b){if(!k.get(q))return;const{onDragPending:R}=we.current,M={id:q,constraint:a,initialCoordinates:p,offset:b};R?.(M),E({type:"onDragPending",event:M})},onStart(q){const a=W.current;if(a==null)return;const p=k.get(a);if(!p)return;const{onDragStart:b}=we.current,j={activatorEvent:B,active:{id:a,data:p.data,rect:Z}};gt.unstable_batchedUpdates(()=>{b?.(j),C(ze.Initializing),S({type:V.DragStart,initialCoordinates:q,active:a}),E({type:"onDragStart",event:j}),Ge(Me.current),it(B)})},onMove(q){S({type:V.DragMove,coordinates:q})},onEnd:Te(V.DragEnd),onCancel:Te(V.DragCancel)});Me.current=se;function Te(q){return async function(){const{active:p,collisions:b,over:j,scrollAdjustedTranslate:R}=me.current;let M=null;if(p&&R){const{cancelDrop:$}=we.current;M={activatorEvent:B,active:p,collisions:b,delta:R,over:j},q===V.DragEnd&&typeof $=="function"&&await Promise.resolve($(M))&&(q=V.DragCancel)}W.current=null,gt.unstable_batchedUpdates(()=>{S({type:q}),C(ze.Uninitialized),Tt(null),Ge(null),it(null),Me.current=null;const $=q===V.DragEnd?"onDragEnd":"onDragCancel";if(M){const oe=we.current[$];oe?.(M),E({type:$,event:M})}})}}},[k]),Xe=d.useCallback((Y,re)=>(ie,pe)=>{const ce=ie.nativeEvent,B=k.get(pe);if(W.current!==null||!B||ce.dndKit||ce.defaultPrevented)return;const se={active:B};Y(ie,re.options,se)===!0&&(ce.dndKit={capturedBy:re.sensor},W.current=pe,Rt(ie,re))},[k,Rt]),kt=Vo(f,Xe);ra(f),be(()=>{P&&w===ze.Initializing&&C(ze.Initialized)},[P,w]),d.useEffect(()=>{const{onDragMove:Y}=we.current,{active:re,activatorEvent:ie,collisions:pe,over:ce}=me.current;if(!re||!ie)return;const B={active:re,activatorEvent:ie,collisions:pe,delta:{x:ke.x,y:ke.y},over:ce};gt.unstable_batchedUpdates(()=>{Y?.(B),E({type:"onDragMove",event:B})})},[ke.x,ke.y]),d.useEffect(()=>{const{active:Y,activatorEvent:re,collisions:ie,droppableContainers:pe,scrollAdjustedTranslate:ce}=me.current;if(!Y||W.current==null||!re||!ce)return;const{onDragOver:B}=we.current,se=pe.get(We),Te=se&&se.rect.current?{id:se.id,rect:se.rect.current,data:se.data,disabled:se.disabled}:null,q={active:Y,activatorEvent:re,collisions:ie,delta:{x:ce.x,y:ce.y},over:Te};gt.unstable_batchedUpdates(()=>{Tt(Te),B?.(q),E({type:"onDragOver",event:q})})},[We]),be(()=>{me.current={activatorEvent:ee,active:ue,activeNode:te,collisionRect:Ie,collisions:Ke,droppableRects:ve,draggableNodes:k,draggingNode:Ye,draggingNodeRect:qe,droppableContainers:L,over:Ee,scrollableAncestors:je,scrollAdjustedTranslate:ke},Z.current={initial:qe,translated:Ie}},[ue,te,Ke,Ie,k,Ye,qe,ve,L,Ee,je,ke]),_o({...ge,delta:z,draggingRect:Ie,pointerCoordinates:Ve,scrollableAncestors:je,scrollableAncestorRects:dt});const tn=d.useMemo(()=>({active:ue,activeNode:te,activeNodeRect:P,activatorEvent:ee,collisions:Ke,containerNodeRect:Ne,dragOverlay:Ce,draggableNodes:k,droppableContainers:L,droppableRects:ve,over:Ee,measureDroppableContainers:De,scrollableAncestors:je,scrollableAncestorRects:dt,measuringConfiguration:ne,measuringScheduled:Ue,windowRect:ct}),[ue,te,P,ee,Ke,Ne,Ce,k,L,ve,Ee,De,je,dt,ne,Ue,ct]),He=d.useMemo(()=>({activatorEvent:ee,activators:kt,active:ue,activeNodeRect:P,ariaDescribedById:{draggable:$e},dispatch:S,draggableNodes:k,over:Ee,measureDroppableContainers:De}),[ee,kt,ue,P,S,$e,k,Ee,De]);return U.createElement(Er.Provider,{value:x},U.createElement(Dt.Provider,{value:He},U.createElement(qr.Provider,{value:tn},U.createElement(Vt.Provider,{value:en},h)),U.createElement(fa,{disabled:c?.restoreFocus===!1})),U.createElement(po,{...c,hiddenTextDescribedById:$e}));function It(){const Y=Fe?.autoScrollEnabled===!1,re=typeof u=="object"?u.enabled===!1:u===!1,ie=I&&!Y&&!re;return typeof u=="object"?{...u,enabled:ie}:{enabled:ie}}}),pa=d.createContext(null),ar="button",xa="Draggable";function va(e){let{id:t,data:n,disabled:s=!1,attributes:o}=e;const i=Et(xa),{activators:l,activatorEvent:c,active:u,activeNodeRect:h,ariaDescribedById:f,draggableNodes:g,over:m}=d.useContext(Dt),{role:v=ar,roleDescription:D="draggable",tabIndex:y=0}=o??{},N=u?.id===t,S=d.useContext(N?Vt:pa),[E,x]=Pt(),[w,C]=Pt(),I=sa(l,t),T=yt(n);be(()=>(g.set(t,{id:t,key:i,node:E,activatorNode:w,data:T}),()=>{const z=g.get(t);z&&z.key===i&&g.delete(t)}),[g,t]);const k=d.useMemo(()=>({role:v,tabIndex:y,"aria-disabled":s,"aria-pressed":N&&v===ar?!0:void 0,"aria-roledescription":D,"aria-describedby":f.draggable}),[s,v,y,N,D,f.draggable]);return{active:u,activatorEvent:c,activeNodeRect:h,attributes:k,isDragging:N,listeners:s?void 0:I,node:E,over:m,setNodeRef:x,setActivatorNodeRef:C,transform:S}}function Hr(){return d.useContext(qr)}const ba="Droppable",ya={timeout:25};function wa(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:o}=e;const i=Et(ba),{active:l,dispatch:c,over:u,measureDroppableContainers:h}=d.useContext(Dt),f=d.useRef({disabled:n}),g=d.useRef(!1),m=d.useRef(null),v=d.useRef(null),{disabled:D,updateMeasurementsFor:y,timeout:N}={...ya,...o},S=yt(y??s),E=d.useCallback(()=>{if(!g.current){g.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{h(Array.isArray(S.current)?S.current:[S.current]),v.current=null},N)},[N]),x=Qt({callback:E,disabled:D||!l}),w=d.useCallback((k,z)=>{x&&(z&&(x.unobserve(z),g.current=!1),k&&x.observe(k))},[x]),[C,I]=Pt(w),T=yt(t);return d.useEffect(()=>{!x||!C.current||(x.disconnect(),g.current=!1,x.observe(C.current))},[C,x]),d.useEffect(()=>(c({type:V.RegisterDroppable,element:{id:s,key:i,disabled:n,node:C,rect:m,data:T}}),()=>c({type:V.UnregisterDroppable,key:i,id:s})),[s]),d.useEffect(()=>{n!==f.current.disabled&&(c({type:V.SetDroppableDisabled,id:s,key:i,disabled:n}),f.current.disabled=n)},[s,i,n,c]),{active:l,rect:m,isOver:u?.id===s,node:C,over:u,setNodeRef:I}}function Na(e){let{animation:t,children:n}=e;const[s,o]=d.useState(null),[i,l]=d.useState(null),c=Ft(n);return!n&&!s&&c&&o(c),be(()=>{if(!i)return;const u=s?.key,h=s?.props.id;if(u==null||h==null){o(null);return}Promise.resolve(t(h,i)).then(()=>{o(null)})},[t,s,i]),U.createElement(U.Fragment,null,n,s?d.cloneElement(s,{ref:l}):null)}const Ca={x:0,y:0,scaleX:1,scaleY:1};function ja(e){let{children:t}=e;return U.createElement(Dt.Provider,{value:Yr},U.createElement(Vt.Provider,{value:Ca},t))}const Ea={position:"fixed",touchAction:"none"},Da=e=>Bt(e)?"transform 250ms ease":void 0,Sa=d.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:o,children:i,className:l,rect:c,style:u,transform:h,transition:f=Da}=e;if(!c)return null;const g=o?h:{...h,scaleX:1,scaleY:1},m={...Ea,width:c.width,height:c.height,top:c.top,left:c.left,transform:Pe.Transform.toString(g),transformOrigin:o&&s?vo(s,c):void 0,transition:typeof f=="function"?f(s):f,...u};return U.createElement(n,{className:l,style:m,ref:t},i)}),Ta=e=>t=>{let{active:n,dragOverlay:s}=t;const o={},{styles:i,className:l}=e;if(i!=null&&i.active)for(const[c,u]of Object.entries(i.active))u!==void 0&&(o[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,u));if(i!=null&&i.dragOverlay)for(const[c,u]of Object.entries(i.dragOverlay))u!==void 0&&s.node.style.setProperty(c,u);return l!=null&&l.active&&n.node.classList.add(l.active),l!=null&&l.dragOverlay&&s.node.classList.add(l.dragOverlay),function(){for(const[u,h]of Object.entries(o))n.node.style.setProperty(u,h);l!=null&&l.active&&n.node.classList.remove(l.active)}},Ra=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Pe.Transform.toString(t)},{transform:Pe.Transform.toString(n)}]},ka={duration:250,easing:"ease",keyframes:Ra,sideEffects:Ta({styles:{active:{opacity:"0"}}})};function Ia(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:o}=e;return _t((i,l)=>{if(t===null)return;const c=n.get(i);if(!c)return;const u=c.node.current;if(!u)return;const h=Ur(l);if(!h)return;const{transform:f}=le(l).getComputedStyle(l),g=kr(f);if(!g)return;const m=typeof t=="function"?t:Ma(t);return Pr(u,o.draggable.measure),m({active:{id:i,data:c.data,node:u,rect:o.draggable.measure(u)},draggableNodes:n,dragOverlay:{node:l,rect:o.dragOverlay.measure(h)},droppableContainers:s,measuringConfiguration:o,transform:g})})}function Ma(e){const{duration:t,easing:n,sideEffects:s,keyframes:o}={...ka,...e};return i=>{let{active:l,dragOverlay:c,transform:u,...h}=i;if(!t)return;const f={x:c.rect.left-l.rect.left,y:c.rect.top-l.rect.top},g={scaleX:u.scaleX!==1?l.rect.width*u.scaleX/c.rect.width:1,scaleY:u.scaleY!==1?l.rect.height*u.scaleY/c.rect.height:1},m={x:u.x-f.x,y:u.y-f.y,...g},v=o({...h,active:l,dragOverlay:c,transform:{initial:u,final:m}}),[D]=v,y=v[v.length-1];if(JSON.stringify(D)===JSON.stringify(y))return;const N=s?.({active:l,dragOverlay:c,...h}),S=c.node.animate(v,{duration:t,easing:n,fill:"forwards"});return new Promise(E=>{S.onfinish=()=>{N?.(),E()}})}}let ir=0;function Aa(e){return d.useMemo(()=>{if(e!=null)return ir++,ir},[e])}const Oa=U.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:o,transition:i,modifiers:l,wrapperElement:c="div",className:u,zIndex:h=999}=e;const{activatorEvent:f,active:g,activeNodeRect:m,containerNodeRect:v,draggableNodes:D,droppableContainers:y,dragOverlay:N,over:S,measuringConfiguration:E,scrollableAncestors:x,scrollableAncestorRects:w,windowRect:C}=Hr(),I=d.useContext(Vt),T=Aa(g?.id),k=Kr(l,{activatorEvent:f,active:g,activeNodeRect:m,containerNodeRect:v,draggingNodeRect:N.rect,over:S,overlayNodeRect:N.rect,scrollableAncestors:x,scrollableAncestorRects:w,transform:I,windowRect:C}),z=Pn(m),L=Ia({config:s,draggableNodes:D,droppableContainers:y,measuringConfiguration:E}),A=z?N.setRef:void 0;return U.createElement(ja,null,U.createElement(Na,{animation:L},g&&T?U.createElement(Sa,{key:T,id:g.id,ref:A,as:c,activatorEvent:f,adjustScale:t,className:u,transition:i,rect:z,style:{zIndex:h,...o},transform:k},n):null))});function _r(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function La(e,t){return e.reduce((n,s,o)=>{const i=t.get(s);return i&&(n[o]=i),n},Array(e.length))}function At(e){return e!==null&&e>=0}function za(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Pa(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Br=e=>{let{rects:t,activeIndex:n,overIndex:s,index:o}=e;const i=_r(t,s,n),l=t[o],c=i[o];return!c||!l?null:{x:c.left-l.left,y:c.top-l.top,scaleX:c.width/l.width,scaleY:c.height/l.height}},Ot={scaleX:1,scaleY:1},Fa=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:o,rects:i,overIndex:l}=e;const c=(t=i[n])!=null?t:s;if(!c)return null;if(o===n){const h=i[l];return h?{x:0,y:n<l?h.top+h.height-(c.top+c.height):h.top-c.top,...Ot}:null}const u=$a(i,o,n);return o>n&&o<=l?{x:0,y:-c.height-u,...Ot}:o<n&&o>=l?{x:0,y:c.height+u,...Ot}:{x:0,y:0,...Ot}};function $a(e,t,n){const s=e[t],o=e[t-1],i=e[t+1];return s?n<t?o?s.top-(o.top+o.height):i?i.top-(s.top+s.height):0:i?i.top-(s.top+s.height):o?s.top-(o.top+o.height):0:0}const Gr="Sortable",Qr=U.createContext({activeIndex:-1,containerId:Gr,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Br,disabled:{draggable:!1,droppable:!1}});function Ua(e){let{children:t,id:n,items:s,strategy:o=Br,disabled:i=!1}=e;const{active:l,dragOverlay:c,droppableRects:u,over:h,measureDroppableContainers:f}=Hr(),g=Et(Gr,n),m=c.rect!==null,v=d.useMemo(()=>s.map(I=>typeof I=="object"&&"id"in I?I.id:I),[s]),D=l!=null,y=l?v.indexOf(l.id):-1,N=h?v.indexOf(h.id):-1,S=d.useRef(v),E=!za(v,S.current),x=N!==-1&&y===-1||E,w=Pa(i);be(()=>{E&&D&&f(v)},[E,v,D,f]),d.useEffect(()=>{S.current=v},[v]);const C=d.useMemo(()=>({activeIndex:y,containerId:g,disabled:w,disableTransforms:x,items:v,overIndex:N,useDragOverlay:m,sortedRects:La(v,u),strategy:o}),[y,g,w.draggable,w.droppable,x,v,N,u,m,o]);return U.createElement(Qr.Provider,{value:C},t)}const Ya=e=>{let{id:t,items:n,activeIndex:s,overIndex:o}=e;return _r(n,s,o).indexOf(t)},qa=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:o,items:i,newIndex:l,previousItems:c,previousContainerId:u,transition:h}=e;return!h||!s||c!==i&&o===l?!1:n?!0:l!==o&&t===u},Ka={duration:200,easing:"ease"},Vr="transform",Ha=Pe.Transition.toString({property:Vr,duration:0,easing:"linear"}),_a={roleDescription:"sortable"};function Ba(e){let{disabled:t,index:n,node:s,rect:o}=e;const[i,l]=d.useState(null),c=d.useRef(n);return be(()=>{if(!t&&n!==c.current&&s.current){const u=o.current;if(u){const h=at(s.current,{ignoreTransform:!0}),f={x:u.left-h.left,y:u.top-h.top,scaleX:u.width/h.width,scaleY:u.height/h.height};(f.x||f.y)&&l(f)}}n!==c.current&&(c.current=n)},[t,n,s,o]),d.useEffect(()=>{i&&l(null)},[i]),i}function Wr(e){let{animateLayoutChanges:t=qa,attributes:n,disabled:s,data:o,getNewIndex:i=Ya,id:l,strategy:c,resizeObserverConfig:u,transition:h=Ka}=e;const{items:f,containerId:g,activeIndex:m,disabled:v,disableTransforms:D,sortedRects:y,overIndex:N,useDragOverlay:S,strategy:E}=d.useContext(Qr),x=Ga(s,v),w=f.indexOf(l),C=d.useMemo(()=>({sortable:{containerId:g,index:w,items:f},...o}),[g,o,w,f]),I=d.useMemo(()=>f.slice(f.indexOf(l)),[f,l]),{rect:T,node:k,isOver:z,setNodeRef:L}=wa({id:l,data:C,disabled:x.droppable,resizeObserverConfig:{updateMeasurementsFor:I,...u}}),{active:A,activatorEvent:Z,activeNodeRect:ue,attributes:W,setNodeRef:Fe,listeners:Ge,isDragging:ee,over:it,setActivatorNodeRef:we,transform:$e}=va({id:l,data:C,attributes:{..._a,...n},disabled:x.draggable}),Qe=no(L,Fe),ne=!!A,ve=ne&&!D&&At(m)&&At(N),De=!S&&ee,Ue=De&&ve?$e:null,Re=ve?Ue??(c??E)({rects:y,activeNodeRect:ue,activeIndex:m,overIndex:N,index:w}):null,ge=At(m)&&At(N)?i({id:l,items:f,activeIndex:m,overIndex:N}):w,fe=A?.id,P=d.useRef({activeId:fe,items:f,newIndex:ge,containerId:g}),Ne=f!==P.current.items,me=t({active:A,containerId:g,isDragging:ee,isSorting:ne,id:l,index:w,items:f,newIndex:P.current.newIndex,previousItems:P.current.items,previousContainerId:P.current.containerId,transition:h,wasDragging:P.current.activeId!=null}),Se=Ba({disabled:!me,index:w,node:k,rect:T});return d.useEffect(()=>{ne&&P.current.newIndex!==ge&&(P.current.newIndex=ge),g!==P.current.containerId&&(P.current.containerId=g),f!==P.current.items&&(P.current.items=f)},[ne,ge,g,f]),d.useEffect(()=>{if(fe===P.current.activeId)return;if(fe!=null&&P.current.activeId==null){P.current.activeId=fe;return}const Ye=setTimeout(()=>{P.current.activeId=fe},50);return()=>clearTimeout(Ye)},[fe]),{active:A,activeIndex:m,attributes:W,data:C,rect:T,index:w,newIndex:ge,items:f,isOver:z,isSorting:ne,isDragging:ee,listeners:Ge,node:k,overIndex:N,over:it,setNodeRef:Qe,setActivatorNodeRef:we,setDroppableNodeRef:L,setDraggableNodeRef:Fe,transform:Se??Re,transition:Ce()};function Ce(){if(Se||Ne&&P.current.newIndex===w)return Ha;if(!(De&&!Bt(Z)||!h)&&(ne||me))return Pe.Transition.toString({...h,property:Vr})}}function Ga(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(s=e?.droppable)!=null?s:t.droppable}}function qt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Qa=[O.Down,O.Right,O.Up,O.Left],Va=(e,t)=>{let{context:{active:n,collisionRect:s,droppableRects:o,droppableContainers:i,over:l,scrollableAncestors:c}}=t;if(Qa.includes(e.code)){if(e.preventDefault(),!n||!s)return;const u=[];i.getEnabled().forEach(g=>{if(!g||g!=null&&g.disabled)return;const m=o.get(g.id);if(m)switch(e.code){case O.Down:s.top<m.top&&u.push(g);break;case O.Up:s.top>m.top&&u.push(g);break;case O.Left:s.left>m.left&&u.push(g);break;case O.Right:s.left<m.left&&u.push(g);break}});const h=wo({collisionRect:s,droppableRects:o,droppableContainers:u});let f=Tr(h,"id");if(f===l?.id&&h.length>1&&(f=h[1].id),f!=null){const g=i.get(n.id),m=i.get(f),v=m?o.get(m.id):null,D=m?.node.current;if(D&&v&&g&&m){const N=Gt(D).some((I,T)=>c[T]!==I),S=Xr(g,m),E=Wa(g,m),x=N||!S?{x:0,y:0}:{x:E?s.width-v.width:0,y:E?s.height-v.height:0},w={x:v.left,y:v.top};return x.x&&x.y?w:wt(w,x)}}}};function Xr(e,t){return!qt(e)||!qt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Wa(e,t){return!qt(e)||!qt(t)||!Xr(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}function Xa(e,t,{checkForDefaultPrevented:n=!0}={}){return function(o){if(e?.(o),n===!1||!o.defaultPrevented)return t?.(o)}}var Ja=rs[" useInsertionEffect ".trim().toString()]||dr;function Za({prop:e,defaultProp:t,onChange:n=()=>{},caller:s}){const[o,i,l]=ei({defaultProp:t,onChange:n}),c=e!==void 0,u=c?e:o;{const f=d.useRef(e!==void 0);d.useEffect(()=>{const g=f.current;g!==c&&console.warn(`${s} is changing from ${g?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=c},[c,s])}const h=d.useCallback(f=>{if(c){const g=ti(f)?f(e):f;g!==e&&l.current?.(g)}else i(f)},[c,e,i,l]);return[u,h]}function ei({defaultProp:e,onChange:t}){const[n,s]=d.useState(e),o=d.useRef(n),i=d.useRef(t);return Ja(()=>{i.current=t},[t]),d.useEffect(()=>{o.current!==n&&(i.current?.(n),o.current=n)},[n,o]),[n,s,i]}function ti(e){return typeof e=="function"}var Wt="Collapsible",[ni]=ss(Wt),[ri,Fn]=ni(Wt),Jr=d.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:s,defaultOpen:o,disabled:i,onOpenChange:l,...c}=e,[u,h]=Za({prop:s,defaultProp:o??!1,onChange:l,caller:Wt});return r.jsx(ri,{scope:n,disabled:i,contentId:cs(),open:u,onOpenToggle:d.useCallback(()=>h(f=>!f),[h]),children:r.jsx(Dn.div,{"data-state":Un(u),"data-disabled":i?"":void 0,...c,ref:t})})});Jr.displayName=Wt;var Zr="CollapsibleTrigger",es=d.forwardRef((e,t)=>{const{__scopeCollapsible:n,...s}=e,o=Fn(Zr,n);return r.jsx(Dn.button,{type:"button","aria-controls":o.contentId,"aria-expanded":o.open||!1,"data-state":Un(o.open),"data-disabled":o.disabled?"":void 0,disabled:o.disabled,...s,ref:t,onClick:Xa(e.onClick,o.onOpenToggle)})});es.displayName=Zr;var $n="CollapsibleContent",ts=d.forwardRef((e,t)=>{const{forceMount:n,...s}=e,o=Fn($n,e.__scopeCollapsible);return r.jsx(os,{present:n||o.open,children:({present:i})=>r.jsx(si,{...s,ref:t,present:i})})});ts.displayName=$n;var si=d.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:s,children:o,...i}=e,l=Fn($n,n),[c,u]=d.useState(s),h=d.useRef(null),f=as(t,h),g=d.useRef(0),m=g.current,v=d.useRef(0),D=v.current,y=l.open||c,N=d.useRef(y),S=d.useRef(void 0);return d.useEffect(()=>{const E=requestAnimationFrame(()=>N.current=!1);return()=>cancelAnimationFrame(E)},[]),dr(()=>{const E=h.current;if(E){S.current=S.current||{transitionDuration:E.style.transitionDuration,animationName:E.style.animationName},E.style.transitionDuration="0s",E.style.animationName="none";const x=E.getBoundingClientRect();g.current=x.height,v.current=x.width,N.current||(E.style.transitionDuration=S.current.transitionDuration,E.style.animationName=S.current.animationName),u(s)}},[l.open,s]),r.jsx(Dn.div,{"data-state":Un(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!y,...i,ref:f,style:{"--radix-collapsible-content-height":m?`${m}px`:void 0,"--radix-collapsible-content-width":D?`${D}px`:void 0,...e.style},children:y&&o})});function Un(e){return e?"open":"closed"}var oi=Jr;const ai=oi,ii=es,li=ts;function ci({dateStr:e}){if(!e)return null;try{const t=br(e);if(!pr(t))return null;let n=Q(t,"MMM d");Be(t)&&(n="Today"),xs(t)&&(n="Tomorrow");const s=vs(t)&&!Be(t);return r.jsxs("div",{className:`flex items-center gap-1 text-[10px] border px-1.5 py-0.5 rounded-full ${s?"text-red-400 border-red-400/50":"text-muted-foreground border-border"}`,children:[r.jsx(ds,{className:"w-3 h-3"}),n]})}catch{return null}}function lr({task:e,onToggle:t,onDelete:n,onEdit:s}){const{attributes:o,listeners:i,setNodeRef:l,transform:c,transition:u,isDragging:h}=Wr({id:e.id,data:{type:"Task",...e}}),f={transform:Pe.Translate.toString(c),transition:u,opacity:h?.5:1};return r.jsx("div",{ref:l,style:f,...o,...i,className:"mb-2 touch-none select-none relative group",children:r.jsxs("div",{className:`
            p-3 rounded-xl border border-transparent hover:border-border/50 transition-all
            flex gap-3 items-start bg-transparent hover:bg-accent/5
            ${h?"ring-2 ring-primary/50 bg-accent/10 z-50":""}
        `,onClick:()=>s(e),children:[r.jsx("div",{onClick:g=>{g.stopPropagation(),t(e)},className:`
                mt-0.5 w-5 h-5 rounded-full border-2 flex items-center justify-center cursor-pointer transition-colors
                ${e.status==="completed"?"bg-primary border-primary":"border-muted-foreground/60 hover:border-primary"}
            `,children:e.status==="completed"&&r.jsx("div",{className:"w-2.5 h-1.5 border-b-2 border-l-2 border-black rotate-[-45deg] mb-0.5"})}),r.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[r.jsx("div",{className:`text-sm font-medium leading-tight truncate ${e.status==="completed"?"line-through text-muted-foreground":"text-foreground"}`,children:e.title}),(e.notes||e.due)&&r.jsxs("div",{className:"flex flex-wrap gap-2 items-center mt-1",children:[e.due&&r.jsx(ci,{dateStr:e.due}),e.notes&&r.jsxs("div",{className:"flex items-center text-[10px] text-muted-foreground gap-1",children:[r.jsx(xr,{className:"w-3 h-3"}),r.jsx("span",{className:"truncate max-w-[150px] opacity-70",children:e.notes.split(`
`)[0]})]})]})]})]})})}function cr({task:e,isOpen:t,onClose:n,onSave:s,onDelete:o,isCreating:i,activeListId:l,availableLists:c=[]}){const[u,h]=d.useState(""),[f,g]=d.useState(""),[m,v]=d.useState(""),[D,y]=d.useState(""),[N,S]=d.useState("");d.useEffect(()=>{if(t){if(i)h(""),g(""),v(""),y(""),S(l||c[0]?.id||"");else if(e)if(h(e.title),g(e.notes||""),S(e.listId),e.due)try{const x=br(e.due);pr(x)&&v(Q(x,"yyyy-MM-dd"))}catch{}else v("")}},[t,e,i,l]);const E=()=>{if(!u)return;let x;m&&(x=D?`${m}T${D}:00Z`:`${m}T00:00:00Z`),s({title:u,notes:f,due:x,listId:N}),n()};return r.jsx(mt,{open:t,onOpenChange:x=>!x&&n(),children:r.jsxs(pt,{className:"sm:max-w-[500px] border-border bg-[#1E1E1E] text-white p-0 gap-0 overflow-hidden shadow-2xl rounded-xl",children:[r.jsx("div",{className:"p-6 pb-2",children:r.jsx(ae,{value:u,onChange:x=>h(x.target.value),placeholder:"Add title",className:"text-2xl font-normal bg-transparent border-0 border-b border-white/20 rounded-none px-0 py-2 focus-visible:ring-0 focus-visible:border-blue-400 placeholder:text-muted-foreground/50 h-auto",autoFocus:i})}),r.jsxs("div",{className:"p-6 pt-2 space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ws,{className:"w-5 h-5 text-muted-foreground shrink-0"}),r.jsxs("div",{className:"flex-1 flex gap-2",children:[r.jsx(ae,{type:"date",value:m,onChange:x=>v(x.target.value),className:"bg-white/5 border-white/10 text-sm w-[150px]"}),r.jsx(ae,{type:"time",value:D,onChange:x=>y(x.target.value),className:"bg-white/5 border-white/10 text-sm w-[120px]"})]})]}),r.jsxs("div",{className:"flex items-center gap-2 pl-7",children:[r.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2 cursor-not-allowed opacity-70",children:[r.jsx("div",{className:"w-4 h-4 rounded-full border border-current"}),"Does not repeat"]}),r.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2 ml-4 cursor-not-allowed opacity-70",children:[r.jsx("div",{className:"w-4 h-4 border border-current"}),"All day"]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(xr,{className:"w-5 h-5 text-muted-foreground shrink-0 mt-2"}),r.jsx(xn,{value:f,onChange:x=>g(x.target.value),placeholder:"Add description",className:"bg-transparent border-0 resize-none min-h-[100px] focus-visible:ring-0 p-0 text-sm leading-relaxed placeholder:text-muted-foreground/50"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-5 shrink-0"})," ",r.jsxs(Je,{value:N,onValueChange:S,children:[r.jsx(Ze,{className:"w-[150px] h-8 bg-white/5 border-white/10 text-xs",children:r.jsx(et,{placeholder:"Select List"})}),r.jsx(tt,{children:c.map(x=>r.jsx(G,{value:x.id,children:x.title},x.id))})]})]})]}),r.jsxs(Lt,{className:"p-4 bg-white/5 flex justify-between items-center",children:[!i&&e?r.jsx(F,{variant:"ghost",size:"icon",onClick:()=>{confirm("Delete?")&&(o(e.id,e.listId),n())},children:r.jsx(vn,{className:"w-4 h-4 text-muted-foreground hover:text-red-400"})}):r.jsx("div",{}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(F,{variant:"ghost",onClick:n,className:"hover:bg-white/10",children:"Cancel"}),r.jsx(F,{onClick:E,disabled:!u,className:"bg-blue-600 hover:bg-blue-700 text-white rounded-full px-6",children:"Save"})]})]})]})})}function di({listId:e,title:t,tasks:n,onAddTask:s,onEdit:o,onToggle:i,onDelete:l}){const{setNodeRef:c}=Wr({id:e,data:{type:"Container",listId:e}}),u=n.filter(f=>f.status!=="completed"),h=n.filter(f=>f.status==="completed");return r.jsxs("div",{ref:c,className:"flex-1 min-w-[260px] max-w-[300px] flex flex-col h-full bg-[#1A1A1A] rounded-2xl overflow-hidden border border-white/5 my-1",children:[r.jsxs("div",{className:"p-4 flex items-center justify-between pb-2",children:[r.jsx("h3",{className:"font-medium text-lg text-white tracking-wide truncate",children:t==="Reclaim"?" Reclaim":t}),r.jsx("div",{className:"flex gap-1",children:r.jsxs(F,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-white",children:[r.jsx("div",{className:"w-1 h-1 bg-current rounded-full mb-0.5"}),r.jsx("div",{className:"w-1 h-1 bg-current rounded-full mb-0.5"}),r.jsx("div",{className:"w-1 h-1 bg-current rounded-full"})]})})]}),r.jsx("div",{className:"px-4 pb-2",children:r.jsxs("button",{onClick:()=>s(e),className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-white transition-colors group w-full text-left",children:[r.jsx("div",{className:"w-6 h-6 rounded-full bg-accent/20 flex items-center justify-center group-hover:bg-blue-500/20 group-hover:text-blue-400",children:r.jsx(yn,{className:"w-4 h-4"})}),"Add a task"]})}),r.jsx("div",{className:"flex-1 overflow-y-auto px-2 py-2 overflow-x-hidden [&::-webkit-scrollbar]:w-1.5 [&::-webkit-scrollbar-thumb]:bg-white/20 [&::-webkit-scrollbar-thumb]:rounded-full hover:[&::-webkit-scrollbar-thumb]:bg-white/40 [&::-webkit-scrollbar-track]:bg-transparent",children:r.jsxs(Ua,{items:n.map(f=>f.id),strategy:Fa,children:[u.length>0?r.jsx("div",{className:"space-y-1",children:u.map(f=>r.jsx(lr,{task:f,onToggle:i,onEdit:o,onDelete:l},f.id))}):h.length===0&&r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center opacity-40",children:[r.jsx("div",{className:"mb-4 text-4xl grayscale",children:""}),r.jsx("p",{className:"text-sm font-medium",children:"No tasks yet"})]}),h.length>0&&r.jsx("div",{className:"mt-4 pt-2 border-t border-white/5",children:r.jsxs(ai,{children:[r.jsxs(ii,{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-white w-full py-2 px-2 hover:bg-white/5 rounded-md transition-colors",children:[r.jsx(Tn,{className:"w-4 h-4 transition-transform ui-open:rotate-90"}),"Completed (",h.length,")"]}),r.jsx(li,{className:"space-y-1 pl-2 mt-1",children:h.map(f=>r.jsx(lr,{task:f,onToggle:i,onEdit:o,onDelete:l},f.id))})]})})]})})]})}function ui({onClick:e}){return r.jsxs(F,{onClick:e,variant:"outline",size:"sm",className:"rounded-none font-arcade text-xs border-primary text-primary hover:bg-primary hover:text-black",children:[r.jsx(fr,{className:"w-4 h-4 mr-1"})," AI_ASSIST"]})}function fi({isOpen:e,onClose:t}){const[n,s]=d.useState([]),[o,i]=d.useState(""),l=d.useRef(null),c=Sn(),{data:u,isLoading:h,refetch:f}=Le({queryKey:["google-status"],queryFn:_.google.getStatus,retry:1,enabled:e}),g=X({mutationFn:async()=>{const{authUrl:y}=await _.google.getAuthUrl();window.location.href=y}});d.useEffect(()=>{e&&f()},[e,f]),d.useEffect(()=>{l.current&&(l.current.scrollTop=l.current.scrollHeight)},[n,e]);const m=X({mutationFn:async y=>_.calendar.assistant(y),onSuccess:y=>{s(N=>[...N,{role:"assistant",content:y.response,isError:!y.success}]),c.invalidateQueries({queryKey:["events"]}),c.invalidateQueries({queryKey:["google-tasks"]}),c.invalidateQueries({queryKey:["google-calendar"]}),c.refetchQueries({queryKey:["google-calendar"]})},onError:y=>{s(N=>[...N,{role:"assistant",content:`Network Error: ${y}`,isError:!0}])}}),v=()=>{if(!o.trim())return;const y={role:"user",content:o};s(N=>[...N,y]),i(""),m.mutate(o)},D=y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),v())};return e?r.jsxs(hr,{className:"fixed left-0 top-[68px] bottom-[40px] w-[380px] shadow-2xl z-50 flex flex-col border-r-2 border-primary bg-black text-white rounded-none animate-in fade-in slide-in-from-left-4 duration-300",children:[r.jsxs(gr,{className:"p-3 border-b border-primary/50 flex flex-row items-center justify-between bg-primary/10",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(fr,{className:"w-5 h-5 text-primary"}),r.jsxs("div",{children:[r.jsx(hs,{className:"text-sm font-arcade tracking-wider text-primary",children:"AI_ASSISTANT"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(gs,{className:"text-[10px] text-muted-foreground font-terminal",children:"Calendar + Tasks Assistant"}),!h&&u?.connected&&r.jsx("span",{className:"text-[9px] font-arcade text-green-400",children:"CONNECTED"})]})]})]}),r.jsx(F,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:t,children:r.jsx(is,{className:"h-4 w-4 text-muted-foreground hover:text-white"})})]}),r.jsx(bn,{className:"flex-1 p-3",ref:l,children:r.jsxs("div",{className:"space-y-3",children:[!h&&!u?.connected&&r.jsxs("div",{className:"border border-yellow-500/50 bg-yellow-500/10 text-yellow-200 text-[10px] font-terminal px-3 py-2 flex items-center justify-between gap-3",children:[r.jsx("span",{children:"Calendar not connected."}),r.jsxs(F,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none border-yellow-500 text-yellow-200 hover:bg-yellow-500/20 font-arcade text-[9px]",onClick:()=>g.mutate(),disabled:g.isPending,children:[r.jsx(Ss,{className:"w-3 h-3 mr-1"}),g.isPending?"CONNECTING...":"CONNECT GOOGLE CALENDAR"]})]}),n.length===0&&r.jsxs("div",{className:"text-center text-muted-foreground text-xs mt-8 space-y-2",children:[r.jsx("p",{className:"font-terminal",children:"Ask me to create events or tasks."}),r.jsx("p",{className:"text-[10px] opacity-50 font-terminal",children:'"Add a workout tomorrow at 3pm"'}),r.jsx("p",{className:"text-[10px] opacity-50 font-terminal",children:'"Schedule PT study session Friday 2pm"'})]}),n.map((y,N)=>r.jsx("div",{className:`flex ${y.role==="user"?"justify-end":"justify-start"}`,children:r.jsx("div",{className:`max-w-[85%] px-3 py-2 text-xs font-terminal whitespace-pre-wrap ${y.role==="user"?"bg-primary text-black":y.isError?"bg-red-500/10 border border-red-500/50 text-red-300":"bg-white/10 text-white border border-white/10"}`,children:y.content})},N)),m.isPending&&r.jsx("div",{className:"flex justify-start",children:r.jsxs("div",{className:"bg-white/5 border border-white/10 px-3 py-2 text-[10px] flex items-center gap-2 text-muted-foreground font-terminal",children:[r.jsx(Rs,{className:"h-3 w-3 animate-spin"}),"Thinking..."]})})]})}),r.jsxs("div",{className:"p-3 border-t border-primary/50",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx(ae,{value:o,onChange:y=>i(y.target.value),onKeyDown:D,placeholder:"Type a command...",className:"bg-black border-secondary font-terminal text-sm rounded-none focus-visible:ring-primary",disabled:m.isPending}),r.jsx(F,{onClick:v,disabled:m.isPending||!o.trim(),className:"rounded-none bg-primary text-black hover:bg-primary/90",children:r.jsx(Ns,{className:"h-4 w-4"})})]}),r.jsx("div",{className:"text-[9px] text-center mt-1 text-muted-foreground/50 font-terminal",children:"OpenRouter  GPT-4o-mini"})]})]}):null}const pn=Array.from({length:24},(e,t)=>t),_e=60;function hi({tasks:e,taskLists:t}){const n=Sn(),{toast:s}=ur(),[o,i]=d.useState(null),[l,c]=d.useState(null),[u,h]=d.useState(0),[f,g]=d.useState(null),m=xo(Qn(zn,{activationConstraint:{distance:8}}),Qn(On,{coordinateGetter:Va})),v=X({mutationFn:x=>_.googleTasks.move(x.taskId,x.listId,x.destListId,x.previous,x.parent),onSuccess:()=>n.invalidateQueries({queryKey:["google-tasks"]}),onError:()=>s({title:"Move Failed",variant:"destructive"})}),D=X({mutationFn:x=>_.googleTasks.update(x.id,x.listId,x.data),onSuccess:()=>{n.invalidateQueries({queryKey:["google-tasks"]}),c(null)}}),y=X({mutationFn:x=>_.googleTasks.create(x.listId,{title:x.title,status:"needsAction"}),onSuccess:()=>n.invalidateQueries({queryKey:["google-tasks"]})}),N=X({mutationFn:x=>_.googleTasks.delete(x.id,x.listId),onSuccess:()=>n.invalidateQueries({queryKey:["google-tasks"]})}),S=X({mutationFn:x=>_.googleTasks.update(x.id,x.listId,{status:x.status==="completed"?"needsAction":"completed"}),onSuccess:()=>n.invalidateQueries({queryKey:["google-tasks"]})}),E=x=>{const{active:w,over:C}=x;if(i(null),!C)return;const I=e.find(k=>k.id===w.id);if(!I)return;let T=null;if(C.data.current?.listId)T=C.data.current.listId;else if(C.data.current?.type==="Container")T=C.id;else{const k=e.find(z=>z.id===C.id);k&&(T=k.listId)}if(T&&(w.id!==C.id||I.listId!==T)){const k=e.filter(L=>L.listId===T).sort((L,A)=>(L.position||"").localeCompare(A.position||""));let z;if(w.id!==C.id){e.findIndex(A=>A.id===w.id);const L=k.findIndex(A=>A.id===C.id);L!==-1&&L>0&&(z=k[L-1].id)}v.mutate({taskId:I.id,listId:I.listId,destListId:T,previous:z})}};return r.jsxs(ma,{sensors:m,collisionDetection:yo,onDragEnd:E,onDragStart:x=>i(x.active.id),children:[r.jsxs("div",{className:"flex h-full items-start justify-center gap-4 pt-4",children:[r.jsx(F,{variant:"ghost",size:"icon",onClick:()=>h(x=>(x-1+t.length)%t.length),className:"h-10 w-10 mt-3 rounded-full border border-white/10 hover:bg-white/10 hover:text-white shrink-0",children:r.jsx(mr,{className:"h-5 w-5"})}),t.length>0&&(()=>{const x=t[u],w=e.filter(C=>C.listId===x.id).sort((C,I)=>(C.position||"").localeCompare(I.position||""));return r.jsx("div",{className:"h-full w-[320px] shrink-0",children:r.jsx(di,{listId:x.id,title:x.title,tasks:w,onAddTask:C=>g(C),onEdit:C=>c(C),onToggle:C=>S.mutate(C),onDelete:(C,I)=>{confirm("Delete task?")&&N.mutate({id:C,listId:I})}},x.id)})})(),r.jsx(F,{variant:"ghost",size:"icon",onClick:()=>h(x=>(x+1)%t.length),className:"h-10 w-10 mt-3 rounded-full border border-white/10 hover:bg-white/10 hover:text-white shrink-0",children:r.jsx(Tn,{className:"h-5 w-5"})})]}),r.jsx(Oa,{children:o?r.jsx("div",{className:"opacity-80 rotate-2 cursor-grabbing",children:r.jsx("div",{className:"p-2 border bg-card text-primary font-arcade text-xs border-primary",children:e.find(x=>x.id===o)?.title||"Task"})}):null}),r.jsx(cr,{task:l,isOpen:!!l,onClose:()=>c(null),onSave:x=>{l&&D.mutate({id:l.id,listId:l.listId,data:x})},onDelete:(x,w)=>N.mutate({id:x,listId:w}),availableLists:t}),r.jsx(cr,{task:null,isOpen:!!f,isCreating:!0,activeListId:f||void 0,availableLists:t,onClose:()=>g(null),onSave:x=>{f&&x.title&&y.mutate({listId:f,title:x.title,...x})},onDelete:()=>{}})]})}function ji(){const e=Sn(),{toast:t}=ur(),[n,s]=d.useState(new Date),[o,i]=d.useState("month"),[l,c]=d.useState(!1),[u,h]=d.useState(!1),[f,g]=d.useState(null),[m,v]=d.useState({title:"",date:"",endDate:"",startTime:"09:00",endTime:"10:00",allDay:!1,eventType:"study",color:"#ef4444",recurrence:"",calendarId:""}),[D,y]=d.useState(new Set),[N,S]=d.useState(!0),[E,x]=d.useState(""),[w,C]=d.useState(null),[I,T]=d.useState(!1),[k,z]=d.useState(!1),[L,A]=d.useState(!1),[Z,ue]=d.useState(()=>{const a=localStorage.getItem("pinnedCalendars");return a?JSON.parse(a):[]}),[W,Fe]=d.useState(()=>{const a=localStorage.getItem("hiddenCalendars");return a?JSON.parse(a):[]}),[Ge,ee]=d.useState(!1),[it,we]=d.useState(!1),$e=a=>{Fe(p=>{const b=p.includes(a),j=b?p.filter(R=>R!==a):[...p,a];return localStorage.setItem("hiddenCalendars",JSON.stringify(j)),b||y(R=>{const M=new Set(R);return M.delete(a),M}),j})},Qe=dn(n),ne=ln(n),ve=an(Qe,{weekStartsOn:0}),De=Hn(ne,{weekStartsOn:0}),Ue=cn({start:ve,end:De}),te=an(n,{weekStartsOn:0}),Re=cn({start:te,end:nt(te,6)}),{data:ge=[]}=Le({queryKey:["events"],queryFn:_.events.getAll}),{data:fe=[],isLoading:P,refetch:Ne}=Le({queryKey:["google-calendar",n.getFullYear(),n.getMonth()],queryFn:async()=>{const a=dn(Bn(n)).toISOString(),p=ln(Nn(n,1)).toISOString(),b=await fetch(`/api/google-calendar/events?timeMin=${encodeURIComponent(a)}&timeMax=${encodeURIComponent(p)}`);if(!b.ok)throw new Error("Failed to fetch");return b.json()}}),{data:me=[]}=Le({queryKey:["tasks"],queryFn:_.tasks.getAll}),{data:Se=[],isLoading:Ce,isError:Ye,refetch:qe}=Le({queryKey:["google-tasks"],queryFn:_.googleTasks.getAll,retry:1}),{data:St=[]}=Le({queryKey:["google-task-lists"],queryFn:_.googleTasks.getLists}),{data:lt=[]}=Le({queryKey:["google-calendar-list"],queryFn:async()=>{const a=await fetch("/api/google-calendar/calendars");if(!a.ok)throw new Error("Failed to fetch calendar list");return a.json()}}),{data:ct,refetch:je,isLoading:dt,error:ut}=Le({queryKey:["google-status"],queryFn:_.google.getStatus,retry:1}),Ve=X({mutationFn:async()=>{const{authUrl:a}=await _.google.getAuthUrl();window.location.href=a}});X({mutationFn:_.google.disconnect,onSuccess:()=>{je(),e.invalidateQueries({queryKey:["google-calendar-events"]}),e.invalidateQueries({queryKey:["google-calendar-list"]}),e.invalidateQueries({queryKey:["google-tasks"]})}});const he=d.useMemo(()=>lt.map(a=>({id:a.id,name:a.summary,color:a.backgroundColor||"#888888"})),[lt]),Xt=d.useMemo(()=>he.filter(a=>!W.includes(a.id)),[he,W]);d.useEffect(()=>{if(he.length>0&&D.size===0){const a=Z.length>0?Z:he.slice(0,2).map(p=>p.id);y(new Set(a))}},[he,Z]),d.useEffect(()=>{if(he.length>0&&Z.length===0&&!localStorage.getItem("pinnedCalendars")){const a=he.slice(0,2).map(p=>p.id);ue(a),localStorage.setItem("pinnedCalendars",JSON.stringify(a))}},[he,Z]);const Jt=a=>{y(p=>{const b=new Set(p);return b.has(a)?b.delete(a):b.add(a),b})},ke=X({mutationFn:_.events.create,onSuccess:()=>{e.invalidateQueries({queryKey:["events"]}),m.calendarId&&m.calendarId!=="local"&&(e.invalidateQueries({queryKey:["google-calendar"]}),Ne()),c(!1),en()}}),Ie=X({mutationFn:({id:a,data:p})=>_.events.update(a,p),onSuccess:()=>{e.invalidateQueries({queryKey:["events"]}),h(!1),g(null)}}),Ke=X({mutationFn:_.events.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["events"]}),h(!1),g(null)}});X({mutationFn:_.tasks.create,onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}}),X({mutationFn:({id:a,status:p})=>_.tasks.update(a,{status:p==="completed"?"pending":"completed"}),onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}}),X({mutationFn:async a=>{const p=await fetch("/api/google-tasks/@default",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:a})});if(!p.ok)throw new Error("Failed to create task");return p.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-tasks"]})}}),X({mutationFn:async({taskId:a,completed:p})=>{const b=await fetch(`/api/google-tasks/@default/${a}/toggle`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({completed:p})});if(!b.ok)throw new Error("Failed to toggle task");return b.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-tasks"]})}});const We=X({mutationFn:async({eventId:a,calendarId:p})=>{const b=await fetch(`/api/google-calendar/events/${encodeURIComponent(p)}/${encodeURIComponent(a)}`,{method:"DELETE"});if(!b.ok)throw new Error("Failed to delete event");return b.status===204?null:b.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-calendar"]}),Ne(),t({title:"EVENT_DELETED",description:"Event removed from Google Calendar"}),T(!1),C(null)},onError:a=>{t({title:"DELETE_FAILED",description:a.message,variant:"destructive"})}}),Ee=X({mutationFn:async a=>{if(!a.calendarId)throw new Error("Missing calendarId");const p=await fetch(`/api/google-calendar/events/${encodeURIComponent(a.calendarId)}/${encodeURIComponent(a.id)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({summary:a.summary,description:a.description,location:a.location,start:a.start,end:a.end,recurrence:a.recurrence})});if(!p.ok)throw new Error("Failed to update google event");return p.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-calendar"]}),Ne(),t({title:"EVENT_UPDATED",description:"Changes synced to Google Calendar"}),T(!1)},onError:a=>{t({title:"SYNC_FAILED",description:a.message,variant:"destructive"})}}),Tt=()=>{w&&w.calendarId&&(w.recurringEventId?confirm("Delete this single occurrence?")&&We.mutate({eventId:w.id,calendarId:w.calendarId}):w.recurrence&&w.recurrence.length>0?confirm("Delete the ENTIRE series? This cannot be undone.")&&We.mutate({eventId:w.id,calendarId:w.calendarId}):confirm("Delete this event?")&&We.mutate({eventId:w.id,calendarId:w.calendarId}))},Zt=()=>{w&&Ee.mutate(w)},en=()=>{v({title:"",date:"",endDate:"",startTime:"09:00",endTime:"10:00",allDay:!1,eventType:"study",color:"#ef4444",recurrence:"",calendarId:""})},Me=a=>{if("summary"in a){const p=a,b=!!p.start?.date&&!p.start?.dateTime,j=p.start?.dateTime||p.start?.date||new Date().toISOString(),R=p.end?.dateTime||p.end?.date||j;return{id:p.id,title:p.summary||"Untitled",start:new Date(j),end:new Date(R),allDay:b,isGoogle:!0,calendarColor:p.calendarColor,calendarName:p.calendarSummary,originalEvent:a}}else{const p=a,b=new Date(p.date),j=p.endDate?new Date(p.endDate):Ms(b,1);return{id:p.id,title:p.title,start:b,end:j,allDay:p.allDay||!1,isGoogle:!1,eventType:p.eventType,originalEvent:a}}},Rt=()=>{if(m.title&&m.date){const[a,p]=m.startTime.split(":").map(Number),[b,j]=m.endTime.split(":").map(Number),R=Oe(Ae(new Date(m.date),a),p);let M=null;if(m.allDay)m.endDate&&(M=nt(new Date(m.endDate),1));else{const $=m.endDate||m.date;M=Oe(Ae(new Date($),b),j)}ke.mutate({title:m.title,date:R,endDate:M,allDay:m.allDay,eventType:m.eventType,color:m.color,recurrence:m.recurrence||null,calendarId:m.calendarId||null})}},Xe=(a,p)=>{const b=p??9;v({title:"",date:Q(a,"yyyy-MM-dd"),endDate:"",startTime:`${b.toString().padStart(2,"0")}:00`,endTime:`${(b+1).toString().padStart(2,"0")}:00`,allDay:!1,eventType:"study",color:"#ef4444",recurrence:"",calendarId:"local"}),c(!0)},kt=a=>{g(a),h(!0)},tn=a=>{C(a),T(!0)},He=a=>{a.isGoogle?tn(a.originalEvent):kt(a.originalEvent)};d.useMemo(()=>{if(!E.trim())return[];const a=E.toLowerCase(),p=[];return N&&ge.forEach(b=>{b.title.toLowerCase().includes(a)&&p.push(Me(b))}),fe.forEach(b=>{D.size>0&&b.calendarId&&!D.has(b.calendarId)||b.summary?.toLowerCase().includes(a)&&p.push(Me(b))}),p.sort((b,j)=>b.start.getTime()-j.start.getTime())},[E,ge,fe,N,D]);const It=(a,p)=>{const b=Ae(Oe(p,0),0),j=Ae(Oe(p,59),23);return a.start<=j&&a.end>=b},Y=a=>{const p=[];return N&&ge.forEach(b=>{const j=Me(b);It(j,a)&&p.push(j)}),fe.forEach(b=>{if(D.size>0&&b.calendarId&&!D.has(b.calendarId))return;const j=Me(b);It(j,a)&&p.push(j)}),p.sort((b,j)=>b.allDay&&!j.allDay?-1:!b.allDay&&j.allDay?1:b.start.getTime()-j.start.getTime())},re=a=>{s(o==="month"?a==="prev"?Bn(n):Nn(n,1):o==="week"?a==="prev"?Xs(n):vr(n,1):a==="prev"?Ls(n):nt(n,1))},ie=()=>s(new Date),pe=a=>{s(a),i("day")};me.filter(a=>a.status==="pending").length,Se.filter(a=>a.status==="needsAction").length;const ce=()=>o==="month"?Q(n,"MMMM yyyy").toUpperCase():o==="week"?`${Q(te,"MMM d")} - ${Q(nt(te,6),"MMM d, yyyy")}`.toUpperCase():Q(n,"EEEE, MMMM d, yyyy").toUpperCase(),B=a=>{const p="backdrop-blur-sm shadow-sm transition-all duration-200 hover:scale-[1.02] hover:z-50 hover:shadow-lg";if(a.isGoogle)return`${p} text-white font-medium border-l-4`;switch(a.eventType){case"study":return`${p} bg-red-500/30 text-white border-l-4 border-red-500`;case"lecture":return`${p} bg-cyan-500/30 text-white border-l-4 border-cyan-500`;case"exam":return`${p} bg-amber-500/30 text-white border-l-4 border-amber-500`;default:return`${p} bg-red-500/30 text-white border-l-4 border-red-500`}},se=a=>{if(a.isGoogle&&a.calendarColor){const p=a.calendarColor.replace("#",""),b=parseInt(p.substring(0,2),16),j=parseInt(p.substring(2,4),16),R=parseInt(p.substring(4,6),16);return{backgroundColor:`rgba(${b}, ${j}, ${R}, 0.35)`,borderLeftColor:a.calendarColor,boxShadow:"0 4px 6px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.1)"}}return{boxShadow:"0 4px 6px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.1)"}},Te=(a,p,b=0,j=1)=>{const R=Kn(a.start,p),M=Kn(a.end,a.start),$=R/60*_e,oe=Math.max(M/60*_e,24),ft=j>1?`${100/j}%`:"calc(100% - 4px)",nn=j>1?`${b/j*100}%`:"0",rn={top:`${$}px`,height:`${oe}px`,width:ft,left:nn};return a.calendarColor&&(rn.backgroundColor=a.calendarColor,rn.borderLeftColor=a.calendarColor),rn},q=a=>{const p=new Map;if(a.length===0)return p;const b=[...a].sort((R,M)=>R.start.getTime()-M.start.getTime()),j=[];for(const R of b){let M=-1;for(let $=0;$<j.length;$++)if(R.start>=j[$]){M=$;break}M===-1?(M=j.length,j.push(R.end)):j[M]=R.end,p.set(R.id,{column:M,totalColumns:1})}for(const R of b){let M=1;for(const oe of b)if(R.id!==oe.id&&R.start<oe.end&&R.end>oe.start){const ft=p.get(R.id)?.column||0,nn=p.get(oe.id)?.column||0;M=Math.max(M,ft+1,nn+1)}const $=p.get(R.id);$&&p.set(R.id,{...$,totalColumns:M})}return p};return r.jsxs(us,{children:[r.jsx("div",{className:"h-[calc(100vh-80px)]",children:r.jsx("div",{className:"flex flex-col h-full",children:r.jsxs(hr,{className:"bg-black/40 border-2 border-primary rounded-none flex-1 flex flex-col overflow-hidden",children:[r.jsxs(gr,{className:"border-b border-primary/30 p-4 flex flex-row justify-between items-center shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(F,{size:"sm",variant:"outline",className:"rounded-none border-primary text-primary hover:bg-primary hover:text-black font-arcade text-xs",onClick:ie,"data-testid":"button-today",children:"TODAY"}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(F,{size:"icon",variant:"ghost",className:"h-8 w-8 rounded-none hover:bg-primary/20",onClick:()=>re("prev"),"data-testid":"button-prev",children:r.jsx(mr,{className:"h-4 w-4"})}),r.jsx(F,{size:"icon",variant:"ghost",className:"h-8 w-8 rounded-none hover:bg-primary/20",onClick:()=>re("next"),"data-testid":"button-next",children:r.jsx(Tn,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{className:"font-arcade text-sm md:text-lg text-primary hover:text-primary/80 flex items-center gap-1 transition-colors",onClick:()=>A(!L),"data-testid":"text-header-title",children:[ce(),r.jsx(fs,{className:K("w-4 h-4 transition-transform",L&&"rotate-180")})]}),L&&r.jsx("div",{className:"absolute top-full left-0 mt-2 z-50 bg-black border-2 border-primary p-2 shadow-lg",children:r.jsxs("div",{className:"grid grid-cols-7 gap-1 text-center min-w-[200px]",children:[["S","M","T","W","T","F","S"].map((a,p)=>r.jsx("div",{className:"font-arcade text-[8px] text-muted-foreground p-1",children:a},p)),cn({start:an(dn(n),{weekStartsOn:0}),end:Hn(ln(n),{weekStartsOn:0})}).slice(0,42).map((a,p)=>r.jsx("button",{onClick:()=>{pe(a),A(!1)},className:K("font-terminal text-[10px] p-1 hover:bg-primary/20 transition-colors",!_n(a,n)&&"text-muted-foreground/50",Be(a)&&"bg-primary text-black",bs(a,n)&&!Be(a)&&"ring-1 ring-primary"),children:Q(a,"d")},p))]})})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative hidden md:block",children:[r.jsx(Cs,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-muted-foreground"}),r.jsx(ae,{className:"rounded-none bg-black/60 border-secondary pl-7 pr-2 font-terminal text-xs h-8 w-40",placeholder:"Search...",value:E,onChange:a=>x(a.target.value),"data-testid":"input-search-events"})]}),r.jsx(ui,{onClick:()=>z(!0)}),r.jsx(F,{size:"sm",variant:"ghost",className:"rounded-none hover:bg-primary/20",onClick:()=>Ne(),disabled:P,"data-testid":"button-sync",children:r.jsx(qn,{className:K("h-4 w-4",P&&"animate-spin")})}),r.jsx("div",{className:"flex border border-secondary rounded-none",children:["month","week","day","tasks"].map(a=>r.jsx(F,{size:"sm",variant:o===a?"default":"ghost",className:K("rounded-none font-arcade text-[10px] px-2",o===a?"bg-primary text-black":""),onClick:()=>i(a),"data-testid":`button-${a}-view`,children:a.toUpperCase()},a))}),r.jsxs(F,{size:"sm",className:"rounded-none font-arcade text-xs bg-primary text-black hover:bg-primary/90",onClick:()=>Xe(n),"data-testid":"button-create-event-header",children:[r.jsx(yn,{className:"w-4 h-4 mr-1"})," CREATE"]})]})]}),r.jsxs("div",{className:"px-4 py-1.5 border-b border-primary/20 bg-black/60 flex items-center gap-3 shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-3 overflow-x-auto flex-1 min-w-0",children:[r.jsx("span",{className:"font-arcade text-[10px] text-muted-foreground shrink-0",children:"CALENDARS:"}),r.jsxs("div",{className:"flex items-center gap-1.5 cursor-pointer hover:opacity-80 transition-opacity shrink-0",onClick:()=>S(!N),children:[r.jsx("div",{className:K("w-2.5 h-2.5 rounded-sm",N?"bg-primary":"bg-muted-foreground/30")}),r.jsx("span",{className:K("font-terminal text-xs",N?"text-primary":"text-muted-foreground"),children:"Local"})]}),Xt.map(a=>r.jsxs("div",{className:"flex items-center gap-1.5 cursor-pointer hover:opacity-80 transition-opacity shrink-0",onClick:()=>Jt(a.id),children:[r.jsx("div",{className:"w-2.5 h-2.5 rounded-sm",style:{backgroundColor:D.has(a.id)?a.color:"rgba(100,100,100,0.3)"}}),r.jsx("span",{className:K("font-terminal text-xs truncate max-w-[80px]",D.has(a.id)?"":"text-muted-foreground"),children:a.name})]},a.id)),W.length>0&&r.jsxs("span",{className:"font-terminal text-[10px] text-muted-foreground shrink-0",children:["+",W.length," hidden"]})]}),r.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[r.jsx(F,{size:"sm",variant:"ghost",className:"h-6 px-2 rounded-none hover:bg-primary/20 font-arcade text-[9px]",onClick:()=>ee(!0),children:"MANAGE"}),ct?.connected?r.jsxs("div",{className:"flex items-center gap-1 text-green-500",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-current"}),r.jsx("span",{className:"font-terminal text-[10px]",children:"SYNCED"})]}):r.jsx(F,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none border-yellow-500 text-yellow-500 hover:bg-yellow-500/20 font-arcade text-[9px]",onClick:()=>Ve.mutate(),disabled:Ve.isPending,children:Ve.isPending?"CONNECTING...":"CONNECT GOOGLE"})]})]}),r.jsx(mt,{open:Ge,onOpenChange:ee,children:r.jsxs(pt,{className:"bg-black border-2 border-primary rounded-none max-w-md",children:[r.jsx(sn,{children:r.jsx(on,{className:"font-arcade text-primary",children:"MANAGE CALENDARS"})}),r.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:[r.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:"Toggle calendars to show/hide them in the legend."}),he.map(a=>r.jsxs("div",{className:K("flex items-center gap-3 p-2 border border-zinc-800 cursor-pointer hover:bg-zinc-900 transition-colors",W.includes(a.id)&&"opacity-50"),onClick:()=>$e(a.id),children:[r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:a.color}}),r.jsx("span",{className:"font-terminal text-sm flex-1",children:a.name}),r.jsx("span",{className:K("font-arcade text-[10px] px-2 py-0.5",W.includes(a.id)?"text-red-500":"text-green-500"),children:W.includes(a.id)?"HIDDEN":"VISIBLE"})]},a.id))]}),r.jsx(Lt,{children:r.jsx(F,{variant:"outline",className:"rounded-none border-primary font-arcade text-xs",onClick:()=>ee(!1),children:"CLOSE"})})]})}),r.jsxs(ms,{className:"p-0 flex-1 overflow-hidden flex flex-col",children:[o==="month"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-7 border-b border-zinc-800 bg-zinc-900/80 shrink-0",children:["SUN","MON","TUE","WED","THU","FRI","SAT"].map(a=>r.jsx("div",{className:"p-2 text-center font-arcade text-xs text-zinc-400 border-r border-zinc-800 last:border-r-0",children:a},a))}),r.jsx("div",{className:"grid grid-cols-7 flex-1 overflow-auto",children:Ue.map((a,p)=>{const b=Y(a),j=_n(a,n),R=Be(a);return r.jsxs("div",{onClick:()=>pe(a),className:K("min-h-[90px] border-r border-b border-zinc-800 p-1.5 cursor-pointer transition-colors hover:bg-zinc-800/50",!j&&"bg-zinc-900/60 text-zinc-600",p%7===6&&"border-r-0"),"data-testid":`day-cell-${Q(a,"yyyy-MM-dd")}`,children:[r.jsx("div",{className:K("text-right font-mono text-sm w-6 h-6 flex items-center justify-center ml-auto",R&&"bg-red-500 text-white rounded-full font-bold"),children:Q(a,"d")}),r.jsxs("div",{className:"space-y-0.5 mt-1",children:[b.slice(0,3).map((M,$)=>r.jsx("div",{className:K("text-[10px] font-mono truncate px-1.5 py-0.5 rounded cursor-pointer hover:brightness-110",B(M)),style:se(M),title:M.title,onClick:oe=>{oe.stopPropagation(),He(M)},children:M.title},`${M.id}-${$}`)),b.length>3&&r.jsxs("div",{className:"text-[10px] font-mono text-zinc-400 px-1 mt-0.5",children:["+",b.length-3," more"]})]})]},p)})})]}),o==="week"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-8 border-b border-zinc-800 bg-zinc-900/80 shrink-0",children:[r.jsx("div",{className:"p-2 w-16 border-r border-zinc-800"}),Re.map(a=>r.jsxs("div",{className:"p-2 text-center border-r border-zinc-800 last:border-r-0 cursor-pointer hover:bg-zinc-800/50",onClick:()=>pe(a),children:[r.jsx("div",{className:"font-arcade text-xs text-zinc-400",children:Q(a,"EEE").toUpperCase()}),r.jsx("div",{className:K("font-mono text-lg mt-1 w-8 h-8 flex items-center justify-center mx-auto",Be(a)&&"bg-red-500 text-white rounded-full font-bold"),children:Q(a,"d")})]},a.toISOString()))]}),r.jsxs("div",{className:"grid grid-cols-8 border-b border-zinc-800 bg-zinc-900/60 shrink-0",children:[r.jsx("div",{className:"p-1 w-16 border-r border-zinc-800 text-xs font-mono text-zinc-500 text-right pr-2",children:"ALL DAY"}),Re.map(a=>{const p=Y(a).filter(b=>b.allDay);return r.jsx("div",{className:"border-r border-zinc-800 last:border-r-0 p-0.5 min-h-[28px]",children:p.map((b,j)=>r.jsx("div",{className:K("text-[10px] font-mono truncate px-1.5 py-0.5 rounded cursor-pointer hover:brightness-110",B(b)),style:se(b),onClick:R=>{R.stopPropagation(),He(b)},children:b.title},j))},`allday-${a.toISOString()}`)})]}),r.jsx(bn,{className:"flex-1",children:r.jsxs("div",{className:"grid grid-cols-8 relative",style:{height:`${24*_e}px`},children:[r.jsx("div",{className:"w-16 border-r border-zinc-800",children:pn.map(a=>r.jsx("div",{className:"border-b border-zinc-800/50 text-right pr-2 font-mono text-[11px] text-zinc-500",style:{height:`${_e}px`},children:a===0?"12 AM":a<12?`${a} AM`:a===12?"12 PM":`${a-12} PM`},a))}),Re.map(a=>{const p=Ae(Oe(a,0),0),b=Y(a).filter(R=>!R.allDay),j=q(b);return r.jsxs("div",{className:"relative border-r border-zinc-800/50 last:border-r-0",children:[pn.map(R=>r.jsx("div",{className:"border-b border-zinc-800/30 cursor-pointer hover:bg-zinc-800/30",style:{height:`${_e}px`},onClick:()=>Xe(a,R)},R)),b.map((R,M)=>{const $=j.get(R.id)||{column:0,totalColumns:1},oe={...Te(R,p,$.column,$.totalColumns),...se(R)};return r.jsxs("div",{className:K("absolute rounded p-1 cursor-pointer overflow-hidden",B(R)),style:oe,onClick:ft=>{ft.stopPropagation(),He(R)},children:[r.jsx("div",{className:"text-[10px] font-mono font-medium truncate",children:R.title}),r.jsx("div",{className:"text-[9px] opacity-80 font-mono",children:Q(R.start,"h:mma")})]},M)})]},a.toISOString())})]})})]}),o==="day"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"p-4 border-b border-zinc-800 bg-zinc-900/80 shrink-0 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-arcade text-xs text-zinc-400",children:Q(n,"EEEE").toUpperCase()}),r.jsx("div",{className:K("font-mono text-2xl font-bold",Be(n)&&"text-red-500"),children:Q(n,"d")})]}),r.jsxs(F,{size:"sm",className:"rounded-none font-arcade text-xs bg-red-500 text-white hover:bg-red-600",onClick:()=>Xe(n),"data-testid":"button-create-event",children:[r.jsx(yn,{className:"w-4 h-4 mr-1"})," CREATE"]})]}),(()=>{const a=Y(n).filter(p=>p.allDay);return a.length===0?null:r.jsxs("div",{className:"p-3 border-b border-secondary/50 bg-black/40 shrink-0 flex gap-2 flex-wrap items-center",children:[r.jsx("span",{className:"font-mono text-sm text-muted-foreground",children:"ALL DAY:"}),a.map((p,b)=>r.jsx("div",{className:K("text-sm font-mono px-3 py-1 rounded cursor-pointer hover:brightness-110",B(p)),style:se(p),onClick:j=>{j.stopPropagation(),He(p)},children:p.title},b))]})})(),r.jsx(bn,{className:"flex-1",children:r.jsxs("div",{className:"relative",style:{height:`${24*_e}px`},children:[pn.map(a=>r.jsxs("div",{className:"flex border-b border-zinc-800/30 cursor-pointer hover:bg-zinc-800/30",style:{height:`${_e}px`},onClick:()=>Xe(n,a),children:[r.jsx("div",{className:"w-20 text-right pr-2 font-mono text-xs text-zinc-500 shrink-0 pt-1",children:a===0?"12 AM":a<12?`${a} AM`:a===12?"12 PM":`${a-12} PM`}),r.jsx("div",{className:"flex-1 border-l border-zinc-800/50"})]},a)),(()=>{const a=Y(n).filter(j=>!j.allDay),p=q(a),b=Ae(Oe(n,0),0);return r.jsx("div",{className:"absolute top-0 left-20 right-0",children:a.map((j,R)=>{const M=p.get(j.id)||{column:0,totalColumns:1},$={...Te(j,b,M.column,M.totalColumns),...se(j)};return r.jsxs("div",{className:K("absolute rounded p-2 cursor-pointer",B(j)),style:$,onClick:oe=>{oe.stopPropagation(),He(j)},children:[r.jsx("div",{className:"font-bold text-sm font-mono truncate",children:j.title}),r.jsxs("div",{className:"text-xs font-mono opacity-80",children:[Q(j.start,"h:mm a")," - ",Q(j.end,"h:mm a")]})]},R)})})})()]})})]}),o==="tasks"&&r.jsx("div",{className:"flex-1 overflow-hidden bg-black/40 p-4",children:r.jsx(hi,{tasks:Se,taskLists:St})})]})]})})}),r.jsx(mt,{open:l,onOpenChange:c,children:r.jsxs(pt,{className:"bg-black border-2 border-primary rounded-none max-w-lg max-h-[90vh] overflow-y-auto",children:[r.jsx(sn,{children:r.jsx(on,{className:"font-arcade text-primary",children:"CREATE_EVENT"})}),r.jsxs("div",{className:"space-y-4 py-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"TITLE"}),r.jsx(ae,{className:"rounded-none bg-black border-secondary focus-visible:ring-primary",placeholder:"Event title...",value:m.title,onChange:a=>v({...m,title:a.target.value}),"data-testid":"input-modal-title"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"START DATE"}),r.jsx(ae,{type:"date",className:"rounded-none bg-black border-secondary",value:m.date,onChange:a=>v({...m,date:a.target.value}),"data-testid":"input-modal-date"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"END DATE"}),r.jsx(ae,{type:"date",className:"rounded-none bg-black border-secondary",value:m.endDate,onChange:a=>v({...m,endDate:a.target.value}),placeholder:m.date,"data-testid":"input-modal-end-date"})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ps,{id:"allDay",checked:m.allDay,onCheckedChange:a=>v({...m,allDay:!!a})}),r.jsx(H,{htmlFor:"allDay",className:"font-terminal text-sm",children:"All day"})]}),!m.allDay&&r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"START TIME"}),r.jsx(ae,{type:"time",className:"rounded-none bg-black border-secondary",value:m.startTime,onChange:a=>v({...m,startTime:a.target.value}),"data-testid":"input-modal-start"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"END TIME"}),r.jsx(ae,{type:"time",className:"rounded-none bg-black border-secondary",value:m.endTime,onChange:a=>v({...m,endTime:a.target.value}),"data-testid":"input-modal-end"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"TYPE"}),r.jsxs(Je,{value:m.eventType,onValueChange:a=>v({...m,eventType:a}),children:[r.jsx(Ze,{className:"rounded-none bg-black border-secondary","data-testid":"select-event-type",children:r.jsx(et,{})}),r.jsxs(tt,{className:"rounded-none bg-black border-primary",children:[r.jsx(G,{value:"study",children:"STUDY"}),r.jsx(G,{value:"lecture",children:"LECTURE"}),r.jsx(G,{value:"exam",children:"EXAM"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"COLOR"}),r.jsx("div",{className:"flex gap-2 flex-wrap",children:["#ef4444","#f97316","#eab308","#22c55e","#3b82f6","#8b5cf6","#ec4899","#6b7280"].map(a=>r.jsx("button",{type:"button",className:K("w-6 h-6 rounded-sm border-2",m.color===a?"border-white":"border-transparent"),style:{backgroundColor:a},onClick:()=>v({...m,color:a}),"data-testid":`color-${a}`},a))})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"REPEAT"}),r.jsxs(Je,{value:m.recurrence,onValueChange:a=>v({...m,recurrence:a}),children:[r.jsx(Ze,{className:"rounded-none bg-black border-secondary","data-testid":"select-recurrence",children:r.jsx(et,{placeholder:"No repeat"})}),r.jsxs(tt,{className:"rounded-none bg-black border-primary",children:[r.jsx(G,{value:"none",children:"NO REPEAT"}),r.jsx(G,{value:"daily",children:"DAILY"}),r.jsx(G,{value:"weekly",children:"WEEKLY"}),r.jsx(G,{value:"monthly",children:"MONTHLY"}),r.jsx(G,{value:"yearly",children:"YEARLY"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"CALENDAR"}),r.jsxs(Je,{value:m.calendarId,onValueChange:a=>v({...m,calendarId:a}),children:[r.jsx(Ze,{className:"rounded-none bg-black border-secondary","data-testid":"select-calendar",children:r.jsx(et,{placeholder:"Local"})}),r.jsxs(tt,{className:"rounded-none bg-black border-primary",children:[r.jsx(G,{value:"local",children:"LOCAL"}),he.map(a=>r.jsx(G,{value:a.id,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:a.color}}),a.name]})},a.id))]})]})]})]})]}),r.jsxs(Lt,{children:[r.jsx(F,{variant:"ghost",className:"rounded-none font-arcade text-xs",onClick:()=>c(!1),children:"CANCEL"}),r.jsx(F,{className:"rounded-none font-arcade text-xs bg-primary text-black hover:bg-primary/90",onClick:Rt,disabled:!m.title||!m.date,"data-testid":"button-save-event",children:"SAVE"})]})]})}),r.jsx(mt,{open:u,onOpenChange:h,children:r.jsxs(pt,{className:"bg-black border-2 border-primary rounded-none max-w-md",children:[r.jsx(sn,{children:r.jsx(on,{className:"font-arcade text-primary",children:"EDIT_EVENT"})}),f&&r.jsxs("div",{className:"space-y-4 py-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"TITLE"}),r.jsx(ae,{className:"rounded-none bg-black border-secondary focus-visible:ring-primary",value:f.title,onChange:a=>g({...f,title:a.target.value}),"data-testid":"input-edit-title"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"DATE"}),r.jsx(ae,{type:"date",className:"rounded-none bg-black border-secondary",value:Q(new Date(f.date),"yyyy-MM-dd"),onChange:a=>{const[p,b]=[new Date(f.date).getHours(),new Date(f.date).getMinutes()];g({...f,date:Oe(Ae(new Date(a.target.value),p),b)})},"data-testid":"input-edit-date"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"TIME"}),r.jsx(ae,{type:"time",className:"rounded-none bg-black border-secondary",value:Q(new Date(f.date),"HH:mm"),onChange:a=>{const[p,b]=a.target.value.split(":").map(Number);g({...f,date:Oe(Ae(new Date(f.date),p),b)})},"data-testid":"input-edit-time"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"font-arcade text-xs",children:"TYPE"}),r.jsxs(Je,{value:f.eventType||"study",onValueChange:a=>g({...f,eventType:a}),children:[r.jsx(Ze,{className:"rounded-none bg-black border-secondary","data-testid":"select-edit-type",children:r.jsx(et,{})}),r.jsxs(tt,{className:"rounded-none bg-black border-primary",children:[r.jsx(G,{value:"study",children:"STUDY"}),r.jsx(G,{value:"lecture",children:"LECTURE"}),r.jsx(G,{value:"exam",children:"EXAM"})]})]})]})]}),r.jsxs(Lt,{className:"flex justify-between",children:[r.jsxs(F,{variant:"ghost",className:"rounded-none font-arcade text-xs text-red-500 hover:text-red-400 hover:bg-red-500/10",onClick:()=>f&&Ke.mutate(f.id),"data-testid":"button-delete-event",children:[r.jsx(vn,{className:"w-4 h-4 mr-1"})," DELETE"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(F,{variant:"ghost",className:"rounded-none font-arcade text-xs",onClick:()=>h(!1),children:"CANCEL"}),r.jsx(F,{className:"rounded-none font-arcade text-xs bg-primary text-black hover:bg-primary/90",onClick:()=>f&&Ie.mutate({id:f.id,data:{title:f.title,date:f.date,eventType:f.eventType}}),"data-testid":"button-update-event",children:"UPDATE"})]})]})]})}),r.jsx(mt,{open:I,onOpenChange:T,children:r.jsx(pt,{className:"font-arcade bg-black border-2 border-green-500 rounded-none max-w-md p-0 overflow-hidden",children:w&&r.jsxs("div",{className:"flex flex-col h-full",children:[r.jsxs("div",{className:"bg-green-500/20 border-b border-green-500 p-4 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),r.jsx("span",{className:"text-green-500 font-bold tracking-wider",children:"EDIT_GOOGLE_EVENT"})]}),w.recurringEventId&&r.jsx(Yn,{variant:"outline",className:"text-[10px] border-green-500 text-green-500",children:"INSTANCE"}),w.recurrence&&r.jsx(Yn,{variant:"outline",className:"text-[10px] border-green-500 text-green-500",children:"SERIES"})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"text-xs text-green-500/80",children:"EVENT_TITLE_"}),r.jsx(ae,{value:w.summary||"",onChange:a=>C({...w,summary:a.target.value}),className:"bg-black border-green-500/50 focus:border-green-500 text-green-500 font-terminal text-lg h-12 rounded-none"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"text-xs text-green-500/80",children:"START_TIME_"}),r.jsx(ae,{type:"datetime-local",value:w.start?.dateTime?.substring(0,16)||w.start?.date+"T00:00"||"",onChange:a=>{const p=a.target.value;C({...w,start:{dateTime:p}})},disabled:!!w.start?.date&&!w.start?.dateTime,className:"bg-black border-green-500/50 text-green-500 font-terminal rounded-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"text-xs text-green-500/80",children:"END_TIME_"}),r.jsx(ae,{type:"datetime-local",value:w.end?.dateTime?.substring(0,16)||w.end?.date+"T00:00"||"",onChange:a=>C({...w,end:{dateTime:a.target.value}}),disabled:!!w.end?.date&&!w.end?.dateTime,className:"bg-black border-green-500/50 text-green-500 font-terminal rounded-none"})]})]}),!w.recurringEventId&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{className:"text-xs text-green-500/80 flex items-center gap-2",children:["RECURRENCE_PATTERN_",r.jsx(qn,{className:"w-3 h-3"})]}),r.jsxs(Je,{value:w.recurrence?.[0]||"none",onValueChange:a=>{C({...w,recurrence:a==="none"?void 0:[a]})},children:[r.jsx(Ze,{className:"bg-black border-green-500/50 text-green-500 rounded-none h-8 font-terminal text-xs",children:r.jsx(et,{placeholder:"No Recurrence"})}),r.jsxs(tt,{className:"bg-black border-green-500 text-green-500 font-terminal",children:[r.jsx(G,{value:"none",children:"None"}),r.jsx(G,{value:"RRULE:FREQ=DAILY",children:"Daily"}),r.jsx(G,{value:"RRULE:FREQ=WEEKLY",children:"Weekly"}),r.jsx(G,{value:"RRULE:FREQ=MONTHLY",children:"Monthly"}),r.jsx(G,{value:"RRULE:FREQ=YEARLY",children:"Yearly"})]})]}),w.recurrence&&!["RRULE:FREQ=DAILY","RRULE:FREQ=WEEKLY","RRULE:FREQ=MONTHLY","RRULE:FREQ=YEARLY"].includes(w.recurrence[0])&&r.jsx(xn,{value:w.recurrence[0],onChange:a=>C({...w,recurrence:[a.target.value]}),className:"bg-black border-green-500/30 text-green-100/70 text-[10px] font-mono h-12 rounded-none",placeholder:"RRULE:FREQ=WEEKLY;BYDAY=MO,WE"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{className:"text-xs text-green-500/80",children:"DESCRIPTION_"}),r.jsx(xn,{value:w.description||"",onChange:a=>C({...w,description:a.target.value}),className:"bg-black border-green-500/50 text-green-500 font-terminal min-h-[100px] rounded-none resize-none"})]}),r.jsxs("div",{className:"pt-2 flex items-center justify-between gap-4 border-t border-green-500/20 mt-4",children:[r.jsxs(F,{variant:"destructive",size:"sm",onClick:Tt,className:"rounded-none bg-red-900/20 text-red-500 hover:bg-red-900/40 border border-red-900/50 font-arcade text-xs",children:[r.jsx(vn,{className:"w-4 h-4 mr-2"}),"DELETE"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(F,{variant:"ghost",className:"bg-transparent border border-green-500/50 text-green-500 hover:bg-green-500/10 rounded-none font-arcade text-xs",onClick:()=>window.open(w.htmlLink,"_blank"),children:[r.jsx(Es,{className:"w-4 h-4 mr-2"})," OPEN"]}),r.jsx(F,{className:"bg-green-500 text-black hover:bg-green-400 rounded-none font-arcade text-xs px-6",onClick:Zt,children:"SAVE CHANGES"})]})]})]})]})})}),r.jsx(fi,{isOpen:k,onClose:()=>z(!1)})]})}export{ji as default};
