import{c as G,u as Ye,a as Be,j as e,r as l,b as K}from"./index-vxaivTfW.js";import{u as y,a as c,b as o,L as vt,D as O,c as Ne,B as m,d as L,e as Q,f as P,g as $,I as u,P as Pe,T as J,C as Ct,h as wt,G as kt,S as Dt}from"./layout-BYzKcK-t.js";import{C,a as D,b as S,c as w}from"./card-8vEaI0SE.js";import{S as ee,a as te,b as se,c as ae,d as x}from"./select-Cl2h7SLP.js";import{A as St,a as Tt,b as Et,c as At,d as qt,e as Mt,f as _t,g as It}from"./alert-dialog-DoWn_RlI.js";import{P as ne,C as Ft,i as ve,a as re,b as $e}from"./isTomorrow-C4CQCMlR.js";import{C as Kt}from"./clock-Brhlla2-.js";import{B as Ot}from"./book-open-D4GgueXi.js";import{C as Ge}from"./circle-check-CrN8qPMT.js";import{t as Ue,d as Lt,f as ze,i as Ce}from"./format-D7m0hUtg.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Re=G("circle",Qt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],$t=G("flame",Pt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["rect",{x:"3",y:"4",width:"6",height:"6",rx:"1",key:"cif1o7"}]],Ut=G("list-todo",Gt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Rt=G("play",zt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],He=G("triangle-alert",Ht);function Vt(){const s=Ye(),{toast:r}=Be(),{data:d=[],isLoading:p}=y({queryKey:["planner","queue"],queryFn:o.planner.getQueue}),{data:N}=y({queryKey:["planner","settings"],queryFn:o.planner.getSettings}),g=c({mutationFn:o.planner.generate,onSuccess:n=>{r({title:"Tasks generated",description:`${n.tasks_created} review tasks created`}),s.invalidateQueries({queryKey:["planner","queue"]})},onError:n=>{r({title:"Generation failed",description:n.message,variant:"destructive"})}}),h=c({mutationFn:n=>o.planner.updateTask(n,{status:"completed"}),onSuccess:()=>{s.invalidateQueries({queryKey:["planner","queue"]})}}),f=c({mutationFn:n=>o.planner.updateTask(n,{status:"deferred"}),onSuccess:()=>{s.invalidateQueries({queryKey:["planner","queue"]})}}),_=c({mutationFn:n=>o.planner.updateSettings(n),onSuccess:()=>{s.invalidateQueries({queryKey:["planner","settings"]}),r({title:"Settings saved"})}}),T=new Date().toISOString().slice(0,10),E=d.filter(n=>n.scheduled_date&&n.scheduled_date<=T),k=d.filter(n=>!n.scheduled_date||n.scheduled_date>T);return e.jsxs(C,{className:"bg-black/40 border-2 border-primary rounded-none",children:[e.jsx(D,{className:"border-b border-primary/50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(S,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-primary inline-block"}),"NEXT_ACTIONS"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-terminal text-xs text-muted-foreground",children:["Source: ",N?.calendar_source==="google"?"Google":"Local"]}),e.jsx("button",{onClick:()=>_.mutate({calendar_source:N?.calendar_source==="google"?"local":"google"}),className:"px-2 py-1 border border-primary/30 text-xs font-arcade text-muted-foreground hover:text-white rounded-none",children:"TOGGLE"}),e.jsx("button",{onClick:()=>g.mutate(),disabled:g.isPending,className:"px-3 py-1 bg-primary text-black font-arcade text-xs rounded-none hover:bg-primary/80 disabled:opacity-50",children:g.isPending?"...":"GENERATE"})]})]})}),e.jsxs(w,{className:"p-4 space-y-4",children:[p&&e.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"Loading queue..."}),!p&&d.length===0&&e.jsx("div",{className:"font-terminal text-xs text-muted-foreground text-center py-4",children:"No pending tasks. Click GENERATE to create review tasks from weak anchors."}),E.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"font-arcade text-xs text-primary mb-2",children:["TODAY (",E.length,")"]}),e.jsx("div",{className:"space-y-2",children:E.map(n=>e.jsx(Ve,{task:n,onComplete:()=>h.mutate(n.id),onDefer:()=>f.mutate(n.id)},n.id))})]}),k.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"font-arcade text-xs text-muted-foreground mb-2",children:["UPCOMING (",k.length,")"]}),e.jsx("div",{className:"space-y-2",children:k.slice(0,10).map(n=>e.jsx(Ve,{task:n,onComplete:()=>h.mutate(n.id),onDefer:()=>f.mutate(n.id)},n.id))})]})]})]})}function Ve({task:s,onComplete:r,onDefer:d}){return e.jsxs("div",{className:"flex items-center justify-between border border-primary/20 bg-black/30 p-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-terminal text-xs text-white truncate",children:[s.review_number?`R${s.review_number}`:""," ",s.anchor_text||s.notes||"Untitled"]}),e.jsxs("div",{className:"font-terminal text-xs text-muted-foreground flex gap-3",children:[s.course_name&&e.jsx("span",{children:s.course_name}),s.scheduled_date&&e.jsx("span",{children:s.scheduled_date}),s.planned_minutes&&e.jsxs("span",{children:[s.planned_minutes,"m"]})]})]}),e.jsxs("div",{className:"flex gap-1 ml-2",children:[e.jsx("button",{onClick:r,className:"px-2 py-1 text-xs font-arcade bg-green-900/50 text-green-400 border border-green-500/30 hover:bg-green-900 rounded-none",children:"DONE"}),e.jsx("button",{onClick:d,className:"px-2 py-1 text-xs font-arcade bg-yellow-900/50 text-yellow-400 border border-yellow-500/30 hover:bg-yellow-900 rounded-none",children:"DEFER"})]})]})}function Wt(s,r){const d=Ue(s),p=Ue(r),N=We(d,p),g=Math.abs(Lt(d,p));d.setDate(d.getDate()-N*g);const h=+(We(d,p)===-N),f=N*(g-h);return f===0?0:f}function We(s,r){const d=s.getFullYear()-r.getFullYear()||s.getMonth()-r.getMonth()||s.getDate()-r.getDate()||s.getHours()-r.getHours()||s.getMinutes()-r.getMinutes()||s.getSeconds()-r.getSeconds()||s.getMilliseconds()-r.getMilliseconds();return d<0?-1:d>0?1:d}function rs(){const s=Ye(),{toast:r}=Be(),[d,p]=l.useState(""),[N,g]=l.useState(!1),[h,f]=l.useState(""),[_,T]=l.useState(""),[E,k]=l.useState(!1),[n,oe]=l.useState(null),[U,z]=l.useState(""),[we,R]=l.useState(""),[H,de]=l.useState(null),A={zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},[Xe,le]=l.useState(0),[ke,Ze]=l.useState(!1),[V,De]=l.useState(""),[ie,W]=l.useState(null),[I,ce]=l.useState(""),[Y,ue]=l.useState(""),[q,me]=l.useState(""),[B,xe]=l.useState("none"),[Je,Se]=l.useState(!1),[he,et]=l.useState("all"),[i,M]=l.useState({title:"",course:"",type:"assignment",dueDate:"",notes:""}),{data:tt}=y({queryKey:["study-wheel","current"],queryFn:o.studyWheel.getCurrentCourse}),{data:v=[]}=y({queryKey:["courses","active"],queryFn:o.courses.getActive}),{data:Te=[]}=y({queryKey:["sessions","today"],queryFn:o.todaySessions.get}),{data:st}=y({queryKey:["streak"],queryFn:o.streak.get}),{data:Ee=[]}=y({queryKey:["weakness-queue"],queryFn:o.weaknessQueue.get}),{data:pe=[]}=y({queryKey:["academic-deadlines"],queryFn:o.academicDeadlines.getAll}),{data:b=[]}=y({queryKey:["google-task-lists"],queryFn:o.googleTasks.getLists}),{data:at=[]}=y({queryKey:["google-tasks"],queryFn:o.googleTasks.getAll});l.useEffect(()=>{if(ke||!b.length)return;const t=b.findIndex(a=>a.title?.toLowerCase().includes("school"));t>=0&&le(t),Ze(!0)},[b,ke]);const Ae=c({mutationFn:({courseId:t,mins:a})=>o.studyWheel.completeSession(t,a),onSuccess:()=>{s.invalidateQueries({queryKey:["study-wheel"]}),s.invalidateQueries({queryKey:["courses"]}),s.invalidateQueries({queryKey:["sessions"]}),s.invalidateQueries({queryKey:["streak"]}),p(""),g(!1),r({title:"Session logged!",description:"Wheel rotated to next course."})},onError:()=>{r({title:"Error",description:"Failed to log session. Please try again.",variant:"destructive"})}}),ge=c({mutationFn:({name:t,code:a})=>o.courses.create({name:t,code:a,active:!0,position:v.length}),onSuccess:()=>{s.invalidateQueries({queryKey:["courses"]}),s.invalidateQueries({queryKey:["study-wheel"]}),f(""),T(""),k(!1),r({title:"Course added!",description:"New course added to the wheel."})},onError:()=>{r({title:"Error",description:"Failed to add course. Please try again.",variant:"destructive"})}}),qe=c({mutationFn:({id:t,name:a,code:j})=>o.courses.update(t,{name:a,code:j}),onSuccess:()=>{s.invalidateQueries({queryKey:["courses"]}),s.invalidateQueries({queryKey:["study-wheel"]}),oe(null),z(""),R(""),r({title:"Course updated!",description:"Course name has been changed."})},onError:()=>{r({title:"Error",description:"Failed to update course. Please try again.",variant:"destructive"})}}),nt=c({mutationFn:t=>o.courses.delete(t),onSuccess:()=>{s.invalidateQueries({queryKey:["courses","active"]}),s.invalidateQueries({queryKey:["study-wheel","current"]}),s.invalidateQueries({queryKey:["study-wheel"]}),r({title:"Course deleted!",description:"Course has been removed from the wheel."})},onError:t=>{console.error("Delete failed:",t),r({title:"Error",description:"Failed to delete course. Please try again.",variant:"destructive"})}}),Me=c({mutationFn:t=>o.googleTasks.update(t.id,t.listId,{status:t.status==="completed"?"needsAction":"completed"}),onSuccess:()=>{s.invalidateQueries({queryKey:["google-tasks"]})}}),_e=c({mutationFn:t=>o.googleTasks.create(t.listId,{title:t.title,status:"needsAction"}),onSuccess:()=>{s.invalidateQueries({queryKey:["google-tasks"]}),De("")}}),Ie=c({mutationFn:t=>o.googleTasks.update(t.task.id,t.task.listId,t.data),onSuccess:()=>{s.invalidateQueries({queryKey:["google-tasks"]}),W(null),ce(""),ue(""),me(""),xe("none")}}),Fe=c({mutationFn:t=>o.googleTasks.delete(t.id,t.listId),onSuccess:()=>{s.invalidateQueries({queryKey:["google-tasks"]})}}),ye=c({mutationFn:t=>o.academicDeadlines.create(t),onSuccess:()=>{s.invalidateQueries({queryKey:["academic-deadlines"]}),Se(!1),M({title:"",course:"",type:"assignment",dueDate:"",notes:""}),r({title:"Deadline added!",description:"Academic deadline has been created."})},onError:()=>{r({title:"Error",description:"Failed to add deadline.",variant:"destructive"})}}),rt=c({mutationFn:t=>o.academicDeadlines.toggleComplete(t),onSuccess:()=>{s.invalidateQueries({queryKey:["academic-deadlines"]})}}),ot=c({mutationFn:t=>o.academicDeadlines.delete(t),onSuccess:()=>{s.invalidateQueries({queryKey:["academic-deadlines"]}),r({title:"Deadline removed",description:"Academic deadline has been deleted."})}}),X=tt?.currentCourse,dt=Te.reduce((t,a)=>t+(a.minutes||0),0),Ke=Te.length,fe=Ke>0,lt=()=>{!X||!d||parseInt(d)<1||Ae.mutate({courseId:X.id,mins:parseInt(d)})},Oe=()=>{h.trim()&&ge.mutate({name:h.trim(),code:_.trim()||void 0})},it=()=>{!n||!U.trim()||qe.mutate({id:n.id,name:U.trim(),code:we.trim()||null})},ct=()=>{H&&(nt.mutate(H.id),de(null))},ut=t=>{oe(t),z(t.name),R(t.code??"")},mt=()=>{!i.title?.trim()||!i.dueDate||ye.mutate(i)},xt=t=>{const a=new Date(t);if(!Ce(a))return"unknown";if(ve(a)&&!re(a))return"overdue";if(re(a))return"today";if($e(a))return"tomorrow";const j=Wt(a,new Date);return j<=3?"soon":j<=7?"week":"later"},ht=t=>{switch(t){case"exam":return"ðŸ“";case"quiz":return"â“";case"project":return"ðŸ“‚";default:return"ðŸ“‹"}},pt=t=>{switch(t){case"overdue":return"border-red-500 bg-red-500/20 text-red-400";case"today":return"border-orange-500 bg-orange-500/20 text-orange-400";case"tomorrow":return"border-yellow-500 bg-yellow-500/20 text-yellow-400";case"soon":return"border-blue-500 bg-blue-500/20 text-blue-400";default:return"border-secondary/30 text-muted-foreground"}},Le={};v.forEach(t=>{Le[String(t.id)]=t.name});const Z=t=>t?/^\d+$/.test(t)?Le[t]||"":t:"",gt=[...new Set([...pe.map(t=>Z(t.course)).filter(Boolean),...v.map(t=>t.name)])].sort(),yt=[...pe].filter(t=>he==="all"||Z(t.course)===he).sort((t,a)=>t.completed!==a.completed?t.completed?1:-1:new Date(t.dueDate).getTime()-new Date(a.dueDate).getTime()),F=b[Xe],be=F?at.filter(t=>t.listId===F.id):[],ft=be.filter(t=>t.status!=="completed"),je=be.filter(t=>t.status==="completed"),Qe=()=>{!V.trim()||!F||_e.mutate({listId:F.id,title:V.trim()})},bt=()=>{if(!ie||!I.trim())return;const t={title:I.trim()};Y&&(t.notes=Y),q&&(t.due=new Date(q).toISOString()),Ie.mutate({task:ie,data:t}),B!=="none"&&q&&ye.mutate({title:I.trim(),type:B,dueDate:q,course:"",notes:Y||""})},jt=t=>{W(t),ce(t.title),ue(t.notes||""),me(t.due?t.due.split("T")[0]:""),xe("none")},Nt=t=>{if(!t)return null;const a=new Date(t);return Ce(a)?re(a)?"Today":$e(a)?"Tomorrow":ve(a)?"Overdue":ze(a,"MMM d"):null};return e.jsx(vt,{children:e.jsxs("div",{className:"space-y-6 max-w-5xl mx-auto",children:[e.jsx(Vt,{}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 grid-rows-[auto]",children:[e.jsxs(C,{className:"bg-black/40 border-2 border-primary rounded-none md:col-span-2",children:[e.jsx(D,{className:"border-b border-primary/50 p-4",children:e.jsxs(S,{className:"font-arcade text-sm flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4"}),"STUDY_WHEEL"]}),e.jsxs("div",{className:"flex items-center gap-2 bg-black/40 border border-secondary px-3 py-1","data-testid":"streak-display",children:[e.jsx($t,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"font-arcade text-sm text-white","data-testid":"text-streak",children:st?.currentStreak||0}),e.jsx("span",{className:"font-terminal text-[10px] text-muted-foreground",children:"DAY STREAK"})]})]})}),e.jsx(w,{className:"p-4",children:v.length===0?e.jsxs("div",{className:"text-center py-8 space-y-4",children:[e.jsx("p",{className:"font-terminal text-muted-foreground",children:"No courses added yet. Add courses to start the study wheel."}),e.jsxs(O,{open:E,onOpenChange:k,children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:"rounded-none border-primary font-arcade","data-testid":"button-add-first-course",children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"ADD_COURSE"]})}),e.jsxs(L,{className:"bg-black border-2 border-primary rounded-none translate-y-0",style:A,children:[e.jsxs(Q,{children:[e.jsx(P,{className:"font-arcade",children:"ADD_NEW_COURSE"}),e.jsx($,{className:"sr-only",children:"Enter course details to add a new course."})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx(u,{placeholder:"Course name (e.g., Anatomy)",value:h,onChange:t=>f(t.target.value),className:"rounded-none border-secondary bg-black font-terminal","data-testid":"input-course-name"}),e.jsx(u,{placeholder:"Course number (e.g., PHTH 5301)",value:_,onChange:t=>T(t.target.value),className:"rounded-none border-secondary bg-black font-terminal","data-testid":"input-course-code"}),e.jsx(m,{onClick:Oe,disabled:!h.trim()||ge.isPending,className:"w-full rounded-none font-arcade","data-testid":"button-confirm-add-course",children:"ADD"})]})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("p",{className:"font-terminal text-muted-foreground text-sm",children:"â–¶ NEXT UP"}),e.jsx("p",{className:"font-arcade text-2xl text-primary","data-testid":"text-current-course",children:X?.name||"LOADING..."})]}),e.jsxs("div",{className:"flex flex-col gap-1 max-w-md mx-auto",children:[v.map((t,a)=>e.jsxs("div",{className:`flex items-center justify-between px-4 py-2 border transition-all duration-300 ${a===0?"border-primary bg-primary/20 scale-105":"border-secondary/30 opacity-70 hover:opacity-100"}`,style:{transform:a===0?"scale(1.02)":`scale(${1-a*.02})`,opacity:a===0?1:Math.max(.4,1-a*.15)},"data-testid":`wheel-course-${t.id}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`font-arcade text-xs w-6 h-6 flex items-center justify-center ${a===0?"bg-primary text-black":"bg-secondary/30 text-muted-foreground"}`,children:a+1}),e.jsx("span",{className:`font-terminal ${a===0?"text-primary font-bold":"text-muted-foreground"}`,children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>ut({id:t.id,name:t.name,code:t.code}),className:"p-1 hover:text-primary transition-colors text-muted-foreground","data-testid":`button-edit-course-${t.id}`,children:e.jsx(Pe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>de({id:t.id,name:t.name}),className:"p-1 hover:text-red-500 transition-colors text-muted-foreground","data-testid":`button-delete-course-${t.id}`,children:e.jsx(J,{className:"w-4 h-4"})})]})]},t.id)),e.jsxs(O,{open:E,onOpenChange:k,children:[e.jsx(Ne,{asChild:!0,children:e.jsxs("button",{className:"flex items-center justify-center px-4 py-2 border border-dashed border-secondary/50 text-muted-foreground hover:border-primary hover:text-primary transition-colors font-terminal","data-testid":"button-add-course-inline",children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"ADD COURSE"]})}),e.jsxs(L,{className:"bg-black border-2 border-primary rounded-none translate-y-0",style:A,children:[e.jsxs(Q,{children:[e.jsx(P,{className:"font-arcade",children:"ADD_NEW_COURSE"}),e.jsx($,{className:"sr-only",children:"Enter course details to add a new course."})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx(u,{placeholder:"Course name (e.g., Anatomy)",value:h,onChange:t=>f(t.target.value),className:"rounded-none border-secondary bg-black font-terminal","data-testid":"input-course-name-inline"}),e.jsx(u,{placeholder:"Course number (e.g., PHTH 5301)",value:_,onChange:t=>T(t.target.value),className:"rounded-none border-secondary bg-black font-terminal","data-testid":"input-course-code-inline"}),e.jsx(m,{onClick:Oe,disabled:!h.trim()||ge.isPending,className:"w-full rounded-none font-arcade","data-testid":"button-confirm-add-course-inline",children:"ADD"})]})]})]})]}),e.jsx(O,{open:!!n,onOpenChange:t=>{t||(oe(null),z(""),R(""))},children:e.jsxs(L,{className:"bg-black border-2 border-primary rounded-none translate-y-0",style:A,children:[e.jsxs(Q,{children:[e.jsx(P,{className:"font-arcade",children:"EDIT_COURSE"}),e.jsx($,{className:"sr-only",children:"Modify the course details."})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx(u,{placeholder:"Course name",value:U,onChange:t=>z(t.target.value),className:"rounded-none border-secondary bg-black font-terminal","data-testid":"input-edit-course-name"}),e.jsx(u,{placeholder:"Course number (e.g., PHTH 5301)",value:we,onChange:t=>R(t.target.value),className:"rounded-none border-secondary bg-black font-terminal","data-testid":"input-edit-course-code"}),e.jsx(m,{onClick:it,disabled:!U.trim()||qe.isPending,className:"w-full rounded-none font-arcade","data-testid":"button-confirm-edit-course",children:"SAVE"})]})]})}),e.jsx(St,{open:!!H,onOpenChange:t=>!t&&de(null),children:e.jsxs(Tt,{className:"bg-black border-2 border-red-500 rounded-none translate-y-0",style:A,children:[e.jsxs(Et,{children:[e.jsx(At,{className:"font-arcade text-red-500",children:"DELETE_COURSE"}),e.jsxs(qt,{className:"font-terminal text-muted-foreground",children:["Are you sure you want to delete ",e.jsx("span",{className:"text-primary font-bold",children:H?.name}),"? This action cannot be undone."]})]}),e.jsxs(Mt,{className:"gap-2",children:[e.jsx(_t,{className:"rounded-none border-secondary font-arcade text-xs",children:"CANCEL"}),e.jsx(It,{onClick:ct,className:"rounded-none bg-red-500 hover:bg-red-600 font-arcade text-xs text-white",children:"DELETE"})]})]})}),N?e.jsxs("div",{className:"flex flex-col items-center gap-4 p-4 border border-primary/50 bg-primary/5",children:[e.jsx("p",{className:"font-terminal text-sm text-muted-foreground",children:"Enter minutes studied:"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{type:"number",min:"1",value:d,onChange:t=>p(t.target.value),placeholder:"30",className:"w-24 rounded-none border-primary bg-black text-center font-arcade text-xl","data-testid":"input-minutes",autoFocus:!0}),e.jsx("span",{className:"font-terminal text-muted-foreground",children:"MIN"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{variant:"outline",onClick:()=>{g(!1),p("")},className:"rounded-none font-arcade border-secondary","data-testid":"button-cancel-session",children:"CANCEL"}),e.jsx(m,{onClick:lt,disabled:!d||parseInt(d)<1||Ae.isPending,className:"rounded-none font-arcade bg-primary","data-testid":"button-log-session",children:"LOG & ROTATE"})]})]}):e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(m,{onClick:()=>g(!0),className:"w-full rounded-none font-arcade px-8 py-6 text-lg bg-primary hover:bg-primary/80 shadow-[0_0_20px_rgba(255,0,0,0.3)] hover:shadow-[0_0_30px_rgba(255,0,0,0.5)] transition-shadow",disabled:!X,"data-testid":"button-start-session",children:[e.jsx(Ct,{className:"w-5 h-5 mr-2"}),"COMPLETE SESSION"]})})]})})]}),e.jsxs(C,{className:"bg-black/40 border-2 border-primary rounded-none self-start",children:[e.jsx(D,{className:"border-b border-primary/50 p-4",children:e.jsxs(S,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(Kt,{className:"w-4 h-4"}),"TODAY"]})}),e.jsxs(w,{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-terminal text-muted-foreground",children:"Sessions"}),e.jsx("span",{className:"font-arcade text-xl text-white","data-testid":"text-today-sessions",children:Ke})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-terminal text-muted-foreground",children:"Minutes"}),e.jsx("span",{className:"font-arcade text-xl text-primary","data-testid":"text-today-minutes",children:dt})]}),e.jsx("div",{className:`p-2 border ${fe?"border-green-500/50 bg-green-500/10":"border-orange-500/50 bg-orange-500/10"}`,children:e.jsx("span",{className:`font-terminal text-xs ${fe?"text-green-400":"text-orange-400"}`,"data-testid":"text-today-status",children:fe?"STREAK MAINTAINED":"NO SESSIONS TODAY - STUDY NOW!"})})]})]}),e.jsxs(C,{className:"bg-black/40 border-2 border-primary rounded-none self-start",children:[e.jsx(D,{className:"border-b border-primary/50 p-4",children:e.jsxs(S,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4"}),"COURSES"]})}),e.jsx(w,{className:"p-4 max-h-64 overflow-y-auto",children:v.length===0?e.jsx("p",{className:"font-terminal text-muted-foreground text-center py-4",children:"No courses yet"}):e.jsx("div",{className:"space-y-3",children:v.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-2 border border-secondary/30 hover:border-secondary transition-colors","data-testid":`summary-course-${t.id}`,children:[e.jsx("span",{className:"font-terminal text-white",children:t.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm font-terminal",children:[e.jsxs("span",{className:"text-muted-foreground",children:[e.jsx("span",{className:"text-white font-bold","data-testid":`course-sessions-${t.id}`,children:t.totalSessions})," sess"]}),e.jsxs("span",{className:"text-muted-foreground",children:[e.jsx("span",{className:K("font-bold",t.totalMinutes>0?"text-green-400":"text-muted-foreground"),"data-testid":`course-minutes-${t.id}`,children:t.totalMinutes})," min"]})]})]},t.id))})})]}),e.jsxs(C,{className:"bg-black/40 border-2 border-primary rounded-none self-start",children:[e.jsx(D,{className:"border-b border-primary/50 p-4",children:e.jsxs(S,{className:"font-arcade text-sm flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ut,{className:"w-4 h-4"}),"TASKS"]}),b.length>1&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>le(t=>(t-1+b.length)%b.length),className:"p-1 hover:bg-white/10 transition-colors",children:e.jsx(Ft,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-terminal text-xs text-white bg-secondary/40 border border-secondary/60 px-2 py-0.5 min-w-[80px] text-center",children:F?.title||"Tasks"}),e.jsx("button",{onClick:()=>le(t=>(t+1)%b.length),className:"p-1 hover:bg-white/10 transition-colors",children:e.jsx(wt,{className:"w-4 h-4"})})]})]})}),e.jsx(w,{className:"p-4",children:b.length===0?e.jsx("p",{className:"font-terminal text-muted-foreground text-center py-4",children:"Connect Google to see your tasks."}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{placeholder:"Add task...",value:V,onChange:t=>De(t.target.value),onKeyDown:t=>t.key==="Enter"&&Qe(),className:"rounded-none border-secondary bg-black font-terminal text-sm h-8"}),e.jsx(m,{size:"sm",onClick:Qe,disabled:!V.trim()||_e.isPending,className:"rounded-none font-arcade text-xs h-8 px-3",children:e.jsx(ne,{className:"w-3 h-3"})})]}),e.jsx("div",{className:"max-h-52 overflow-y-auto pr-1",children:be.length===0?e.jsx("p",{className:"font-terminal text-muted-foreground text-center py-4 text-sm",children:"No tasks in this list."}):e.jsxs("div",{className:"space-y-2",children:[ft.map(t=>{const a=Nt(t.due),j=t.due&&ve(new Date(t.due))&&!re(new Date(t.due));return e.jsxs("div",{className:"flex items-center gap-2 p-2 border border-secondary/30 hover:border-primary/50 transition-colors group",children:[e.jsx("button",{onClick:()=>Me.mutate(t),className:"flex-shrink-0 p-0.5 hover:bg-primary/20 rounded",children:e.jsx(Re,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"font-terminal text-sm text-white block truncate",children:t.title}),(a||t.notes)&&e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[a&&e.jsx("span",{className:K("font-terminal text-xs",j?"text-red-400":"text-muted-foreground"),children:a}),t.notes&&e.jsx("span",{className:"font-terminal text-xs text-muted-foreground truncate max-w-[120px]",children:t.notes})]})]}),e.jsx("button",{onClick:()=>jt(t),className:"p-1 text-muted-foreground hover:text-primary opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0",children:e.jsx(Pe,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>Fe.mutate(t),className:"p-1 text-muted-foreground hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0",children:e.jsx(J,{className:"w-3 h-3"})})]},t.id)}),je.length>0&&e.jsxs("div",{className:"pt-2 border-t border-secondary/20 mt-2",children:[e.jsxs("p",{className:"font-terminal text-xs text-muted-foreground mb-2",children:["Completed (",je.length,")"]}),je.slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center gap-2 p-2 opacity-50 group hover:opacity-75 transition-opacity",children:[e.jsx("button",{onClick:()=>Me.mutate(t),className:"flex-shrink-0 p-0.5 hover:bg-green-500/20 rounded",children:e.jsx(Ge,{className:"w-4 h-4 text-green-500"})}),e.jsx("span",{className:"font-terminal text-sm text-muted-foreground line-through flex-1 truncate",children:t.title}),e.jsx("button",{onClick:()=>Fe.mutate(t),className:"p-1 text-muted-foreground hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(J,{className:"w-3 h-3"})})]},t.id))]})]})})]})})]}),e.jsx(O,{open:!!ie,onOpenChange:t=>!t&&W(null),children:e.jsxs(L,{className:"bg-black border-2 border-primary rounded-none translate-y-0",style:A,children:[e.jsxs(Q,{children:[e.jsx(P,{className:"font-arcade",children:"EDIT_TASK"}),e.jsx($,{className:"sr-only",children:"Edit the selected task."})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"Title"}),e.jsx(u,{placeholder:"Task title",value:I,onChange:t=>ce(t.target.value),className:"rounded-none border-secondary bg-black font-terminal",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"Notes"}),e.jsx(u,{placeholder:"Add notes...",value:Y,onChange:t=>ue(t.target.value),className:"rounded-none border-secondary bg-black font-terminal"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"Due Date"}),e.jsx(u,{type:"date",value:q,onChange:t=>me(t.target.value),className:"rounded-none border-secondary bg-black font-terminal"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"Add to Deadlines"}),e.jsxs(ee,{value:B,onValueChange:t=>xe(t),children:[e.jsx(te,{className:"rounded-none border-secondary bg-black font-terminal",children:e.jsx(se,{placeholder:"Select type"})}),e.jsxs(ae,{className:"bg-black border-secondary rounded-none",children:[e.jsx(x,{value:"none",children:"NONE - Don't add to deadlines"}),e.jsx(x,{value:"assignment",children:"ðŸ“‹ ASSIGNMENT"}),e.jsx(x,{value:"quiz",children:"â“ QUIZ"}),e.jsx(x,{value:"exam",children:"ðŸ“ EXAM"})]})]}),B!=="none"&&!q&&e.jsx("p",{className:"font-terminal text-xs text-orange-400 mt-1",children:"âš  Set a due date to add to deadlines"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:"outline",onClick:()=>W(null),className:"flex-1 rounded-none font-arcade border-secondary",children:"CANCEL"}),e.jsx(m,{onClick:bt,disabled:!I.trim()||Ie.isPending,className:"flex-1 rounded-none font-arcade",children:"SAVE"})]})]})]})}),e.jsxs(C,{className:"bg-black/40 border-2 border-primary rounded-none self-start",children:[e.jsxs(D,{className:"border-b border-primary/50 p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(S,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(kt,{className:"w-4 h-4"}),"DEADLINES"]}),e.jsxs(O,{open:Je,onOpenChange:Se,children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(m,{variant:"outline",size:"sm",className:"rounded-none border-primary hover:bg-primary/20 font-arcade text-[10px] h-7 px-2",children:[e.jsx(ne,{className:"w-3 h-3 mr-1"}),"ADD"]})}),e.jsxs(L,{className:"bg-black border-2 border-primary rounded-none translate-y-0",style:A,children:[e.jsxs(Q,{children:[e.jsx(P,{className:"font-arcade",children:"ADD_DEADLINE"}),e.jsx($,{className:"sr-only",children:"Add a new academic deadline."})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx(u,{placeholder:"Title (e.g., Midterm Exam)",value:i.title,onChange:t=>M({...i,title:t.target.value}),className:"rounded-none border-secondary bg-black font-terminal"}),e.jsxs(ee,{value:i.type,onValueChange:t=>M({...i,type:t}),children:[e.jsx(te,{className:"rounded-none border-secondary bg-black font-terminal",children:e.jsx(se,{placeholder:"Select type"})}),e.jsxs(ae,{className:"bg-black border-secondary rounded-none",children:[e.jsx(x,{value:"assignment",children:"ðŸ“‹ Assignment"}),e.jsx(x,{value:"quiz",children:"â“ Quiz"}),e.jsx(x,{value:"exam",children:"ðŸ“ Exam"}),e.jsx(x,{value:"project",children:"ðŸ“‚ Project"})]})]}),e.jsxs(ee,{value:i.course||"none",onValueChange:t=>M({...i,course:t==="none"?"":t}),children:[e.jsx(te,{className:"rounded-none border-secondary bg-black font-terminal",children:e.jsx(se,{placeholder:"Select course"})}),e.jsxs(ae,{className:"bg-black border-secondary rounded-none",children:[e.jsx(x,{value:"none",children:"No course"}),v.map(t=>e.jsx(x,{value:t.name,children:t.name},t.id))]})]}),e.jsx(u,{type:"date",value:i.dueDate,onChange:t=>M({...i,dueDate:t.target.value}),className:"rounded-none border-secondary bg-black font-terminal"}),e.jsx(u,{placeholder:"Notes (optional)",value:i.notes,onChange:t=>M({...i,notes:t.target.value}),className:"rounded-none border-secondary bg-black font-terminal"}),e.jsx(m,{onClick:mt,disabled:!i.title?.trim()||!i.dueDate||ye.isPending,className:"w-full rounded-none font-arcade",children:"ADD_DEADLINE"})]})]})]})]}),e.jsxs(ee,{value:he,onValueChange:et,children:[e.jsx(te,{className:"rounded-none border-secondary bg-black/60 font-terminal text-xs h-7 w-full pl-3 pr-7",children:e.jsx(se,{})}),e.jsxs(ae,{className:"bg-black border-secondary rounded-none min-w-[200px]",children:[e.jsx(x,{value:"all",children:"ALL COURSES"}),gt.map(t=>e.jsx(x,{value:t,children:t},t))]})]})]}),e.jsx(w,{className:"p-4 max-h-72 overflow-y-auto",children:pe.length===0?e.jsx("p",{className:"font-terminal text-muted-foreground text-center py-8",children:"No deadlines yet. Add assignments, quizzes, and exams to track."}):e.jsx(Dt,{className:"h-full",children:e.jsx("div",{className:"space-y-2",children:yt.map(t=>{const a=xt(t.dueDate),j=new Date(t.dueDate);return e.jsxs("div",{className:K("flex items-center gap-3 p-3 border transition-all",t.completed?"border-secondary/20 opacity-50":pt(a)),children:[e.jsx("button",{onClick:()=>rt.mutate(t.id),className:"flex-shrink-0 p-0.5",children:t.completed?e.jsx(Ge,{className:"w-6 h-6 text-green-500"}):e.jsx(Re,{className:"w-6 h-6 text-primary/70 hover:text-primary transition-colors"})}),e.jsx("span",{className:"text-lg flex-shrink-0",children:ht(t.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:K("font-terminal text-sm",t.completed&&"line-through"),children:t.title}),Z(t.course)&&e.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:Z(t.course)})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("span",{className:K("px-2 py-1 font-terminal text-xs font-bold text-white",t.completed?"bg-secondary/50":a==="overdue"?"bg-red-600":a==="today"?"bg-orange-600":a==="tomorrow"?"bg-yellow-600":a==="soon"?"bg-red-800":"bg-red-900"),children:Ce(j)?ze(j,"MMM d"):"No date"}),e.jsx("button",{onClick:()=>ot.mutate(t.id),className:"p-1 text-muted-foreground hover:text-red-500 transition-colors",children:e.jsx(J,{className:"w-4 h-4"})})]})]},t.id)})})})})]}),Ee.length>0?e.jsxs(C,{className:"bg-black/40 border-2 border-primary rounded-none md:col-span-2",children:[e.jsx(D,{className:"border-b border-primary/50 p-4",children:e.jsxs(S,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4 text-orange-500"}),"WEAKNESS_QUEUE"]})}),e.jsx(w,{className:"p-4",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:Ee.map(t=>e.jsxs("div",{className:"px-3 py-1 border border-orange-500/50 bg-orange-500/10 font-terminal text-sm text-orange-300","data-testid":`weakness-${t.id}`,children:[t.topic,t.reason&&e.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(",t.reason,")"]})]},t.id))})})]}):e.jsx(C,{className:"bg-black/40 border border-secondary/30 rounded-none md:col-span-2",children:e.jsxs(w,{className:"p-3 flex items-center justify-center gap-2",children:[e.jsx(He,{className:"w-3 h-3 text-muted-foreground"}),e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"No flagged weaknesses â€” topics you struggle with will appear here."})]})})]})]})})}export{rs as default};
