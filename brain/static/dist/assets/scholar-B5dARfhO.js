import{c as P,r as j,j as e,b as R,u as te}from"./index-CuEi-1f6.js";import{v as ye,u as k,a as Q,B as O,L as ve,A as H,g as X,S as E,k as we,h as y}from"./layout-Bw7Jt4dh.js";import{C as u,a as h,b as p,c as N}from"./card-CLzSaNoA.js";import{B as o,S as Se,a as Ee,b as ke,c as Re,d as q}from"./select-CqH4fxQW.js";import{T as Ce,a as Pe,b as Te,c as I,M as Ae,L as Ie}from"./tabs-DdraGeiP.js";import{P as Oe}from"./play-BEsuCjsi.js";import{R as D,S as De}from"./send-sFdXNdGI.js";import{C as ne}from"./clock-BaEa2y1U.js";import{S as B}from"./search-8sSjb09M.js";import{C as Me,B as K}from"./circle-check-bSVuoiEM.js";import{C}from"./circle-alert-CEESpbeX.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],qe=P("circle-check-big",Le);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Z=P("circle-question-mark",_e);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ce=P("circle-x",$e);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Ue=P("history",Fe);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],ee=P("lightbulb",Ve);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],se=P("trending-up",He);function Be(r,t=[]){let d=[];function a(x,m){const i=j.createContext(m);i.displayName=x+"Context";const l=d.length;d=[...d,m];const g=v=>{const{scope:w,children:T,...S}=v,A=w?.[r]?.[l]||i,M=j.useMemo(()=>S,Object.values(S));return e.jsx(A.Provider,{value:M,children:T})};g.displayName=x+"Provider";function f(v,w){const T=w?.[r]?.[l]||i,S=j.useContext(T);if(S)return S;if(m!==void 0)return m;throw new Error(`\`${v}\` must be used within \`${x}\``)}return[g,f]}const c=()=>{const x=d.map(m=>j.createContext(m));return function(i){const l=i?.[r]||x;return j.useMemo(()=>({[`__scope${r}`]:{...i,[r]:l}}),[i,l])}};return c.scopeName=r,[a,Ke(c,...t)]}function Ke(...r){const t=r[0];if(r.length===1)return t;const d=()=>{const a=r.map(c=>({useScope:c(),scopeName:c.scopeName}));return function(x){const m=a.reduce((i,{useScope:l,scopeName:g})=>{const v=l(x)[`__scope${g}`];return{...i,...v}},{});return j.useMemo(()=>({[`__scope${t.scopeName}`]:m}),[m])}};return d.scopeName=t.scopeName,d}var Qe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],le=Qe.reduce((r,t)=>{const d=ye(`Primitive.${t}`),a=j.forwardRef((c,x)=>{const{asChild:m,...i}=c,l=m?d:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...i,ref:x})});return a.displayName=`Primitive.${t}`,{...r,[t]:a}},{}),z="Progress",W=100,[ze]=Be(z),[We,Ye]=ze(z),ie=j.forwardRef((r,t)=>{const{__scopeProgress:d,value:a=null,max:c,getValueLabel:x=Ge,...m}=r;(c||c===0)&&!re(c)&&console.error(Je(`${c}`,"Progress"));const i=re(c)?c:W;a!==null&&!ae(a,i)&&console.error(Xe(`${a}`,"Progress"));const l=ae(a,i)?a:null,g=_(l)?x(l,i):void 0;return e.jsx(We,{scope:d,value:l,max:i,children:e.jsx(le.div,{"aria-valuemax":i,"aria-valuemin":0,"aria-valuenow":_(l)?l:void 0,"aria-valuetext":g,role:"progressbar","data-state":xe(l,i),"data-value":l??void 0,"data-max":i,...m,ref:t})})});ie.displayName=z;var oe="ProgressIndicator",de=j.forwardRef((r,t)=>{const{__scopeProgress:d,...a}=r,c=Ye(oe,d);return e.jsx(le.div,{"data-state":xe(c.value,c.max),"data-value":c.value??void 0,"data-max":c.max,...a,ref:t})});de.displayName=oe;function Ge(r,t){return`${Math.round(r/t*100)}%`}function xe(r,t){return r==null?"indeterminate":r===t?"complete":"loading"}function _(r){return typeof r=="number"}function re(r){return _(r)&&!isNaN(r)&&r>0}function ae(r,t){return _(r)&&!isNaN(r)&&r<=t&&r>=0}function Je(r,t){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${W}\`.`}function Xe(r,t){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${W} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var me=ie,Ze=de;const ue=j.forwardRef(({className:r,indicatorClassName:t,value:d,...a},c)=>e.jsx(me,{ref:c,className:R("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",r),...a,children:e.jsx(Ze,{className:R("h-full w-full flex-1 bg-primary transition-all",t),style:{transform:`translateX(-${100-(d||0)}%)`}})}));ue.displayName=me.displayName;function es(){const r=te(),[t,d]=j.useState(!1),{data:a,isLoading:c}=k({queryKey:["scholarStatus"],queryFn:async()=>{const l=await fetch("/api/scholar");if(!l.ok)throw new Error("Failed to fetch Scholar status");return l.json()},refetchInterval:t?2e3:!1}),x=Q({mutationFn:async()=>{const l=await fetch("/api/scholar/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({triggered_by:"ui"})});if(!l.ok)throw new Error("Failed to start Scholar run");return l.json()},onSuccess:()=>{d(!0),r.invalidateQueries({queryKey:["scholarStatus"]})}});j.useEffect(()=>{a?.running?d(!0):t&&!a?.running&&(d(!1),r.invalidateQueries({queryKey:["scholarStatus"]}))},[a?.running,t,r]);const m=()=>c?e.jsx(D,{className:"w-4 h-4 animate-spin"}):a?.running?e.jsx(D,{className:"w-4 h-4 animate-spin text-primary"}):a?.status==="complete"?e.jsx(qe,{className:"w-4 h-4 text-green-400"}):a?.status==="error"?e.jsx(ce,{className:"w-4 h-4 text-red-400"}):e.jsx(ne,{className:"w-4 h-4 text-muted-foreground"}),i=()=>a?.running?e.jsx(o,{className:"bg-primary/20 text-primary border-primary/50",children:"Running"}):a?.status==="complete"?e.jsx(o,{className:"bg-green-500/20 text-green-400 border-green-500/50",children:"Complete"}):a?.status==="error"?e.jsx(o,{className:"bg-red-500/20 text-red-400 border-red-500/50",children:"Error"}):e.jsx(o,{variant:"outline",className:"text-muted-foreground",children:"Idle"});return e.jsxs(u,{className:"brain-card rounded-none",children:[e.jsx(h,{className:"border-b border-secondary/50 p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[m(),e.jsx(p,{className:"font-arcade text-sm text-primary",children:"SCHOLAR ORCHESTRATOR"})]}),i()]})}),e.jsxs(N,{className:"p-3 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[a?.running&&e.jsxs(e.Fragment,{children:[a.current_step&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground",children:"Current Step:"}),e.jsx("div",{className:"font-terminal text-xs text-secondary",children:a.current_step})]}),a.progress!==void 0&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-[10px] text-muted-foreground",children:"Progress:"}),e.jsxs("span",{className:"font-terminal text-[10px] text-primary",children:[Math.round(a.progress),"%"]})]}),e.jsx(ue,{value:a.progress,className:"h-2 bg-black border border-secondary/40"})]})]}),!a?.running&&a?.last_run&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground",children:"Last Run:"}),e.jsx("div",{className:"font-terminal text-xs text-secondary",children:new Date(a.last_run).toLocaleString()})]}),a?.errors&&a.errors.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-terminal text-[10px] text-red-400",children:"Errors:"}),e.jsx("div",{className:"space-y-1 p-2 bg-red-900/20 border border-red-500/50 rounded-none",children:a.errors.map((l,g)=>e.jsxs("div",{className:"font-terminal text-[10px] text-red-400",children:["â€¢ ",l]},g))})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(O,{onClick:()=>x.mutate(),disabled:a?.running||x.isPending,className:"flex-1 bg-primary hover:bg-primary/80 rounded-none font-terminal text-xs",children:[e.jsx(Oe,{className:"w-3 h-3 mr-1"}),x.isPending?"Starting...":"Run Scholar"]}),e.jsx(O,{onClick:()=>r.invalidateQueries({queryKey:["scholarStatus"]}),variant:"outline",className:"rounded-none font-terminal text-xs",disabled:c,children:e.jsx(D,{className:`w-3 h-3 ${c?"animate-spin":""}`})})]}),e.jsx("div",{className:"pt-2 border-t border-secondary/30",children:e.jsx("p",{className:"font-terminal text-[9px] text-muted-foreground",children:"Runs Scholar orchestrator loop: analyzes SOP, generates questions, creates proposals"})})]})]})}function ms(){const r=te(),[t,d]=j.useState("summary"),[a,c]=j.useState([]),[x,m]=j.useState(""),[i,l]=j.useState(!1),g=j.useRef(null),{data:f=[]}=k({queryKey:["sessions"],queryFn:y.sessions.getAll}),{data:v=[]}=k({queryKey:["courses"],queryFn:y.courses.getAll}),{data:w=[]}=k({queryKey:["proposals"],queryFn:y.proposals.getAll}),{data:T=[]}=k({queryKey:["scholar-questions"],queryFn:y.scholar.getQuestions}),{data:S=[]}=k({queryKey:["scholar-findings"],queryFn:y.scholar.getFindings}),{data:A=[]}=k({queryKey:["scholar-tutor-audit"],queryFn:y.scholar.getTutorAudit}),{data:M}=k({queryKey:["scholar-clusters"],queryFn:y.scholar.getClusters}),$=Q({mutationFn:y.scholar.runClustering,onSuccess:()=>{r.invalidateQueries({queryKey:["scholar-clusters"]})}}),he=Q({mutationFn:({id:s,data:n})=>y.proposals.update(s,n),onSuccess:()=>{r.invalidateQueries({queryKey:["proposals"]})}});j.useEffect(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[a]),f.slice(0,20);const pe=f.reduce((s,n)=>s+(n.minutes||0),0),Ne=f.length>0?Math.round(pe/f.length):0,je=f.filter(s=>{const n=new Date(s.date),b=new Date;return b.setDate(b.getDate()-7),n>=b}).length,L=v.filter(s=>(s.totalSessions||0)<3),F=f.filter(s=>s.confusions&&s.confusions.length>0).flatMap(s=>s.confusions||[]),U=f.filter(s=>s.issues&&s.issues.length>0).flatMap(s=>s.issues||[]),Y=async()=>{if(!x.trim())return;const s=x.trim();c(n=>[...n,{role:"user",content:s}]),m(""),l(!0);try{const n=await y.scholar.chat(s);c(b=>[...b,{role:"assistant",content:n.response}])}catch{c(b=>[...b,{role:"assistant",content:"Error processing your question. Please try again."}])}finally{l(!1)}},fe=T,G=A,be=S,J=s=>{switch(s){case"APPROVED":return"bg-primary/20 text-primary border-primary";case"REJECTED":return"bg-secondary/40 text-muted-foreground border-secondary";case"IMPLEMENTED":return"bg-white/20 text-white border-white";default:return"bg-secondary/20 text-secondary-foreground border-secondary"}},ge=s=>{switch(s){case"HIGH":return"text-primary border-primary";case"MED":return"text-white border-white";default:return"text-muted-foreground border-muted-foreground"}};return e.jsx(ve,{children:e.jsxs("div",{className:"h-[calc(100vh-140px)] flex flex-col gap-6",children:[e.jsxs("div",{className:"space-y-4 shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{className:"w-6 h-6 text-primary"}),e.jsx("h1",{className:"font-arcade text-lg text-primary",children:"SCHOLAR"}),e.jsx(o,{variant:"outline",className:"rounded-none text-[10px] font-terminal border-primary/50",children:"READ ONLY ADVISORY"})]}),e.jsxs(O,{variant:"outline",size:"sm",className:"rounded-none font-arcade text-xs border-secondary",onClick:()=>r.invalidateQueries(),"data-testid":"button-refresh-data",children:[e.jsx(D,{className:"w-3 h-3 mr-2"})," REFRESH DATA"]})]}),e.jsx(es,{})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(Ce,{value:t,onValueChange:d,className:"h-full flex flex-col",children:[e.jsx(Pe,{className:"bg-black/60 border border-secondary rounded-none p-1 shrink-0 w-full justify-start overflow-x-auto",children:[{id:"summary",label:"SUMMARY",icon:se},{id:"analysis",label:"ANALYSIS",icon:B},{id:"proposals",label:"PROPOSALS",icon:ee}].map(s=>e.jsxs(Te,{value:s.id,className:"rounded-none font-arcade text-[10px] data-[state=active]:bg-primary data-[state=active]:text-black px-3","data-testid":`tab-${s.id}`,children:[e.jsx(s.icon,{className:"w-3 h-3 mr-1"}),s.label]},s.id))}),e.jsx(I,{value:"summary",className:"flex-1 overflow-hidden mt-6",children:e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6 h-full",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4 overflow-auto pr-2",children:[e.jsxs(u,{className:"bg-black/40 border-2 border-primary/50 rounded-none",children:[e.jsx(h,{className:"p-4 border-b border-primary/30",children:e.jsxs(p,{className:"font-arcade text-sm text-primary flex items-center gap-3",children:[e.jsx(se,{className:"w-4 h-4"})," STUDY HEALTH OVERVIEW"]})}),e.jsx(N,{className:"p-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-3 gap-6 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-arcade text-2xl text-primary",children:f.length}),e.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"TOTAL SESSIONS"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-arcade text-2xl text-white",children:je}),e.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"THIS WEEK"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-arcade text-2xl text-secondary",children:[Ne,"m"]}),e.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"AVG/SESSION"})]})]})})]}),e.jsxs(u,{className:"bg-black/40 border-2 border-white/30 rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-white/20",children:e.jsxs(p,{className:"font-arcade text-xs text-white flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"})," WHAT APPEARS TO BE WORKING"]})}),e.jsxs(N,{className:"p-6",children:[e.jsx("ul",{className:"space-y-3 font-terminal text-sm",children:v.filter(s=>(s.totalSessions||0)>=3).length>0?e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(X,{className:"w-4 h-4 text-primary shrink-0 mt-0.5"}),e.jsxs("span",{children:[v.filter(s=>(s.totalSessions||0)>=3).length," courses have consistent study activity"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(X,{className:"w-4 h-4 text-primary shrink-0 mt-0.5"}),e.jsx("span",{children:"Round-robin rotation ensuring balanced coverage"})]})]}):e.jsx("li",{className:"text-muted-foreground",children:"Insufficient data - need more sessions to identify patterns"})}),e.jsx("div",{className:"mt-3 pt-3 border-t border-secondary/30",children:e.jsxs(o,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:["CONFIDENCE: ",f.length>10?"MEDIUM":"LOW"," (based on ",f.length," sessions)"]})})]})]}),e.jsxs(u,{className:"bg-black/40 border-2 border-destructive/50 rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-destructive/30",children:e.jsxs(p,{className:"font-arcade text-xs text-destructive flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"})," POTENTIAL CONCERNS"]})}),e.jsx(N,{className:"p-6",children:e.jsxs("ul",{className:"space-y-3 font-terminal text-sm",children:[L.length>0&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(C,{className:"w-4 h-4 text-destructive shrink-0 mt-0.5"}),e.jsxs("span",{children:[L.length," courses with low activity: ",L.map(s=>s.name).join(", ")]})]}),F.length>0&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(C,{className:"w-4 h-4 text-destructive shrink-0 mt-0.5"}),e.jsxs("span",{children:[F.length," unresolved confusions logged"]})]}),U.length>0&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(C,{className:"w-4 h-4 text-destructive shrink-0 mt-0.5"}),e.jsxs("span",{children:[U.length," session issues flagged"]})]}),L.length===0&&F.length===0&&U.length===0&&e.jsx("li",{className:"text-muted-foreground",children:"No significant concerns identified"})]})})]})]}),e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none flex flex-col h-full",children:[e.jsx(h,{className:"p-3 border-b border-secondary shrink-0",children:e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4"})," ASK SCHOLAR"]})}),e.jsxs(N,{className:"p-0 flex-1 flex flex-col overflow-hidden",children:[e.jsx(E,{className:"flex-1 p-3",children:e.jsxs("div",{className:"space-y-3",children:[a.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(H,{className:"w-8 h-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Ask questions about your study data, patterns, or get recommendations."})]}),a.map((s,n)=>e.jsx("div",{className:R("p-2 rounded-sm font-terminal text-xs",s.role==="user"?"bg-primary/20 text-primary ml-8":"bg-secondary/20 text-white mr-8"),children:s.content},n)),i&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground font-terminal text-xs",children:[e.jsx(D,{className:"w-3 h-3 animate-spin"}),"Analyzing Brain data..."]}),e.jsx("div",{ref:g})]})}),e.jsx("div",{className:"p-2 border-t border-secondary shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(we,{value:x,onChange:s=>m(s.target.value),onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),Y())},placeholder:"Ask about your study patterns...",className:"rounded-none bg-black border-secondary text-xs min-h-[60px] resize-none","data-testid":"input-scholar-chat"}),e.jsx(O,{size:"icon",className:"rounded-none bg-primary text-black h-[60px] w-10",onClick:Y,disabled:i,"data-testid":"button-send-chat",children:e.jsx(De,{className:"w-4 h-4"})})]})})]})]})]})}),e.jsx(I,{value:"audit",className:"flex-1 overflow-auto mt-4",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-secondary",children:e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"})," TUTOR BEHAVIOR AUDIT"]})}),e.jsxs(N,{className:"p-4 space-y-4",children:[e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:"Post-session analysis of Tutor interactions. No live Tutor access."}),[{q:"Was the Tutor source-aligned?",status:"pending"},{q:"Was cognitive load appropriate?",status:"concern"},{q:"Were confusions resolved or deferred?",status:"ok"},{q:"Did explanations correlate with outcomes?",status:"pending"}].map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-black/40 border border-secondary/50",children:[e.jsx("span",{className:"font-terminal text-xs",children:s.q}),e.jsx(o,{variant:"outline",className:R("rounded-none text-[9px]",s.status==="ok"?"border-primary text-primary":s.status==="concern"?"border-destructive text-destructive":"border-secondary text-secondary-foreground"),children:s.status.toUpperCase()})]},n))]})]}),e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-secondary",children:e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"})," RECURRENT ISSUES"]})}),e.jsx(N,{className:"p-4",children:e.jsx("div",{className:"space-y-3",children:G.map((s,n)=>e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-terminal text-sm",children:s.issue??"Unknown issue"}),e.jsxs(o,{variant:"outline",className:"rounded-none text-[9px] border-primary text-primary",children:["x",s.frequency??0]})]}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:(s.courses||[]).map((b,V)=>e.jsx(o,{variant:"secondary",className:"rounded-none text-[8px]",children:b},V))})]},n))})})]})]})}),e.jsx(I,{value:"analysis",className:"flex-1 overflow-auto mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-secondary",children:e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"})," TUTOR AUDIT"]})}),e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs(u,{className:"bg-black/40 border-2 border-primary/50 rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-primary/30",children:e.jsxs(p,{className:"font-arcade text-xs text-primary flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"})," TUTOR BEHAVIOR AUDIT"]})}),e.jsx(N,{className:"p-4",children:e.jsx(E,{className:"h-[300px]",children:e.jsx("div",{className:"space-y-3",children:A.length===0?e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"No audit data available"}):A.map((s,n)=>e.jsxs("div",{className:"p-3 bg-primary/5 border border-primary/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-terminal text-sm",children:s.sessionDate}),e.jsx(o,{variant:"outline",className:"rounded-none text-[9px] border-primary",children:s.phase})]}),e.jsx("p",{className:"font-terminal text-xs mb-2",children:s.observation}),e.jsx("div",{className:"flex gap-2",children:e.jsx(o,{variant:"secondary",className:"rounded-none text-[8px]",children:s.impact})})]},n))})})})]}),e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-secondary",children:e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"})," RECURRENT ISSUES"]})}),e.jsx(N,{className:"p-4",children:e.jsx("div",{className:"space-y-3",children:G.map((s,n)=>e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-terminal text-sm",children:s.issue??"Unknown issue"}),e.jsxs(o,{variant:"outline",className:"rounded-none text-[9px] border-primary text-primary",children:["x",s.frequency??0]})]}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:(s.courses||[]).map((b,V)=>e.jsx(o,{variant:"secondary",className:"rounded-none text-[8px]",children:b},V))})]},n))})})]})]})})]}),e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-secondary",children:e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"})," QUESTION PIPELINE"]})}),e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-secondary",children:e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"})," QUESTION RESOLUTION PIPELINE"]})}),e.jsxs(N,{className:"p-4",children:[e.jsxs("div",{className:"space-y-2 font-terminal text-xs text-muted-foreground mb-4",children:[e.jsx("p",{children:"1. Generate question from identified issue"}),e.jsx("p",{children:"2. Attempt answer using Brain data"}),e.jsx("p",{children:"3. If insufficient, research learning science"}),e.jsx("p",{children:"4. If still unresolved, escalate to user"})]}),e.jsx("div",{className:"space-y-3",children:[{stage:"Identified",count:5},{stage:"Brain Analysis",count:3},{stage:"Research",count:1},{stage:"User Escalation",count:2}].map((s,n)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary/60"}),e.jsx("span",{className:"font-terminal text-sm flex-1",children:s.stage}),e.jsx(o,{variant:"outline",className:"rounded-none",children:s.count})]},n))})]})]}),e.jsxs(u,{className:"bg-black/40 border-2 border-primary/50 rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-primary/30",children:e.jsxs(p,{className:"font-arcade text-xs text-primary flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"})," OPEN QUESTIONS"]})}),e.jsx(N,{className:"p-4",children:e.jsx(E,{className:"h-[300px]",children:e.jsx("div",{className:"space-y-4",children:fe.map(s=>e.jsxs("div",{className:"p-3 bg-primary/5 border border-primary/30",children:[e.jsx("p",{className:"font-terminal text-sm mb-3",children:s.question}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-muted-foreground shrink-0",children:"Context:"}),e.jsx("span",{children:s.context})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-muted-foreground shrink-0",children:"Data Gap:"}),e.jsx("span",{children:s.dataInsufficient})]})]})]},s.id))})})})]})]})})]}),e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-secondary",children:e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"})," EVIDENCE REVIEW"]})}),e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-secondary",children:e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"})," OBSERVED DATA"]})}),e.jsx(N,{className:"p-4",children:e.jsx(E,{className:"h-[300px]",children:e.jsx("div",{className:"space-y-4",children:S.map((s,n)=>e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(o,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:s.category}),e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:s.sessionDate})]}),e.jsx("p",{className:"font-terminal text-sm",children:s.observation})]},n))})})})]}),e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-secondary",children:e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"})," RESEARCH INTERPRETATION"]})}),e.jsx(N,{className:"p-4",children:e.jsx(E,{className:"h-[300px]",children:e.jsx("div",{className:"space-y-4",children:be.map((s,n)=>e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:s.topic??s.title}),e.jsx("p",{className:"font-terminal text-xs mb-2",children:s.summary??s.content}),e.jsx("div",{className:"flex justify-between text-[10px] text-muted-foreground",children:e.jsxs("span",{children:["Source: ",s.source]})})]},n))})})})]})]})})]}),e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsxs(h,{className:"p-3 border-b border-secondary flex flex-row items-center justify-between",children:[e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"})," TOPIC CLUSTERS"]}),e.jsx(O,{variant:"outline",size:"sm",className:"rounded-none font-arcade text-xs",onClick:()=>$.mutate(),disabled:$.isPending,children:$.isPending?"Running...":"Run Clustering"})]}),e.jsx(N,{className:"p-4",children:e.jsx(E,{className:"h-[300px]",children:e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:M?.clusters?.length===0?e.jsx("p",{className:"font-terminal text-xs text-muted-foreground col-span-2",children:"No clusters yet. Run clustering to analyze."}):M?.clusters?.map(s=>e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-arcade text-xs text-primary",children:["Cluster ",s.cluster_id]}),e.jsxs(o,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:[s.count," items"]})]}),e.jsx("div",{className:"space-y-2",children:s.items.map((n,b)=>e.jsxs("div",{className:"flex items-center gap-2 font-terminal text-xs",children:[e.jsx(o,{variant:"secondary",className:"rounded-none text-[8px] shrink-0",children:n.source==="digest"?"DIG":"PROP"}),e.jsx("span",{className:"truncate",children:n.title||"Untitled"})]},b))})]},s.cluster_id))})})})]})]})}),e.jsx(I,{value:"proposals",className:"flex-1 overflow-auto mt-4",children:e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsxs(h,{className:"p-3 border-b border-secondary",children:[e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"})," IMPROVEMENT PROPOSALS"]}),e.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground mt-1",children:"No auto-implementation. All changes require user approval."})]}),e.jsx(N,{className:"p-4",children:e.jsx(E,{className:"h-[500px]",children:e.jsx("div",{className:"space-y-4",children:w.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"font-arcade text-xs text-primary mb-2",children:"NO PROPOSALS YET"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Proposals are generated by the Scholar workflow after analyzing Brain session data. Run a Scholar analysis from the dashboard or via the Scholar CLI to create proposals."})]}):w.filter(s=>s.status!=="REJECTED").map(s=>e.jsxs("div",{className:"p-4 bg-black/40 border border-secondary/50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:s.proposalId}),e.jsx("h4",{className:"font-terminal text-sm mt-1",children:s.summary})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(o,{variant:"outline",className:R("rounded-none text-[9px]",ge(s.priority||"MED")),children:s.priority||"MED"})})]}),s.targetSystem&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Target: "}),e.jsx(o,{variant:"secondary",className:"rounded-none text-[9px]",children:s.targetSystem})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-secondary/30",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:"Confidence: MED"}),e.jsx(o,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:"Risk: LOW"})]}),e.jsxs(Se,{value:s.status||"DRAFT",onValueChange:n=>he.mutate({id:s.id,data:{status:n}}),children:[e.jsx(Ee,{className:R("rounded-none w-28 h-7 text-[10px]",J(s.status||"DRAFT")),"data-testid":`select-proposal-status-${s.id}`,children:e.jsx(ke,{})}),e.jsxs(Re,{className:"rounded-none bg-black border-primary",children:[e.jsx(q,{value:"DRAFT",children:"PROPOSED"}),e.jsx(q,{value:"APPROVED",children:"APPROVED"}),e.jsx(q,{value:"REJECTED",children:"REJECTED"}),e.jsx(q,{value:"IMPLEMENTED",children:"IMPLEMENTED"})]})]})]})]},s.id))})})})]})}),e.jsx(I,{value:"history",className:"flex-1 overflow-auto mt-4",children:e.jsxs(u,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(h,{className:"p-3 border-b border-secondary",children:e.jsxs(p,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"})," PROPOSAL HISTORY (READ ONLY)"]})}),e.jsx(N,{className:"p-4",children:e.jsx(E,{className:"h-[500px]",children:e.jsx("div",{className:"space-y-2",children:w.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"font-arcade text-xs text-primary mb-2",children:"NO HISTORY YET"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Proposal history will appear here once Scholar generates its first analysis."})]}):w.map(s=>e.jsxs("div",{className:"flex items-center p-3 bg-black/40 border border-secondary/50 font-terminal text-sm","data-testid":`history-proposal-${s.id}`,children:[e.jsx("div",{className:"w-20 font-mono text-xs text-muted-foreground",children:s.proposalId}),e.jsx("div",{className:"flex-1 truncate",children:s.summary}),e.jsxs("div",{className:"flex gap-2 items-center shrink-0",children:[e.jsx(o,{variant:"outline",className:R("rounded-none text-[9px]",J(s.status||"DRAFT")),children:s.status||"DRAFT"}),e.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[e.jsx(ne,{className:"w-3 h-3 inline mr-1"}),s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A"]})]})]},s.id))})})})]})})]})})]})})}export{ms as default};
