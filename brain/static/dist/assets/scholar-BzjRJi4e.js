import{c as b,u as oe,r as u,j as e,b as N}from"./index-vxaivTfW.js";import{u as x,a as F,L as xe,A as B,B as C,h as H,S as m,k as V,b as o}from"./layout-BYzKcK-t.js";import{C as r,a as t,b as n,c}from"./card-8vEaI0SE.js";import{B as l,R as I,S as me}from"./badge-DGgQticr.js";import{S as he,a as ue,b as pe,c as Ne,d as v}from"./select-Cl2h7SLP.js";import{T as je,a as be,L as O,b as fe,c as h,M as ge}from"./tabs-BCg-851K.js";import{S as K}from"./search-ChWgW5O7.js";import{B as Q}from"./book-open-D4GgueXi.js";import{C as ye}from"./circle-check-CrN8qPMT.js";import{C as j}from"./circle-alert-tpSvuc_j.js";import{F as ve}from"./file-text-D42du7m2.js";import{C as Ee}from"./clock-Brhlla2-.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],_=b("circle-question-mark",Se);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ke=b("circle-x",we);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],W=b("history",Te);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],z=b("lightbulb",Re);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],G=b("trending-up",Ae);function Ve(){const E=oe(),[Y,$]=u.useState("summary"),[S,w]=u.useState([]),[k,D]=u.useState(""),[M,P]=u.useState(!1),L=u.useRef(null),{data:i=[]}=x({queryKey:["sessions"],queryFn:o.sessions.getAll}),{data:f=[]}=x({queryKey:["courses"],queryFn:o.courses.getAll}),{data:g=[]}=x({queryKey:["proposals"],queryFn:o.proposals.getAll}),{data:J=[]}=x({queryKey:["scholar-questions"],queryFn:o.scholar.getQuestions}),{data:X=[]}=x({queryKey:["scholar-findings"],queryFn:o.scholar.getFindings}),{data:Z=[]}=x({queryKey:["scholar-tutor-audit"],queryFn:o.scholar.getTutorAudit}),{data:T}=x({queryKey:["scholar-clusters"],queryFn:o.scholar.getClusters}),R=F({mutationFn:o.scholar.runClustering,onSuccess:()=>{E.invalidateQueries({queryKey:["scholar-clusters"]})}}),ee=F({mutationFn:({id:s,data:a})=>o.proposals.update(s,a),onSuccess:()=>{E.invalidateQueries({queryKey:["proposals"]})}});u.useEffect(()=>{L.current?.scrollIntoView({behavior:"smooth"})},[S]);const se=i.slice(0,20),ae=i.reduce((s,a)=>s+(a.minutes||0),0),re=i.length>0?Math.round(ae/i.length):0,te=i.filter(s=>{const a=new Date(s.date),d=new Date;return d.setDate(d.getDate()-7),a>=d}).length,y=f.filter(s=>(s.totalSessions||0)<3),p=i.filter(s=>s.confusions&&s.confusions.length>0).flatMap(s=>s.confusions||[]),A=i.filter(s=>s.issues&&s.issues.length>0).flatMap(s=>s.issues||[]),U=async()=>{if(!k.trim())return;const s=k.trim();w(a=>[...a,{role:"user",content:s}]),D(""),P(!0);try{const a=await o.scholar.chat(s);w(d=>[...d,{role:"assistant",content:a.response}])}catch{w(d=>[...d,{role:"assistant",content:"Error processing your question. Please try again."}])}finally{P(!1)}},ne=J,ce=Z,le=X,q=s=>{switch(s){case"APPROVED":return"bg-primary/20 text-primary border-primary";case"REJECTED":return"bg-secondary/40 text-muted-foreground border-secondary";case"IMPLEMENTED":return"bg-white/20 text-white border-white";default:return"bg-secondary/20 text-secondary-foreground border-secondary"}},de=s=>{switch(s){case"HIGH":return"text-primary border-primary";case"MED":return"text-white border-white";default:return"text-muted-foreground border-muted-foreground"}};return e.jsx(xe,{children:e.jsxs("div",{className:"h-[calc(100vh-140px)] flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"w-6 h-6 text-primary"}),e.jsx("h1",{className:"font-arcade text-lg text-primary",children:"SCHOLAR"}),e.jsx(l,{variant:"outline",className:"rounded-none text-[10px] font-terminal border-primary/50",children:"READ ONLY ADVISORY"})]}),e.jsxs(C,{variant:"outline",size:"sm",className:"rounded-none font-arcade text-xs border-secondary",onClick:()=>E.invalidateQueries(),"data-testid":"button-refresh-data",children:[e.jsx(I,{className:"w-3 h-3 mr-2"})," REFRESH DATA"]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(je,{value:Y,onValueChange:$,className:"h-full flex flex-col",children:[e.jsx(be,{className:"bg-black/60 border border-secondary rounded-none p-1 shrink-0 w-full justify-start overflow-x-auto",children:[{id:"summary",label:"SUMMARY",icon:G},{id:"audit",label:"TUTOR AUDIT",icon:K},{id:"pipeline",label:"QUESTIONS",icon:_},{id:"evidence",label:"EVIDENCE",icon:Q},{id:"proposals",label:"PROPOSALS",icon:z},{id:"clusters",label:"CLUSTERS",icon:O},{id:"history",label:"HISTORY",icon:W}].map(s=>e.jsxs(fe,{value:s.id,className:"rounded-none font-arcade text-[10px] data-[state=active]:bg-primary data-[state=active]:text-black px-3","data-testid":`tab-${s.id}`,children:[e.jsx(s.icon,{className:"w-3 h-3 mr-1"}),s.label]},s.id))}),e.jsx(h,{value:"summary",className:"flex-1 overflow-hidden mt-6",children:e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6 h-full",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4 overflow-auto pr-2",children:[e.jsxs(r,{className:"bg-black/40 border-2 border-primary/50 rounded-none",children:[e.jsx(t,{className:"p-4 border-b border-primary/30",children:e.jsxs(n,{className:"font-arcade text-sm text-primary flex items-center gap-3",children:[e.jsx(G,{className:"w-4 h-4"})," STUDY HEALTH OVERVIEW"]})}),e.jsx(c,{className:"p-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-3 gap-6 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-arcade text-2xl text-primary",children:i.length}),e.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"TOTAL SESSIONS"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-arcade text-2xl text-white",children:te}),e.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"THIS WEEK"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-arcade text-2xl text-secondary",children:[re,"m"]}),e.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"AVG/SESSION"})]})]})})]}),e.jsxs(r,{className:"bg-black/40 border-2 border-white/30 rounded-none",children:[e.jsx(t,{className:"p-3 border-b border-white/20",children:e.jsxs(n,{className:"font-arcade text-xs text-white flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"})," WHAT APPEARS TO BE WORKING"]})}),e.jsxs(c,{className:"p-6",children:[e.jsx("ul",{className:"space-y-3 font-terminal text-sm",children:f.filter(s=>(s.totalSessions||0)>=3).length>0?e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-primary shrink-0 mt-0.5"}),e.jsxs("span",{children:[f.filter(s=>(s.totalSessions||0)>=3).length," courses have consistent study activity"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-primary shrink-0 mt-0.5"}),e.jsx("span",{children:"Round-robin rotation ensuring balanced coverage"})]})]}):e.jsx("li",{className:"text-muted-foreground",children:"Insufficient data - need more sessions to identify patterns"})}),e.jsx("div",{className:"mt-3 pt-3 border-t border-secondary/30",children:e.jsxs(l,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:["CONFIDENCE: ",i.length>10?"MEDIUM":"LOW"," (based on ",i.length," sessions)"]})})]})]}),e.jsxs(r,{className:"bg-black/40 border-2 border-destructive/50 rounded-none",children:[e.jsx(t,{className:"p-3 border-b border-destructive/30",children:e.jsxs(n,{className:"font-arcade text-xs text-destructive flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4"})," POTENTIAL CONCERNS"]})}),e.jsx(c,{className:"p-6",children:e.jsxs("ul",{className:"space-y-3 font-terminal text-sm",children:[y.length>0&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(j,{className:"w-4 h-4 text-destructive shrink-0 mt-0.5"}),e.jsxs("span",{children:[y.length," courses with low activity: ",y.map(s=>s.name).join(", ")]})]}),p.length>0&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(j,{className:"w-4 h-4 text-destructive shrink-0 mt-0.5"}),e.jsxs("span",{children:[p.length," unresolved confusions logged"]})]}),A.length>0&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(j,{className:"w-4 h-4 text-destructive shrink-0 mt-0.5"}),e.jsxs("span",{children:[A.length," session issues flagged"]})]}),y.length===0&&p.length===0&&A.length===0&&e.jsx("li",{className:"text-muted-foreground",children:"No significant concerns identified"})]})})]})]}),e.jsxs(r,{className:"bg-black/40 border-2 border-secondary rounded-none flex flex-col h-full",children:[e.jsx(t,{className:"p-3 border-b border-secondary shrink-0",children:e.jsxs(n,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"})," ASK SCHOLAR"]})}),e.jsxs(c,{className:"p-0 flex-1 flex flex-col overflow-hidden",children:[e.jsx(m,{className:"flex-1 p-3",children:e.jsxs("div",{className:"space-y-3",children:[S.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(B,{className:"w-8 h-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Ask questions about your study data, patterns, or get recommendations."})]}),S.map((s,a)=>e.jsx("div",{className:N("p-2 rounded-sm font-terminal text-xs",s.role==="user"?"bg-primary/20 text-primary ml-8":"bg-secondary/20 text-white mr-8"),children:s.content},a)),M&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground font-terminal text-xs",children:[e.jsx(I,{className:"w-3 h-3 animate-spin"}),"Analyzing Brain data..."]}),e.jsx("div",{ref:L})]})}),e.jsx("div",{className:"p-2 border-t border-secondary shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{value:k,onChange:s=>D(s.target.value),onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),U())},placeholder:"Ask about your study patterns...",className:"rounded-none bg-black border-secondary text-xs min-h-[60px] resize-none","data-testid":"input-scholar-chat"}),e.jsx(C,{size:"icon",className:"rounded-none bg-primary text-black h-[60px] w-10",onClick:U,disabled:M,"data-testid":"button-send-chat",children:e.jsx(me,{className:"w-4 h-4"})})]})})]})]})]})}),e.jsx(h,{value:"audit",className:"flex-1 overflow-auto mt-4",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs(r,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(t,{className:"p-3 border-b border-secondary",children:e.jsxs(n,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"})," TUTOR BEHAVIOR AUDIT"]})}),e.jsxs(c,{className:"p-4 space-y-4",children:[e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:"Post-session analysis of Tutor interactions. No live Tutor access."}),[{q:"Was the Tutor source-aligned?",status:"pending"},{q:"Was cognitive load appropriate?",status:"concern"},{q:"Were confusions resolved or deferred?",status:"ok"},{q:"Did explanations correlate with outcomes?",status:"pending"}].map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-black/40 border border-secondary/50",children:[e.jsx("span",{className:"font-terminal text-xs",children:s.q}),e.jsx(l,{variant:"outline",className:N("rounded-none text-[9px]",s.status==="ok"?"border-primary text-primary":s.status==="concern"?"border-destructive text-destructive":"border-secondary text-secondary-foreground"),children:s.status.toUpperCase()})]},a))]})]}),e.jsxs(r,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(t,{className:"p-3 border-b border-secondary",children:e.jsxs(n,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"})," RECURRENT ISSUES"]})}),e.jsx(c,{className:"p-4",children:e.jsx("div",{className:"space-y-3",children:ce.map((s,a)=>e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-terminal text-sm",children:s.issue??"Unknown issue"}),e.jsxs(l,{variant:"outline",className:"rounded-none text-[9px] border-primary text-primary",children:["x",s.frequency??0]})]}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:(s.courses||[]).map((d,ie)=>e.jsx(l,{variant:"secondary",className:"rounded-none text-[8px]",children:d},ie))})]},a))})})]})]})}),e.jsx(h,{value:"pipeline",className:"flex-1 overflow-auto mt-4",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs(r,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(t,{className:"p-3 border-b border-secondary",children:e.jsxs(n,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"})," QUESTION RESOLUTION PIPELINE"]})}),e.jsxs(c,{className:"p-4",children:[e.jsxs("div",{className:"space-y-2 font-terminal text-xs text-muted-foreground mb-4",children:[e.jsx("p",{children:"1. Generate question from identified issue"}),e.jsx("p",{children:"2. Attempt answer using Brain data"}),e.jsx("p",{children:"3. If insufficient, research learning science"}),e.jsx("p",{children:"4. If still unresolved, escalate to user"})]}),e.jsx("div",{className:"space-y-3",children:[{stage:"Identified",count:5},{stage:"Brain Analysis",count:3},{stage:"Research",count:1},{stage:"User Escalation",count:2}].map((s,a)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary/60"}),e.jsx("span",{className:"font-terminal text-sm flex-1",children:s.stage}),e.jsx(l,{variant:"outline",className:"rounded-none",children:s.count})]},a))})]})]}),e.jsxs(r,{className:"bg-black/40 border-2 border-primary/50 rounded-none",children:[e.jsx(t,{className:"p-3 border-b border-primary/30",children:e.jsxs(n,{className:"font-arcade text-xs text-primary flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"})," OPEN QUESTIONS (YOUR INPUT NEEDED)"]})}),e.jsx(c,{className:"p-4",children:e.jsx(m,{className:"h-[400px]",children:e.jsx("div",{className:"space-y-4",children:ne.map(s=>e.jsxs("div",{className:"p-3 bg-primary/5 border border-primary/30",children:[e.jsx("p",{className:"font-terminal text-sm mb-3",children:s.question}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-muted-foreground shrink-0",children:"Context:"}),e.jsx("span",{children:s.context})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-muted-foreground shrink-0",children:"Data Gap:"}),e.jsx("span",{children:s.dataInsufficient})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-muted-foreground shrink-0",children:"Research:"}),e.jsx("span",{children:s.researchAttempted})]})]}),e.jsx("div",{className:"mt-3 pt-2 border-t border-primary/20",children:e.jsx(V,{placeholder:"Your response...",className:"rounded-none bg-black border-secondary text-xs min-h-[60px]","data-testid":`input-question-response-${s.id}`})})]},s.id))})})})]})]})}),e.jsx(h,{value:"evidence",className:"flex-1 overflow-auto mt-4",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs(r,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(t,{className:"p-3 border-b border-secondary",children:e.jsxs(n,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"})," OBSERVED DATA (from Brain)"]})}),e.jsx(c,{className:"p-4",children:e.jsx(m,{className:"h-[400px]",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:"SESSION DISTRIBUTION"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 font-terminal text-xs",children:f.map(s=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:s.name}),e.jsxs("span",{className:"text-muted-foreground",children:[s.totalSessions||0," sessions"]})]},s.id))})]}),e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:"CONFUSION LOG"}),e.jsx("div",{className:"space-y-1 font-terminal text-xs",children:p.length>0?p.slice(0,5).map((s,a)=>e.jsxs("div",{className:"text-muted-foreground",children:["â€¢ ",s]},a)):e.jsx("div",{className:"text-muted-foreground",children:"No confusions logged"})})]}),e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:"RECENT SESSIONS"}),e.jsx("div",{className:"space-y-1 font-terminal text-xs",children:se.slice(0,5).map((s,a)=>e.jsxs("div",{className:"flex justify-between text-muted-foreground",children:[e.jsx("span",{children:s.topic||"Untitled"}),e.jsxs("span",{children:[s.minutes||0,"m"]})]},a))})]})]})})})]}),e.jsxs(r,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(t,{className:"p-3 border-b border-secondary",children:e.jsxs(n,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"})," RESEARCH INTERPRETATION"]})}),e.jsxs(c,{className:"p-4",children:[e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:"Learning science findings relevant to your study patterns."}),e.jsx(m,{className:"h-[350px]",children:e.jsx("div",{className:"space-y-4",children:le.map((s,a)=>e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:s.topic??s.title}),e.jsx("p",{className:"font-terminal text-xs mb-2",children:s.summary??s.content}),e.jsx("div",{className:"flex justify-between text-[10px] text-muted-foreground",children:e.jsxs("span",{children:["Source: ",s.source]})}),e.jsx("div",{className:"mt-2 pt-2 border-t border-secondary/30",children:e.jsxs("span",{className:"text-[10px] text-primary",children:["Relevance: ",s.relevance??"n/a"]})})]},a))})})]})]})]})}),e.jsx(h,{value:"proposals",className:"flex-1 overflow-auto mt-4",children:e.jsxs(r,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsxs(t,{className:"p-3 border-b border-secondary",children:[e.jsxs(n,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"})," IMPROVEMENT PROPOSALS"]}),e.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground mt-1",children:"No auto-implementation. All changes require user approval."})]}),e.jsx(c,{className:"p-4",children:e.jsx(m,{className:"h-[500px]",children:e.jsx("div",{className:"space-y-4",children:g.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground font-terminal text-sm",children:"No proposals yet. Scholar will generate proposals based on Brain analysis."}):g.filter(s=>s.status!=="REJECTED").map(s=>e.jsxs("div",{className:"p-4 bg-black/40 border border-secondary/50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:s.proposalId}),e.jsx("h4",{className:"font-terminal text-sm mt-1",children:s.summary})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(l,{variant:"outline",className:N("rounded-none text-[9px]",de(s.priority||"MED")),children:s.priority||"MED"})})]}),s.targetSystem&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Target: "}),e.jsx(l,{variant:"secondary",className:"rounded-none text-[9px]",children:s.targetSystem})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-secondary/30",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:"Confidence: MED"}),e.jsx(l,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:"Risk: LOW"})]}),e.jsxs(he,{value:s.status||"DRAFT",onValueChange:a=>ee.mutate({id:s.id,data:{status:a}}),children:[e.jsx(ue,{className:N("rounded-none w-28 h-7 text-[10px]",q(s.status||"DRAFT")),"data-testid":`select-proposal-status-${s.id}`,children:e.jsx(pe,{})}),e.jsxs(Ne,{className:"rounded-none bg-black border-primary",children:[e.jsx(v,{value:"DRAFT",children:"PROPOSED"}),e.jsx(v,{value:"APPROVED",children:"APPROVED"}),e.jsx(v,{value:"REJECTED",children:"REJECTED"}),e.jsx(v,{value:"IMPLEMENTED",children:"IMPLEMENTED"})]})]})]})]},s.id))})})})]})}),e.jsx(h,{value:"clusters",className:"flex-1 overflow-auto mt-4",children:e.jsxs(r,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsxs(t,{className:"p-3 border-b border-secondary flex flex-row items-center justify-between",children:[e.jsxs(n,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"})," TOPIC CLUSTERS"]}),e.jsx(C,{variant:"outline",size:"sm",className:"rounded-none font-arcade text-[10px] border-primary text-primary",onClick:()=>R.mutate(),disabled:R.isPending,"data-testid":"button-run-clustering",children:R.isPending?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-3 h-3 mr-1 animate-spin"})," CLUSTERING..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-3 h-3 mr-1"})," RUN CLUSTERING"]})})]}),e.jsx(c,{className:"p-4",children:e.jsx(m,{className:"h-[500px]",children:e.jsx("div",{className:"space-y-4",children:!T?.clusters||T.clusters.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground font-terminal text-sm",children:"No clusters yet. Click RUN CLUSTERING to group digests and proposals by topic."}):T.clusters.map(s=>e.jsxs("div",{className:"p-4 bg-black/40 border border-secondary/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-arcade text-xs text-primary uppercase",children:s.cluster_id}),e.jsxs(l,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:[s.count," items"]})]}),e.jsx("div",{className:"space-y-2",children:s.items.map((a,d)=>e.jsxs("div",{className:"flex items-center gap-2 font-terminal text-xs",children:[e.jsx(l,{variant:"secondary",className:"rounded-none text-[8px] shrink-0",children:a.source==="digest"?"DIG":"PROP"}),e.jsx("span",{className:"truncate",children:a.title||"Untitled"})]},d))})]},s.cluster_id))})})})]})}),e.jsx(h,{value:"history",className:"flex-1 overflow-auto mt-4",children:e.jsxs(r,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(t,{className:"p-3 border-b border-secondary",children:e.jsxs(n,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"})," PROPOSAL HISTORY (READ ONLY)"]})}),e.jsx(c,{className:"p-4",children:e.jsx(m,{className:"h-[500px]",children:e.jsx("div",{className:"space-y-2",children:g.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground font-terminal text-sm",children:"No proposal history yet."}):g.map(s=>e.jsxs("div",{className:"flex items-center p-3 bg-black/40 border border-secondary/50 font-terminal text-sm","data-testid":`history-proposal-${s.id}`,children:[e.jsx("div",{className:"w-20 font-mono text-xs text-muted-foreground",children:s.proposalId}),e.jsx("div",{className:"flex-1 truncate",children:s.summary}),e.jsxs("div",{className:"flex gap-2 items-center shrink-0",children:[e.jsx(l,{variant:"outline",className:N("rounded-none text-[9px]",q(s.status||"DRAFT")),children:s.status||"DRAFT"}),e.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[e.jsx(Ee,{className:"w-3 h-3 inline mr-1"}),s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A"]})]})]},s.id))})})})]})})]})})]})})}export{Ve as default};
