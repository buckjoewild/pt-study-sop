import{c as x,u as q,r as a,j as e,b as B}from"./index-CDeS5KDC.js";import{u as U,a as z,L as D,S as F,f as P,g as Q,h as G,i as b,I as v,B as i,j as K,F as S,k as l}from"./select-mLMzr1sc.js";import{C as y,c as k,a as V,b as Y}from"./card-CGvdjm45.js";import{R as H,S as W}from"./send-BDKKlA1B.js";import{B as Z}from"./book-open-DQAF5Niz.js";import{F as X}from"./file-text-CTE0c8td.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],ee=x("brain-circuit",J);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],te=x("sparkles",se);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],re=x("user",ae);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],ce=x("zap",ne);function me(){const f=q(),[h,w]=a.useState("core"),[n,E]=a.useState(""),[c,g]=a.useState(""),[r,C]=a.useState(()=>`session-${Date.now()}`),[M,j]=a.useState(0),[t,I]=a.useState(!1),d=a.useRef(null),{data:o=[],refetch:T}=U({queryKey:["chat",r],queryFn:()=>l.chat.getMessages(r),enabled:t}),m=z({mutationFn:s=>l.chat.sendMessage(r,{sender:"user",content:s}),onSuccess:()=>{f.invalidateQueries({queryKey:["chat",r]}),setTimeout(()=>{l.chat.sendMessage(r,{sender:"tutor",content:A()}).then(()=>{f.invalidateQueries({queryKey:["chat",r]})})},1e3)}}),A=()=>{const s=[`Great question about ${n||"this topic"}! Let me break this down for you with the PEIRRO method.`,"Let's apply the Seed-Lock principle here. What's your initial hook or mental model for understanding this concept?","According to the Function Before Structure approach, let's first understand what this DOES before where it IS.","Excellent progress! Remember: prove understanding at L2 (teach-back) before advancing to the next level.","Let me check the source materials... Based on your active sources, here's what we know:"];return s[Math.floor(Math.random()*s.length)]};a.useEffect(()=>{let s;return t&&(s=setInterval(()=>{j(u=>u+1)},1e3)),()=>clearInterval(s)},[t]),a.useEffect(()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)},[o]);const _=s=>{const u=Math.floor(s/60),L=s%60;return`${u.toString().padStart(2,"0")}:${L.toString().padStart(2,"0")}`},p=()=>{const s=`session-${Date.now()}`;C(s),I(!0),j(0),l.chat.sendMessage(s,{sender:"tutor",content:`Ready to study ${n||"your chosen topic"} in ${h.toUpperCase()} mode. What would you like to focus on first?`}).then(()=>{T()})},N=()=>{c.trim()&&t&&(m.mutate(c),g(""))},R=()=>{t||p(),m.mutate(`Can you explain ${n||"this concept"} in more detail? Break it down step by step.`)},O=()=>{t||p(),m.mutate(`Quiz me on ${n||"what we've discussed"}. Give me a practice question to test my understanding.`)},$=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),N())};return e.jsx(D,{children:e.jsxs("div",{className:"h-[calc(100vh-140px)] flex flex-col md:flex-row gap-6",children:[e.jsxs("aside",{className:"w-full md:w-80 flex flex-col gap-6 shrink-0",children:[e.jsxs(y,{className:"bg-black/40 border-2 border-primary rounded-none",children:[e.jsx("div",{className:"grid grid-cols-3",children:["core","sprint","drill"].map(s=>e.jsx("button",{onClick:()=>w(s),className:B("p-3 font-arcade text-[10px] uppercase border-b-2 transition-all hover:bg-primary/20",h===s?"bg-primary text-black border-primary font-bold":"text-muted-foreground border-secondary bg-black"),"data-testid":`button-mode-${s}`,children:s},s))}),e.jsxs(k,{className:"p-4",children:[e.jsxs("div",{className:"font-terminal text-sm text-center text-primary mb-4 animate-pulse uppercase",children:["<< ",h.toUpperCase(),"_MODE ",t?"ACTIVE":"STANDBY"," >>"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-arcade text-muted-foreground",children:"COURSE"}),e.jsxs(F,{defaultValue:"anat",children:[e.jsx(P,{className:"rounded-none bg-black border-secondary","data-testid":"select-course",children:e.jsx(Q,{})}),e.jsxs(G,{className:"bg-black border-primary rounded-none",children:[e.jsx(b,{value:"anat",children:"ANATOMY"}),e.jsx(b,{value:"phys",children:"PHYSIOLOGY"}),e.jsx(b,{value:"neuro",children:"NEUROSCIENCE"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-arcade text-muted-foreground",children:"TOPIC"}),e.jsx(v,{className:"rounded-none bg-black border-secondary",placeholder:"Ex: Cranial Nerves",value:n,onChange:s=>E(s.target.value),"data-testid":"input-topic"})]}),e.jsx(i,{className:"w-full rounded-none font-arcade bg-secondary hover:bg-white hover:text-black",onClick:p,"data-testid":"button-start-session",children:t?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," NEW_SESSION"]}):"START_SESSION"})]})]})]}),e.jsxs(y,{className:"bg-black/40 border-2 border-secondary rounded-none flex-1 flex flex-col",children:[e.jsx(V,{className:"border-b border-secondary p-4",children:e.jsxs(Y,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"})," CONTEXT"]})}),e.jsxs(k,{className:"p-4 flex-1 space-y-4 font-terminal text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"TIMER"}),e.jsx("span",{className:"text-xl text-primary font-arcade","data-testid":"text-timer",children:_(M)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"MESSAGES"}),e.jsx("span",{className:"text-white","data-testid":"text-message-count",children:o.length})]}),e.jsxs("div",{className:"space-y-2 pt-4 border-t border-secondary/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase mb-2",children:"ACTIVE SOURCES"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs border border-secondary p-2 bg-black/50",children:[e.jsx(Z,{className:"w-3 h-3 text-white"}),e.jsx("span",{className:"truncate",children:"Gray's Anatomy Ch.4"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs border border-secondary p-2 bg-black/50",children:[e.jsx(X,{className:"w-3 h-3 text-white"}),e.jsx("span",{className:"truncate",children:"Lecture_Notes_W4.pdf"})]})]})]}),e.jsxs("div",{className:"p-2 grid grid-cols-2 gap-2 border-t border-secondary bg-black/20",children:[e.jsxs(i,{size:"sm",variant:"ghost",onClick:R,className:"rounded-none border border-secondary hover:bg-primary hover:text-black text-[10px] font-arcade h-auto py-2","data-testid":"button-explain",children:[e.jsx(te,{className:"w-3 h-3 mr-1"})," EXPLAIN"]}),e.jsxs(i,{size:"sm",variant:"ghost",onClick:O,className:"rounded-none border border-secondary hover:bg-primary hover:text-black text-[10px] font-arcade h-auto py-2","data-testid":"button-quiz",children:[e.jsx(ce,{className:"w-3 h-3 mr-1"})," QUIZ_ME"]})]})]})]}),e.jsxs(y,{className:"flex-1 bg-black/60 border-2 border-primary rounded-none flex flex-col overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.1)_50%),linear-gradient(90deg,rgba(255,0,0,0.03),rgba(255,0,0,0.03)_1px,transparent_1px),linear-gradient(rgba(255,0,0,0.03),rgba(255,0,0,0.03)_1px,transparent_1px)] bg-[length:100%_4px,20px_20px,20px_20px] pointer-events-none"}),e.jsx(K,{className:"flex-1 p-6",ref:d,children:e.jsx("div",{className:"space-y-6",children:!t&&o.length===0?e.jsxs("div",{className:"text-center py-12 font-terminal text-muted-foreground",children:[e.jsx(S,{className:"w-12 h-12 mx-auto mb-4 text-primary/50"}),e.jsx("p",{children:"SELECT A TOPIC AND START A SESSION"}),e.jsx("p",{className:"text-xs mt-2",children:"Your AI tutor is standing by..."})]}):o.map(s=>s.sender==="tutor"?e.jsxs("div",{className:"flex gap-4 max-w-[80%]","data-testid":`message-tutor-${s.id}`,children:[e.jsx("div",{className:"w-8 h-8 shrink-0 bg-primary/20 border border-primary flex items-center justify-center rounded-none",children:e.jsx(S,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs font-arcade text-primary",children:"AI_TUTOR"}),e.jsx("div",{className:"bg-primary/10 border border-primary/30 p-3 font-terminal text-sm md:text-base leading-relaxed",children:e.jsx("p",{children:s.content})})]})]},s.id):e.jsxs("div",{className:"flex flex-row-reverse gap-4 max-w-[80%] ml-auto","data-testid":`message-user-${s.id}`,children:[e.jsx("div",{className:"w-8 h-8 shrink-0 bg-secondary/20 border border-secondary flex items-center justify-center rounded-none",children:e.jsx(re,{className:"w-5 h-5 text-secondary-foreground"})}),e.jsxs("div",{className:"space-y-1 text-right",children:[e.jsx("div",{className:"text-xs font-arcade text-muted-foreground",children:"USER"}),e.jsx("div",{className:"bg-secondary/20 border border-secondary p-3 font-terminal text-sm md:text-base leading-relaxed text-left",children:e.jsx("p",{children:s.content})})]})]},s.id))})}),e.jsxs("div",{className:"p-4 border-t-2 border-primary bg-black",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{className:"flex-1 rounded-none bg-secondary/20 border-secondary focus-visible:ring-primary font-terminal text-lg h-12",placeholder:t?"TYPE_MESSAGE...":"START A SESSION FIRST...",value:c,onChange:s=>g(s.target.value),onKeyPress:$,disabled:!t,"data-testid":"input-message"}),e.jsx(i,{className:"h-12 w-12 rounded-none bg-primary text-black hover:bg-primary/90",onClick:N,disabled:!t||!c.trim(),"data-testid":"button-send",children:e.jsx(W,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"text-[10px] font-arcade text-muted-foreground mt-2 text-right","data-testid":"text-session-id",children:["SESSION_ID: #",r.slice(-8).toUpperCase(),t?"-ACTIVE":"-IDLE"]})]})]})]})})}export{me as default};
