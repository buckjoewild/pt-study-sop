<!DOCTYPE html>
<!-- PT Study Brain Dashboard v3.0 - Updated: 2026-01-11 - SaaS Professional UI -->
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="dark" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>PT Study Brain v3.0</title>

  <link
    href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Orbitron:wght@500;600;700;800&family=Press+Start+2P&family=VT323&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="/static/css/dashboard.css?v=4.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script src="/static/js/dashboard.js?v=3.0" defer></script>
</head>

<body>
  <div class="app-shell retro-scanlines">
    <!-- Top Navigation Header -->
    <header class="top-nav-header" role="banner">
      <!-- 90s Arcade Chaos Decorative Elements -->
      <div class="chaos-accent chaos-accent-1"></div>
      <div class="chaos-accent chaos-accent-2"></div>
      <div class="chaos-accent chaos-accent-3"></div>
      <div class="chaos-accent chaos-accent-4"></div>

      <!-- Brand (Left) -->
      <a href="#overview" class="top-nav-brand" onclick="openTab(event, 'overview'); return false;"
        title="Trey's Study System">
        <img src="/static/images/logo-brain-new.jpg" alt="Trey's Study System" class="logo-icon">
      </a>

      <div class="top-nav-center">
        <div class="top-nav-title">
          TREY'S <span>STUDY SYSTEM</span>
        </div>

        <!-- Navigation Menu (Center - Desktop) -->
        <nav class="top-nav-menu" role="navigation" aria-label="Main navigation">
          <a href="#overview" class="top-nav-item active" onclick="openTab(event, 'overview')" data-tab="overview"
            aria-current="page">
            <div class="terminal-badge">
              <img src="/static/images/icons/neo-nav-overview.svg" alt="" class="nav-icon-img nav-icon-img--top" />
            </div>
            <span class="terminal-badge-label">VIEW</span>
          </a>
          <a href="#sessions" class="top-nav-item" onclick="openTab(event, 'sessions')" data-tab="sessions">
            <div class="terminal-badge">
              <img src="/static/images/icons/neo-nav-brain.svg" alt="" class="nav-icon-img nav-icon-img--top" />
            </div>
            <span class="terminal-badge-label">BRAIN</span>
          </a>
          <a href="#syllabus" class="top-nav-item" onclick="openTab(event, 'syllabus')" data-tab="syllabus">
            <div class="terminal-badge">
              <img src="/static/images/icons/neo-nav-syllabus.svg" alt="" class="nav-icon-img nav-icon-img--top" />
            </div>
            <span class="terminal-badge-label">LIST</span>
          </a>
          <a href="#scholar" class="top-nav-item" onclick="openTab(event, 'scholar')" data-tab="scholar">
            <div class="terminal-badge">
              <img src="/static/images/icons/neo-nav-scholar.svg" alt="" class="nav-icon-img nav-icon-img--top" />
            </div>
            <span class="terminal-badge-label">SCHOLAR</span>
          </a>
          <a href="#tutor" class="top-nav-item" onclick="openTab(event, 'tutor')" data-tab="tutor">
            <div class="terminal-badge">
              <img src="/static/images/icons/neo-nav-tutor.svg" alt="" class="nav-icon-img nav-icon-img--top" />
            </div>
            <span class="terminal-badge-label">TUTOR</span>
          </a>
          <a href="#brain" class="top-nav-item" onclick="openTab(event, 'brain')" data-tab="brain">
            <div class="terminal-badge">
              <img src="/static/images/icons/neo-nav-database.svg" alt="" class="nav-icon-img nav-icon-img--top" />
            </div>
            <span class="terminal-badge-label">DATA</span>
          </a>
          <a href="#sync" class="top-nav-item" onclick="openTab(event, 'sync')" data-tab="sync">
            <div class="terminal-badge">
              <img src="/static/images/icons/neo-nav-sync.svg" alt="" class="nav-icon-img nav-icon-img--top" />
              <span id="sync-count-badge" class="badge-count" style="display: none;">0</span>
            </div>
            <span class="terminal-badge-label">SYNC</span>
          </a>
        </nav>
      </div>

      <!-- Right Section -->
      <div class="top-nav-right">
        <span class="top-nav-page-title" id="current-page-title">Overview</span>
        <span class="top-nav-version">v3.0</span>
        <button class="top-nav-profile" id="profile-btn" aria-label="Profile" title="Profile">
          <span style="font-size: 13px; font-weight: 600;">TT</span>
        </button>

        <!-- Hamburger Button (Mobile) -->
        <button class="hamburger-btn" id="hamburger-btn" onclick="toggleMobileNav()" aria-label="Toggle menu"
          aria-expanded="false" aria-controls="mobile-nav-panel">
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
      </div>
    </header>

    <!-- Mobile Navigation Overlay -->
    <div class="mobile-nav-overlay" id="mobile-nav-overlay" onclick="closeMobileNav()"></div>

    <!-- Mobile Navigation Panel -->
    <nav class="mobile-nav-panel" id="mobile-nav-panel" role="navigation" aria-label="Mobile navigation">
      <a href="#overview" class="mobile-nav-item active" onclick="openTab(event, 'overview'); closeMobileNav();"
        data-tab="overview">
        <img src="/static/images/icons/neo-nav-overview.svg" alt="Overview" class="nav-icon-img">
        <span class="nav-text">Overview</span>
      </a>
      <a href="#sessions" class="mobile-nav-item" onclick="openTab(event, 'sessions'); closeMobileNav();"
        data-tab="sessions">
        <img src="/static/images/icons/neo-nav-brain.svg" alt="Brain" class="nav-icon-img">
        <span class="nav-text">Brain</span>
      </a>
      <a href="#syllabus" class="mobile-nav-item" onclick="openTab(event, 'syllabus'); closeMobileNav();"
        data-tab="syllabus">
        <img src="/static/images/icons/neo-nav-syllabus.svg" alt="Syllabus" class="nav-icon-img">
        <span class="nav-text">Syllabus</span>
      </a>
      <a href="#scholar" class="mobile-nav-item" onclick="openTab(event, 'scholar'); closeMobileNav();"
        data-tab="scholar">
        <img src="/static/images/icons/neo-nav-scholar.svg" alt="Scholar" class="nav-icon-img">
        <span class="nav-text">Scholar</span>
      </a>
      <a href="#tutor" class="mobile-nav-item" onclick="openTab(event, 'tutor'); closeMobileNav();" data-tab="tutor">
        <img src="/static/images/icons/neo-nav-tutor.svg" alt="Tutor" class="nav-icon-img">
        <span class="nav-text">Tutor</span>
      </a>
      <a href="#brain" class="mobile-nav-item" onclick="openTab(event, 'brain'); closeMobileNav();" data-tab="brain">
        <img src="/static/images/icons/neo-nav-database.svg" alt="Database" class="nav-icon-img">
        <span class="nav-text">Database</span>
      </a>
      <a href="#sync" class="mobile-nav-item" onclick="openTab(event, 'sync'); closeMobileNav();" data-tab="sync">
        <img src="/static/images/icons/neo-nav-sync.svg" alt="Sync" class="nav-icon-img">
        <span class="nav-text">Sync Inbox</span>
      </a>
    </nav>

    <!-- Legacy Sidebar (Hidden - kept for JS compatibility) -->
    <aside class="sidebar" id="sidebar" aria-hidden="true" style="display: none !important;">
      <nav class="sidebar-nav">
        <a href="#overview" class="nav-item active" onclick="openTab(event, 'overview')" data-tab="overview">
          <img src="/static/images/icons/neo-nav-overview.svg" alt="Overview" class="nav-icon-img">
        </a>
        <a href="#sessions" class="nav-item" onclick="openTab(event, 'sessions')" data-tab="sessions">
          <img src="/static/images/icons/neo-nav-brain.svg" alt="Brain" class="nav-icon-img">
        </a>
        <a href="#syllabus" class="nav-item" onclick="openTab(event, 'syllabus')" data-tab="syllabus">
          <img src="/static/images/icons/neo-nav-syllabus.svg" alt="Syllabus" class="nav-icon-img">
        </a>
        <a href="#scholar" class="nav-item" onclick="openTab(event, 'scholar')" data-tab="scholar">
          <img src="/static/images/icons/neo-nav-scholar.svg" alt="Scholar" class="nav-icon-img">
        </a>
        <a href="#tutor" class="nav-item" onclick="openTab(event, 'tutor')" data-tab="tutor">
          <img src="/static/images/icons/neo-nav-tutor.svg" alt="Tutor" class="nav-icon-img">
        </a>
        <a href="#brain" class="nav-item" onclick="openTab(event, 'brain')" data-tab="brain">
          <img src="/static/images/icons/neo-nav-database.svg" alt="Database" class="nav-icon-img">
        </a>
        <a href="#sync" class="nav-item" onclick="openTab(event, 'sync')" data-tab="sync">
          <img src="/static/images/icons/neo-nav-sync.svg" alt="Sync" class="nav-icon-img">
        </a>
      </nav>
    </aside>

    <!-- Mobile Overlay (Legacy - kept for compatibility) -->
    <div class="mobile-overlay" id="mobile-overlay" style="display: none !important;"></div>

    <!-- Main Content Wrapper -->
    <div class="main-wrapper">
      <!-- Main Content Area -->
      <main class="main-content">

        <!-- Overview Tab -->
        <section id="tab-overview" class="tab-panel active">
          <style>
            #overview-wrapper {
              /* Neo-retro glass tokens for Overview */
              --bg-deep: var(--bg);
              --card-bg: var(--glass-bg);
              --border-color: var(--border);
              --text-main: var(--text-primary);
              --text-muted: var(--text-secondary);
              --accent-primary: var(--primary);
              --accent-teal: var(--accent);

              /* Red/grey gradient for Glassmorphism */
              background: radial-gradient(circle at 15% 50%, rgba(var(--primary-rgb), 0.12), transparent 25%),
                radial-gradient(circle at 85% 30%, rgba(var(--accent-rgb), 0.12), transparent 25%),
                var(--bg-deep);

              color: var(--text-main);
              padding: 32px;
              border-radius: var(--radius-lg);
              box-sizing: border-box;
            }

            #overview-wrapper * {
              box-sizing: border-box;
            }

            /* Grid System */
            .dashboard-grid {
              display: grid;
              grid-template-columns: repeat(4, 1fr);
              /* Force 4 columns */
              gap: 24px;
              margin-top: 24px;
            }

            /* Cards */
            .d-card {
              background: var(--card-bg);
              border: 1px solid var(--border-color);
              border-radius: var(--radius-xl);
              padding: 20px;
              backdrop-filter: var(--glass-blur);
              /* The Glass Blur */
              -webkit-backdrop-filter: var(--glass-blur);
              box-shadow: var(--shadow-sm);
            }

            /* Mini Stats */
            .d-card.mini {
              grid-column: span 1;
              display: flex;
              align-items: center;
              gap: 16px;
              transition: transform 0.2s;
            }

            .d-card.mini:hover {
              transform: translateY(-2px);
              border-color: var(--accent-primary);
              box-shadow: var(--shadow-md), var(--primary-glow-subtle);
            }

            /* Spanning Cards */
            .d-card.hero {
              grid-column: span 4;
              min-height: 250px;
            }

            .d-card.upload {
              grid-column: span 4;
              cursor: pointer;
              border-style: dashed;
            }

            /* Icons */
            .d-icon {
              width: 48px;
              height: 48px;
              background: rgba(255, 255, 255, 0.05);
              border-radius: 12px;
              display: flex;
              align-items: center;
              justify-content: center;
              flex-shrink: 0;
            }

            .d-icon svg {
              width: 24px;
              height: 24px;
              stroke: var(--text-main);
            }

            /* Chart Container (Prevent Explosion) */
            .chart-box {
              height: 120px;
              width: 120px;
              position: relative;
            }

            /* Responsive */
            @media (max-width: 1024px) {
              .dashboard-grid {
                grid-template-columns: 1fr 1fr;
              }

              .d-card.hero,
              .d-card.upload {
                grid-column: span 2;
              }
            }

            @media (max-width: 600px) {
              .dashboard-grid {
                display: flex;
                flex-direction: column;
              }
            }
          </style>

          <div id="overview-wrapper">
            <div class="tab-header">
              <h2 class="page-title">Dashboard Overview</h2>
              <!-- Expand/Collapse All Controls -->
              <div class="tab-controls">
                <div class="btn-group">
                  <button type="button" class="btn btn-ghost" onclick="expandAllSections('tab-overview')">
                    <span style="font-size: 10px;">‚ñº</span> Expand All
                  </button>
                  <button type="button" class="btn btn-ghost" onclick="collapseAllSections('tab-overview')">
                    <span style="font-size: 10px;">‚ñ≤</span> Collapse All
                  </button>
                </div>
              </div>
            </div>

            <!-- Quick Stats Section (Always visible, not collapsible) -->
            <div class="dashboard-grid" style="margin-bottom: 24px;">

              <div class="d-card mini">
                <div class="d-icon" style="color:#0EA5E9;">
                  <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                </div>
                <div>
                  <div style="font-size:1.5rem; font-weight:700;" id="total-sessions">0</div>
                  <div style="font-size:0.85rem; color:#94a3b8;">Total Sessions</div>
                </div>
              </div>

              <div class="d-card mini">
                <div class="d-icon" style="color:#14B8A6;">
                  <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                  </svg>
                </div>
                <div>
                  <div style="font-size:1.5rem; font-weight:700;" id="total-time">0h</div>
                  <div style="font-size:0.85rem; color:#94a3b8;">Study Time</div>
                </div>
              </div>

              <div class="d-card mini">
                <div class="d-icon" style="color:#10b981;">
                  <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
                    </path>
                  </svg>
                </div>
                <div>
                  <div style="font-size:1.5rem; font-weight:700;" id="avg-score">-%</div>
                  <div style="font-size:0.85rem; color:#94a3b8;">Avg. Score</div>
                </div>
              </div>

              <div class="d-card mini">
                <div class="d-icon" style="color:#f59e0b;">
                  <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10">
                    </path>
                  </svg>
                </div>
                <div>
                  <div style="font-size:1.5rem; font-weight:700;" id="anki-cards">0</div>
                  <div style="font-size:0.85rem; color:#94a3b8;">Cards Due</div>
                </div>
              </div>
            </div>

            <!-- Scholar Insights Panel (Collapsible) -->
            <details class="section-panel" id="scholar-insights-panel" open style="display: none;">
              <summary>
                <div class="summary-content">
                  <div class="terminal-badge wide">
                    <img src="/static/images/icons/neo-header-insights.svg" alt="" class="section-icon-img" />
                    <span class="terminal-badge-label">SCHOLAR INSIGHTS</span>
                  </div>
                </div>
                <span class="summary-chevron">‚ñº</span>
              </summary>
              <div class="section-panel-content">
                <div id="scholar-insights-card"
                  style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                  <!-- Alerts Section -->
                  <div id="scholar-alerts-section">
                    <h4 style="font-size:0.75rem; text-transform:uppercase; color:#94a3b8; margin-bottom:10px;">Alerts
                    </h4>
                    <div id="scholar-alerts-list" style="font-size:0.9rem;">
                      <div style="color:#64748b;">No alerts</div>
                    </div>
                  </div>

                  <!-- Proposals Section -->
                  <div>
                    <h4 style="font-size:0.75rem; text-transform:uppercase; color:#94a3b8; margin-bottom:10px;">Pending
                      Proposals</h4>
                    <div id="scholar-proposals-count" style="font-size:0.9rem; cursor: pointer;"
                      onclick="openTab(null, 'scholar')">
                      <span style="color:#64748b;">0 proposals</span>
                    </div>
                  </div>

                  <!-- Questions Section -->
                  <div>
                    <h4 style="font-size:0.75rem; text-transform:uppercase; color:#94a3b8; margin-bottom:10px;">Pending
                      Questions</h4>
                    <div id="scholar-questions-count" style="font-size:0.9rem; cursor: pointer;"
                      onclick="openTab(null, 'scholar')">
                      <span style="color:#64748b;">0 questions</span>
                    </div>
                  </div>

                  <!-- Recent Findings Section -->
                  <div style="grid-column: span 1;">
                    <h4 style="font-size:0.75rem; text-transform:uppercase; color:#94a3b8; margin-bottom:10px;">Recent
                      Findings</h4>
                    <ul id="scholar-findings-list"
                      style="padding-left:0; margin:0; list-style:none; font-size:0.85rem; color:#94a3b8;">
                      <li style="color:#64748b;">No recent findings</li>
                    </ul>
                  </div>
                </div>
                <div style="margin-top: 16px; text-align: right;">
                  <button class="btn" style="font-size: 0.75rem; padding: 4px 10px;"
                    onclick="openTab(null, 'scholar')">View All ‚Üí</button>
                </div>
              </div>
            </details>

            <!-- Patterns & Insights (Collapsible) -->
            <details class="section-panel" id="patterns-panel">
              <summary>
                <div class="summary-content">
                  <div class="terminal-badge wide">
                    <img src="/static/images/icons/neo-header-patterns.svg" alt="" class="section-icon-img" />
                    <span class="terminal-badge-label">PATTERNS & INSIGHTS</span>
                  </div>
                </div>
                <span class="summary-chevron">‚ñº</span>
              </summary>
              <div class="section-panel-content" id="patterns">
                <div
                  style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; align-items:start;">
                  <div style="display:flex; flex-direction:column; align-items:center; gap:12px;">
                    <div class="chart-box"><canvas id="modeChart"></canvas></div>
                    <div id="mode-legend"
                      style="display:flex; flex-wrap:wrap; gap:12px; font-size:0.75rem; color:#94a3b8;"></div>
                  </div>

                  <div>
                    <h4 style="font-size:0.75rem; text-transform:uppercase; color:#94a3b8; margin-bottom:8px;">Focus
                      Areas</h4>
                    <div style="font-size:0.9rem;">
                      <div style="margin-bottom:5px;"><span style="color:#ef4444;">‚Ä¢</span> Weak: <span
                          id="weak-topics">-</span></div>
                      <div><span style="color:#10b981;">‚Ä¢</span> Strong: <span id="strong-topics">-</span></div>
                    </div>
                  </div>

                  <div>
                    <h4 style="font-size:0.75rem; text-transform:uppercase; color:#94a3b8; margin-bottom:8px;">
                      Retrospective</h4>
                    <ul id="what-worked"
                      style="padding-left:15px; margin:0; list-style:none; font-size:0.9rem; color:#94a3b8;">
                      <li>waiting for data...</li>
                    </ul>
                  </div>
                </div>
              </div>
            </details>

            <!-- Study Trends (Collapsible) -->
            <details class="section-panel" id="trends-panel">
              <summary>
                <div class="summary-content">
                  <div class="terminal-badge wide">
                    <img src="/static/images/icons/neo-header-trends.svg" alt="" class="section-icon-img" />
                    <span class="terminal-badge-label">STUDY TRENDS</span>
                  </div>
                </div>
                <span class="summary-chevron">‚ñº</span>
              </summary>
              <div class="section-panel-content">
                <div style="display:flex; justify-content:flex-end; margin-bottom: 16px;">
                  <select id="trends-period"
                    style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; padding: 6px 12px; color: #f1f5f9; font-size: 0.85rem; cursor: pointer;">
                    <option value="7">Last 7 days</option>
                    <option value="14">Last 14 days</option>
                    <option value="30" selected>Last 30 days</option>
                  </select>
                </div>
                <div id="trends-container" style="position: relative; width: 100%; height: 200px;">
                  <canvas id="trends-chart" style="width: 100%; height: 100%;"></canvas>
                  <div id="trends-empty"
                    style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #94a3b8; text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 8px;">üìä</div>
                    <div>No trend data yet</div>
                    <div style="font-size: 0.85rem;">Complete some study sessions to see your progress</div>
                  </div>
                </div>
                <div id="trends-legend"
                  style="display: flex; justify-content: center; gap: 24px; margin-top: 16px; font-size: 0.85rem; color: #94a3b8;">
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <span style="width: 12px; height: 3px; background: #a855f7; border-radius: 2px;"></span>
                    Understanding
                  </div>
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <span style="width: 12px; height: 3px; background: #3b82f6; border-radius: 2px;"></span>
                    Retention
                  </div>
                </div>
              </div>
            </details>

            <!-- Upload Section (Collapsible, collapsed by default) -->
            <details class="section-panel" id="upload-panel">
              <summary>
                <div class="summary-content">
                  <div class="terminal-badge wide">
                    <img src="/static/images/icons/neo-header-upload.svg" alt="" class="section-icon-img" />
                    <span class="terminal-badge-label">UPLOAD LOG</span>
                  </div>
                </div>
                <span class="summary-chevron">‚ñº</span>
              </summary>
              <div class="section-panel-content">
                <div class="d-card upload" id="dropzone" style="margin: 0;">
                  <div style="display:flex; align-items:center; justify-content:space-between;">
                    <div style="display:flex; align-items:center; gap:15px;">
                      <div class="d-icon"><i class="fas fa-folder-open" style="font-size: 24px;"></i></div>
                      <div>
                        <div style="font-weight:bold;">Drop files here or click to browse</div>
                        <div style="font-size:0.75rem; color:#94a3b8;">Supports .md session log files</div>
                      </div>
                    </div>
                    <div id="upload-status" style="font-size:0.75rem;"></div>
                    <input type="file" id="file-input" style="display:none;" />
                  </div>
                </div>
              </div>
            </details>

          </div>
        </section>

        <!-- Sessions Tab (renamed to Brain) -->
        <section id="tab-sessions" class="tab-panel">
          <div class="tab-header">
            <h2 class="page-title">Brain</h2>
            <div class="tab-controls">
              <div class="btn-group">
                <button type="button" class="btn btn-ghost" onclick="expandAllSections('tab-sessions')">
                  <span style="font-size: 10px;">‚ñº</span> Expand All
                </button>
                <button type="button" class="btn btn-ghost" onclick="collapseAllSections('tab-sessions')">
                  <span style="font-size: 10px;">‚ñ≤</span> Collapse All
                </button>
              </div>
            </div>
          </div>

          <!-- Fast Entry from Tutor (Collapsible) -->
          <details class="section-panel" id="fast-entry-panel">
            <summary>
              <div class="summary-content">
                <div class="terminal-badge wide">
                  <img src="/static/images/icons/neo-header-fast.svg" alt="" class="section-icon-img" />
                  <span class="terminal-badge-label">FAST ENTRY</span>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content">

              <!-- Prompt Dropdown -->
              <div class="form-group" style="margin-bottom: 16px;">
                <label class="form-label">Get the Format Prompt</label>
                <div style="display: flex; gap: 8px; align-items: center;">
                  <select id="fast-entry-prompt-select" class="form-select" style="flex: 1;">
                    <option value="">Select a prompt to copy...</option>
                    <option value="session-log">Session Log Format</option>
                    <option value="quick-recap">Quick Recap Format</option>
                  </select>
                  <button type="button" class="btn btn-secondary" onclick="copyFastEntryPrompt()">Copy Prompt</button>
                </div>
              </div>

              <!-- Prompt Display -->
              <div id="fast-entry-prompt-display"
                style="display: none; margin-bottom: 16px; padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                  <span style="font-size: 12px; font-weight: 600; color: var(--text-primary);">Prompt to paste in
                    ChatGPT/Tutor:</span>
                  <button type="button" class="btn" style="padding: 4px 8px; font-size: 11px;"
                    onclick="copyFastEntryPrompt()">Copy</button>
                </div>
                <pre id="fast-entry-prompt-text"
                  style="font-size: 12px; white-space: pre-wrap; color: var(--text-secondary); margin: 0; max-height: 150px; overflow-y: auto;"></pre>
              </div>

              <!-- Paste Area -->
              <div class="form-group">
                <label for="fast-entry-paste" class="form-label">Paste Tutor Output Here</label>
                <textarea id="fast-entry-paste" class="form-textarea" rows="10" placeholder="Paste the formatted session output from your tutor here...

Example format:
---
Date: 2026-01-10
Topic: Cardiovascular Physiology
Mode: Core
Duration: 45 minutes
Understanding: 4
Retention: 3
What Worked: Active recall with diagrams
Gaps: Need to review valve mechanics
---"></textarea>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-primary" onclick="submitFastEntry()">Ingest Session</button>
                <button type="button" class="btn btn-secondary"
                  onclick="document.getElementById('fast-entry-paste').value = ''">Clear</button>
              </div>
              <div id="fast-entry-status" style="margin-top: 8px;"></div>
            </div>
          </details>

          <!-- Latest Study Sessions (Collapsible) -->
          <details class="section-panel" id="sessions-panel">
            <summary>
              <div class="summary-content">
                <div class="terminal-badge wide">
                  <img src="/static/images/icons/neo-header-sessions.svg" alt="" class="section-icon-img" />
                  <span class="terminal-badge-label">LATEST SESSIONS</span>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content" id="sessions-section">
              <div class="table-wrapper">
                <table class="sessions-table">
                  <thead>
                    <tr>
                      <th class="text-left">Date</th>
                      <th class="badge-cell">Mode</th>
                      <th class="text-left">Topic</th>
                      <th class="text-right">Duration</th>
                      <th class="text-center">Score (U/R/S)</th>
                      <th class="actions">Action</th>
                    </tr>
                  </thead>
                  <tbody id="sessions-tbody">
                    <!-- Empty state shown when no sessions -->
                    <tr class="empty-row" id="sessions-empty-row">
                      <td colspan="6">
                        <div class="empty-state empty-state-compact">
                          <span class="empty-state-icon"><i class="fas fa-inbox"></i></span>
                          <h3 class="empty-state-title">No sessions yet</h3>
                          <p class="empty-state-hint">Start a study session to track your progress here.</p>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </details>

          <!-- Quick Session Entry (Collapsible) -->
          <details class="section-panel" id="quick-session-panel">
            <summary>
              <div class="summary-content">
                <div class="terminal-badge wide">
                  <img src="/static/images/icons/neo-header-quick.svg" alt="" class="section-icon-img" />
                  <span class="terminal-badge-label">QUICK ENTRY</span>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content">
              <form id="quick-session-form" class="form-section">
                <div class="form-grid">
                  <div class="form-group">
                    <label for="topic" class="form-label">Topic *</label>
                    <input type="text" id="topic" class="form-input" required
                      placeholder="e.g., Cardiovascular Physiology">
                  </div>
                  <div class="form-group">
                    <label for="study_mode" class="form-label">Study Mode</label>
                    <select id="study_mode" class="form-select">
                      <option value="Core">Core</option>
                      <option value="Sprint">Sprint</option>
                      <option value="Drill">Drill</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="time_spent_minutes" class="form-label">Time (minutes) *</label>
                    <input type="number" id="time_spent_minutes" class="form-input" required min="1" placeholder="30">
                  </div>
                  <div class="form-group">
                    <label for="understanding_level" class="form-label">Understanding * (1-5)</label>
                    <input type="number" id="understanding_level" class="form-input" required min="1" max="5"
                      placeholder="3">
                  </div>
                  <div class="form-group">
                    <label for="retention_confidence" class="form-label">Retention (1-5)</label>
                    <input type="number" id="retention_confidence" class="form-input" min="1" max="5" placeholder="3">
                  </div>
                  <div class="form-group">
                    <label for="system_performance" class="form-label">System Performance (1-5)</label>
                    <input type="number" id="system_performance" class="form-input" min="1" max="5" placeholder="3">
                  </div>
                </div>

                <div class="form-group">
                  <label for="what_worked" class="form-label">What Worked / What You Liked</label>
                  <textarea id="what_worked" class="form-textarea" rows="3"
                    placeholder="e.g., 'The gated platter really helped me focus', 'Love how it broke down the complex topic'"></textarea>
                </div>

                <div class="form-group">
                  <label for="what_needs_fixing" class="form-label">What Needs Fixing / What It Didn't Do</label>
                  <textarea id="what_needs_fixing" class="form-textarea" rows="3"
                    placeholder="e.g., 'It didn't explain the concept clearly', 'Need more examples on this topic'"></textarea>
                </div>

                <div class="form-group">
                  <label for="notes_insights" class="form-label">Additional Notes & Insights</label>
                  <textarea id="notes_insights" class="form-textarea" rows="2"
                    placeholder="Any other observations..."></textarea>
                </div>

                <div class="form-actions">
                  <button type="submit" class="btn btn-primary">Save Session</button>
                  <button type="button" class="btn btn-secondary" onclick="resetQuickForm()">Clear Form</button>
                </div>
              </form>
              <div id="quick-session-status"></div>
            </div>
          </details>

          <!-- Session Resume (Collapsible) -->
          <details class="section-panel" id="resume-panel">
            <summary>
              <div class="summary-content">
                <div class="terminal-badge wide">
                  <img src="/static/images/icons/neo-header-resume.svg" alt="" class="section-icon-img" />
                  <span class="terminal-badge-label">SESSION RESUME</span>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content" id="resume">
              <div class="resume-actions" style="margin-bottom: 16px;">
                <button type="button" class="btn btn-primary" id="btn-resume">Generate Resume</button>
                <a class="btn btn-secondary" href="/api/resume/download" target="_blank" rel="noopener">Download</a>
              </div>
              <pre class="resume-preview" id="resume-box">Click "Generate Resume" to fetch the latest summary.</pre>
            </div>
          </details>
        </section>

        <!-- Syllabus Tab -->
        <section id="tab-syllabus" class="tab-panel">
          <div class="tab-header">
            <h2 class="page-title">Syllabus & Calendar</h2>
            <div class="tab-controls">
              <div class="btn-group">
                <button type="button" class="btn btn-ghost" onclick="expandAllSections('tab-syllabus')">
                  <span style="font-size: 10px;">‚ñº</span> Expand All
                </button>
                <button type="button" class="btn btn-ghost" onclick="collapseAllSections('tab-syllabus')">
                  <span style="font-size: 10px;">‚ñ≤</span> Collapse All
                </button>
              </div>
            </div>
          </div>

          <!-- Calendar View (Always Visible - Primary Feature) -->
          <details class="section-panel" id="calendar-panel">
            <summary>
              <div class="summary-content">
                <div class="terminal-badge wide">
                  <img src="/static/images/icons/neo-header-calendar.svg" alt="" class="section-icon-img" />
                  <span class="terminal-badge-label">STUDY CALENDAR</span>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content" id="calendar-section">
              <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                <button id="btn-view-calendar" class="btn btn-primary" type="button">Calendar</button>
                <button id="btn-view-list" class="btn" type="button">List</button>
              </div>

              <div id="syllabus-calendar-container">
                <!-- Filters -->
                <div style="margin-bottom: 16px; display: flex; gap: 12px; flex-wrap: wrap; align-items: center;">
                  <div class="form-group" style="margin: 0; min-width: 150px;">
                    <label class="form-label" style="font-size: 12px;">Course</label>
                    <select id="calendar-filter-course" class="form-select" style="font-size: 13px;">
                      <option value="">All Courses</option>
                    </select>
                  </div>
                  <div class="form-group" style="margin: 0; min-width: 120px;">
                    <label class="form-label" style="font-size: 12px;">Event Type</label>
                    <select id="calendar-filter-type" class="form-select" style="font-size: 13px;">
                      <option value="">All Types</option>
                      <option value="lecture">Lectures</option>
                      <option value="quiz">Quizzes</option>
                      <option value="exam">Exams</option>
                      <option value="assignment">Assignments</option>
                    </select>
                  </div>
                  <div class="form-group" style="margin: 0; min-width: 100px;">
                    <label class="form-label" style="font-size: 12px;">View</label>
                    <select id="calendar-view-range" class="form-select" style="font-size: 13px;">
                      <option value="month">Month View</option>
                      <option value="week">Week View</option>
                      <option value="day">Day View</option>
                    </select>
                  </div>
                  <button id="btn-refresh-calendar" class="btn" style="margin-top: 20px;">Refresh</button>
                </div>

                <!-- Calendar Navigation -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                  <button id="btn-calendar-prev" class="btn" style="padding: 6px 12px;">‚Üê Prev</button>
                  <h3 id="calendar-month-year" style="margin: 0; font-size: 18px; font-weight: 600;">Loading...</h3>
                  <button id="btn-calendar-next" class="btn" style="padding: 6px 12px;">Next ‚Üí</button>
                </div>

                <!-- Calendar Grid -->
                <div id="calendar-grid"
                  style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin-bottom: 20px;">
                  <!-- Calendar will be rendered here by JavaScript -->
                </div>

                <!-- Legend -->
                <div
                  style="display: flex; gap: 16px; flex-wrap: wrap; padding-top: 16px; border-top: 1px solid var(--border); font-size: 12px;">
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <div
                      style="width: 16px; height: 16px; border-radius: 4px; background: rgba(31, 111, 235, 0.3); border: 1px solid var(--accent);">
                    </div>
                    <span>Course Event</span>
                  </div>
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <div
                      style="width: 16px; height: 16px; border-radius: 4px; background: rgba(63, 185, 80, 0.3); border: 1px solid var(--success);">
                    </div>
                    <span>Study Session</span>
                  </div>
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <div
                      style="width: 16px; height: 16px; border-radius: 4px; background: rgba(188, 142, 249, 0.3); border: 1px solid var(--purple);">
                    </div>
                    <span>Planned Repetition</span>
                  </div>
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <div
                      style="width: 16px; height: 16px; border-radius: 4px; background: rgba(248, 81, 73, 0.3); border: 1px solid var(--error);">
                    </div>
                    <span>Exam/Quiz</span>
                  </div>
                </div>

                <!-- Quick Add Planned Session -->
                <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
                  <h4 style="font-size: 14px; font-weight: 600; margin-bottom: 12px;">Plan Spaced Repetition Session
                  </h4>
                  <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                    <div class="form-group" style="margin: 0; min-width: 140px;">
                      <label class="form-label" style="font-size: 12px;">Date</label>
                      <input type="date" id="plan-session-date" class="form-input" style="font-size: 13px;">
                    </div>
                    <div class="form-group" style="margin: 0; min-width: 100px;">
                      <label class="form-label" style="font-size: 12px;">Minutes</label>
                      <input type="number" id="plan-session-minutes" class="form-input" value="60" min="15" step="15"
                        style="font-size: 13px;">
                    </div>
                    <div class="form-group" style="margin: 0; flex: 1; min-width: 200px;">
                      <label class="form-label" style="font-size: 12px;">Course</label>
                      <select id="plan-session-course" class="form-select" style="font-size: 13px;">
                        <option value="">Optional</option>
                      </select>
                    </div>
                    <button id="btn-add-planned-session" class="btn btn-primary" style="margin-top: 20px;">Add Planned
                      Session</button>
                  </div>
                  <div id="plan-session-status" style="margin-top: 8px; font-size: 12px;"></div>
                </div>

                <!-- Google Calendar Sync Section -->
                <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border);">
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <h4 style="margin: 0; font-size: 15px;">Google Calendar Sync</h4>
                    <span id="gcal-status-badge" class="badge"
                      style="padding: 4px 10px; border-radius: 12px; font-size: 12px;">Checking...</span>
                  </div>

                  <!-- Not Connected State -->
                  <div id="gcal-auth-section" style="display: block;">
                    <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 12px;">
                      Connect your Google Calendar to import events automatically.
                    </p>
                    <button id="btn-gcal-connect" class="btn btn-primary" style="width: 100%;">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"
                        style="margin-right: 8px; vertical-align: middle;">
                        <path
                          d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                        <path
                          d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                        <path
                          d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                        <path
                          d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                      </svg>
                      Connect Google Calendar
                    </button>
                  </div>

                  <!-- Connected State -->
                  <div id="gcal-sync-section" style="display: none;">
                    <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 8px;">
                      Connected as: <strong id="gcal-user-email" style="color: var(--text-primary);">‚Äî</strong>
                    </p>
                    <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                      <button id="btn-gcal-sync" class="btn btn-primary" style="flex: 1;">
                        üìÖ Sync Calendar
                      </button>
                      <button id="btn-gtasks-sync" class="btn btn-primary" style="flex: 1;">
                        ‚úÖ Sync Tasks
                      </button>
                    </div>
                    <div style="display: flex; gap: 8px;">
                      <button id="btn-gcal-disconnect" class="btn" style="flex: 1; padding: 8px 12px;"
                        title="Disconnect">
                        Disconnect
                      </button>
                    </div>
                    <p id="gcal-sync-status" style="margin-top: 8px; font-size: 12px; color: var(--text-muted);"></p>
                  </div>
                </div>
              </div>

              <!-- Syllabus List View -->
              <div id="syllabus-list-container" style="display: none;">
                <!-- Week Selector at Top -->
                <div
                  style="margin-bottom: 20px; padding: 16px; background: var(--surface-2); border-radius: 12px; border: 1px solid var(--border);">
                  <div
                    style="display: flex; gap: 16px; flex-wrap: wrap; align-items: center; justify-content: space-between;">
                    <div style="display: flex; gap: 12px; align-items: center;">
                      <div class="form-group" style="margin: 0; min-width: 140px;">
                        <label class="form-label" style="font-size: 12px;">Start Week</label>
                        <select id="list-start-week" class="form-select" style="font-size: 13px;">
                          <!-- Will be populated by JS, Week 1 = Jan 5, 2025 -->
                        </select>
                      </div>
                      <div class="form-group" style="margin: 0; min-width: 100px;">
                        <label class="form-label" style="font-size: 12px;">Show Weeks</label>
                        <select id="list-week-count" class="form-select" style="font-size: 13px;">
                          <option value="1">1 week</option>
                          <option value="2">2 weeks</option>
                          <option value="3" selected>3 weeks</option>
                          <option value="4">4 weeks</option>
                          <option value="8">8 weeks</option>
                          <option value="all">All</option>
                        </select>
                      </div>
                    </div>
                    <div style="display: flex; gap: 8px; align-items: center;">
                      <button id="btn-list-prev-week" class="btn" style="padding: 6px 12px;">‚Üê Earlier</button>
                      <span id="list-week-range-label"
                        style="font-size: 13px; color: var(--text-secondary); min-width: 150px; text-align: center;">Week
                        1 - 3</span>
                      <button id="btn-list-next-week" class="btn" style="padding: 6px 12px;">Later ‚Üí</button>
                    </div>
                  </div>
                </div>

                <!-- Filters Row -->
                <div style="margin-bottom: 16px; display: flex; gap: 12px; flex-wrap: wrap; align-items: center;">
                  <div class="form-group" style="margin: 0; min-width: 150px;">
                    <label class="form-label" style="font-size: 12px;">Course</label>
                    <select id="syllabus-list-course" class="form-select" style="font-size: 13px;">
                      <option value="">All Courses</option>
                    </select>
                  </div>
                  <div class="form-group" style="margin: 0; min-width: 120px;">
                    <label class="form-label" style="font-size: 12px;">Event Type</label>
                    <select id="syllabus-list-type" class="form-select" style="font-size: 13px;">
                      <option value="">All Types</option>
                      <option value="lecture">Lectures</option>
                      <option value="reading">Readings</option>
                      <option value="quiz">Quizzes</option>
                      <option value="exam">Exams</option>
                      <option value="assignment">Assignments</option>
                      <option value="other">Other</option>
                    </select>
                  </div>
                  <div class="form-group" style="margin: 0; min-width: 200px; flex: 1;">
                    <label class="form-label" style="font-size: 12px;">Search title/details</label>
                    <input id="syllabus-list-search" class="form-input" type="text" placeholder="Search events..."
                      style="font-size: 13px;">
                  </div>
                  <button id="btn-refresh-syllabus-list" class="btn" style="margin-top: 20px;">Refresh</button>
                </div>

                <div class="table-wrapper">
                  <table class="sessions-table" style="min-width: 900px;">
                    <thead>
                      <tr>
                        <th class="text-center" style="width: 50px;">Done</th>
                        <th class="date-cell" style="width: 100px;">Date</th>
                        <th class="text-left" style="width: 120px;">Course</th>
                        <th class="badge-cell" style="width: 100px;">Type</th>
                        <th class="text-left">Title</th>
                        <th class="text-center" style="width: 60px;">Weight</th>
                        <th class="text-left truncate" style="max-width: 200px;">Details</th>
                        <th class="actions" style="width: 60px;">Actions</th>
                      </tr>
                    </thead>
                    <tbody id="syllabus-list-body">
                    </tbody>
                  </table>
                </div>
                <div id="syllabus-list-empty" class="empty-state empty-state-compact" style="display: none;">
                  <span class="empty-state-icon">üîç</span>
                  <h3 class="empty-state-title">No events found</h3>
                  <p class="empty-state-hint">No events match the current filters. Try adjusting your search.</p>
                </div>
              </div>
            </div>
          </details>

          <!-- Study Tasks (Readings & Topics) -->
          <details class="section-panel" id="study-tasks-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">üìö</span>
                <div class="summary-text">
                  <h3>Study Tasks</h3>
                  <p>Readings, topics, and ongoing assignments. Check off as you complete.</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content" id="study-tasks-section">
              <div style="display: flex; gap: 8px; align-items: center; margin-bottom: 16px;">
                <select id="study-tasks-filter" class="form-select" style="font-size: 13px; min-width: 120px;">
                  <option value="active">Active</option>
                  <option value="all">All</option>
                  <option value="completed">Completed</option>
                </select>
                <button id="btn-refresh-study-tasks" class="btn" type="button">Refresh</button>
              </div>

              <!-- Task Stats -->
              <div id="study-tasks-stats"
                style="display: flex; gap: 16px; flex-wrap: wrap; padding: 12px 0; border-bottom: 1px solid var(--border); margin-bottom: 16px;">
                <div style="display: flex; align-items: center; gap: 6px;">
                  <span style="font-size: 20px; font-weight: 700; color: var(--warning);"
                    id="tasks-pending-count">0</span>
                  <span style="font-size: 12px; color: var(--text-muted);">Pending</span>
                </div>
                <div style="display: flex; align-items: center; gap: 6px;">
                  <span style="font-size: 20px; font-weight: 700; color: var(--accent);"
                    id="tasks-in-progress-count">0</span>
                  <span style="font-size: 12px; color: var(--text-muted);">In Progress</span>
                </div>
                <div style="display: flex; align-items: center; gap: 6px;">
                  <span style="font-size: 20px; font-weight: 700; color: var(--success);"
                    id="tasks-completed-count">0</span>
                  <span style="font-size: 12px; color: var(--text-muted);">Completed</span>
                </div>
                <div style="display: flex; align-items: center; gap: 6px; margin-left: auto;">
                  <span style="font-size: 12px; color: var(--text-muted);">Progress:</span>
                  <div
                    style="width: 120px; height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                    <div id="tasks-progress-bar"
                      style="height: 100%; width: 0%; background: linear-gradient(90deg, var(--success), var(--accent)); transition: width 0.3s;">
                    </div>
                  </div>
                  <span id="tasks-progress-pct" style="font-size: 12px; font-weight: 600;">0%</span>
                </div>
              </div>

              <!-- Task List -->
              <div id="study-tasks-list" style="max-height: 400px; overflow-y: auto;">
                <div style="color: var(--text-muted); font-size: 13px; padding: 20px; text-align: center;">Loading study
                  tasks...</div>
              </div>
            </div>
          </details>

          <!-- Syllabus Intake -->
          <details class="section-panel" id="syllabus-intake-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">üìù</span>
                <div class="summary-text">
                  <h3>Syllabus Intake (MVP)</h3>
                  <p>Manually add course and event information</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content" id="syllabus">
              <form id="syllabus-form" class="form-section">
                <div class="form-grid">
                  <div class="form-group">
                    <label class="form-label" for="course_name">Course Name *</label>
                    <input id="course_name" class="form-input" type="text" placeholder="PT Anatomy I" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="course_code">Course Code</label>
                    <input id="course_code" class="form-input" type="text" placeholder="PTA101">
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="course_term">Term</label>
                    <input id="course_term" class="form-input" type="text" placeholder="Spring 2026">
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="course_instructor">Instructor</label>
                    <input id="course_instructor" class="form-input" type="text" placeholder="Dr. Smith">
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="course_mode">Default Study Mode</label>
                    <select id="course_mode" class="form-select">
                      <option value="Core">Core</option>
                      <option value="Sprint">Sprint</option>
                      <option value="Drill">Drill</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="course_time_budget">Minutes per week</label>
                    <input id="course_time_budget" class="form-input" type="number" min="0" placeholder="900">
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label" for="event_title">Event Title *</label>
                  <input id="event_title" class="form-input" type="text" placeholder="Exam 1 ‚Äì Pelvis &amp; Hip"
                    required>
                </div>
                <div class="form-grid">
                  <div class="form-group">
                    <label class="form-label" for="event_type">Event Type</label>
                    <select id="event_type" class="form-select">
                      <option value="lecture">Lecture</option>
                      <option value="reading">Reading</option>
                      <option value="quiz">Quiz</option>
                      <option value="exam">Exam</option>
                      <option value="assignment">Assignment</option>
                      <option value="other">Other</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="event_date">Date</label>
                    <input id="event_date" class="form-input" type="date">
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="event_due_date">Due Date</label>
                    <input id="event_due_date" class="form-input" type="date">
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="event_weight">Weight (0‚Äì1)</label>
                    <input id="event_weight" class="form-input" type="number" step="0.01" min="0" max="1"
                      placeholder="0.30">
                  </div>
                </div>
                <div class="form-group">
                  <label class="form-label" for="event_raw_text">Details (chapters, slides, notes)</label>
                  <textarea id="event_raw_text" class="form-textarea" rows="2"
                    placeholder="Covers weeks 1‚Äì3, Chapters 1‚Äì5; Slides 01‚Äì03."></textarea>
                </div>
                <div class="form-actions">
                  <button type="submit" class="btn btn-primary">Save Course + Event</button>
                </div>
              </form>
              <div id="syllabus-status"></div>
            </div>
          </details>

          <!-- ChatGPT JSON Import -->
          <details class="section-panel" id="json-import-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">ü§ñ</span>
                <div class="summary-text">
                  <h3>Syllabus via ChatGPT (JSON Import)</h3>
                  <p>Use ChatGPT to convert syllabus text to JSON format</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content" id="syllabus-chatgpt">
              <div class="form-section">
                <div class="form-group">
                  <label class="form-label" for="syllabus_prompt_template">1) Copy this prompt into ChatGPT</label>
                  <button type="button" class="btn" id="btn-syllabus-prompt-copy"
                    style="margin-top: 6px; margin-bottom: 6px;">Copy Prompt</button>
                  <textarea id="syllabus_prompt_template" class="form-textarea" rows="12" readonly>
You are helping me convert a course syllabus into a JSON format for my PT Study Brain app.

### Goal

Given the raw syllabus text I provide, output a SINGLE JSON object in this exact shape:

{
  "name": "COURSE NAME",
  "code": "COURSE CODE OR SHORT LABEL",
  "term": "TERM (e.g., Spring 2026)",
  "instructor": "INSTRUCTOR NAME (if known)",
  "default_study_mode": "Core",
  "time_budget_per_week_minutes": 900,
  "events": [
    {
      "type": "lecture | reading | quiz | exam | assignment | other",
      "title": "Short, clear title",
      "date": "YYYY-MM-DD or null",
      "due_date": "YYYY-MM-DD or null",
      "weight": 0.0,
      "raw_text": "Short description: chapters, slides, topics, etc."
    }
  ]
}

### Rules

1. Only output JSON. No commentary, no markdown, no backticks.
2. Use these rules for events:
   - Create ONE event per meaningful item in the syllabus (lecture, reading block, quiz, exam, assignment).
   - type: lecture, reading, quiz, exam, assignment, or other.
   - title: short but specific (include week or topic where helpful).
   - date: calendar date if present, otherwise null.
   - due_date: for quizzes/exams/assignments, usually same as date; otherwise null.
   - weight: 0.0 if not clearly stated; or 0.3 if the syllabus says ‚Äú30%‚Äù.
   - raw_text: the most useful details (chapters, pages, slides, topics), under ~200 characters.
3. If the syllabus spans multiple courses, process ONLY ONE course per run.
4. If term, instructor, or course code are not obvious, use null for those fields.
5. Dates must be in "YYYY-MM-DD" format if you can infer them; otherwise null.

Now say: ‚ÄúPaste your syllabus text here (one course at a time).‚Äù Then wait for me, and after I paste the syllabus, respond ONLY with the JSON object.</textarea>
                </div>
                <div class="form-group">
                  <label class="form-label" for="syllabus_json_input">2) Paste ChatGPT JSON here and import</label>
                  <textarea id="syllabus_json_input" class="form-textarea" rows="8"
                    placeholder='{"name": "PT Anatomy I", "code": "PTA101", ...}'></textarea>
                </div>
                <div class="form-actions">
                  <button type="button" class="btn btn-primary" id="btn-syllabus-json-import">Import JSON</button>
                </div>
                <div id="syllabus-json-status"></div>
              </div>
            </div>
          </details>

          <!-- Course Color Manager -->
          <details class="section-panel" id="course-colors-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">üé®</span>
                <div class="summary-text">
                  <h3>Course Colors</h3>
                  <p>Click a color swatch to pick a custom color</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content" id="course-colors-section">
              <div id="course-color-manager" style="padding: 8px 0;">
                <div style="color: var(--text-muted); font-size: 13px;">Loading courses...</div>
              </div>
            </div>
          </details>

        </section>

        <!-- Scholar Tab -->
        <section id="tab-scholar" class="tab-panel">
          <div class="tab-header">
            <h2 class="page-title">Scholar Research</h2>
            <div class="tab-controls">
              <div class="btn-group">
                <button type="button" class="btn btn-ghost" onclick="expandAllSections('tab-scholar')">
                  <span style="font-size: 10px;">‚ñº</span> Expand All
                </button>
                <button type="button" class="btn btn-ghost" onclick="collapseAllSections('tab-scholar')">
                  <span style="font-size: 10px;">‚ñ≤</span> Collapse All
                </button>
              </div>
            </div>
          </div>

          <!-- Scholar API Key Configuration -->
          <details class="section-panel" id="scholar-api-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">üîë</span>
                <div class="summary-text">
                  <h3>Scholar API Key</h3>
                  <p>Configure API access for Scholar features</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content">
              <div
                style="margin-bottom: 16px; padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                  <h4 style="font-size: 15px; font-weight: 600; color: var(--text-primary); margin: 0;">Configuration
                  </h4>
                  <button id="btn-toggle-api-key" class="btn"
                    style="padding: 6px 10px; font-size: 12px;">Configure</button>
                </div>
                <div id="api-key-status" style="font-size: 12px; color: var(--text-muted);">Loading API key status...
                </div>
                <div id="api-key-config" style="display: none; margin-top: 12px;">
                  <div class="form-grid">
                    <div class="form-group">
                      <label class="form-label" for="api-provider-select">Provider</label>
                      <select id="api-provider-select" class="form-select">
                        <option value="openrouter">OpenRouter</option>
                        <option value="openai">OpenAI</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label class="form-label" for="api-key-input">API Key</label>
                      <input id="api-key-input" class="form-input" type="password" placeholder="Paste your API key">
                    </div>
                  </div>
                  <div class="form-actions" style="margin-top: 8px;">
                    <button type="button" class="btn btn-primary" id="btn-save-api-key">Save Key</button>
                    <button type="button" class="btn" id="btn-test-api-key">Test</button>
                  </div>
                  <div id="api-key-test-result" style="margin-top: 8px; font-size: 12px; color: var(--text-muted);">
                  </div>
                </div>
              </div>
            </div>
          </details>

          <!-- Run Scholar -->
          <details class="section-panel" id="scholar-run-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">‚ñ∂Ô∏è</span>
                <div class="summary-text">
                  <h3>Run Scholar</h3>
                  <p>Execute Scholar orchestrator and view status</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content">
              <!-- Scholar Status -->
              <div style="margin-bottom: 24px;">
                <div style="display: flex; gap: 16px; margin-bottom: 16px; flex-wrap: wrap;">
                  <div
                    style="padding: 12px 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; flex: 1; min-width: 150px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 4px;">Status</div>
                    <div id="scholar-status" style="font-size: 16px; font-weight: 600; color: var(--text-primary);">-
                    </div>
                  </div>
                  <div
                    style="padding: 12px 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; flex: 1; min-width: 150px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                      <div>
                        <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 4px;">Safe Mode</div>
                        <div id="scholar-safe-mode"
                          style="font-size: 16px; font-weight: 600; color: var(--text-primary);">-</div>
                      </div>
                      <button id="btn-toggle-safe-mode" class="btn"
                        style="padding: 4px 8px; font-size: 12px;">Toggle</button>
                    </div>
                  </div>
                  <div
                    style="padding: 12px 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; flex: 1; min-width: 150px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                      <div>
                        <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 4px;">Multi-Agent</div>
                        <div id="scholar-multi-agent"
                          style="font-size: 16px; font-weight: 600; color: var(--text-primary);">-</div>
                      </div>
                      <div style="display: flex; gap: 8px; align-items: center;">
                        <label for="scholar-multi-agent-max"
                          style="font-size: 11px; color: var(--text-muted);">Max</label>
                        <select id="scholar-multi-agent-max" class="form-select"
                          style="padding: 4px 6px; font-size: 11px; min-width: 56px;">
                          <option value="1">1</option>
                          <option value="2">2</option>
                          <option value="3">3</option>
                          <option value="4">4</option>
                          <option value="5">5</option>
                          <option value="6">6</option>
                        </select>
                        <button id="btn-toggle-multi-agent" class="btn"
                          style="padding: 4px 8px; font-size: 12px;">Toggle</button>
                      </div>
                    </div>
                  </div>
                  <div
                    style="padding: 12px 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; flex: 1; min-width: 150px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 4px;">Last Updated</div>
                    <div id="scholar-last-updated"
                      style="font-size: 16px; font-weight: 600; color: var(--text-primary);">-</div>
                  </div>
                </div>
              </div>

              <!-- Run Scholar Section -->
              <div
                style="margin-bottom: 24px; padding: 16px; background: rgba(31, 111, 235, 0.1); border: 1px solid var(--accent); border-radius: 8px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                  <h4 style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin: 0;">Run Scholar</h4>
                  <button id="btn-run-scholar" class="btn btn-primary" style="margin: 0;">Start Run</button>
                </div>
                <div id="scholar-run-status" style="font-size: 13px; color: var(--text-secondary); margin-top: 8px;">
                  Click "Start Run" to execute Scholar orchestrator
                </div>
                <div id="scholar-run-progress" class="scholar-progress" style="display:none; margin-top: 10px;">
                  <div class="scholar-progress-bar" id="scholar-run-progress-bar"></div>
                </div>
                <div id="scholar-run-meta"
                  style="display:none; margin-top: 8px; font-size: 12px; color: var(--text-muted);"></div>
                <div id="scholar-run-actions" style="display:none; margin-top: 10px; gap: 8px; flex-wrap: wrap;">
                  <button id="btn-scholar-refresh" class="btn" type="button">Refresh Status</button>
                  <button id="btn-scholar-open-final" class="btn" type="button">Open Latest Final</button>
                  <button id="btn-scholar-cancel" class="btn" type="button">Cancel Run</button>
                </div>
                <div style="margin-top: 8px; font-size: 12px; color: var(--text-muted);">Tip: drag the bottom edge to
                  resize.</div>
                <div id="scholar-run-log" class="scholar-run-log" style="display: none;">
                </div>
              </div>
            </div>
          </details>

          <!-- Proposals & Questions -->
          <details class="section-panel" id="scholar-proposals-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">üìù</span>
                <div class="summary-text">
                  <h3>Proposals & Questions</h3>
                  <p>Review proposals and answer pending questions</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content">
              <!-- Proposals Section -->
              <div style="margin-bottom: 24px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                  <h4 style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin: 0;">
                    üìù Proposals Awaiting Review
                    <span id="scholar-proposals-section-count"
                      style="font-size: 12px; color: var(--text-muted); margin-left: 8px;">(0)</span>
                  </h4>
                </div>
                <div id="scholar-proposals-list"
                  style="padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; min-height: 60px;">
                  <div style="color: var(--text-muted); font-size: 13px;">Loading proposals...</div>
                </div>
              </div>

              <!-- Questions Section -->
              <div style="margin-bottom: 24px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                  <h4 style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin: 0;">
                    Questions Needing Answers
                    <span id="scholar-questions-section-count"
                      style="font-size: 12px; color: var(--text-muted); margin-left: 8px;">(0)</span>
                  </h4>
                  <button id="btn-save-answers" class="btn btn-primary" style="display: none;">Save Answers</button>
                </div>
                <div id="scholar-questions"
                  style="padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; min-height: 60px;">
                  <div style="color: var(--text-muted); font-size: 13px;">Loading questions...</div>
                </div>
              </div>

              <!-- Answered Questions Section (Collapsible) -->
              <div style="margin-bottom: 24px;">
                <div
                  style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; cursor: pointer;"
                  onclick="toggleAnsweredQuestions()">
                  <h4 style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin: 0;">
                    ‚úÖ Answered Questions
                    <span id="scholar-answered-section-count"
                      style="font-size: 12px; color: var(--text-muted); margin-left: 8px;">(0)</span>
                  </h4>
                  <span id="answered-questions-chevron" style="font-size: 12px; color: var(--text-muted);">‚ñ∂</span>
                </div>
                <div id="scholar-answered-questions"
                  style="display: none; padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; min-height: 40px;">
                  <div style="color: var(--text-muted); font-size: 13px;">No answered questions yet.</div>
                </div>
              </div>
            </div>
          </details>

          <!-- System Health & Research -->
          <details class="section-panel" id="scholar-health-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">üî¨</span>
                <div class="summary-text">
                  <h3>System Health & Research</h3>
                  <p>Module status, research topics, and system gaps</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content">
              <!-- System Health (formerly Coverage) -->
              <div style="margin-bottom: 24px;">
                <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">
                  üî¨ System Health
                  <span id="scholar-coverage-summary"
                    style="font-size: 12px; color: var(--text-muted); margin-left: 8px;"></span>
                </h4>
                <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 12px;">
                  Continuous auditing, polishing, and improvement of the study system
                </div>

                <!-- Progress Bar -->
                <div style="margin-bottom: 16px;">
                  <div
                    style="display: flex; height: 20px; border-radius: 10px; overflow: hidden; background: rgba(139, 148, 158, 0.2);">
                    <div id="scholar-coverage-bar-complete"
                      style="background: var(--success); transition: width 0.3s ease;"></div>
                    <div id="scholar-coverage-bar-progress"
                      style="background: var(--warning); transition: width 0.3s ease;"></div>
                  </div>
                </div>

                <!-- Stats Cards - Compact -->
                <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                  <div
                    style="flex: 1; padding: 10px; background: rgba(63, 185, 80, 0.15); border-radius: 8px; text-align: center;">
                    <div style="font-size: 10px; color: var(--success); text-transform: uppercase;">Documented</div>
                    <div id="scholar-coverage-complete"
                      style="font-size: 24px; font-weight: 700; color: var(--success);">0</div>
                  </div>
                  <div
                    style="flex: 1; padding: 10px; background: rgba(218, 165, 32, 0.15); border-radius: 8px; text-align: center;">
                    <div style="font-size: 10px; color: var(--warning); text-transform: uppercase;">In Progress</div>
                    <div id="scholar-coverage-progress"
                      style="font-size: 24px; font-weight: 700; color: var(--warning);">0</div>
                  </div>
                  <div
                    style="flex: 1; padding: 10px; background: rgba(139, 148, 158, 0.15); border-radius: 8px; text-align: center;">
                    <div style="font-size: 10px; color: var(--text-muted); text-transform: uppercase;">Pending</div>
                    <div id="scholar-coverage-not-started"
                      style="font-size: 24px; font-weight: 700; color: var(--text-muted);">0</div>
                  </div>
                  <div
                    style="flex: 1; padding: 10px; background: rgba(136, 46, 224, 0.15); border-radius: 8px; text-align: center;">
                    <div style="font-size: 10px; color: #a855f7; text-transform: uppercase;">Stale (30d+)</div>
                    <div id="scholar-coverage-stale" style="font-size: 24px; font-weight: 700; color: #a855f7;">-</div>
                  </div>
                </div>

                <!-- Module List -->
                <div id="scholar-coverage-list"
                  style="max-height: 250px; overflow-y: auto; padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px;">
                  <div style="color: var(--text-muted); font-size: 13px;">Loading module status...</div>
                </div>
              </div>

              <!-- Research & Gaps -->
              <div style="margin-bottom: 24px;">
                <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">
                  üìö Research & Gap Analysis
                </h4>
                <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 12px;">
                  Pedagogy research, meta-analysis findings, and system gaps to address
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                  <!-- Active Research -->
                  <div
                    style="padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px;">
                    <div style="font-size: 12px; font-weight: 600; color: var(--text-primary); margin-bottom: 8px;">üîç
                      Active Research Topics</div>
                    <div id="scholar-research-topics"
                      style="font-size: 13px; color: var(--text-secondary); min-height: 60px;">
                      Loading...
                    </div>
                  </div>

                  <!-- Identified Gaps -->
                  <div
                    style="padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px;">
                    <div style="font-size: 12px; font-weight: 600; color: var(--text-primary); margin-bottom: 8px;">‚ö†Ô∏è
                      Identified Gaps</div>
                    <div id="scholar-gaps" style="font-size: 13px; color: var(--text-secondary); min-height: 60px;">
                      Loading...
                    </div>
                  </div>
                </div>

                <!-- Improvement Candidates -->
                <div
                  style="margin-top: 12px; padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px;">
                  <div style="font-size: 12px; font-weight: 600; color: var(--text-primary); margin-bottom: 8px;">üí°
                    Improvement Candidates</div>
                  <div id="scholar-improvements"
                    style="font-size: 13px; color: var(--text-secondary); min-height: 40px;">
                    Loading...
                  </div>
                </div>
              </div>

              <!-- Next Steps -->
              <div style="margin-bottom: 24px;">
                <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 12px; color: var(--text-primary);">üìã What
                  To Do Next</h4>
                <div id="scholar-next-steps"
                  style="padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; min-height: 60px;">
                  <div style="color: var(--text-muted); font-size: 13px;">Loading next steps...</div>
                </div>
              </div>

              <!-- Latest Run Summary -->
              <div style="margin-bottom: 24px;">
                <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 12px; color: var(--text-primary);">üìÑ
                  Latest Run Summary</h4>
                <div id="scholar-latest-run"
                  style="padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; font-family: monospace; font-size: 13px; white-space: pre-wrap; max-height: 200px; overflow-y: auto;">
                  <div style="color: var(--text-muted);">Loading latest run...</div>
                </div>
              </div>
            </div>
          </details>

          <!-- AI Strategic Digest -->
          <details class="section-panel" id="scholar-digest-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">üß†</span>
                <div class="summary-text">
                  <h3>AI Strategic Digest</h3>
                  <p>AI-powered analysis and strategic recommendations</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content">
              <!-- AI Weekly Digest Section -->
              <div
                style="margin-bottom: 24px; padding: 16px; background: linear-gradient(135deg, rgba(136, 46, 224, 0.1), rgba(63, 185, 80, 0.1)); border: 1px solid #a855f7; border-radius: 8px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                  <div>
                    <h4 style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin: 0;">
                      üß† AI Strategic Digest
                      <span
                        style="font-size: 10px; padding: 2px 6px; background: #a855f7; color: white; border-radius: 4px; margin-left: 8px;">AI-Powered</span>
                    </h4>
                  </div>
                  <button id="btn-generate-digest" class="btn btn-primary"
                    style="margin: 0; background: #a855f7;">Generate Analysis</button>
                  <button class="btn" style="margin: 0;" onclick="saveStrategicDigest()">Save Digest</button>
                </div>
                <div id="scholar-digest-status"
                  style="font-size: 13px; color: var(--text-secondary); margin-bottom: 8px;">
                  AI analyzes proposals, gaps, improvements, and research to recommend strategic next steps
                </div>
                <div id="scholar-digest-content"
                  style="display: none; padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; max-height: 500px; overflow-y: auto;">
                  <div id="scholar-digest-text" style="font-size: 13px; line-height: 1.7;"></div>
                </div>
              </div>
            </div>
          </details>

          <!-- Saved Digests -->
          <details class="section-panel" id="scholar-saved-digests-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">üìÅ</span>
                <div class="summary-text">
                  <h3>Saved Digests</h3>
                  <p>View previously saved strategic digests</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content">
              <div style="margin-bottom: 24px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                  <h4 style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin: 0;">
                    üìÅ Saved Digests
                    <span id="saved-digests-count"
                      style="font-size: 12px; color: var(--text-muted); margin-left: 8px;">(0)</span>
                  </h4>
                  <button class="btn btn-secondary" onclick="loadSavedDigests()"
                    style="font-size: 12px;">Refresh</button>
                </div>
                <div id="saved-digests-list"
                  style="padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; min-height: 60px; max-height: 400px; overflow-y: auto;">
                  <div style="color: var(--text-muted); font-size: 13px;">Loading saved digests...</div>
                </div>
              </div>

              <!-- Digest Viewer Modal -->
              <div id="digest-viewer-modal"
                style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center;">
                <div
                  style="background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 12px; width: 90%; max-width: 800px; max-height: 90vh; display: flex; flex-direction: column;">
                  <div
                    style="display: flex; justify-content: space-between; align-items: center; padding: 16px 20px; border-bottom: 1px solid var(--border);">
                    <h3 id="digest-viewer-title" style="margin: 0; font-size: 16px; color: var(--text-primary);">Digest
                      Title</h3>
                    <button onclick="closeDigestViewer()"
                      style="background: none; border: none; font-size: 20px; cursor: pointer; color: var(--text-muted);">&times;</button>
                  </div>
                  <div id="digest-viewer-content"
                    style="padding: 20px; overflow-y: auto; flex: 1; font-size: 13px; line-height: 1.7; white-space: pre-wrap; font-family: monospace;">
                  </div>
                  <div
                    style="padding: 12px 20px; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; gap: 8px;">
                    <button class="btn btn-secondary" onclick="closeDigestViewer()">Close</button>
                  </div>
                </div>
              </div>
            </div>
          </details>
        </section>

        <!-- Tutor Tab -->
        <section id="tab-tutor" class="tab-panel">
          <div class="tab-header">
            <h2 class="page-title">Tutor</h2>
            <div class="tab-controls">
              <div class="btn-group">
                <button type="button" class="btn btn-ghost" onclick="expandAllSections('tab-tutor')">
                  <span style="font-size: 10px;">‚ñº</span> Expand All
                </button>
                <button type="button" class="btn btn-ghost" onclick="collapseAllSections('tab-tutor')">
                  <span style="font-size: 10px;">‚ñ≤</span> Collapse All
                </button>
              </div>
            </div>
          </div>

          <!-- Ask Tutor Chat -->
          <details class="section-panel" id="tutor-chat-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">üí¨</span>
                <div class="summary-text">
                  <h3>Ask Tutor</h3>
                  <p>Chat with your AI tutor</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content" id="tutor-chat">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                <div style="display: flex; gap: 12px; align-items: center;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <label for="tutor-mode-select"
                      style="font-size: 13px; font-weight: 600; color: var(--text-primary);">Mode:</label>
                    <select id="tutor-mode-select" class="form-select" style="min-width: 120px; font-size: 13px;">
                      <option value="Core" selected>Core</option>
                      <option value="Sprint">Sprint</option>
                      <option value="Drill">Drill</option>
                    </select>
                  </div>
                  <button type="button" class="btn btn-secondary" id="btn-tutor-new-session" style="font-size: 13px;">
                    üîÑ New Session
                  </button>
                </div>
              </div>

              <!-- Chat Messages Container -->
              <div id="tutor-chat-messages" style="
          height: 400px;
          overflow-y: auto;
          padding: 16px;
          background: var(--surface-0);
          border: 1px solid var(--border);
          border-radius: 12px;
          margin-bottom: 16px;
          display: flex;
          flex-direction: column;
          gap: 12px;
        ">
                <div class="chat-message tutor" style="align-self: flex-start; max-width: 85%;">
                  <div class="chat-sender"
                    style="font-size: 11px; font-weight: 600; color: var(--primary); margin-bottom: 4px;">Tutor</div>
                  <div class="chat-bubble" style="
              background: var(--surface-2);
              color: var(--text-primary);
              padding: 12px 16px;
              border-radius: 16px 16px 16px 4px;
              font-size: 14px;
              line-height: 1.5;
            ">Ready to help! Sync your Study folder and ask me anything.</div>
                </div>
              </div>

              <!-- Chat Input -->
              <div class="form-section" style="margin: 0;">
                <div style="display: flex; gap: 12px; align-items: flex-end;">
                  <div style="flex: 1;">
                    <textarea id="tutor-question" class="form-textarea" rows="2"
                      placeholder="Type your question... (Enter to send, Shift+Enter for new line)"
                      style="resize: none;"></textarea>
                  </div>
                  <button type="button" class="btn btn-primary" id="btn-tutor-send"
                    style="height: 50px; padding: 0 24px;">
                    Send
                  </button>
                </div>
              </div>
            </div>
          </details>

          <!-- RAG Sources -->
          <details class="section-panel" id="tutor-rag-panel">
            <summary>
              <div class="summary-content">
                <span class="summary-icon">üìö</span>
                <div class="summary-text">
                  <h3>RAG Sources</h3>
                  <p>Manage Study RAG and Runtime RAG knowledge</p>
                </div>
              </div>
              <span class="summary-chevron">‚ñº</span>
            </summary>
            <div class="section-panel-content" id="tutor-knowledge">
              <p class="card-subtitle" style="font-size: 13px; color: var(--text-secondary); margin-top: 8px;">
                Study RAG and Runtime RAG are separate. Add Study materials by dropping files into a folder, then Sync.
                Uploads are only used for YouTube/URL links.
              </p>
            </div>

            <!-- Study RAG -->
            <div class="form-section">
              <h4 style="font-size: 14px; font-weight: 700; margin-bottom: 10px;">Study RAG (your materials)</h4>

              <!-- Folder Path Configuration -->
              <div
                style="margin-bottom: 16px; padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px;">
                <label
                  style="font-size: 12px; font-weight: 600; color: var(--text-primary); display: block; margin-bottom: 8px;">Study
                  Materials Folder</label>
                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                  <input type="text" id="study-rag-path-input" class="form-input"
                    placeholder="C:\Users\YourName\Documents\StudyMaterials"
                    style="flex: 1; font-family: monospace; font-size: 12px;" />
                  <label for="study-rag-folder-picker" class="btn btn-secondary"
                    style="cursor: pointer; margin: 0; display: flex; align-items: center; gap: 4px;">
                    üìÅ Browse
                  </label>
                  <input type="file" id="study-rag-folder-picker" webkitdirectory directory multiple
                    style="display: none;" />
                </div>
                <div style="display: flex; gap: 8px; align-items: center;">
                  <button type="button" class="btn btn-primary" id="btn-save-study-path" style="font-size: 12px;">Save
                    Path</button>
                  <span id="study-rag-path-status" style="font-size: 12px; color: var(--text-muted);"></span>
                </div>
                <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px;">
                  Enter the full path to your study materials folder, or click Browse to select it. This is where your
                  PDFs, notes, and study files live.
                </div>
              </div>

              <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 10px;">
                Current folder: <span id="study-rag-path-display"
                  style="font-family: monospace; color: var(--text-primary);">Loading...</span>
              </div>
              <div class="form-actions" style="margin-bottom: 10px;">
                <button type="button" class="btn btn-primary" id="btn-tutor-study-sync">Sync Study Folder</button>
                <button type="button" class="btn btn-secondary" id="btn-tutor-study-refresh">Refresh Folders</button>
              </div>
              <div id="tutor-study-status"></div>
              <div id="tutor-study-folders"
                style="max-height: 220px; overflow-y: auto; padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px;">
                <div style="color: var(--text-muted); font-size: 13px;">Loading Study folders...</div>
              </div>
            </div>

            <!-- Runtime RAG -->
            <div class="form-section" style="padding-top: 0;">
              <h4 style="font-size: 14px; font-weight: 700; margin-bottom: 10px;">Runtime RAG (systems/engines)</h4>
              <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 10px;">
                These are compact descriptions of systems/engines that shape Tutor behavior. Toggle them on/off.
              </div>
              <div class="form-actions" style="margin-bottom: 10px;">
                <button type="button" class="btn btn-secondary" id="btn-tutor-runtime-refresh">Refresh Runtime
                  Items</button>
              </div>
              <div id="tutor-runtime-items"
                style="max-height: 220px; overflow-y: auto; padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px;">
                <div style="color: var(--text-muted); font-size: 13px;">Loading Runtime items...</div>
              </div>
            </div>

            <!-- YouTube / URL links (only upload-style input) -->
            <div class="form-section" style="padding-top: 0;">
              <h4 style="font-size: 14px; font-weight: 700; margin-bottom: 10px;">YouTube / URL Links</h4>
              <div class="form-grid">
                <div class="form-group">
                  <label for="tutor-link-url" class="form-label">Add a YouTube / URL</label>
                  <input type="text" id="tutor-link-url" class="form-input"
                    placeholder="https://www.youtube.com/watch?v=..." />
                  <div style="font-size: 12px; color: var(--text-muted); margin-top: 6px;">Stored as a Study RAG record
                    (content may be empty until transcript/notes are added).</div>
                </div>
                <div class="form-group">
                  <label for="tutor-link-doc-type" class="form-label">Link Type</label>
                  <select id="tutor-link-doc-type" class="form-select">
                    <option value="youtube">youtube</option>
                    <option value="other">other</option>
                  </select>
                </div>
              </div>
              <div class="form-actions">
                <button type="button" class="btn btn-secondary" id="btn-tutor-add-link">Add Link</button>
              </div>
              <div id="tutor-upload-status"></div>
            </div>
    </div>
    </details>

    <!-- Hidden legacy answer box for compatibility -->
    <div id="tutor-answer-box" style="display: none;"></div>
    <div id="tutor-citations" style="display: none;"></div>
    </section>

    <!-- Database Tab -->
    <section id="tab-brain" class="tab-panel">
      <div class="tab-header">
        <h2 class="page-title">Brain Database</h2>
        <div class="tab-controls">
          <div class="btn-group">
            <button type="button" class="btn btn-ghost" onclick="expandAllSections('tab-brain')">
              <span style="font-size: 10px;">‚ñº</span> Expand All
            </button>
            <button type="button" class="btn btn-ghost" onclick="collapseAllSections('tab-brain')">
              <span style="font-size: 10px;">‚ñ≤</span> Collapse All
            </button>
          </div>
        </div>
      </div>

      <!-- Database Statistics -->
      <details class="section-panel" id="brain-stats-panel">
        <summary>
          <div class="summary-content">
            <span class="summary-icon">üìä</span>
            <div class="summary-text">
              <h3>Database Statistics</h3>
              <p>Overview of stored sessions, events, and documents</p>
            </div>
          </div>
          <span class="summary-chevron">‚ñº</span>
        </summary>
        <div class="section-panel-content" id="brain-stats-section">
          <div id="brain-stats-grid" class="stats-grid">
            <div class="stat-card">
              <div class="label">Sessions</div>
              <div class="value" id="brain-session-count" style="color: var(--accent);">--</div>
            </div>
            <div class="stat-card">
              <div class="label">Syllabus Events</div>
              <div class="value" id="brain-event-count" style="color: var(--success);">--</div>
            </div>
            <div class="stat-card">
              <div class="label">RAG Documents</div>
              <div class="value" id="brain-rag-count" style="color: var(--purple);">--</div>
            </div>
            <div class="stat-card">
              <div class="label">Pending Cards</div>
              <div class="value" id="brain-pending-cards" style="color: var(--warning);">--</div>
            </div>
            <div class="stat-card">
              <div class="label">DB Size (MB)</div>
              <div class="value" id="brain-db-size">--</div>
            </div>
          </div>
          <button class="btn" onclick="loadBrainStatus()" style="margin-top: 12px;">Refresh</button>
        </div>
      </details>

      <!-- Topic Mastery Overview -->
      <details class="section-panel" id="brain-mastery-panel">
        <summary>
          <div class="summary-content">
            <span class="summary-icon">üéØ</span>
            <div class="summary-text">
              <h3>Topic Mastery Overview</h3>
              <p>Track understanding and retention by topic</p>
            </div>
          </div>
          <span class="summary-chevron">‚ñº</span>
        </summary>
        <div class="section-panel-content" id="brain-mastery-section">
          <div id="brain-mastery-list"
            style="padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; min-height: 60px;">
            Loading...</div>
        </div>
      </details>

      <!-- Ingestion Status Section -->
      <details class="section-panel" id="brain-sync-panel">
        <summary>
          <div class="summary-content">
            <span class="summary-icon">üîÑ</span>
            <div class="summary-text">
              <h3>Ingestion Status</h3>
              <p>Session sync and file tracking status</p>
            </div>
          </div>
          <span class="summary-chevron">‚ñº</span>
        </summary>
        <div class="section-panel-content" id="brain-sync-section">
          <div style="padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px;">
            <div id="sync-status">
              <p style="margin: 0 0 8px 0;"><strong>Files Tracked:</strong> <span id="sync-files-count"
                  style="color: var(--accent);">-</span></p>
              <p style="margin: 0 0 8px 0;"><strong>Valid Sessions:</strong> <span id="sync-sessions-count"
                  style="color: var(--success);">-</span></p>
              <p style="margin: 0;"><strong>Last Sync:</strong> <span id="sync-last-time"
                  style="color: var(--text-muted);">-</span></p>
            </div>
            <div style="display: flex; gap: 8px; margin-top: 16px;">
              <button class="btn btn-primary" onclick="runSync(false)">Sync Now</button>
              <button class="btn btn-secondary" onclick="runSync(true)">Force Re-sync All</button>
            </div>
            <div id="sync-message" style="margin-top: 12px; font-size: 13px;"></div>
          </div>
        </div>
      </details>

      <!-- Anki Cards Section -->
      <details class="section-panel" id="anki-cards-panel">
        <summary>
          <div class="summary-content">
            <span class="summary-icon">üÉè</span>
            <div class="summary-text">
              <h3>Anki Cards</h3>
              <p>Manage flashcard drafts and sync to Anki</p>
            </div>
          </div>
          <span class="summary-chevron">‚ñº</span>
        </summary>
        <div class="section-panel-content" id="anki-cards-section">

          <!-- Connection Status & Actions -->
          <div
            style="padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 16px;">
            <div
              style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px;">
              <div style="display: flex; align-items: center; gap: 12px;">
                <span style="font-weight: 600;">Anki Status:</span>
                <span id="anki-status"
                  style="display: inline-flex; align-items: center; gap: 6px; padding: 4px 12px; border-radius: 20px; font-size: 13px; background: rgba(255,255,255,0.05); border: 1px solid var(--border);">
                  <span style="width: 8px; height: 8px; border-radius: 50%; background: var(--text-muted);"></span>
                  Checking...
                </span>
              </div>
              <div style="display: flex; gap: 8px;">
                <button id="anki-sync-btn" class="btn btn-primary" onclick="syncAnkiCards()"
                  style="display: flex; align-items: center; gap: 6px;">
                  <span>üîÑ</span> Sync to Anki
                </button>
                <button class="btn" onclick="refreshAnkiDrafts()">Refresh</button>
              </div>
            </div>
          </div>

          <!-- Card Drafts Table -->
          <div
            style="padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 16px;">
            <h4 style="margin: 0 0 16px 0; font-size: 14px; font-weight: 600;">Card Drafts</h4>
            <div class="table-wrapper">
              <table class="sessions-table" id="anki-drafts-table" style="min-width: 700px;">
                <thead>
                  <tr>
                    <th class="text-left" style="width: 25%;">Front</th>
                    <th class="text-left" style="width: 25%;">Back</th>
                    <th class="badge-cell" style="width: 80px;">Status</th>
                    <th class="text-left" style="width: 120px;">Course</th>
                    <th class="actions" style="width: 120px;">Actions</th>
                  </tr>
                </thead>
                <tbody id="anki-drafts-body">
                  <tr class="empty-row">
                    <td colspan="5">
                      <div class="empty-state empty-state-compact">
                        <span class="empty-state-icon">üìù</span>
                        <h3 class="empty-state-title">No card drafts yet</h3>
                        <p class="empty-state-hint">Create your first flashcard using the form below.</p>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Create New Card Form -->
          <div style="padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px;">
            <h4 style="margin: 0 0 16px 0; font-size: 14px; font-weight: 600;">Create New Card Draft</h4>
            <form id="anki-create-form" onsubmit="createAnkiCard(event)">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                <div class="form-group" style="margin: 0;">
                  <label class="form-label" for="anki-card-front">Front *</label>
                  <textarea id="anki-card-front" class="form-textarea" rows="3" placeholder="Question or prompt..."
                    required style="resize: vertical;"></textarea>
                </div>
                <div class="form-group" style="margin: 0;">
                  <label class="form-label" for="anki-card-back">Back *</label>
                  <textarea id="anki-card-back" class="form-textarea" rows="3" placeholder="Answer or explanation..."
                    required style="resize: vertical;"></textarea>
                </div>
              </div>
              <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                <div class="form-group" style="margin: 0;">
                  <label class="form-label" for="anki-card-type">Card Type</label>
                  <select id="anki-card-type" class="form-select">
                    <option value="Basic">Basic</option>
                    <option value="Basic (and reversed)">Basic (and reversed)</option>
                    <option value="Cloze">Cloze</option>
                  </select>
                </div>
                <div class="form-group" style="margin: 0;">
                  <label class="form-label" for="anki-card-deck">Deck Name</label>
                  <input type="text" id="anki-card-deck" class="form-input" placeholder="PT Study::Default">
                </div>
                <div class="form-group" style="margin: 0;">
                  <label class="form-label" for="anki-card-course">Course (optional)</label>
                  <select id="anki-card-course" class="form-select">
                    <option value="">-- No Course --</option>
                  </select>
                </div>
              </div>
              <div class="form-actions" style="display: flex; gap: 8px;">
                <button type="submit" class="btn btn-primary">Add Card Draft</button>
                <button type="reset" class="btn btn-secondary">Clear</button>
              </div>
              <div id="anki-create-status" style="margin-top: 8px; font-size: 13px;"></div>
            </form>
          </div>

        </div>
      </details>
    </section>
    <!-- Sync Inbox Tab -->
    <section id="tab-sync" class="tab-panel">
      <div class="tab-header">
        <h2 class="page-title">Sync Inbox</h2>
        <button class="btn btn-secondary" onclick="loadSyncPending()">Refresh</button>
      </div>

      <div class="section-panel" style="padding: 20px;">
        <p style="color: var(--text-secondary); margin-bottom: 20px;">
          Review and approve incoming data from the Blackboard scraper or syllabus imports.
        </p>

        <div id="sync-list-container" class="table-wrapper">
          <table class="sessions-table">
            <thead>
              <tr>
                <th>Type</th>
                <th>Course</th>
                <th>Title</th>
                <th>Details</th>
                <th>Date / Due</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="sync-tbody">
              <!-- JS Populated -->
            </tbody>
          </table>
        </div>
      </div>
    </section>

    </main>

    <!-- Proposal Viewer Modal -->
    <div id="proposal-modal-overlay"
      style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
      <div id="proposal-modal"
        style="background: var(--card-bg); border: 1px solid var(--border); border-radius: 12px; max-width: 800px; width: 90%; max-height: 85vh; display: flex; flex-direction: column; box-shadow: 0 20px 60px rgba(0,0,0,0.4);">
        <!-- Modal Header -->
        <div
          style="padding: 16px 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
          <div>
            <h3 id="proposal-modal-title" style="margin: 0; font-size: 18px; color: var(--text-primary);">Proposal</h3>
            <div id="proposal-modal-meta" style="font-size: 12px; color: var(--text-muted); margin-top: 4px;"></div>
          </div>
          <button onclick="closeProposalModal()"
            style="background: none; border: none; font-size: 24px; color: var(--text-muted); cursor: pointer; padding: 0 8px;">&times;</button>
        </div>
        <!-- Modal Content -->
        <div id="proposal-modal-content"
          style="flex: 1; overflow-y: auto; padding: 20px; font-family: monospace; font-size: 13px; white-space: pre-wrap; line-height: 1.6; color: var(--text-secondary); background: var(--bg);">
          Loading...
        </div>
        <!-- Modal Actions -->
        <div
          style="padding: 16px 20px; border-top: 1px solid var(--border); display: flex; gap: 12px; justify-content: flex-end;">
          <button id="proposal-reject-btn" class="btn" style="background: var(--danger); color: white;"
            onclick="handleProposalAction('reject')">‚ùå Reject</button>
          <button id="proposal-approve-btn" class="btn btn-primary" style="background: var(--success);"
            onclick="handleProposalAction('approve')">‚úì Approve</button>
          <button class="btn btn-secondary" onclick="closeProposalModal()">Close</button>
        </div>
      </div>
    </div>

    <!-- Event Edit Modal -->
    <div id="event-edit-modal" class="modal-overlay" style="display: none;">
      <div class="modal-content"
        style="background: var(--card-bg); border: 1px solid var(--border); border-radius: 12px; padding: 24px; max-width: 500px; width: 90%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
        <div class="tab-header">
          <h3 style="margin: 0; font-size: 18px;">Edit Event</h3>
          <button type="button" onclick="closeEventEditModal()"
            style="background: none; border: none; font-size: 24px; cursor: pointer; color: var(--text-muted);">&times;</button>
        </div>
        <form id="event-edit-form">
          <input type="hidden" id="edit-event-id">
          <div class="form-group" style="margin-bottom: 16px;">
            <label class="form-label" for="edit-event-title">Title</label>
            <input type="text" id="edit-event-title" class="form-input" required>
          </div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
            <div class="form-group" style="margin: 0;">
              <label class="form-label" for="edit-event-type">Type</label>
              <select id="edit-event-type" class="form-select">
                <option value="lecture">Lecture</option>
                <option value="reading">Reading</option>
                <option value="quiz">Quiz</option>
                <option value="exam">Exam</option>
                <option value="assignment">Assignment</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div class="form-group" style="margin: 0;">
              <label class="form-label" for="edit-event-status">Status</label>
              <select id="edit-event-status" class="form-select">
                <option value="pending">Pending</option>
                <option value="completed">Completed</option>
                <option value="cancelled">Cancelled</option>
              </select>
            </div>
          </div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
            <div class="form-group" style="margin: 0;">
              <label class="form-label" for="edit-event-date">Date</label>
              <input type="date" id="edit-event-date" class="form-input">
            </div>
            <div class="form-group" style="margin: 0;">
              <label class="form-label" for="edit-event-due-date">Due Date</label>
              <input type="date" id="edit-event-due-date" class="form-input">
            </div>
          </div>
          <div class="form-group" style="margin-bottom: 16px;">
            <label class="form-label" for="edit-event-weight">Weight (0-1)</label>
            <input type="number" id="edit-event-weight" class="form-input" step="0.01" min="0" max="1">
          </div>
          <div class="form-group" style="margin-bottom: 20px;">
            <label class="form-label" for="edit-event-details">Details</label>
            <textarea id="edit-event-details" class="form-textarea" rows="3"></textarea>
          </div>
          <div style="display: flex; gap: 12px; justify-content: flex-end; align-items: center;">
            <button type="button" class="btn" style="color: var(--error); margin-right: auto;"
              onclick="deleteEvent()">Delete</button>
            <button type="button" class="btn" onclick="closeEventEditModal()">Cancel</button>
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </div>
        </form>
        <div id="event-edit-status" style="margin-top: 12px; font-size: 13px;"></div>
      </div>
    </div>

    <style>
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        z-index: 1000;
        backdrop-filter: blur(4px);
      }

      .session-detail-row {
        background: rgba(255, 255, 255, 0.03);
      }

      .session-detail-row td {
        padding: 16px 12px;
      }

      .session-detail-row.hidden {
        display: none;
      }
    </style>

    <!-- Edit Session Modal -->
    <div id="edit-session-modal" class="modal-overlay" style="display: none;">
      <div class="modal">
        <div class="modal-header">
          <h3 class="modal-title">Edit Session</h3>
          <button type="button" class="modal-close" onclick="closeEditModal()">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <form id="edit-session-form" onsubmit="saveSession(event)">
          <div class="modal-body">
            <input type="hidden" id="edit-session-id" />

            <!-- Row 1: Date, Start Time, End Time -->
            <div class="modal-form-grid">
              <div class="form-group">
                <label for="edit-date" class="form-label">Date</label>
                <input type="date" id="edit-date" class="form-input" required />
              </div>
              <div class="form-group">
                <label for="edit-start-time" class="form-label">Start Time</label>
                <input type="time" id="edit-start-time" class="form-input" />
              </div>
              <div class="form-group">
                <label for="edit-end-time" class="form-label">End Time</label>
                <input type="time" id="edit-end-time" class="form-input" />
              </div>
            </div>

            <!-- Row 2: Course, Topic, Study Mode -->
            <div class="modal-form-grid">
              <div class="form-group">
                <label for="edit-course" class="form-label">Course</label>
                <input type="text" id="edit-course" class="form-input" placeholder="e.g., Anatomy I" />
              </div>
              <div class="form-group">
                <label for="edit-topic" class="form-label">Topic</label>
                <input type="text" id="edit-topic" class="form-input" placeholder="e.g., Gluteal Region" required />
              </div>
              <div class="form-group">
                <label for="edit-study-mode" class="form-label">Study Mode</label>
                <select id="edit-study-mode" class="form-select">
                  <option value="Core">Core</option>
                  <option value="Sprint">Sprint</option>
                  <option value="Drill">Drill</option>
                </select>
              </div>
            </div>

            <!-- Row 3: Duration & Scores -->
            <div class="modal-form-grid">
              <div class="form-group">
                <label for="edit-duration" class="form-label">Duration (minutes)</label>
                <input type="number" id="edit-duration" class="form-input" min="1" placeholder="60" />
              </div>
              <div class="form-group">
                <label for="edit-understanding" class="form-label">Understanding (1-5)</label>
                <input type="number" id="edit-understanding" class="form-input" min="1" max="5" />
              </div>
              <div class="form-group">
                <label for="edit-retention" class="form-label">Retention (1-5)</label>
                <input type="number" id="edit-retention" class="form-input" min="1" max="5" />
              </div>
            </div>

            <!-- Row 4: System Performance & Emotional Check-in -->
            <div class="modal-form-grid-2">
              <div class="form-group">
                <label for="edit-system-performance" class="form-label">System Performance (1-5)</label>
                <input type="number" id="edit-system-performance" class="form-input" min="1" max="5" />
              </div>
              <div class="form-group">
                <label for="edit-emotional" class="form-label">Emotional Check-in</label>
                <input type="text" id="edit-emotional" class="form-input" placeholder="e.g., focused, tired" />
              </div>
            </div>

            <!-- Goal -->
            <div class="form-group">
              <label for="edit-goal" class="form-label">Goal</label>
              <textarea id="edit-goal" class="form-textarea" rows="2" placeholder="Session goal..."></textarea>
            </div>

            <!-- Session Summary -->
            <div class="form-group">
              <label for="edit-summary" class="form-label">Session Summary</label>
              <textarea id="edit-summary" class="form-textarea" rows="3" placeholder="What was covered..."></textarea>
            </div>

            <!-- Wins -->
            <div class="form-group">
              <label for="edit-wins" class="form-label">Wins (What Worked)</label>
              <textarea id="edit-wins" class="form-textarea" rows="2" placeholder="What went well..."></textarea>
            </div>

            <!-- Friction Points -->
            <div class="form-group">
              <label for="edit-friction" class="form-label">Friction Points (What Needs Fixing)</label>
              <textarea id="edit-friction" class="form-textarea" rows="2"
                placeholder="Challenges encountered..."></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeEditModal()">Cancel</button>
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Sync Inbox Tab -->
    <section id="tab-sync" class="tab-panel">
      <div class="tab-header">
        <h2 class="page-title">Sync Inbox</h2>
        <div style="display: flex; gap: 10px;">
          <button class="btn btn-primary" onclick="runBlackboardScraper()" id="btn-run-scraper">Run Scraper</button>
          <button class="btn btn-secondary" onclick="loadSyncPending()">Refresh</button>
        </div>
      </div>

      <div class="section-panel" style="padding: 20px;">
        <p style="color: var(--text-secondary); margin-bottom: 20px;">
          Review and approve incoming data from the Blackboard scraper or syllabus imports.
        </p>

        <div id="sync-list-container" class="table-wrapper">
          <table class="sessions-table">
            <thead>
              <tr>
                <th>Type</th>
                <th>Course</th>
                <th>Title</th>
                <th>Details</th>
                <th>Date / Due</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="sync-tbody">
              <!-- JS Populated -->
            </tbody>
          </table>
        </div>
      </div>
    </section>

    </main><!-- End main-content -->
  </div><!-- End main-wrapper -->
  </div><!-- End app-shell -->

  <!-- Sidebar Toggle Script -->
  <script>
    // Sidebar toggle functions
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('mobile-overlay');
      sidebar.classList.toggle('mobile-open');
      overlay.classList.toggle('active');
    }

    function toggleSidebarCollapse() {
      const sidebar = document.getElementById('sidebar');
      const icon = document.getElementById('collapse-icon');
      sidebar.classList.toggle('collapsed');
      icon.textContent = sidebar.classList.contains('collapsed') ? '‚ñ∂' : '‚óÄ';
    }

    // Update page title when switching tabs
    const originalOpenTab = window.openTab;
    window.openTab = function (evt, tabName) {
      if (originalOpenTab) originalOpenTab(evt, tabName);

      // Update header title
      const titles = {
        'overview': 'Overview',
        'sessions': 'Brain',
        'syllabus': 'Syllabus & Calendar',
        'scholar': 'Scholar Research',
        'tutor': 'Tutor',
        'brain': 'Database'
      };
      const titleEl = document.getElementById('current-page-title');
      if (titleEl && titles[tabName]) {
        titleEl.textContent = titles[tabName];
      }

      // Update active nav item (top nav, mobile, legacy)
      document.querySelectorAll('.nav-item, .top-nav-item, .mobile-nav-item').forEach(item => {
        item.classList.remove('active');
        if (item.dataset.tab === tabName) {
          item.classList.add('active');
        }
      });

      // Close mobile sidebar after selection
      if (window.innerWidth <= 768) {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('mobile-overlay');
        sidebar.classList.remove('mobile-open');
        overlay.classList.remove('active');
      }
    };
  </script>

  <!-- Retro Terminal Footer -->
  <footer class="retro-footer">
    <div class="retro-terminal" style="opacity: 0.5; font-size: 12px; letter-spacing: 0.05em;">
      SYSTEM STATUS: ONLINE | ENCRYPTION: ACTIVE | TREY'S STUDY OS v3.0
    </div>
  </footer>

</body>

</html>
