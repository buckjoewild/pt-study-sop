{
  "project": "pt-study-sop",
  "branchName": "ralph/calendar-llm-google-calendar-fix",
  "description": "Connect Calendar AI assistant to Google Calendar using repo OAuth tokens, enable full CRUD, and render events in the calendar UI.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Load Google OAuth tokens and report connection status",
      "description": "As a developer, I need the backend to load OAuth credentials and tokens so Google Calendar API calls and status checks succeed.",
      "acceptanceCriteria": [
        "Read OAuth client credentials from `GoogleCalendarTasksAPI.json` at repo root.",
        "Read user tokens from `.google-tokens.json` at repo root and initialize the Google API client.",
        "GET `/api/google/status` returns `connected: true` when tokens are valid.",
        "When tokens are missing or expired, `/api/google/status` returns `connected: false` with a clear error message and next step.",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "List calendars and events across all calendars",
      "description": "As a user, I want calendar list and event search to pull from all accessible Google calendars.",
      "acceptanceCriteria": [
        "GET `/api/google-calendar/calendars` returns all accessible calendars (id + summary).",
        "GET `/api/google-calendar/events?timeMin=<iso>&timeMax=<iso>` returns events across all calendars.",
        "Each event includes `calendarId` and `calendarName` (or summary) so the UI can label the source.",
        "Requests return a clear auth error when not connected.",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Create, update, and delete Google Calendar events",
      "description": "As a user, I want to create, edit, and delete events through the backend using full calendar permissions.",
      "acceptanceCriteria": [
        "POST `/api/google-calendar/events` creates an event and returns `eventId` + `calendarId`.",
        "Create/update/delete accept `calendarId` to target any accessible calendar.",
        "PATCH endpoint updates an event using the same URL shape as the calendar UI (`/api/google-calendar/events/{eventId}?calendarId={calendarId}`).",
        "DELETE endpoint deletes an event using the same URL shape as the calendar UI (`/api/google-calendar/events/{eventId}` with optional `calendarId`).",
        "When calendarId is missing, default to primary and include the chosen calendarId in the response.",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Render Google events in the calendar layout",
      "description": "As a user, I want the calendar page to display real Google events so my schedule is accurate.",
      "acceptanceCriteria": [
        "Calendar page loads events from `/api/google-calendar/events` (not mock data).",
        "Events show correct date/time and a label for the source calendar.",
        "After create/update/delete, the UI refreshes events (auto refresh or manual refresh button).",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Enable Calendar AI assistant to use Google Calendar CRUD",
      "description": "As a user, I want the Calendar AI assistant to add, edit, delete, and find events with full calendar permissions.",
      "acceptanceCriteria": [
        "Calendar assistant requests are routed through the Brain chat handler and can call calendar CRUD actions.",
        "Assistant can find events for a date range and returns the matching list.",
        "Assistant can create/update/delete events and confirms the result.",
        "If not connected, assistant returns a clear prompt to connect via `/api/google/auth`.",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    }
  ]
}
